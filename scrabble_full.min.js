Scrabble.Main = function() {
    return {init: function() {
            Scrabble.SocialPlatformManager.init();
            if (Scrabble.config.fbId == "0" || Scrabble.config.accessToken == "") {
                return false
            }
            Scrabble.MatchOptions.setDefaultDictionary();
            Scrabble.LocalStorageManager.detectLocalStorage();
            Scrabble.TelemetryManager.init();
            Scrabble.ImageLoader.loadImages();
            Scrabble.KeyboardManager.init();
            Scrabble.SoundManager.init();
            Scrabble.Main.buildMenus();
            Scrabble.Main.translateUI();
            Scrabble.PopupManager.init();
            Scrabble.GameServerManager.getUserIndirect(Scrabble.config.fbId);
            Scrabble.StoreSynchronizer.getTNTUser();
            Scrabble.PlayerManager.loadFacebookFriends();
            if (Scrabble.LocalStorageManager.get("showTipOfTheDay") !== "false") {
                Scrabble.PopupManager.add(Scrabble.UpsellPopup)
            }
        },buildMenus: function() {
            Scrabble.LeftMenu.init();
            Scrabble.AnimationManager.init();
            Scrabble.TopMenu.initialize();
            Scrabble.Chat.initialize();
            Scrabble.ResolutionManager.init();
            Scrabble.WordList.initialize();
            Scrabble.LeaderBoard.init();
            Scrabble.ResolutionManager.updateResolution();
            Scrabble.GameScene.init();
            Scrabble.SplashScreen.initialize()
        },translateUI: function() {
            var c = $("[data-translate-link]");
            var a, d;
            for (var b = 0; b < c.length; b++) {
                a = $(c[b]);
                d = Scrabble.Dictionary.translate(a.attr("data-translate-link"));
                a.html(d);
                a.attr("title", d)
            }
        }}
}();
Scrabble.AjaxProxy = function() {
    var b = Scrabble.config._callbackUrl + "/" + Scrabble.vNum + "/client/container/ajax/MayhemProxy.php";
    var c = Scrabble.config._callbackUrl + "/" + Scrabble.vNum + "/client/container/ajax/Geolocation.php";
    var a = 1048576;
    return {callCount: 0,errorCount: 0,callstack: {},isRecovering: false,recoverAttempts: 0,get: function(g, h, k, d, f) {
            f = f || true;
            Scrabble.AjaxProxy.callCount++;
            h = Scrabble.AjaxProxy.updateData(h);
            h.event = g;
            h.override = "GET";
            h.clientVersion = Scrabble.config._version;
            h.secure = String(Scrabble.config._isSecure);
            h.branding = Scrabble.config._branding;
            var e = new Date();
            var j = e.getTime();
            if (f === true) {
                Scrabble.AjaxProxy.callstack[j] = ["GET", g, h, k, d]
            }
            $.ajax({type: "POST",url: b,timeout: a,data: urlEncode(h),success: function(m) {
                    if (typeof k === "function") {
                        var l = Scrabble.AjaxProxy.parseResponse(m, g, j);
                        if (l != false) {
                            k(l, d);
                            Scrabble.AjaxProxy.handleRequestDuration(j, g)
                        }
                        g = h = k = d = null
                    }
                },error: function(l, n, m) {
                    Scrabble.AjaxProxy.proxyError(l, g, j);
                    delete Scrabble.AjaxProxy.callstack[j];
                    Scrabble.AjaxProxy.handleRequestDuration(j, g);
                    g = h = k = d = null
                }})
        },getLocation: function(d) {
            $.ajax({type: "POST",url: c,success: function(f) {
                    d(f)
                },error: function(f) {
                    console.error("Geolocation Error")
                }})
        },parseResponse: function(m, e, h) {
            if (e == Scrabble.MayhemEvents.GetChatRoom) {
                m = m.replaceAll("+", " ");
                m = m.replaceAll("%2B", "+")
            }
            var j = xml2json.parser(m.split("<![CDATA[").join(""));
            if (j.error) {
                console.error(m);
                if ((e == Scrabble.MayhemEvents.FindWordInDictionary && j.error.code == "404")) {
                } else {
                    var g = new Date();
                    var f = g.getTime();
                    Scrabble.TelemetryManager.gameLoad("fail", "data", e)
                }
                if (j.error.code == "401" || (e == Scrabble.MayhemEvents.GetToken && j.error.field == "applicationUserId")) {
                    console.warn("401 Error received");
                    Scrabble.AjaxProxy.recoverMayhemSession();
                    return false
                }
            }
            if (j.version) {
                if (j.version != "ok") {
                    var k = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLUPDT_TTL");
                    var l = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLUPDT_MSG");
                    var d = {type: "noticePopup",title: k,message: l,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(d))
                }
            }
            delete Scrabble.AjaxProxy.callstack[h];
            return j
        },recoverMayhemSession: function() {
            Scrabble.AjaxProxy.recoverAttempts++;
            if (Scrabble.AjaxProxy.recoverAttempts < 5) {
                if (Scrabble.AjaxProxy.isRecovering == false) {
                    Scrabble.AjaxProxy.isRecovering = true;
                    Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.TokenReceived, Scrabble.AjaxProxy.emptyStack);
                    Scrabble.GameServerManager.getToken()
                }
            }
        },emptyStack: function() {
            console.warn("Recovered Mayhem session");
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.TokenReceived, Scrabble.AjaxProxy.emptyStack);
            var e;
            var d = [];
            for (var f in Scrabble.AjaxProxy.callstack) {
                e = Scrabble.AjaxProxy.callstack[f];
                if (d.indexOf(e[1]) == -1 || e[1] != "PostMatch") {
                    console.log("Calling [" + e[1] + "] after reconnect successful");
                    if (e[0] = "GET") {
                        Scrabble.AjaxProxy.get(e[1], e[2], e[3], e[4])
                    } else {
                        Scrabble.AjaxProxy.post(e[1], e[2], e[3], e[4])
                    }
                    d.push(e[1])
                } else {
                    console.error("Call was already sent [" + e[1] + "]")
                }
            }
            Scrabble.AjaxProxy.callstack = {};
            Scrabble.AjaxProxy.recoverAttempts = 0;
            Scrabble.AjaxProxy.isRecovering = false
        },post: function(g, h, k, d, f) {
            f = f || true;
            Scrabble.AjaxProxy.callCount++;
            h = Scrabble.AjaxProxy.updateData(h);
            h.event = g;
            h.clientVersion = Scrabble.config._version;
            h.secure = String(Scrabble.config._isSecure);
            h.branding = Scrabble.config._branding;
            var e = new Date();
            var j = e.getTime();
            if (f === true) {
                Scrabble.AjaxProxy.callstack[j] = ["POST", g, h, k, d]
            }
            $.ajax({type: "POST",url: b,timeout: a,data: urlEncode(h),success: function(m) {
                    if (typeof k === "function") {
                        var l = Scrabble.AjaxProxy.parseResponse(m, g, j);
                        if (l != false) {
                            k(l, d);
                            Scrabble.AjaxProxy.handleRequestDuration(j, g)
                        }
                        g = h = k = d = null
                    }
                },error: function(l, n, m) {
                    Scrabble.AjaxProxy.proxyError(l, g, j);
                    Scrabble.AjaxProxy.handleRequestDuration(j, g);
                    g = h = k = d = null
                }})
        },proxyError: function(j, g, d) {
            Scrabble.AjaxProxy.errorCount++;
            Scrabble.TelemetryManager.gameLoad("fail", "data", g);
            var h = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_TTL");
            var f = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_MSG");
            var e = {type: "noticePopup",title: h,message: f,diag: {}};
            Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(e));
            console.error("Ajax Error : " + g);
            console.error(j);
            console.error(Scrabble.AjaxProxy.callstack[d])
        },updateData: function(d) {
            if (d.mh_session_key != undefined) {
                d.mh_session_key = Scrabble.GameServerManager.mh_session_key
            }
            if (d.mh_uid != undefined) {
                d.mh_uid = Scrabble.GameServerManager.mh_uid
            }
            if (d.mh_auth_params != undefined) {
                d.mh_auth_params = Scrabble.GameServerManager.mh_auth_params
            }
            return d
        },handleRequestDuration: function(g, h) {
            var d = new Date();
            var f = d.getTime();
            var e = (d - g)
        }}
}();
Scrabble.FacebookBridge = function() {
    BATCH_SIZE = 50;
    return {_getUserInfoLastRequestId: 0,_getUserInfoBatches: {},_usedRequests: [],nudgedPlayers: [],getFriends: function(b, a) {
            FB.api("/me/friends", {access_token: Scrabble.config.accessToken,fields: "id"}, b)
        },getUserInfo: function(k, f) {
            var c = Scrabble.FacebookBridge._generateGetUserInfoRequestId();
            var a = {sent: 0,received: 0,data: []};
            argsIds = f.ids + "";
            var b = argsIds;
            var d = b.split(",");
            usersLength = d.length;
            var j = 0;
            var g, e;
            while (j < usersLength) {
                a.sent++;
                g = d.slice(j, j + BATCH_SIZE);
                j += BATCH_SIZE;
                e = g.join(",");
                var h = "SELECT " + f.fields + " FROM user WHERE uid IN (" + e + ")";
                FB.api({method: "fql.query",query: h,access_token: Scrabble.config.accessToken}, function(l) {
                    Scrabble.FacebookBridge._getUserInfoCallback(c, k, l)
                })
            }
            Scrabble.FacebookBridge._getUserInfoBatches[c] = a
        },_getUserInfoCallback: function(c, d, b) {
            var a = Scrabble.FacebookBridge._getUserInfoBatches[c];
            if (a) {
                a.data = a.data.concat(b);
                a.received++;
                if (a.received == a.sent) {
                    d(a.data);
                    delete a
                }
            }
        },_generateGetUserInfoRequestId: function() {
            var a = Scrabble.FacebookBridge._getUserInfoLastRequestId++;
            return a
        },askForExtendedPermissions: function(a, b) {
            FB.login(function(c) {
                if (c && c.authResponse) {
                    Scrabble.config.accessToken = c.authResponse.accessToken;
                    Scrabble.FacebookBridge.checkForExtendedPermissions(a, b)
                } else {
                    if (b) {
                        b()
                    }
                }
            }, {scope: "friends_likes"})
        },checkForExtendedPermissions: function(a, b) {
            FB.api("/me/permissions", {access_token: Scrabble.config.accessToken}, function(c) {
                if (c.data[0].friends_likes == 1) {
                    if (a) {
                        a()
                    }
                } else {
                    if (b) {
                        b()
                    }
                }
            })
        },findWordGameFriends: function(b) {
            var a = "SELECT uid FROM page_fan WHERE uid in (Select uid2 FROM friend WHERE uid1 = me()) AND page_id IN (" + Scrabble.WordGameUtils.wordGameIds.join(",") + ")";
            FB.api({method: "fql.query",query: a,access_token: Scrabble.config.accessToken}, function(c) {
                Scrabble.WordGameUtils.parseLikesWordGames(c);
                if (b != null) {
                    b(c)
                }
            })
        },inviteFriend: function(e, b, a, d) {
            var c = Scrabble.kontagent.genUniqueTrackingTag();
            FB.ui({method: "apprequests",title: Scrabble.Dictionary.translate("PSH_TXT_INVT_TTL"),message: Scrabble.Dictionary.translate("PSH_TXT_INVT_MSG", {"[FRIEND_NAME]": Scrabble.PlayerManager.currentUser.first_name}),to: b,picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_invite_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + c + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + e}, function(h) {
                if (h) {
                    var f = h.to.join(",");
                    var g = {subtype1: e};
                    Scrabble.TelemetryManager.trackInviteSent(Scrabble.config.fbId, f, c, g)
                }
                if (h && a != null) {
                    a()
                }
                if (!h && d != null) {
                    d()
                }
            })
        },inviteFriends: function(f, b, d, a, e) {
            if (b) {
                b = (Scrabble.PlayerManager.getRegisteredPlayers().concat(Scrabble.PlayerManager.ommitList)).join(",")
            } else {
                b = Scrabble.PlayerManager.ommitList.join(",")
            }
            if (d == undefined) {
                d = "PSH_TXT_INVT_MSG"
            }
            var c = Scrabble.kontagent.genUniqueTrackingTag();
            FB.ui({method: "apprequests",title: Scrabble.Dictionary.translate("PSH_TXT_INVT_TTL"),exclude_ids: b,filters: ["app_non_users"],message: Scrabble.Dictionary.translate(d, {"[FRIEND_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name}),picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_invite_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + c + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + f}, function(j) {
                if (j) {
                    var g = j.to.join(",");
                    var h = {subtype1: f};
                    Scrabble.TelemetryManager.trackInviteSent(Scrabble.config.fbId, g, c, h)
                }
                if (f == "bring_your_friends") {
                    if (j) {
                        Scrabble.TelemetryManager.sendTutorial("bring_your_friends", "send", j.to.length)
                    } else {
                        Scrabble.TelemetryManager.sendTutorial("bring_your_friends", "cancel")
                    }
                }
                if (j && a != null) {
                    a()
                }
                if (!j && e != null) {
                    e()
                }
            })
        },inviteFriendsFromAds: function(d, a, c) {
            if (a) {
                a = a + (Scrabble.PlayerManager.getRegisteredPlayers().concat(Scrabble.PlayerManager.ommitList)).join(",")
            } else {
                a = (Scrabble.PlayerManager.getRegisteredPlayers().concat(Scrabble.PlayerManager.ommitList)).join(",")
            }
            if (c == undefined) {
                c = "PSH_TXT_INVT_MSG"
            }
            var b = Scrabble.kontagent.genUniqueTrackingTag();
            FB.ui({method: "apprequests",title: Scrabble.Dictionary.translate("PSH_TXT_INVT_TTL"),exclude_ids: a,message: Scrabble.Dictionary.translate(c, {"[FRIEND_NAME]": Scrabble.PlayerManager.currentUser.first_name}),picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_invite_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + b + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + d}, function(h) {
                if (h) {
                    var f = h.to.join(",");
                    var g = {subtype1: d};
                    Scrabble.TelemetryManager.trackInviteSent(Scrabble.config.fbId, f, b, g);
                    var e = {title: Scrabble.Dictionary.translate("FCBK_TXT_INTRSTTL_INVTSNT_TTL"),message: Scrabble.Dictionary.translate("FCBK_TXT_INTRSTTL_INVTSNT_MSG"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "FCBK_BTN_INTRSTTL_INVTSNT_OK"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(e))
                }
            })
        },publishStatComment: function(e, d, c) {
            var a = Scrabble.kontagent.genUniqueTrackingTag();
            var b = "leaderboard_comment";
            FB.ui({method: "feed",name: Scrabble.Dictionary.translate("FCBK_TXT_CMMNT_LNKTXT", {"[FRIEND_NAME]": e}),description: Scrabble.Dictionary.translate("FCBK_TXT_CMMNT_MSG2"),caption: Scrabble.Dictionary.translate("FCBK_TXT_CMMNT_MSG"),link: Scrabble.config._applicationUrl + "?stream=" + a,to: d,picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_jab_" + Scrabble.config.lang + ".png",data: "type:stream&trackingTag:" + a + "&subtype1:" + b}, function(f) {
                var g = {subtype1: b};
                if (f) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, a, "stream", g)
                }
                if (typeof c != "undefined") {
                    c(f)
                }
            })
        },publishBingo: function(d, b, e) {
            var a = Scrabble.kontagent.genUniqueTrackingTag();
            var c = "bingo";
            FB.ui({method: "feed",name: Scrabble.Dictionary.translate("FBPSTS_TXT_BNG_TTL"),display: "iframe",description: Scrabble.Dictionary.translate("FCBK_TXT_CMMNT_MSG2"),picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_bingo_" + Scrabble.config.lang + ".png",caption: Scrabble.Dictionary.translate("FBPSTS_TXT_BNG_MSG", {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[#_POINTS]": d,"[WORD]": b.toUpperCase()}),link: Scrabble.config._applicationUrl + "?stream=" + a,data: "type:stream&trackingTag:" + a + "&subtype1:" + c}, function(f) {
                var g = {subtype1: c};
                if (f) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, a, "stream", g)
                }
                if (e) {
                    e(f)
                }
            })
        },publishHighWordScore: function(b, d) {
            var a = Scrabble.kontagent.genUniqueTrackingTag();
            var c = "new_best_word_score";
            FB.ui({method: "feed",name: Scrabble.Dictionary.translate("FBPSTS_TXT_BSTWRD_TTL"),display: "iframe",picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_best_word_score_" + Scrabble.config.lang + ".png",caption: Scrabble.Dictionary.translate("FBPSTS_TXT_BSTWRD_MSG", {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[#_POINTS]": d,"[WORD]": b.toUpperCase()}),link: Scrabble.config._applicationUrl + "?stream=" + a,data: "type:stream&trackingTag:" + a + "&subtype1:" + c}, function(e) {
                var f = {subtype1: c};
                if (e) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, a, "stream", f)
                }
                if (callback) {
                    callback()
                }
            })
        },publishHighGameScore: function(c) {
            var a = Scrabble.kontagent.genUniqueTrackingTag();
            var b = "new_best_game_score";
            FB.ui({method: "feed",name: Scrabble.Dictionary.translate("FBPSTS_TXT_BSTGM_TTL"),display: "iframe",picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_best_game_score_" + Scrabble.config.lang + ".png",caption: Scrabble.Dictionary.translate("FBPSTS_TXT_BSTGM_MSG", {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[#_POINTS]": c}),link: Scrabble.config._applicationUrl + "?stream=" + a,data: "type:stream&trackingTag:" + a + "&subtype1:" + b}, function(d) {
                var e = {subtype1: b};
                if (d) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, a, "stream", e)
                }
                if (callback) {
                    callback()
                }
            })
        },publishWonGame: function(g, c) {
            var d = Scrabble.kontagent.genUniqueTrackingTag();
            var b, f, a, e;
            if (c.rank == 0) {
                b = "/share_draw_" + Scrabble.config.lang + ".png";
                f = Scrabble.Dictionary.translate("FBPSTS_TXT_DRW_MSG", {"[OPPONENT_NAME]": c.opponents[0],"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name});
                a = Scrabble.Dictionary.translate("FBPSTS_TXT_DRW_TTL")
            } else {
                if (c.opponents && c.opponents.length) {
                    if (c.opponents.length == 1) {
                        e = {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[OPPONENT_NAME]": c.opponents[0]}
                    }
                    if (c.opponents.length == 2) {
                        e = {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[OPPONENT_NAME]": c.opponents[0],"[OPPONENT_NAME2]": c.opponents[1]}
                    } else {
                        e = {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name,"[OPPONENT_NAME]": c.opponents[0],"[OPPONENT_NAME2]": c.opponents[1],"[OPPONENT_NAME3]": c.opponents[2]}
                    }
                } else {
                    e = {"[PLAYER_NAME]": Scrabble.PlayerManager.currentUser.first_name}
                }
                if (c.rank == 1) {
                    b = "/share_win_" + Scrabble.config.lang + ".png";
                    a = Scrabble.Dictionary.translate("FBPSTS_TXT_VCTRY_TTL");
                    if (c.opponents.length == 1) {
                        f = Scrabble.Dictionary.translate("FBPSTS_TXT_VCTRY_MSG", e)
                    } else {
                        if (c.opponents.length == 2) {
                            f = Scrabble.Dictionary.translate("FBPSTS_TXT_VCTRY_MSG_3PLYR", e)
                        } else {
                            f = Scrabble.Dictionary.translate("FBPSTS_TXT_VCTRY_MSG_4PLAYR", e)
                        }
                    }
                } else {
                    a = Scrabble.Dictionary.translate("FBPSTS_TXT_LST_TTL");
                    if (c.rank == 2) {
                        b = "/share_finished_2nd_" + Scrabble.config.lang + ".png"
                    }
                    if (c.rank == 3) {
                        b = "/share_finished_3rd_" + Scrabble.config.lang + ".png"
                    }
                    if (c.rank == 4) {
                        b = "/share_finished_4th_" + Scrabble.config.lang + ".png"
                    }
                    if (c.opponents.length == 1) {
                        f = Scrabble.Dictionary.translate("FBPSTS_TXT_LST" + c.rank + "_MSG", e)
                    } else {
                        if (c.opponents.length == 2) {
                            f = Scrabble.Dictionary.translate("FBPSTS_TXT_LST" + c.rank + "_MSG_3PLYR", e)
                        } else {
                            f = Scrabble.Dictionary.translate("FBPSTS_TXT_LST" + c.rank + "_MSG_4PLYR", e)
                        }
                    }
                }
            }
            FB.ui({method: "feed",name: a,display: "iframe",description: Scrabble.Dictionary.translate("FCBK_TXT_CMMNT_MSG2"),picture: trimSecure(Scrabble.config._cdnWallposts) + b,caption: f,link: Scrabble.config._applicationUrl + "?stream=" + d,data: "type:stream&trackingTag:" + d}, function(h) {
                if (h) {
                    var j = {};
                    if (c.rank == 1) {
                        j.subtype1 = "victory"
                    } else {
                        j.subtype1 = "end_of_game_result"
                    }
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, d, "stream", j)
                }
                if (g) {
                    g()
                }
            })
        },publishGameCreated: function(b, d) {
            var c = Scrabble.kontagent.genUniqueTrackingTag();
            var a = "game_created";
            FB.ui({method: "apprequests",to: b,title: Scrabble.Dictionary.translate("PSH_TXT_NWGM_TTL"),message: Scrabble.Dictionary.translate("PSH_TXT_NWGM_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name}),data: "type:game_invite&trackingTag:" + c + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + a + "&matchId:" + Scrabble.GameServerManager.currentMatch + "&matchStatus:created",picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_invite_" + Scrabble.config.lang + ".png"}, function(g) {
                if (g) {
                    var e = g.to.join(",");
                    var f = {subtype1: a}
                }
                if (d) {
                    d()
                }
            })
        },addNudge: function(a) {
            for (var b = 0; b < Scrabble.FacebookBridge.nudgedPlayers.length; b++) {
                if (a == Scrabble.FacebookBridge.nudgedPlayers[b]) {
                    return false
                }
            }
            Scrabble.FacebookBridge.nudgedPlayers.push(a)
        },publishNudge: function(b, d, h) {
            if (Scrabble.FacebookBridge.nudgedPlayers.length != 0) {
                console.warn(Scrabble.FacebookBridge.nudgedPlayers);
                var f = Scrabble.kontagent.genUniqueTrackingTag();
                var c = "turn_notification";
                var a = "type:game_invite&trackingTag:" + f + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + c + "&matchStatus:nudge";
                if (Scrabble.FacebookBridge.nudgedPlayers.length == 1) {
                    a += "&matchId:" + b.matchuri
                }
                var g = "FCBK_LBL_NDGPP_NDG";
                var e = "PSH_TXT_NDGD_MSG";
                if (d == "forfeit") {
                    g = "FCBK_LBL_FRCFRFTPP_FRCFRFT";
                    e = "PSH_TXT_FRCFRFT_MSG"
                }
                FB.ui({method: "apprequests",to: Scrabble.FacebookBridge.nudgedPlayers.join(","),title: Scrabble.Dictionary.translate(g),message: Scrabble.Dictionary.translate("PSH_TXT_NDGD_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name}),data: a,picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_nudge_" + Scrabble.config.lang + ".png"}, function(l) {
                    if (l) {
                        var j = l.to.join(",");
                        var k = {subtype1: c}
                    }
                    if (typeof h === "function") {
                        h()
                    }
                })
            }
            Scrabble.FacebookBridge.nudgedPlayers = []
        },publishTurn: function(m, l) {
            console.warn("Publishing Turn");
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.FacebookBridge.publishTurn);
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.FacebookBridge.publishTurn);
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.skipEnd);
            var k = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (k == null) {
                k = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
            }
            var a = null, b = "", j = [], e = "", c = "", o = "";
            if (k.plays.play || l) {
                if (l) {
                    if (m) {
                        m()
                    }
                    return
                } else {
                    if (k.state == "COMPLETE") {
                        var f = k.mmatchusers.matchuser;
                        f.sort(Scrabble.EndGamePopup._sortUsersByRanks);
                        c = [];
                        for (var h = 0; h < f.length; h++) {
                            var n = Scrabble.PlayerManager.getPlayerInfo(f[h].userid, "fbId");
                            if (n != Scrabble.PlayerManager.currentUser.fbId) {
                                c.push(n)
                            }
                        }
                        if (f.length > 2) {
                            if (f[0].status == "WIN") {
                                o = Scrabble.Dictionary.translate("PSH_TXT_FCBKMLTPLY_WN", {"[PLAYER_NAME]": Scrabble.PlayerManager.getPlayerInfo(f[0].userid, "first_name")})
                            } else {
                                o = Scrabble.Dictionary.translate("PSH_TXT_GMOVRDRW_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name})
                            }
                        } else {
                            if (f[0].userid == Scrabble.PlayerManager.currentUser.mayhemId && f[0].status == "WIN") {
                                o = Scrabble.Dictionary.translate("PSH_TXT_GMOVRLSS_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name})
                            } else {
                                if (f[0].status == "WIN") {
                                    o = Scrabble.Dictionary.translate("PSH_TXT_GMOVRWIN_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name})
                                } else {
                                    o = Scrabble.Dictionary.translate("PSH_TXT_GMOVRDRW_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name})
                                }
                            }
                        }
                    } else {
                        if (k.plays.play.length) {
                            a = k.plays.play[k.plays.play.length - 1]
                        } else {
                            a = k.plays.play
                        }
                        e = a.score;
                        console.warn(a);
                        c = Scrabble.PlayerManager.getPlayerInfo(a.nextplayerturn, "fbId");
                        if (a.playtype == "PLAY_WORD") {
                            if (a.allwords.word.length) {
                                j = a.allwords.word[0].split(";")
                            } else {
                                j = a.allwords.word.split(";")
                            }
                        } else {
                            if (a.playtype == "SWAP_TILES") {
                                j = a.playdata.split(";")
                            }
                        }
                        for (var h = 0; h < j.length; h++) {
                            b += j[h].split(",")[3]
                        }
                        o = Scrabble.Dictionary.translate("PSH_TXT_YRTRN_MSG", {"[OPPONENT_NAME]": Scrabble.PlayerManager.currentUser.first_name})
                    }
                }
                if (c && c != "" && c != false && c != "0" && c != Scrabble.config.fbId) {
                    var g = Scrabble.kontagent.genUniqueTrackingTag();
                    var d = "turn_notification";
                    FB.ui({method: "apprequests",to: c,title: Scrabble.Dictionary.translate("PSH_TXT_YRTRN_TTL"),message: o,data: "type:game_invite&trackingTag:" + g + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1" + d + "&matchId:" + Scrabble.GameServerManager.currentMatch + "&matchStatus:turn",picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_play_" + Scrabble.config.lang + ".png"}, function(s) {
                        if (s) {
                            var q = s.to.join(",");
                            var r = {subtype1: d}
                        }
                        if (m) {
                            m()
                        }
                    })
                } else {
                    if (m) {
                        m()
                    }
                }
            }
        },sendFriendsInvite: function(d, e) {
            Scrabble.PopupManager.close();
            var b = [];
            b[0] = [];
            var a = 0;
            for (var c in Scrabble.PlayerManager.playerList) {
                if (Scrabble.PlayerManager.playerList[c].isAppUser == true) {
                    b[a].push(c);
                    if (b[a].length % 25 == 0) {
                        a++;
                        b[a] = []
                    }
                }
            }
            if (b[0].length > 0) {
                Scrabble.FacebookBridge._sendPartialFriendsInvite(d, b, 0, e)
            }
        },sendSelectedFriendsInvite: function(a, d) {
            var c = [];
            for (var b = 0; b <= Math.floor(a.length / 25); b++) {
                c[b] = []
            }
            for (var b = 0; b < a.length; b++) {
                c[Math.floor(b / 25)].push(a[b])
            }
            if (c[0].length > 0) {
                Scrabble.FacebookBridge._sendPartialFriendsInvite(c, 0, d, [])
            }
        },_sendPartialFriendsInvite: function(e, b, a, f, d) {
            if (b[a].length > 0) {
                var c = Scrabble.kontagent.genUniqueTrackingTag();
                FB.ui({method: "apprequests",to: b[a].join(","),title: Scrabble.Dictionary.translate("PSH_TXT_INVT_TTL"),message: Scrabble.Dictionary.translate("PSH_TXT_INVT_MSG", {"[FRIEND_NAME]": Scrabble.PlayerManager.currentUser.first_name}),picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_invite_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + c + "&inviterMayhemId:" + Scrabble.PlayerManager.currentUser.mayhemId + "&subtype1:" + e}, function(h) {
                    if (h) {
                        var g = h.to.join(",");
                        Scrabble.TelemetryManager.trackInviteSent(Scrabble.config.fbId, g, c, {subtype1: e});
                        Scrabble.TelemetryManager.sendTutorial("spread_the_word", "send", h.to.length)
                    } else {
                        Scrabble.TelemetryManager.sendTutorial("spread_the_word", "cancel")
                    }
                    if (h && h.to && d != null) {
                        d = d.concat(h.to)
                    }
                    if (b[a + 1] != null) {
                        Scrabble.FacebookBridge._sendPartialFriendsInvite(b, a + 1, f, d)
                    } else {
                        if (f) {
                            f(d)
                        }
                    }
                })
            } else {
                if (f) {
                    f(invitedCount)
                }
            }
        },sendForfeit: function(a, c) {
            var b = Scrabble.kontagent.genUniqueTrackingTag();
            FB.ui({method: "apprequests",title: Scrabble.Dictionary.translate("PSH_TXT_YRTRN_TTL"),message: Scrabble.Dictionary.translate("PSH_TXT_OPPFRFT_MSG", {"[OPPONENT _NAME]": Scrabble.PlayerManager.currentUser.first_name}),to: a,picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_play_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + b + "&subType1:stream&matchId:" + Scrabble.GameServerManager.currentMatch}, function(d) {
                if (d) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, b, "stream")
                }
                if (c) {
                    c(d)
                }
            })
        },sendResign: function(a, c) {
            var b = Scrabble.kontagent.genUniqueTrackingTag();
            FB.ui({method: "apprequests",title: Scrabble.Dictionary.translate("PSH_TXT_YRTRN_TTL"),message: Scrabble.Dictionary.translate("PSH_TXT_OPPDLTD_MSG", {"[OPPONENT _NAME]": Scrabble.PlayerManager.currentUser.first_name}),to: a,picture: trimSecure(Scrabble.config._cdnWallposts) + "/share_play_" + Scrabble.config.lang + ".png",data: "type:app_invite&trackingTag:" + b + "&subType1:stream"}, function(d) {
                if (d) {
                    Scrabble.TelemetryManager.trackStreamPost(Scrabble.config.fbId, b, "stream")
                }
                if (c) {
                    c(d)
                }
            })
        }}
}();
Scrabble.MayhemBridge = function() {
    var g = Scrabble.config._mayhemUrl;
    var e = 1048576;
    var b = "CLIENT_VERSION_PARAMETER";
    var k = "METHOD_OVERRIDE_PARAMETER";
    var a = "SERVER_AUTHORIZATION_METHOD";
    var l = "SERVER_AUTHORIZATION_PARAMETERS";
    var f = "SESSION_KEY_PARAMETER";
    var h = "USER_ID_PARAMETER";
    var d = Scrabble.config._socialPlatformName + "-scrabble-" + Scrabble.config._version;
    var c = "dummy";
    var j = {GetToken: {headers: [b, k, a, l],params: {game: "scrabble"},url: "/users/'mayhemId'/token",paramsLocation: "GET"},GetUserIndirect: {headers: [b, k],params: {applicationUserId: null,application: Scrabble.config._socialPlatformName},url: "/users",paramsLocation: "GET"},GetUserDirect: {headers: [b, k],params: {application: Scrabble.config._socialPlatformName},url: "/users/'uid'",paramsLocation: "GET"},GetMatch: {headers: [b, k, f, h],params: {lastUpdatedTime: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/users/'uid'/scrabblematches/'matchId'",paramsLocation: "GET"},GetScrabbleMatches: {headers: [b, k, f, h],params: {lastUpdatedTime: null,matchState: null,dictionaryList: null,speed: null,page: null,pageSize: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/users/'uid'/scrabblematches",paramsLocation: "POST"},GetMatches: {headers: [b, k, f],params: {game: "scrabble",userRating: null,startUserCount: null,ratingRange: null,dictionary: null,speed: null,application: Scrabble.config._socialPlatformName},url: "/matches",paramsLocation: "GET"},GetMatchUser: {headers: [b, f, h],params: {matchId: null,userId: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/scrabblematchusers",paramsLocation: "POST"},GetUserSettings: {headers: [b, k, f, h],params: {},url: "/games/scrabble/settings/'uid'",paramsLocation: "GET"},PostUserSettings: {headers: [b, k, f, h],params: {animations: null,sounds: null,notificationPrompts: null,onlineStatusVisibility: null,defaultDictionary: null,boardLayout: null,application: Scrabble.config._socialPlatformName,game: "scrabble"},url: "/games/scrabble/settings/'uid'",paramsLocation: "PUT"},GetTwoLetterWords: {headers: [b, k],params: {wordLength: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/dictionary/'dictionary'",paramsLocation: "GET"},FindWordInDictionary: {headers: [b, k],params: {word: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/dictionary/'dictionary'",paramsLocation: "GET"},GetStatIndirect: {headers: [b, k],params: {game: "scrabble",statTypeCode: null,realTime: null,lastUpdatedTime: null,period: null,application: Scrabble.config._socialPlatformName},url: "/users/'uid'/stats",paramsLocation: "GET"},GetStatsList: {headers: [b, k],params: {game: "scrabble",statTypeCode: null,realTime: null,rank: false,lastUpdatedTime: null,application: Scrabble.config._socialPlatformName},url: "/userlist/'userList'/stats",paramsLocation: "GET"},GetStats: {headers: [b, k],params: {game: "scrabble",statTypeCode: null,rank: null,count: null,realTime: null,lastUpdatedTime: null,period: null,application: Scrabble.config._socialPlatformName},url: "/stats",paramsLocation: "GET"},GetChatRoom: {headers: [b, k, f, h],params: {application: Scrabble.config._socialPlatformName,afterChatEntryId: null},url: "/chatrooms/'chatRoomId'/chatentries",paramsLocation: "GET"},PostUser: {headers: [b, a, l],params: {application: "facebook",applicationUserId: null},url: "/users",paramsLocation: "POST"},PostUserList: {headers: [b, a, l],params: {applicationUserIds: null,userIds: null,game: "scrabble",application: Scrabble.config._socialPlatformName},url: "/userlist",paramsLocation: "POST"},PostPlay: {headers: [b, f, h],params: {playType: null,playData: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/matches/'matchId'/users/'uid'/plays",paramsLocation: "POST"},PostChat: {headers: [b, f, h],params: {message: null,userId: null,application: Scrabble.config._socialPlatformName},url: "/chatrooms/'chatRoomId'/chatentries?userId='userId'",paramsLocation: "POST"},GetRack: {headers: [b, k, f, h],params: {matchId: null,userId: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/racks",paramsLocation: "GET"},PostStat: {headers: [b, f, h],params: {game: "scrabble",statTypeCode: null,value: null,csm: null,application: Scrabble.config._socialPlatformName},url: "/users/'uid'/stats",paramsLocation: "POST"},GetBoard: {headers: [b, k],params: {game: "scrabble",boardId: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/boards/'boardId'",paramsLocation: "GET"},PostMatchUser: {headers: [b, f, h],params: {userRating: null,application: Scrabble.config._socialPlatformName},url: "/users/'uid'/matches/'matchId'",paramsLocation: "POST"},PostMatch: {headers: [b, f, h],params: {title: null,description: null,access: null,mode: "NORMAL",joinMatch: null,dictionary: null,speed: null,userRating: null,startUserCount: null,game: "scrabble",matchUserIds: null,title: null,joinRatingRange: null,matchUserApplication: null,matchUserApplicationIds: null,application: Scrabble.config._socialPlatformName},url: "/users/'uid'/matches'%matchUserApplicationIds'",paramsLocation: "POST"},PostInviteIndirect: {headers: [b, f, h],params: {applicationUserId: null,application: Scrabble.config._socialPlatformName},url: "/matches/'matchId'/users/'uid'/invitations",paramsLocation: "POST"},GetScrabbleAds: {headers: [b, k],params: {userId: null},url: "/games/scrabble/scrabbleads",paramsLocation: "GET"},GetInvitedFriends: {headers: [b, k],params: {userId: null},url: "/games/scrabble/invitedfriends",paramsLocation: "GET"},PostInvitedFriends: {headers: [b, k, h, a, l, f],params: {userId: null,applicationUids: null,registered: null,application: Scrabble.config._socialPlatformName},url: "/games/scrabble/invitedfriends?userId='userId'",paramsLocation: "POST"},PostMatchInvite: {headers: [b, h, f],params: {application: Scrabble.config._socialPlatformName,applicationUserId: null,matchId: null,userId: null},url: "/matches/'matchId'/users/'userId'/invitations/",paramsLocation: "POST"}};
    return {callCount: 0,errorCount: 0,callstack: {},recoverAttempts: 0,isRecovering: false,SERVER_AUTHORIZATION_METHOD: {key: "mh_auth_method",value: Scrabble.config._mayhemAuthMethod},SERVER_AUTHORIZATION_PARAMETERS: {key: "mh_auth_params",value: null},METHOD_OVERRIDE_PARAMETER: {key: "mh_method_override",value: null},CLIENT_VERSION_PARAMETER: {key: "mh_client_version",value: d},SESSION_KEY_PARAMETER: {key: "mh_session_key",value: null},USER_ID_PARAMETER: {key: "mh_uid",value: null},get: function(n, o, q, m) {
            Scrabble.MayhemBridge.callCount++;
            o = Scrabble.MayhemBridge.updateData(o);
            o.event = n;
            o.override = "GET";
            o.clientVersion = Scrabble.config._version;
            o.secure = String(Scrabble.config._isSecure);
            Scrabble.MayhemBridge.call("GET", n, o, q, m)
        },post: function(n, o, q, m) {
            Scrabble.MayhemBridge.callCount++;
            o = Scrabble.MayhemBridge.updateData(o);
            o.event = n;
            o.clientVersion = Scrabble.config._version;
            o.secure = String(Scrabble.config._isSecure);
            Scrabble.MayhemBridge.call("POST", n, o, q, m)
        },parseResponse: function(n, s, m) {
            if (s == Scrabble.MayhemEvents.GetChatRoom) {
                n = n.replaceAll("+", " ");
                n = n.replaceAll("%2B", "+")
            }
            var r = xml2json.parser(n.split("<![CDATA[").join(""));
            if (r.error) {
                console.error(n);
                if (s == Scrabble.MayhemEvents.FindWordInDictionary && r.error.code == "404") {
                } else {
                    var q = new Date();
                    var o = q.getTime();
                    Scrabble.TelemetryManager.gameLoad("fail", "data", s)
                }
                if (r.error.code == "401" || (s == Scrabble.MayhemEvents.GetToken && r.error.field == "applicationUserId")) {
                    console.warn("401 Error received");
                    Scrabble.MayhemBridge.recoverMayhemSession();
                    return false
                }
            }
            delete Scrabble.MayhemBridge.callstack[m];
            return r
        },proxyError: function(o, n, m) {
            Scrabble.MayhemBridge.errorCount++;
            Scrabble.TelemetryManager.gameLoad("fail", "data", n);
            console.error("XHR Error : " + n);
            console.error(o);
            Scrabble.GameServerManager.changeProxy("ajax");
            console.error(Scrabble.MayhemBridge.callstack[m])
        },recoverMayhemSession: function() {
            Scrabble.MayhemBridge.recoverAttempts++;
            if (Scrabble.MayhemBridge.recoverAttempts < 5) {
                if (Scrabble.MayhemBridge.isRecovering == false) {
                    Scrabble.MayhemBridge.isRecovering = true;
                    Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.TokenReceived, Scrabble.MayhemBridge.emptyStack);
                    Scrabble.GameServerManager.getToken()
                }
            }
        },emptyStack: function() {
            console.warn("Recovered Mayhem session");
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.TokenReceived, Scrabble.MayhemBridge.emptyStack);
            var m;
            for (var n in Scrabble.MayhemBridge.callstack) {
                m = Scrabble.MayhemBridge.callstack[n];
                if (m[0] = "GET") {
                    Scrabble.MayhemBridge.get(m[1], m[2], m[3], m[4])
                } else {
                    Scrabble.MayhemBridge.post(m[1], m[2], m[3], m[4])
                }
            }
            Scrabble.MayhemBridge.callstack = {};
            Scrabble.MayhemBridge.recoverAttempts = 0;
            Scrabble.MayhemBridge.isRecovering = false
        },updateData: function(m) {
            if (m.mh_session_key != undefined) {
                m.mh_session_key = Scrabble.GameServerManager.mh_session_key
            }
            if (m.mh_uid != undefined) {
                m.mh_uid = Scrabble.GameServerManager.mh_uid
            }
            if (m.mh_auth_params != undefined) {
                m.mh_auth_params = Scrabble.GameServerManager.mh_auth_params
            }
            return m
        },handleRequestDuration: function(q, r) {
            var m = new Date();
            var o = m.getTime();
            var n = (m - q)
        },call: function(m, n, t, v, s) {
            Scrabble.MayhemBridge.updateHeader(m);
            var q = new Date();
            var u = q.getTime();
            var r = g + Scrabble.MayhemBridge.parseUrl(n, t);
            var o = "https://sngames.eamobile.com/crossdomain.xml";
            Scrabble.MayhemBridge.callstack[u] = [m, n, t, v, s];
            Scrabble.AjaxProxy.transport = $.ajaxSetup("transport");
            $.flXHRproxy.registerOptions(r, {xmlResponseText: false,loadPolicyURL: o});
            $.ajax({beforeSend: function(z) {
                    z.setRequestHeader("Content-Type", "text/xml");
                    z.setRequestHeader("Accept", "text/xml");
                    z.setRequestHeader("X-Requested-With", "XMLHttpRequest");
                    z.setRequestHeader("Access-Control-Allow-Origin", "*");
                    z.setRequestHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS, PUT");
                    var x = j[n]["headers"].length;
                    for (var A = 0; A < x; A++) {
                        z.setRequestHeader(Scrabble.MayhemBridge[j[n]["headers"][A]]["key"], Scrabble.MayhemBridge[j[n]["headers"][A]]["value"])
                    }
                },type: "POST",cache: false,transport: "flXHRproxy",url: r,timeout: e,data: Scrabble.MayhemBridge.parseBody(n, t),success: function(z) {
                    if (typeof v === "function") {
                        var x = Scrabble.MayhemBridge.parseResponse(z, n, u);
                        if (x != false) {
                            v(x, s);
                            Scrabble.MayhemBridge.handleRequestDuration(u, n)
                        }
                        n = t = v = s = null
                    }
                },error: function(x) {
                    Scrabble.MayhemBridge.proxyError(x, n, u);
                    Scrabble.MayhemBridge.handleRequestDuration(u, n);
                    n = null;
                    t = null;
                    v = null;
                    s = null
                }})
        },parseUrl: function(r, t) {
            var s = j[r]["url"];
            s = s.split("'");
            if (s.length > 1) {
                for (var o = 0; o < s.length; o++) {
                    if ((o + 1) % 2 == 0) {
                        var q = false;
                        if (s[o].substr(0, 1) == "%") {
                            q = true
                        }
                        if (t[s[o]] != undefined && t[s[o]] != "") {
                            if (q) {
                                s[o] = "?" + t[s[o]].substr(1)
                            } else {
                                s[o] = t[s[o]]
                            }
                        } else {
                            if (q == false) {
                                console.error("<error>Mandatory parameter '" + s[o] + "' missing. Call Aborted !</error>")
                            } else {
                                s[o] = ""
                            }
                        }
                    }
                }
            }
            s = s.join("");
            var n = j[r]["params"];
            var m = "";
            for (var u in n) {
                if (s.indexOf("?") == -1) {
                    m = "?"
                } else {
                    m = "&"
                }
                if (n[u] == null) {
                    if (t[u] != "" && t[u] != null && t[u] != undefined) {
                        m += u + "=" + t[u];
                        s += m
                    }
                } else {
                    m += u + "=" + n[u];
                    s += m
                }
            }
            return s
        },parseBody: function(n, o) {
            var q = {dummy: "dummy"};
            for (var m in j[n]["params"]) {
                if (j[n]["params"][m] == null) {
                    if (o[m] != undefined) {
                        q[m] = o[m]
                    }
                } else {
                    q[m] = j[n]["params"][m]
                }
            }
            return urlEncode(q)
        },updateHeader: function(m) {
            Scrabble.MayhemBridge.SERVER_AUTHORIZATION_PARAMETERS.value = Scrabble.GameServerManager.mh_auth_params;
            Scrabble.MayhemBridge.SESSION_KEY_PARAMETER.value = Scrabble.GameServerManager.token().sessionKey;
            Scrabble.MayhemBridge.METHOD_OVERRIDE_PARAMETER.value = m;
            Scrabble.MayhemBridge.USER_ID_PARAMETER.value = Scrabble.GameServerManager.token().uid
        }}
}();
var SurveyBridge = function() {
    var a = $("#game_container");
    return {openSurvey: function() {
            if (Scrabble.GameScene.boardAnimated == false) {
                SurveyBridge._createBlocker();
                var c = Scrabble.config.lang;
                a.append('<div id="surveyContainer"><iframe id="surveyFrame" src="' + Scrabble.config._surveyURL + "?uemail=" + Scrabble.config.email + "&ulang=" + c + '" frameborder="0" MARGINWIDTH="0" MARGINHEIGHT="0" scrolling="no" width="640" height="480"></iframe></div>');
                var b = $("#surveyContainer");
                b.css("left", "174px");
                b.css("top", "70px")
            }
        },closeSurvey: function() {
            $("#surveyContainer").remove();
            SurveyBridge._removeBlocker()
        },openLink: function(b) {
            SurveyBridge._createBlocker();
            $("body").append('<div id="linkContainer"><div id="linkContainerCloseBtn"></div><iframe id="linkFrame" src="' + b + '" frameborder="0" MARGINWIDTH="0" MARGINHEIGHT="0" height="640"></iframe></div>');
            $("body").off("click", "#linkContainerCloseBtn", SurveyBridge.closeLink);
            $("body").on("click", "#linkContainerCloseBtn", SurveyBridge.closeLink);
            $("#game_container").off("click", ".blocker", SurveyBridge.closeLink);
            $("#game_container").on("click", ".blocker", SurveyBridge.closeLink)
        },closeLink: function() {
            $("#linkContainer").remove();
            SurveyBridge._removeBlocker()
        },_createBlocker: function() {
            $("#game_container .blocker").remove();
            a.append('<span class="blocker"></span>');
            $("#game_container .blocker").css("top", "0px");
            $("#game_container .blocker").css("zIndex", "100")
        },_removeBlocker: function() {
            $("#game_container .blocker").fadeTo(200, 0, function() {
                $(this).remove()
            })
        }}
}();
Scrabble.DomBuilder = function() {
    return {boardSquareConstruct: function(a, c, b) {
            return ['<div class="', b, ' boardCell" id="cell_', a, "_", c, '"></div>'].join("")
        },bonusSquareParticle: function(c, a) {
            var b;
            switch (a) {
                case "doubleLetter":
                    b = "gsStar04_" + Scrabble.config._branding + ".png";
                    break;
                case "tripleLetter":
                    b = "gsStar01_" + Scrabble.config._branding + ".png";
                    break;
                case "doubleWord":
                    b = "gsStar02_" + Scrabble.config._branding + ".png";
                    break;
                case "tripleWord":
                    b = "gsStar03_" + Scrabble.config._branding + ".png";
                    break;
                case "bingo":
                    b = "gsStar00_" + Scrabble.config._branding + ".png";
                    break
            }
            return ['<div id="', c, '">', '<img class="bonusSquareParticleGlow" src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/gsStarGlow.png">', '<img class="bonusSquareParticle" src="' + Scrabble.config._cdnVersion + "/images/skins/skin_default/", b, '">', "</div>"].join("")
        },buildArchiveMatch: function(h, q, D) {
            h = clone(h);
            var k = h.mmatchusers.matchuser.length;
            var a;
            var f = "";
            var B = 0;
            var m, r;
            var x = "win";
            var v = 0;
            var s = "MENU_TXT_GMCRD_CMPLTDGMS_TCHR";
            var A = 0;
            if (session_cache.archiveEmotes == undefined) {
                session_cache.archiveEmotes = {}
            }
            for (A = 0; A < k; A++) {
                var C = 0;
                if (h.mmatchusers.matchuser[A].userscore) {
                    C += h.mmatchusers.matchuser[A].userscore
                }
                if (h.mmatchusers.matchuser[A].bonus) {
                    C += h.mmatchusers.matchuser[A].userscore
                }
                if (h.mmatchusers.matchuser[A].penalty) {
                    C += h.mmatchusers.matchuser[A].userscore
                }
                if (Scrabble.GamesList.checkIfSurrender(h, h.mmatchusers.matchuser[A])) {
                    C = -1
                }
                if (h.mmatchusers.matchuser[A].userid == Scrabble.PlayerManager.currentUser.mayhemId && D == true) {
                    C = -1
                }
                h.mmatchusers.matchuser[A].total = C
            }
            if (h.mmatchusers.matchuser.length == undefined) {
                h.mmatchusers.matchuser = [h.mmatchusers.matchuser]
            }
            h.mmatchusers.matchuser = h.mmatchusers.matchuser.sort(Scrabble.EndGamePopup._sortUsersByRanks);
            f = h.mmatchusers.matchuser[0].userid;
            for (A = 0; A < k; A++) {
                if (h.mmatchusers.matchuser[A].userid == Scrabble.PlayerManager.currentUser.mayhemId) {
                    v = A
                }
            }
            var z;
            if (h.matchuri == Scrabble.GameServerManager.currentMatch) {
                if (q) {
                    z = "lastListElement lastCurrentGame"
                } else {
                    z = "listElement currentGame"
                }
            } else {
                if (q) {
                    z = "lastListElement"
                } else {
                    z = "listElement"
                }
            }
            var t = "single";
            if (k == 4) {
                t = "multi"
            } else {
                if (k == 3) {
                    t = "multi2"
                }
            }
            var n = "left";
            var o = "DRAW";
            if (h.mmatchusers.matchuser.length > 1) {
                if (v == 0 && h.mmatchusers.matchuser[0].total > h.mmatchusers.matchuser[1].total) {
                    o = "WIN"
                } else {
                    if (h.mmatchusers.matchuser[v].total < h.mmatchusers.matchuser[0].total) {
                        o = "LOSS"
                    }
                }
            }
            var l = "";
            var j = "";
            var b = "";
            var d = "";
            var c = "";
            switch (o) {
                case "WIN":
                    s += "WIN";
                    f = h.mmatchusers.matchuser[1].userid;
                    if (h.mmatchusers.matchuser.length <= 2) {
                        l = "MENU_TXT_GMCRD_USRWNS1";
                        j = "MENU_TXT_GMCRD_USRWNS2"
                    } else {
                        l = "MENU_TXT_GMCRD_USRWNSMLTPLYR"
                    }
                    c = ' data-name_user_id="' + f + '"';
                    b = trimName(Scrabble.PlayerManager.getPlayerInfo(f, "first_name"), Scrabble.PlayerManager.getPlayerInfo(f, "last_name"), 18);
                    break;
                case "LOSS":
                    n = "right";
                    x = "lost";
                    s += "LSS";
                    l = "MENU_TXT_GMCRD_USRLSS1";
                    j = "MENU_TXT_GMCRD_USRLSS2";
                    d = ' data-name_user_id="' + f + '"';
                    b = trimName(Scrabble.PlayerManager.getPlayerInfo(f, "first_name"), Scrabble.PlayerManager.getPlayerInfo(f, "last_name"), 18);
                    break;
                case "DRAW":
                    l = "MENU_TXT_GMCRD_DRW";
                    b = trimName(Scrabble.PlayerManager.getPlayerInfo(f, "first_name"), Scrabble.PlayerManager.getPlayerInfo(f, "last_name"), 18);
                    x = "draw";
                    s += "DRW";
                    if (h.mmatchusers.matchuser[1] != undefined) {
                        f = h.mmatchusers.matchuser[1].userid
                    }
                    session_cache.archiveEmotes[h.matchuri] = {};
                    session_cache.archiveEmotes[h.matchuri].faceSet = "";
                    session_cache.archiveEmotes[h.matchuri].phraseSet = "";
                    break
            }
            var u = ['<div class="', z, ' archivedMatch" data-match_id="', h.matchuri.substring(9), '">', '<div class="matchElementView">'];
            var g = Scrabble.PlayerManager.getPlayerInfo(f, "picUrl");
            if (g == false) {
                g = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png";
                Scrabble.PlayerManager.getAnonymousPlayersInfo(f)
            }
            u = u.concat(['<span class="matchPlayerName matchPlayerName_', n, ' typo_black" ', d, ">", Scrabble.Dictionary.translate(l, {"[OPPONENT_NAME]": b}), "</span>", '<span class="typo_black completedMatchText2_', n, '" ', c, ">", Scrabble.Dictionary.translate(j, {"[OPPONENT_NAME]": b}), "</span>", '<div class="matchPlayer ', n, "Side ", t, '">', '<span class="playerPic_', t, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" >', '<img src="', g, '" class="tiny_avatar" alt="', b, '" data-user_id="', f, '">', "</span>", '<span class="matchPlayerFrame"></span>', "</div>"]);
            var e = getTimeAgo(h.lastupdateddate);
            if (D) {
                e = getTimeAgo("now")
            }
            u = u.concat(['<span class="lastWord"><span class="whoPlayed typo_black">', Scrabble.Dictionary.translate("MENU_TXT_GMCRD_GMENDPRFX"), '</span><span class="timeAgo typo_lighterBlue"> ', e, "</span></span></div>", "</div>"]);
            return u.join("")
        },buildHelpMenu: function() {
            var a = ["CRDTS_TXT_TTL", (((Scrabble.config._branding == "mattel") ? "MATTEL_" : "") + "ABT_LEGAL"), "FCBK_HLP_TXT_CREDITS"];
            for (var b = 0; b < a.length; b++) {
                if (a[b] == "ABT_LEGAL" || a[b] == "MATTEL_ABT_LEGAL") {
                    a[b] = Scrabble.Dictionary.translate(a[b], {"[VERSION NUMBER]": Scrabble.config._version})
                }
                a[b] = Scrabble.Dictionary.translate(a[b])
            }
            a[0] = "<h2>" + a[0] + "</h2>";
            return ['<div id="helpPopupHeader">', '<span class="popupTitle typo_black">', Scrabble.Dictionary.translate("HLP_LBL_HLP"), "</span>", '<div class="smallBackBtn">', '<p class="typo_white">', Scrabble.Dictionary.translate("ABT_BTN_BK"), "</p>", "</div>", "</div>", '<span class="smallListBG"></span>', '<div id="helpList">', '<div id="topicList">', '<div class="helpMenuSctBtn" id="firstHelpBtn" data-content="HLP_TXT_GMPLY_PLYNG_TTL,HLP_TXT_GMPLY_PLYNG_MSG,HLP_TXT_GMPLY_PLYNG_MSG2,HLP_TXT_GMPLY_PLYNG_MSG3,HLP_TXT_GMPLY_SCRNG_TILES1,HLP_TXT_GMPLY_SCRNG_TLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_FRTILES,HLP_TXT_GMPLY_SCRNG_FRNCHTLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_GERTILES,HLP_TXT_GMPLY_SCRNG_GERMNTLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_ITTILES,HLP_TXT_GMPLY_SCRNG_ITTLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_SPNTILES,HLP_TXT_GMPLY_SCRNG_SPNTLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_PORTILES,HLP_TXT_GMPLY_SCRNG_PORTLSDSTRBTN,HLP_TXT_GMPLY_SCRNG_TILES2,HLP_TXT_GMPLY_SCRNG_BONUS,HLP_TXT_GMPLY_SCRNG_BINGO,HLP_TXT_ATMTCNDGS_MSG,HLP_TXT_GMPLY_SCRNG_END">', '<p class="helpBtnText typo_white">', Scrabble.Dictionary.translate("HLP_BTN_SCRRBLRLS"), "</p>", "</div>", '<div class="helpMenuSctBtn" data-content="HLP_TXT_GMPLY_WRDLST_TTL,FBHLP_TXT_GMPLY_WRDLST_MSG">', '<p class="helpBtnText typo_white">', Scrabble.Dictionary.translate("HLP_BTN_DCTNRY"), "</p>", "</div>", '<div class="helpMenuSctBtn" data-content="HLP_TXT_GMPLY_GSCN_TTL,HLP_TXT_FCBK_GMPLY_GSCN_MSG">', '<p class="helpBtnText typo_white">', Scrabble.Dictionary.translate("HLP_BTN_GSCN"), "</p>", "</div>", "</div>", '<div id="topicContent" class="typo_black"></div>', '<div id="credits" class="typo_black">', a.join("<br /><br />"), '<span class="verticalSpacer"></span>', "</div>", '<div id="avalon" class="typo_lightBlue">', "</div>", "</div>", '<div id="helpPopupFooter"></div>', '<div class="cancelButton" id="helpCloseButton">', Scrabble.Dictionary.translate("OPTNS_BTN_CLS"), "</div>"].join("")
        },buildInterstitial: function(b) {
            var a;
            if (b) {
                a = '<div id="interstitialsVideoPlayer"></div>'
            } else {
                a = Scrabble.DomBuilder.buildStaticInterstitial()
            }
            return ['<div id="interstitialContainer">', '<div id="interstitialTop"></div>', '<div id="interstitialMiddle">', '<div id="interstitialAd">', a, "</div>", '<div id="interstitialTimer"><p id="interstitialsTimerTxt"></p><div id="interstitialCloseBtn"></div></div>', '<div id="interstitialOptOut">', '<p id="interstitialHeaderTxt">', Scrabble.Dictionary.translate("FCBK_TXT_INTRSTTL_RMVADS_MSG"), "</p>", '<div id="interstitialsRemoveAds" class="confirmButton popupButton wideBlueBtn" data-action="PopupOKClicked"><p class="typo_white">', Scrabble.Dictionary.translate("FCBK_BTN_INTRSTTL_REMVADS_GTNW"), "</p></span>", "</div>", "</div>", '<div id="interstitialBottom"></div>', "</div>"].join("")
        },buildStaticInterstitial: function() {
            var a = (Scrabble.config._isSecure) ? "on" : "off";
            return ad = '<iframe scrolling="no" id="staticInterstitial" src="' + Scrabble.config._callbackUrl + "/" + Scrabble.vNum + "/client/container/dart/doubleclick_banner.php?branding=" + Scrabble.config._branding + "&width=300&height=250&secure=" + a + '"></iframe>'
        },buildLeaderBoardScrollable: function(f, h) {
            var j = f.length;
            var n = [];
            var m, g, a, k, l;
            for (var e = 0; e < j; e++) {
                if (e != 0) {
                    n.push("<span class='separatorBevel'></span>")
                }
                var c;
                g = f[e];
                a = g.userName;
                desc = g.description;
                if (g.isAppUser) {
                    m = (g.mayhemId == Scrabble.PlayerManager.currentUser.mayhemId) ? "currentUserCard" : "friendUserCard";
                    score = g.value;
                    c = (g.mayhemId == Scrabble.PlayerManager.currentUser.mayhemId) ? "" : '<div class="playBtn"><p class="typo_white">' + Scrabble.Dictionary.translate("FCBK_TXT_LDRBRDS_CMNTLNK") + "</p></div>";
                    var b = "";
                    if (h == true) {
                        b = "centeredScore "
                    }
                    k = ['<div class="lbItem lbUserCard" data-lb_user_id="', g.mayhemId, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" >', '<img src="', g.picUrl, '">', '<div class="', m, '"></div>', '<p class="', g.positionClass, " typo_fancy", (g.mayhemId == Scrabble.PlayerManager.currentUser.mayhemId) ? "Orange" : "Blue", '">', g.position, '<span class="ordinal">', Scrabble.Ordinals.getOrdinalIndicator(g.position), "</span></p>", '<p class="name typo_black">', trimName(a, "", 12), "</p>", '<p class="desc typo_pinkRed">', desc, "</p>", '<p class="score ', b, 'typo_black">', score, "</p>", c, "</div>"]
                } else {
                    friendId = g.facebookId;
                    var d = (Scrabble.config._branding == "hasbro") ? "white" : "black";
                    k = ['<div class="lbItem lbFriendCard" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" >', '<img src="', g.picUrl, '">', '<div class="friendCard"></div>', '<p class="name typo_black">', trimName(a, "", 12), "</p>", '<div class="inviteFriendBtn" data-friend_id="', friendId, '">', '<p class="typo_', d, '">', Scrabble.Dictionary.translate("MYGM_BTN_SGGSTDFRNDSCRD_INVT"), "</p>", "</div>", "</div>"]
                }
                n.push(k.join(""))
            }
            return n.join("")
        },buildOptionsMenu: function() {
            return ['<div id="optionsPopupHeader">', '<span class="popupTitle typo_black">', Scrabble.Dictionary.translate("MENU_LBL_OPTIONS"), "</span>", "</div>", '<span class="smallListBG"></span>', '<div id="optionsList">', '<div id="optionsElementList">', '<div class="optionsSlider" id="musicVolumeOption">', '<span class="optionsMenuTitle">', Scrabble.Dictionary.translate("OPTNS_LBL_MUSIC"), "</span>", '<div class="optionsSliderBackground">', '<div class="optionsSliderLeft"></div>', '<div class="optionsSliderMiddle"></div>', '<div class="optionsSliderRight"></div>', "</div>", '<div class="optionsSliderForeground">', '<div class="optionsSliderLeft"></div>', '<div class="optionsSliderMiddle"></div>', "</div>", '<div class="optionsSliderBtn"></div>', "</div>", '<div class="optionsSlider" id="sfxVolumeOption">', '<span class="optionsMenuTitle">', Scrabble.Dictionary.translate("OPTNS_LBL_SOUND"), "</span>", '<div class="optionsSliderBackground">', '<div class="optionsSliderLeft"></div>', '<div class="optionsSliderMiddle"></div>', '<div class="optionsSliderRight"></div>', "</div>", '<div class="optionsSliderForeground">', '<div class="optionsSliderLeft"></div>', '<div class="optionsSliderMiddle"></div>', "</div>", '<div class="optionsSliderBtn"></div>', "</div>", '<div class="optionCheckbox">', '<p class="optionsMenuTitle">', Scrabble.Dictionary.translate("FB_DISPLAY_BONUS_LETTERS"), "</p>", '<div id="bonusLettersOption" class="checkbox checked"></div>', "</div>", '<div class="optionCheckbox">', '<p class="optionsMenuTitle">', Scrabble.Dictionary.translate("FB_INTROPOPUP_TOGGLE"), "</p>", '<div id="showTipOfTheDayOption" class="checkbox checked"></div>', "</div>", '<div class="optionsMenuBtn" id="optionsAvalonBtn">', '<p class="optionsBtnText typo_white typo_turnpike">', Scrabble.Dictionary.translate("TYT_BTN_OPTNTYTSPCLBTN"), "</p>", "</div>", '<div class="optionsMenuBtn" id="scrabbleStoreOptBtn">', '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" />', '<p class="optionsBtnText typo_white">', Scrabble.Dictionary.translate("TYT_BTN_STROPTNBTN"), "</p>", "</div>", '<div class="optionsMenuBtn" id="scrabbleAboutBtn">', '<p class="optionsBtnText typo_white">', Scrabble.Dictionary.translate("HLP_BTN_ABOUT"), "</p>", "</div>", '<div class="optionsMenuBtn" id="scrabbleHelpBtn">', '<p class="optionsBtnText typo_white">', Scrabble.Dictionary.translate("OPTNS_BTN_SCRABBLEHELP"), "</p>", "</div>", '<div class="optionsMenuBtn" id="lastHelpBtn">', '<p class="optionsBtnText typo_white">', Scrabble.Dictionary.translate("HLP_BTN_CRDTS"), "</p>", "</div>", '<span class="verticalSpacer"></span>', "</div>", "</div>", '<div id="optionsPopupFooter"></div>', '<div class="cancelButton" id="optionsCloseButton">', Scrabble.Dictionary.translate("OPTNS_BTN_CLS"), "</div>"].join("")
        },buildGameOptionsMenu: function() {
            return ['<span class="popupTitle typo_black">', Scrabble.Dictionary.translate("MENU_LBL_NGAME"), "</span>", '<span class="popupCreateXBtn"></span>', '<div class="optionsMenuDropdown" id="wordlistOption">', '<span class="gameOptionsMenuTitle typo_darkGrey">', Scrabble.Dictionary.translate("GSCN_LBL_WRDLST"), '<span class="infoToken" title="', Scrabble.Dictionary.translate("GSCN_LBL_WRDLST"), '" id="wordsListInfoToken"></span>', "</span>", '<div class="optionsDropdownLeft"></div>', '<div class="optionsDropdownMiddle"></div>', '<div class="optionsDropdownRight"></div>', '<div class="optionsDropdown typo_lightBlue">', '<span class="optionsDropdownItem" data-id="0"><div class="optionsDropdownItemFlag flag_TWL"></div>', Scrabble.Dictionary.translate("FACEBOOK_GSCNPP_TXT_WRDLST_TTL_TWL"), "</span>", '<span class="optionsDropdownItem" data-id="1"><div class="optionsDropdownItemFlag flag_MW"></div>', Scrabble.Dictionary.translate("FACEBOOK_GSCNPP_TXT_WRDLST_TTL_MW"), "</span>", '<span class="optionsDropdownItem" data-id="2"><div class="optionsDropdownItemFlag flag_COL"></div><img class="smallCollinsImg" src="', Scrabble.config._cdnVersion, '/images/skins/skin_default/collinsLogoDictionary.png"/>', Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_COLLINS"), "</span>", '<span class="optionsDropdownItem" data-id="3"><div class="optionsDropdownItemFlag flag_FWL"></div><img class="smallCollinsImg" src="', Scrabble.config._cdnVersion, '/images/skins/skin_default/larousseLogoNewGame.png"/>' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_FWL"), "</span>", '<span class="optionsDropdownItem" data-id="4"><div class="optionsDropdownItemFlag flag_IWL"></div>' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_IWL"), "</span>", '<span class="optionsDropdownItem" data-id="5"><div class="optionsDropdownItemFlag flag_GWL"></div>' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_GWL"), "</span>", '<span class="optionsDropdownItem" data-id="6"><div class="optionsDropdownItemFlag flag_SWL"></div>' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_SWL"), "</span>", '<span class="optionsDropdownItem" data-id="7"><div class="optionsDropdownItemFlag flag_PWL"></div>' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL_PWL"), "</span>", "</div>", "</div>", '<div id="newGamePopupFriendGameBtn" class="largeWhiteBtn">', '<div id="newGamePopupFriendIcon"></div>', '<p class="newGameBtnTitle">', Scrabble.Dictionary.translate("NGM_BTN_PLYFRNDS_TTL"), "</p>", '<p class="newGameBtnSubTitle typo_limeBlue">', Scrabble.Dictionary.translate("FCB_NGM_BTN_PLYFRNDS_MSG"), "</p>", "</div>", '<div id="newGamePopupRandomOpponentBtn" class="largeWhiteBtn">', '<div id="newGamePopupRandomIcon"></div>', '<p class="newGameBtnTitle">', Scrabble.Dictionary.translate("NGM_BTN_RNDMOPP_TTL"), "</p>", '<p class="newGameBtnSubTitle typo_limeBlue">', Scrabble.Dictionary.translate("FCB_NGM_BTN_RDM_MSG"), "</p>", "</div>"].join("")
        },buildMainMenu: function() {
            return ['<div id="myTurnGames" class="mainMenuModule">', '<div class="mainMenuModuleHeader">', '<span class="moduleTitle typo_white">', Scrabble.Dictionary.translate("MYGM_LBL_MTURN"), "</span>", "</div>", '<div id="myTurnGamesList"></div>', "</div>", '<div id="theirTurnGames" class="mainMenuModule">', '<div class="mainMenuModuleHeader">', '<span class="moduleTitle typo_white">', Scrabble.Dictionary.translate("MYGM_LBL_TTURN"), "</span>", '<span class="collapseArrow isExpanded" />', "</div>", '<div id="theirTurnGamesList"></div>', '<div id="theirTurnCollapsed" class="typo_darkGrey">', Scrabble.LeftMenu.theirTurnString(), "</div>", "</div>", '<div id="completedGames" class="mainMenuModule">', '<div class="mainMenuModuleHeader">', '<span class="moduleTitle typo_white">', Scrabble.Dictionary.translate("MENU_LBL_CMPLTDGMS"), "</span>", '<span class="collapseArrow isExpanded" />', "</div>", '<div id="completedGamesList"></div>', '<div id="completeCollapsed" class="typo_darkGrey">', Scrabble.LeftMenu.completedGameString(), "</div>", "</div>", '<span class="verticalSpacer"></span>'].join("")
        },buildNewGameMenu: function() {
            return ['<div id="newGamePopupHeader">', '<span class="popupTitle typo_black">', Scrabble.Dictionary.translate("MENU_LBL_NGAME"), "</span>", "</div>", '<div id="newGamePopupSubHeader">', '<div class="radioBtn selected" id="twoPlayerRadioBtn"><p class="typo_black">', Scrabble.Dictionary.translate("FRNDLST_LBL_2PLYR"), "</p></div>", '<div class="radioBtn notSelected" id="multiPlayerRadioBtn"><p class="typo_black">', Scrabble.Dictionary.translate("FRNDLST_LBL_MLTPLYR"), "</p></div>", '<div class="squareTxtField">', '<div class="squareTxtFieldLeft"></div>', '<div class="squareTxtFieldMiddle"></div>', '<div class="squareTxtFieldRight"></div>', '<input type="text" id="newGameSearchField" class="typo_lightBlue" title="', Scrabble.Dictionary.translate("FCBK_TXT_SRCHFLD"), '">', "</div>", "</div>", '<span class="smallListBG"></span>', '<div id="newGameListContainer">', '<div id="newGameList">', '<div id="newGameListSinglePlayer"></div>', '<div id="newGameListMultiPlayer">', '<div id="newGameListMultiPlayerSelected"></div>', '<div id="newGameListMultiPlayerSeparator">', '<div class="listSeparatorTopLeft"></div>', '<div class="listSeparatorTop"></div>', '<div class="listSeparatorTopRight"></div>', '<div class="listSeparatorMiddle">', '<div class="wideGreenBtn"><p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"), "</p></div>", "</div>", '<div class="listSeparatorBottomLeft"></div>', '<div class="listSeparatorBottom"></div>', '<div class="listSeparatorBottomRight"></div>', "</div>", '<div id="newGameListMultiPlayerList"></div>', "</div>", "</div>", "</div>", '<div id="newGamePopupFooter"></div>', '<div class="smallRedBtn" id="newGameCloseButton">', '<p class="typo_white" id="newGameMenuClose">', Scrabble.Dictionary.translate("GSCNPP_BTN_ASYNC_CLS"), "</p>", "</div>"].join("")
        },buildStoreFrame: function() {
            return ['<div id="storePopupHeader">', '<span class="storePopupTitle typo_white">', Scrabble.Dictionary.translate("STR_BTN_STRMNMNU"), "</span>", '<span class="xButton" id="storeCloseButton"></span>', '<div class="backBlueBtn" id="storeBackButton">', '<p class="typo_white">', Scrabble.Dictionary.translate("STR_BTN_BACK"), "</p>", "</div>", "</div>", '<div id="storePopupSubHeader">', '<div id="storeBalance"><p class="typo_lightBlue" id="storeBalanceAmmount">0</p><p class="typo_lightBlue">', Scrabble.Dictionary.translate("STR_TXT_YRBLNC"), ':</p><span class="storeCoinIcon"></span></div>', '<div class="smallerBlueBtn" id="storeGetCoinsButton">', '<p class="typo_white">', Scrabble.Dictionary.translate("STR_BTN_ADDCNS"), "</p>", "</div>", "</div>", '<span class="smallListBG"></span>', '<div id="storeListContainer">', '<div id="storeList">', "</div>", "</div>", '<div id="storeLoadingIcon"><img src="', Scrabble.config._cdnVersion, '/images/loadingWheel00.gif" alt="', Scrabble.Dictionary.translate("DFLT_TXT_LDNG"), '" /></div>', '<div id="storePopupFooter">', "</div>"].join("")
        },buildStorePreview: function(c) {
            var b = ['<div class="storeItemPreviewContainer" data-storeItemId="', c.id, '">'];
            b = b.concat(['<span class="storeItemPreviewName typo_lightBlue">', Scrabble.Dictionary.translate(c.meta.shared.titleId), "</span>", '<span class="storeItemPreviewDescription typo_limeBlue">', Scrabble.Dictionary.translate(c.meta.shared.descriptionId), "</span>"]);
            if (c.meta.facebook && c.meta.facebook.preview) {
                var a = c.meta.facebook.preview;
                a = a.substring(0, a.indexOf(".")) + "_" + Scrabble.config.lang.toUpperCase() + "_" + Scrabble.config._branding + a.substring(a.indexOf("."));
                b.push('<span class="storePreviewImageContainer"><img src="' + Scrabble.config._cdnVersion + a + '" class="storeItemPreview" /></span>')
            }
            if (c.purchased == true && c.equiped == false && c.category != "kit") {
                b.push('<div class="mediumGreenBtn storeItemActionBtn"><p class="typo_white">' + Scrabble.Dictionary.translate("STR_BTN_INSTLLITM"))
            } else {
                if (c.purchased == true && c.equiped == true && c.category != "kit") {
                    b.push('<div class="storeInstalledItem"><p class="typo_white">' + Scrabble.Dictionary.translate("STR_BTN_ACTVITM"))
                } else {
                    if (c.purchased == false && c.price == -1 && c.category != "kit") {
                        b.push('<div class="storeLockedItem"><p class="typo_white">' + Scrabble.Dictionary.translate("TYT_BTN_STR_BTNLCKD"))
                    } else {
                        if (c.category == "kit") {
                            b.push('<div class="storeChkBoxItem ' + ((Scrabble.QuestPopup.isToyotaQuestActive) ? "checked" : "unchecked") + '"><p class="storeChkBoxItemLabel">' + Scrabble.Dictionary.translate(((Scrabble.QuestPopup.isToyotaQuestActive) ? "FCBK_HLP_BTN_TRNNTFCTNS_ON" : "FCBK_HLP_BTN_TRNNTFCTNS_OFF")))
                        } else {
                            b.push('<div class="mediumBlueBtn storeItemActionBtn"><p class="typo_white">' + Scrabble.DomBuilder.parsePrice(c.price, c.currency))
                        }
                    }
                }
            }
            b = b.concat(["</p>", "</div>", "</div>"]);
            return b.join("")
        },buildStoreItem: function(e) {
            var b = false;
            if (e.category == "kit") {
                b = true
            }
            if (Scrabble.config._branding == "mattel" && e.meta.mattel) {
                for (var g in e.meta.mattel) {
                    e.meta.shared[g] = e.meta.mattel[g]
                }
            }
            var d = ['<div class="storeItemContainer ', ((b) ? "kitContainer" : ""), '" data-storeItemId="', e.id, '">'];
            if (e.meta.facebook && e.meta.facebook.icon) {
                var f = e.meta.facebook.icon.substring(0, e.meta.facebook.icon.indexOf(".")) + "_" + Scrabble.config._branding + e.meta.facebook.icon.substring(e.meta.facebook.icon.indexOf("."));
                d.push('<img src="' + Scrabble.config._cdnVersion + f + '" class="storeItemIcon" />')
            }
            if (e.category == "adRemoval" && Scrabble.Store.adsRemovedLeft != null) {
                var a = Scrabble.Store.adsRemovedLeft;
                d.push('<span class="storeAdExpirationDate typo_lightRed">' + Scrabble.Dictionary.translate("TYT_TXT_PPUP5DSLFTTTLE", {"[X]": a}) + "</span>")
            } else {
                if (e.category != "adRemoval" && e.expiration != null) {
                    var a = getDayDifference(Date.fromISO(Scrabble.Store.storeItems[y].expiration));
                    d.push('<span class="storeAdExpirationDate typo_lightRed">' + Scrabble.Dictionary.translate("TYT_TXT_PPUP5DSLFTTTLE", {"[X]": a}) + "</span>")
                }
            }
            d = d.concat(['<span class="storeItemName ', ((b) ? "typo_white" : "typo_lightBlue"), '">', Scrabble.Dictionary.translate(e.meta.shared.titleId), "</span>", '<span class="storeItemDescription ', ((b) ? "typo_white" : "typo_limeBlue"), '">', Scrabble.Dictionary.translate(e.meta.shared.summaryId, {"[#_COINS]": e.meta.defaultValue}), "</span>"]);
            var c = new Date();
            if (e.category == "moneyPack" && c >= (new Date(2013, 3, 13, 0)) && c < (new Date(2013, 3, 14, 23))) {
                d.push('<span class="storePromoBanner">' + Scrabble.Dictionary.translate("+50%") + "</span>")
            }
            if (e.meta.facebook && e.meta.facebook.preview) {
                d.push('<span class="storePreviewBtn"></span>')
            }
            if (e.purchased == true && e.equiped == false && e.category != "kit") {
                d.push('<div class="mediumGreenBtn storeItemActionBtn"><p class="typo_white">' + Scrabble.Dictionary.translate("STR_BTN_INSTLLITM"))
            } else {
                if (e.purchased == true && e.equiped == true && e.category != "kit") {
                    d.push('<div class="storeInstalledItem"><p class="typo_inactive">' + Scrabble.Dictionary.translate("STR_BTN_ACTVITM"))
                } else {
                    if (e.purchased == false && e.price == -1 && e.category != "kit") {
                        d.push('<div class="storeLockedItem"><p class="typo_white">' + Scrabble.Dictionary.translate("TYT_BTN_STR_BTNLCKD"))
                    } else {
                        if (e.category == "kit") {
                            d.push('<div class="storeItemBackground storeGreyItemBackground"></div><div class="storeChkBoxItem ' + ((Scrabble.QuestPopup.isToyotaQuestActive) ? "checked" : "unchecked") + '"><p class="storeChkBoxItemLabel">' + Scrabble.Dictionary.translate(((Scrabble.QuestPopup.isToyotaQuestActive) ? "FCBK_HLP_BTN_TRNNTFCTNS_ON" : "FCBK_HLP_BTN_TRNNTFCTNS_OFF")))
                        } else {
                            d.push('<div class="mediumBlueBtn storeItemActionBtn"><p class="typo_white">' + Scrabble.DomBuilder.parsePrice(e.price, e.currency))
                        }
                    }
                }
            }
            d = d.concat(["</p>", "</div>", "</div>"]);
            return d.join("")
        },buildNewGamePlayerProfile: function(c, a) {
            var b = Scrabble.Dictionary.translate("FRNDLSTPRFL_TXT_WIN", {"[#_WINS]": a[Scrabble.StatType.TOTAL_WINS.id]}) + '<span class="stringSeparator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>';
            b += Scrabble.Dictionary.translate("FRNDLSTPRFL_TXT_LOSS", {"[#_LOSSES]": a[Scrabble.StatType.TOTAL_LOSSES.id]}) + '<span class="stringSeparator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>';
            b += a[Scrabble.StatType.TOTAL_DRAWS.id] + " " + Scrabble.Dictionary.translate("STTS_TXT_DRWS");
            return ['<div id="newGamePlayerProfileHeader"><p class="typo_white">', Scrabble.Dictionary.translate("MENU_LBL_NGAME"), "</p></div>", '<div id="newGamePlayerProfileSubHeader">', '<div class="smallBackBtn"><p class="typo_white">', Scrabble.Dictionary.translate("ABT_BTN_BK"), "</p></div>", '<p class="typo_black">', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), "</p>", "</div>", '<div id="newGamePlayerProfileInfo">', '<img src="', c.picUrl, '">', '<div id="newGamePlayerProfileImgFrame"></div>', '<p class="name typo_black">', c.first_name + " " + c.last_name, "</p>", '<p class="playingSince typo_darkRed">', Scrabble.Dictionary.translate("STTS_TXT_PLYTMAGO", {"[PLAYED_SINCE_AGO]": parseSignupDate(c.signupTime)}), "</p>", "</div>", '<div id="newGamePlayerProfileStatsContent">', '<div class="newGamePlayerProfileStatsElement"><p class="statsTitle typo_black">', Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_RCRD"), '</p><p class="statsSubTitle typo_darkRed">', b, '</p><p class="statsValue typo_black">', a[Scrabble.StatType.TOTAL_GAMES.id], "</p></div>", '<div class="newGamePlayerProfileStatsElement"><p class="statsTitle typo_black">', Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BSTWRD_TTL"), '</p><p class="statsSubTitle typo_darkRed">"', a[Scrabble.StatType.HIGH_WORD.id].word, '"</p><p class="statsValue typo_black">', a[Scrabble.StatType.HIGH_WORD.id].score + '<span class="smallerPoints">' + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN3").toLowerCase(), "</span></p></div>", '<div class="newGamePlayerProfileStatsElement"><p class="statsTitle typo_black">', Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BSTGM_TTL"), '</p><p class="statsValue typo_black">', a[Scrabble.StatType.HIGH_GAME.id] + '<span class="smallerPoints">' + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN3").toLowerCase(), "</span></p></div>", '<div class="newGamePlayerProfileStatsElement"><p class="statsTitle typo_black">', Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BNGS_TTL"), '</p><p class="statsValue typo_black">', a[Scrabble.StatType.TOTAL_BINGOS.id], "</p></div>", '<div class="newGamePlayerProfileStatsElement"><p class="statsTitle typo_black">', Scrabble.Dictionary.translate("FCBK_LBL_LDRBRDS_RTNG"), '</p><p class="statsValue typo_black">', a[Scrabble.StatType.RATING.id], "</p></div>", "</div>", '<div id="newGamePlayerProfileBtn" class="wideGreenBtn" data-friendId="', c.mayhemId, '"><p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"), "</p></div>"].join("")
        },parsePrice: function(b, a) {
            var c = "";
            var d = (a == "realMoney") ? true : false;
            b = convertToReadableNumber(b, d, d);
            if (b == 0) {
                c = Scrabble.Dictionary.translate("STR_BTN_FREEITM")
            } else {
                if (a == "realMoney") {
                    c = '<span class="storeCashPrice">' + b + '</span><span class="storeCurrency">' + Scrabble.Dictionary.translate("USD") + "</span>"
                } else {
                    if (a == "scrabbleCash" && b != 0) {
                        c = '<span class="storeCashPrice">' + b + '</span><span class="storeCoinIcon"></span>'
                    } else {
                        c = b
                    }
                }
            }
            return c
        },buildSinglePlayers: function(g) {
            var b = "";
            var c = new Date();
            c = c.getTime();
            for (var e = 0; e < g.length; e++) {
                var d = g[e];
                var a = d.first_name + " " + d.last_name;
                if (a.length > 26) {
                    a = a.slice(0, 26);
                    a = a + "..."
                }
                if (d.mayhemId != "0") {
                    var f = c - d.signupTime;
                    var h = "";
                    if (f < 1209600000) {
                        h = '<p class="singlePlayerNewPlayer typo_lightBlue">' + Scrabble.Dictionary.translate("FRNDLST_TXT_NWPLYR") + "</p>"
                    }
                    b += ['<div class="singlePlayerFriend" data-friendId="', d.mayhemId, '" data-friendFirstName="', d.first_name, '" data-friendLastName="', d.last_name, '">', '<div class="singlePlayerFriendPic"><img src="', d.picUrl, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" ><div class="newGameFriendPicContainer"></div></div>', h, '<p class="singlePlayerFriendName typo_black">', a, "</p>", '<div class="smallGreenBtn" data-friendId="', d.mayhemId, '">', '<p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"), "</p>", "</div>", '<div class="arrowHorizontal"></div>', "</div>"].join("")
                }
            }
            return b
        },buildMultiPlayers: function(g) {
            var b = "";
            var c = new Date();
            c = c.getTime();
            for (var e = 0; e < g.length; e++) {
                var d = g[e];
                var a = d.first_name + " " + d.last_name;
                if (a.length > 26) {
                    a = a.slice(0, 26);
                    a = a + "..."
                }
                if (d.mayhemId != "0") {
                    var f = c - d.signupTime;
                    var h = "";
                    if (f < 1209600000) {
                        h = '<p class="multiPlayerNewPlayer typo_lightBlue">' + Scrabble.Dictionary.translate("FRNDLST_TXT_NWPLYR") + "</p>"
                    }
                    b += ['<div class="multiPlayerFriend" data-friendId="', d.mayhemId, '" data-friendFirstName="', d.first_name, '" data-friendLastName="', d.last_name, '">', '<div class="multiPlayerFriendPic"><img src="', d.picUrl, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '"><div class="newGameFriendPicContainer"></div></div>', h, '<p class="multiPlayerFriendName typo_black">', a, "</p>", '<div class="smallBlueBtn">', '<p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYRSLCT"), "</p>", "</div>", '<div class="arrowHorizontal"></div>', "</div>"].join("")
                }
            }
            return b
        },buildSingleFriends: function(d, g, a, c, e) {
            markup = "";
            var b, f, h;
            for (i = a; i <= c; i++) {
                b = g[i];
                f = b.userName.split(" ")[0];
                h = b.userName.split(" ")[1];
                var j = b.userName;
                if (j.length > 26) {
                    j = j.slice(0, 26);
                    j = j + "..."
                }
                markup += ['<div class="' + d + '" data-friendFirstName="', f, '" data-friendLastName="', h, '">', '<div class="singlePlayerFriendPic"><img src="', b.picUrl, '"><div class="newGameFriendPicContainer"></div></div>', '<p class="singlePlayerFriendName typo_black">', j, "</p>", '<div class="smallOrangeBtn" data-friendId="', b.facebookId, '">', '<p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_INVT_SLCT"), "</p>", "</div>", '<div class="arrowHorizontal"></div>', "</div>"].join("")
            }
            return markup
        },buildLoadButton: function(b) {
            var a = "";
            if (Scrabble.config.lang == "en") {
                a = "LOAD MORE FRIENDS..."
            } else {
                a = "AFFICHER PLUS D'AMIS..."
            }
            markup = ['<div id="' + b + '" class="friendsLoading">', '<p class="singlePlayerFriendName typo_black">', a, "</p>", '<div class="arrowHorizontal"></div>', "</div>"].join("");
            return markup
        },buildNudgeable: function(e, d, a) {
            var g = Scrabble.PlayerManager.getPlayerInfo(d, "fbId");
            var f = Scrabble.PlayerManager.playerList[g];
            var b = "";
            if (f != undefined) {
                b = f.first_name + " " + f.last_name;
                if (b.length > 26) {
                    b = b.slice(0, 26);
                    b = b + "..."
                }
            } else {
                f = {picUrl: Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"};
                b = Scrabble.Dictionary.translate("DFLT_TXT_LDNG")
            }
            var c = ['<div class="', a, 'Item" data-matchId="', e.matchuri, '">', '<div class="nudgePlayerPic"><img class="nudgePlayerPicImage" data-userid="', d, '" src="', f.picUrl, '" title="', b, '" /><div class="nudgePicContainer"></div></div>', '<p class="nudgePlayerName typo_lightGrey" data-userid="', d, '">', b, "</p>", '<p class="nudgePlayerLastPlay typo_lightGrey">', getTimeAgo(e.lastupdateddate, true), "</p>", '<div class="medCheckedBtn" data-matchId="', e.matchuri, '">', '<p class="typo_white">', Scrabble.Dictionary.translate((a == "nudge") ? "FCBK_LBL_NDGPP_NDG" : "GSCN_LBL_FFORFEIT"), "</p>", "</div>", "</div>"].join("");
            return c
        },buildGlow: function(a) {
            return '<span class="tileGlow ' + a + 'Glow"></span>'
        },buildSuggestionFriend: function(e, b) {
            var d = Scrabble.PlayerManager.getPlayerInfo(e, "fbId");
            d = Scrabble.PlayerManager.playerList[d];
            if (d == null) {
                e = "random"
            }
            if (e == "random") {
                return ['<div class="randomSuggestion">', '<div class="singlePlayerFriendPic"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/randomOpponent_", Scrabble.config._branding, ".png", '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" ><div class="newGameFriendPicContainer"></div></div>', '<p class="singlePlayerFriendDesc typo_black">', Scrabble.Dictionary.translate("MENU_LBL_SGGSTDGMS_PLYNGNW"), "</p>", '<p class="singlePlayerFriendName typo_black">', Scrabble.Dictionary.translate("MENU_LBL_SGGSTDGMS_RNDMOPP"), "</p>", '<div class="smallGreenBtn" data-friendId="random">', '<p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"), "</p>", "</div>", "</div>"].join("")
            } else {
                var a = d.first_name + " " + d.last_name;
                var c = ["FRNDLST_TXT_NWPLYR", "MENU_LBL_SGGSTDGMS_PLYDRCNTLY"];
                return ['<div class="suggestionFriend">', '<div class="singlePlayerFriendPic"><img src="', d.picUrl, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" ><div class="newGameFriendPicContainer"></div></div>', '<p class="singlePlayerFriendDesc typo_black">', Scrabble.Dictionary.translate(c[b]), "</p>", '<p class="singlePlayerFriendName typo_black">', a, "</p>", '<div class="smallGreenBtn" data-friendId="', d.mayhemId, '">', '<p class="typo_white">', Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"), "</p>", "</div>", "</div>"].join("")
            }
        },chatEntryConstruct: function(f, c, e, h) {
            var d = "Left";
            var b = Scrabble.PlayerManager.getPlayerInfo(f, "first_name");
            if (b == false || b == "false") {
                b = "Anon."
            }
            var a = Scrabble.PlayerManager.getPlayerInfo(f, "picUrl");
            if (a == false) {
                a = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"
            }
            var g = getTextualTimeFromTimeAgo(e);
            if (f == Scrabble.PlayerManager.currentUser.mayhemId) {
                d = "Right";
                b = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_USRNM")
            }
            return ['<div class="chatEntry', d, ' chatEntry" data-entry_id="', h, '">', '<span class="chatEntryAvatar">', '<div class="chatEntryAvatarOverlay"></div>', '<img src="', a, '" alt="', b, '" data-pic_user_id="', f, '"/>', "</span>", '<span class="chatEntryName typo_black" data-name_user_id="', f, '">', trimName(b, "", 5), "</span>", '<span class="chatBubble', d, (e == "now") ? " sending" : "", '">', '<span class="chatBubbleTop">', "</span>", '<span class="chatBubbleMid">', '<p class="chatEntryText typo_black">', Scrabble.Emoticons.trimSymbols(c), "</p>", "</span>", '<span class="chatBubbleBot">', '<span class="chatEntryTime">', g, "</span>", "</span>", "</span>", "</div>"].join("")
        },chatLoadMore: function() {
            return ['<div id="chatLoadMore"><div class="chatLoadLabel">', Scrabble.Dictionary.translate("FCBK_BTN_SHWMRCHT"), "</div></div>"].join("")
        },emoticonListConstruct: function() {
            var a = ['<div id="emoticonPageList">'];
            var c = null;
            var b = 0;
            for (b = 0; b < 5; ++b) {
                a[a.length] = '<span class="emoticonPageBullet" id="bullet' + (b + 1) + '"></span>'
            }
            a[a.length] = "</div>";
            a[a.length] = '<div id="emoticonPageArrowLeft"></div><div id="emoticonPageArrowRight"></div>';
            for (b = 0; b < Scrabble.Emoticons.list.length; ++b) {
                if (b == 0) {
                    a[a.length] = '<div class="emoticonPage" id="ePage1">'
                } else {
                    if (b == 20) {
                        a[a.length] = '</div><div class="emoticonPage" id="ePage2">'
                    } else {
                        if (b == 40) {
                            a[a.length] = '</div><div class="emoticonPage" id="ePage3">'
                        } else {
                            if (b == 60) {
                                a[a.length] = '</div><div class="emoticonPage" id="ePage4">'
                            } else {
                                if (b == 80) {
                                    a[a.length] = '</div><div class="emoticonPage" id="ePage5">'
                                }
                            }
                        }
                    }
                }
                c = Scrabble.Emoticons.list[b];
                var d = c.url.replace(/^0+/, "");
                var e = -(parseInt(d) * 32);
                a[a.length] = Scrabble.DomBuilder.getEmoticon(c, false)
            }
            a[a.length] = "</div>";
            return a.join("")
        },getEmoticon: function(a, c) {
            var b = a.url.replace(/^0+/, "");
            var d = -(parseInt(b) * 32);
            if (c) {
                return '<span style="background-position: ' + d + 'px 0px" onmousedown="return false" class="emoticon"></span>'
            } else {
                return '<span style="background-position: ' + d + 'px 0px" onmousedown="return false" class="emoticonListItem" id="' + a.charCode + '" title="' + a.charCode + '"></span>'
            }
        },gameCardConstruct: function(a, c, b, g, e, d, h) {
            var f = ['<div class="gameCard ', a, '" id="gameCard_', c, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '" >', (h) ? '<span class="hasForfeited"></span>' : "", '<img class="cardAvatar" src="', e, '" height="40" width="40"/>', '<span class="', (d) ? "myTurn" : "gameCardSkin", '"></span>', '<p class="gameCardScore">', g, "</p>", '<p class="gameCardName">', trimName(b, "", 9), "</p>", "</div>"];
            return f.join("")
        },gameCardTilesLeftConstruct: function(b, e, a) {
            var d = 0;
            var c = b;
            if (b == 1) {
                c = Scrabble.Dictionary.translate("GSCN_TXT_TLSLFT1", {"[#_TILES]": b})
            } else {
                c = Scrabble.Dictionary.translate("GSCN_TXT_TLSLFT", {"[#_TILES]": b})
            }
            if (a == "duo") {
                d = 156
            } else {
                if (a == "trio") {
                    d = 131
                } else {
                    d = 104
                }
            }
            return '<div class="tleft' + a + ' tilesLeft" style="left:' + ((e * d) - 6) + 'px"><span class="tleftBubble typo_white">' + c + "</span></div>"
        },leftMenuCover: function(a) {
            return '<span class="cover"></span>'
        },lookupResultConstruct: function(c, b) {
            var a;
            if (b) {
                a = '<span class="typo_green">' + c + "</span> ";
                return a + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_VLDMSG", {"[LANGUAGE]": getLocalizedDictionary(null, true)})
            } else {
                a = '<span class="typo_lightRed">' + c + "</span> ";
                return a + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_INVLDMSG", {"[LANGUAGE]": getLocalizedDictionary(null, true)})
            }
        },matchConstruct: function(l, j, q, b, a, s, n, g) {
            if (j == Scrabble.PlayerManager.currentUser.mayhemId) {
                j = q[0]
            }
            if (typeof j !== "undefined" && j != -1) {
                var d = Scrabble.PlayerManager.getPlayerInfo(j, "picUrl");
                if (d == false) {
                    d = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png";
                    Scrabble.PlayerManager.getAnonymousPlayersInfo(j)
                }
                var k = trimName(Scrabble.PlayerManager.getPlayerInfo(j, "first_name"), Scrabble.PlayerManager.getPlayerInfo(j, "last_name"), 18);
                if (k == "false ") {
                    k = Scrabble.Dictionary.translate("DFLT_TXT_LDNG")
                }
            } else {
                d = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png";
                k = Scrabble.Dictionary.translate("GSCN_TXT_PLYRCRD_PLYRNM_SRCHNG")
            }
            if (l.matchuri == Scrabble.GameServerManager.currentMatch) {
                if (n == "listElement") {
                    n = n + " currentGame"
                } else {
                    n = n + " lastCurrentGame"
                }
            }
            var c = "single";
            if (q.length == 3) {
                c = "multi"
            } else {
                if (q.length == 2) {
                    c = "multi2"
                }
            }
            var f = ['<div class="', n, ' match" data-match_id="', l.matchuri.substring(9), '">', '<div class="matchElementView">', '<span class="matchPlayerName matchPlayerName_', g, ' typo_black" data-name_user_id="', j, '">', k, "</span>", '<div class="matchPlayer ', g, "Side ", c, '">', '<span class="playerPic_', c, '" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '">', '<img src="', d, '" class="tiny_avatar" alt="', k, '" data-user_id="', j, '">', "</span>", '<span class="matchPlayerFrame"></span>', "</div>"];
            var o = q.length;
            var e;
            if (s instanceof String) {
                f[f.length] = s
            } else {
                if (s != undefined) {
                    if (s.wordArr != undefined && s.wordArr.length > 0) {
                        var m = (19 * s.wordArr.length);
                        if (m > 152) {
                            m = 152
                        }
                        f[f.length] = '<div class="lastPlayTiles" style="width:' + m + 'px">';
                        for (var h = 0; h < s.wordArr.length; h++) {
                            if (s.wordArr.length > 7) {
                                if (h == 7) {
                                    f[f.length] = '<p class="typo_small_tile">...</p>';
                                    break
                                }
                            }
                            f[f.length] = '<p class="typo_small_tile">' + Scrabble.Dictionary.translate(s.wordArr[h], {"}": "CH","[": "RR","]": "LL"}) + "</p>"
                        }
                        f[f.length] = "</div>"
                    } else {
                        f[f.length] = '<div class="cardTeacher typo_black"><span class="' + g + 'CardTeacherText">' + s.teacherMessage + "</span></div>"
                    }
                } else {
                    console.warn("Invalid Move")
                }
            }
            var r = a.split("^")[1];
            if (String(r) == "undefined") {
                r = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_TMAGOJSTNW")
            }
            f = f.concat(['<div class="lastWord">']);
            if ((g == "right") || (a.indexOf("pts,") != -1)) {
                f = f.concat(['<span class="whoPlayed typo_black">', a.split("^")[0], "</span>"])
            }
            f = f.concat(['<span class="timeAgo">&nbsp;', r, "</span></div></div></div>"]);
            return f.join("")
        },movesListConstruct: function(g) {
            var f = g.length;
            var e = [];
            for (var d = 0; d < f; d++) {
                var b = g[d];
                e.push('<tr class="odd"><td><p class="roundNumber">' + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_MVS_RND", {"[#_ROUND]": (d + 1)}) + '</p></td><td></td><td></td><td></td></tr><tr class="even"><td>');
                var h = b.length;
                for (var c = 0; c < h; c++) {
                    var a = b[c].name;
                    e.push('<p data-name_user_id="' + b[c].id + '">' + a + "</p>")
                }
                e.push("</td><td>");
                for (c = 0; c < h; c++) {
                    e.push("<p>" + b[c].word + "</p>")
                }
                e.push("</td><td>");
                for (c = 0; c < h; c++) {
                    e.push("<p>" + b[c].score + "</p>")
                }
                e.push("</td><td>");
                for (c = 0; c < h; c++) {
                    e.push("<p>" + b[c].total + "</p>")
                }
                e.push("</td></tr>")
            }
            return e.join("")
        },playerCardsConstruct: function() {
            var a = [];
            for (var b = 0; b < 4; b++) {
                a = a.concat(['<div class="playerCard" id="player_', b, '_card" title="', Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"), '">', '<img src="" class="playerCardAvatar" />', '<span class="playerCardName"></span>', '<span class="playerCardScore"></span>', '<span class="playerCardExtra"></span>', "</div>"])
            }
            return a
        },tileRackConstruct: function(c) {
            var b = [];
            var d;
            for (var a = 0; a < 7; a++) {
                d = ['<div class="tileRackSpace tileRackSpace" id="', c, a, '"></div>'];
                b.push(d.join(""))
            }
            return b.join("")
        },boardSkinSelectorConstruct: function() {
            return ['<div id="boardSkinSelectionMenu">', '<span class="arrowLeft"></span>', '<span id="boardSkinSelectedDisplay"></span>', '<span class="arrowRight"></span>', '<span class="confirmButton">', Scrabble.Dictionary.translate("FCBK_BTN_CHSBRDUI_UI"), "</span>", '<span class="xButton"></span>', "</div>"].join("")
        },tlwlConstruct: function(f, g) {
            var c = ['<div id="tlwlTileCollection">'], e = "", b = false, a = "";
            for (var d = 0; d < g.length; d++) {
                e = Scrabble.Dictionary.translate(g[d], {"}": "CH","[": "RR","]": "LL"});
                if (d % 6 == 0 || d == 0) {
                    b = true
                }
                if (g.length - d < 6) {
                    a = 'style="width:' + ((g.length - d) * 30) + 'px"'
                }
                c[c.length] = ((b && d != 0) ? "</div>" : "") + ((b) ? ('<div class="tlwl_tileRow" ' + a + ">") : "") + '<span class="tlwl_tile" id="tlwl_' + e + '">' + Scrabble.TileFactory.createTile(200, false, g[d]) + "</span>";
                b = false
            }
            c[c.length] = '</div></div><div id="tlwlWordCollection">';
            c[c.length] = '</div><div id="tlwlShowAllBtn" class="mediumBlueBtn typo_white"><p>' + Scrabble.Dictionary.translate("GSCNPP_BTN_WRDLST_2LTTRWRDS_SHWALL") + "</p></div>";
            return c.join("")
        }}
}();
Scrabble.Emoticons = function() {
    return {list: [{charCode: ":D",url: "000",safeCode: ":D"}, {charCode: ":)",url: "001",safeCode: ":)"}, {charCode: "XD",url: "002",safeCode: "XD"}, {charCode: "(>.<)",url: "003",safeCode: "(&gt;.&lt;)"}, {charCode: ";-)",url: "004",safeCode: ";-)"}, {charCode: ":-*",url: "005",safeCode: ":-*"}, {charCode: ":-X",url: "006",safeCode: ":-X"}, {charCode: "(:-E)",url: "007",safeCode: "(:-E)"}, {charCode: ":P",url: "008",safeCode: ":P"}, {charCode: "(/:()",url: "009",safeCode: "(/:()"}, {charCode: "^o)",url: "010",safeCode: "^o)"}, {charCode: "(X()",url: "011",safeCode: "(X()"}, {charCode: "*-)",url: "012",safeCode: "*-)"}, {charCode: ":-(",url: "013",safeCode: ":-("}, {charCode: ":'(",url: "014",safeCode: ":'("}, {charCode: "(:.-)",url: "015",safeCode: "(:.-)"}, {charCode: "(^^)",url: "016",safeCode: "(^^)"}, {charCode: "(>;->)",url: "017",safeCode: "(&gt;;-&gt;)"}, {charCode: "(]:-[)",url: "018",safeCode: "(]:-[)"}, {charCode: "(:-)",url: "019",safeCode: "(:-)"}, {charCode: "(:&quot;)",url: "020",safeCode: "(:&quot;)"}, {charCode: ":@",url: "021",safeCode: ":@"}, {charCode: "(*_*)",url: "022",safeCode: "(*_*)"}, {charCode: "(<:-0)",url: "023",safeCode: "(&lt;:-0)"}, {charCode: "(_)",url: "024",safeCode: "(_)"}, {charCode: "(+0()",url: "025",safeCode: "(+0()"}, {charCode: ":-O",url: "026",safeCode: ":-O"}, {charCode: "(:-{)",url: "027",safeCode: "(:-{)"}, {charCode: "(#1)",url: "028",safeCode: "(#1)"}, {charCode: "(_E=mc2_)",url: "029",safeCode: "(_E=mc2_)"}, {charCode: "(QK)",url: "030",safeCode: "(QK)"}, {charCode: "(*<|:-{)})",url: "031",safeCode: "(*&lt;|:-{)})"}, {charCode: "(VK)",url: "032",safeCode: "(VK)"}, {charCode: "(P-()",url: "033",safeCode: "(P-()"}, {charCode: "(SPY)",url: "034",safeCode: "(SPY)"}, {charCode: "(@_@)",url: "035",safeCode: "(@_@)"}, {charCode: "(]:->)",url: "036",safeCode: "(]:-&gt;)"}, {charCode: "(\\VVV/)",url: "037",safeCode: "(\\VVV/)"}, {charCode: "(F(x_x)F)",url: "038",safeCode: "(F(x_x)F)"}, {charCode: "(A)",url: "039",safeCode: "(A)"}, {charCode: "(B)",url: "040",safeCode: "(B)"}, {charCode: "(C)",url: "041",safeCode: "(C)"}, {charCode: "(D)",url: "042",safeCode: "(D)"}, {charCode: "(E)",url: "043",safeCode: "(E)"}, {charCode: "(F)",url: "044",safeCode: "(F)"}, {charCode: "(G)",url: "045",safeCode: "(G)"}, {charCode: "(H)",url: "046",safeCode: "(H)"}, {charCode: "(I)",url: "047",safeCode: "(I)"}, {charCode: "(J)",url: "048",safeCode: "(J)"}, {charCode: "(K)",url: "049",safeCode: "(K)"}, {charCode: "(L)",url: "050",safeCode: "(L)"}, {charCode: "(M)",url: "051",safeCode: "(M)"}, {charCode: "(N)",url: "052",safeCode: "(N)"}, {charCode: "(O)",url: "053",safeCode: "(O)"}, {charCode: "(P)",url: "054",safeCode: "(P)"}, {charCode: "(Q)",url: "055",safeCode: "(Q)"}, {charCode: "(R)",url: "056",safeCode: "(R)"}, {charCode: "(S)",url: "057",safeCode: "(S)"}, {charCode: "(T)",url: "058",safeCode: "(T)"}, {charCode: "(U)",url: "059",safeCode: "(U)"}, {charCode: "(V)",url: "060",safeCode: "(V)"}, {charCode: "(W)",url: "061",safeCode: "(W)"}, {charCode: "(X)",url: "062",safeCode: "(X)"}, {charCode: "(Y)",url: "063",safeCode: "(Y)"}, {charCode: "(Z)",url: "064",safeCode: "(Z)"}, {charCode: "(wr)",url: "065",safeCode: "(wr)"}, {charCode: "(lr)",url: "066",safeCode: "(lr)"}, {charCode: "(<3)",url: "067",safeCode: "(&lt;3)"}, {charCode: "(</3)",url: "068",safeCode: "(&lt;/3)"}, {charCode: "(Fl)",url: "069",safeCode: "(Fl)"}, {charCode: "(Rb)",url: "070",safeCode: "(Rb)"}, {charCode: "(^:^)",url: "071",safeCode: "(^:^)"}, {charCode: "(<(&quot;)>)",url: "072",safeCode: "(&lt;(&quot;)&gt;)"}, {charCode: "(*<<<<=)",url: "073",safeCode: "(*&lt;&lt;&lt;&lt;=)"}, {charCode: "(Ha)",url: "074",safeCode: "(Ha)"}, {charCode: "(cp)",url: "075",safeCode: "(cp)"}, {charCode: "(bu)",url: "076",safeCode: "(bu)"}, {charCode: "(cl)",url: "077",safeCode: "(cl)"}, {charCode: "(ap)",url: "078",safeCode: "(ap)"}, {charCode: "(au)",url: "079",safeCode: "(au)"}, {charCode: "( )",url: "080",safeCode: "( )"}, {charCode: "(tyt)",url: "081",safeCode: "(tyt)"}, {charCode: "(ava)",url: "082",safeCode: "(ava)"}],trimSymbols: function(b) {
            b = b.split("<").join("&lt;").split(">").join("&gt;").split('"').join("&quot;");
            for (var a = 0; a < Scrabble.Emoticons.list.length; a++) {
                b = b.split(Scrabble.Emoticons.list[a].safeCode).join(Scrabble.DomBuilder.getEmoticon(Scrabble.Emoticons.list[a], true))
            }
            return b
        },detectSymbolTypes: function(e) {
            var c = [];
            var a;
            var d = Scrabble.Emoticons.list.length;
            for (var b = 0; b < d; b++) {
                a = Scrabble.Emoticons.list[b].charCode;
                if (e.indexOf(a) != -1) {
                    if (a == "(tyt)" || a == "(ava)") {
                        if (c.indexOf("toyota") == -1) {
                            c.push("toyota")
                        }
                    } else {
                        if (c.indexOf("standard") == -1) {
                            c.push("standard")
                        }
                    }
                }
            }
            return c
        }}
}();
Scrabble.PopupFactory = function() {
    return {genericPopup: function(a) {
            var c = ['<div id="scrabblePopup" class="genericPopup">', '<div class="popupTop">', '<p class="popupTitle typo_lightBlue">', a.title, "</p>", "</div>", '<div class="popupMid">', '<p class="popupMessage  typo_black">', a.message, "</p>", '<div class="popupDialogZone">'];
            for (var b in a.diag) {
                c = c.concat(['<div class="popupButton typo_white ', b, 'Button" id="u', b, 'Button" data-action="', a.diag[b]["action"], '">', Scrabble.Dictionary.translate(a.diag[b]["label"]), "</div>"])
            }
            c = c.concat(["</div></div>", '<span class="popupBot"></span>', "</div>"]);
            return c.join("")
        },wildTilePopup: function(b) {
            var d = ['<span class="smallOverlayTitle typo_lightBlue">', Scrabble.Dictionary.translate("GSCNPP_TXT_BLKNTL_TTL"), "</span>", '<div class="wildTilesLetters">'];
            var c = Scrabble.TileSets.getAlphabet(Scrabble.GameServerManager.currentGame().board.dictionary);
            for (var a = 0; a < c.length; a++) {
                if (a == 24) {
                    d.push('<div class="lastTileRow">')
                }
                d.push('<div id="wildLetter_' + c[a] + '" class="wildLetter">' + Scrabble.TileFactory.createTile(200, false, c[a]) + "</div>")
            }
            d.push("</div></div>");
            d.push('<span class="cancelButton" id="wildTileCloseBtn">', Scrabble.Dictionary.translate("GSCNPP_BTN_BLKNTL_CLS"), "</span>");
            return d.join("")
        },tradeTilesPopup: function(d) {
            var h = "ENGLISH_TWL";
            try {
                h = Scrabble.GameServerManager.currentGame().board.dictionary
            } catch (g) {
            }
            var a = "";
            if (h.indexOf("_") != -1) {
                a = h.substring(h.indexOf("_") + 1)
            } else {
                a = h.substring(0, 1) + "WL"
            }
            var c = ['<h1 class="typo_lightBlue">', Scrabble.Dictionary.translate("GSCN_LBL_EXCHANGE"), "</h1>", Scrabble.PopupFactory.tileTracking(), '<div class="tradeTilesFlag flag_', a, '"></div><p class="typo_lightBlue">', Scrabble.Dictionary.translate("GSCNPP_TXT_EXCHNG_MSG2"), '</p><span class="xButton" id="tradeTilesPopupXBtn"></span><div id="tradeRack">'];
            var f;
            for (var b = 0; b < 7; b++) {
                f = ['<div class="tradeRackSpace"></div>'];
                c.push(f.join(""))
            }
            c = c.concat(['</div><span id="tradeTilesCancel" class="typo_white">', Scrabble.Dictionary.translate("GSCNPP_BTN_EXCHNG_CNCL"), '</span><span id="tradeTilesAccept" class="smallBlueBtn typo_white">', Scrabble.Dictionary.translate("GSCNPP_BTN_EXCHNG_OK"), "</span>"]);
            return c.join("")
        },tileTracking: function() {
            var b, c, g, h, f = [];
            try {
                h = Scrabble.GameServerManager.currentGame().board.dictionary
            } catch (d) {
                h = "ENGLISH_TWL"
            }
            f.push('<div id="tileTrackingHeader" class="typo_black">');
            g = Scrabble.TileSets.getDistribution(h);
            alphabetInit = Scrabble.TileSets.getDistribution(h);
            if (Scrabble.TradeTilesPopup.tileTracking === true) {
                f.push((Scrabble.Dictionary.translate("EX_TXT_EXTLTRCKNG") + '<span class="infoToken" title="' + Scrabble.Dictionary.translate("EX_TXT_EXTLTRCKNG") + '" id="tileTrackingInfoToken"></span>'));
                var a = new Date();
                if (a >= (new Date(2013, 3, 1, 3)) && a < new Date(2013, 6, 1, 0) && Scrabble.TradeTilesPopup.branding == true) {
                    f.push(('<span class="tileTrackingToyotaPromo typo_turnpike typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_TLTRCKNGTYT") + "</span>"))
                }
                $("#board .tile").each(function() {
                    b = Scrabble.TileSets.getLetter($(this).data("id"), h);
                    if (b != null && g[b] != null && g[b] > 0) {
                        g[b]--
                    }
                });
                $("#tileRackContainer .tile").each(function() {
                    b = Scrabble.TileSets.getLetter($(this).data("id"), h);
                    if (b != null && g[b] != null && g[b] > 0) {
                        g[b]--
                    }
                })
            } else {
                f.push((Scrabble.Dictionary.translate("EX_TXT_EXTLDSTRBTN") + '<span class="infoToken" title="' + Scrabble.Dictionary.translate("EX_TXT_EXTLDSTRBTN") + '" id="tileDistInfoToken"></span>'))
            }
            f.push('</div><div class="tileTrackingLetters">');
            for (b in g) {
                c = b;
                if (c == "german_A") {
                    c = "&Auml;"
                } else {
                    if (c == "german_U") {
                        c = "&Uuml;"
                    } else {
                        if (c == "german_O") {
                            c = "&Ouml;"
                        } else {
                            if (c == "spanish_LL") {
                                c = "LL"
                            } else {
                                if (c == "spanish_CH") {
                                    c = "CH"
                                } else {
                                    if (c == "spanish_N") {
                                        c = "&Ntilde;"
                                    } else {
                                        if (c == "spanish_RR") {
                                            c = "RR"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                f.push('<div class="tileTrackingItem"><span class="tileTrackingLetter typo_black ' + ((g[b] == 0) ? "transp" : "") + '">' + c + '</span><span class="tileTrackingCount ' + ((g[b] == 0 || g[b] != alphabetInit[b]) ? "typo_darkGrey" : "typo_lightBlue") + '"> ' + g[b] + "</span></div>")
            }
            f.push('</div><div id="tileTrackingInfo" class="typo_lightBlue"><span class="xButton"></span><span id="tileTrackingInfoTitle"></span><span id="tileTrackingInfoMsg"></span></div><span id="tradeTilesRackMessage" class="typo_darkGrey">' + Scrabble.Dictionary.translate("EX_TXT_EXDRGTLS") + "</span>");
            return f.join("")
        },playerProfilePopup: function(a, c) {
            var b = ['<div class="profilePopup">', '<div class="profileContent">', "</div>", "</div>"];
            return b.join("")
        },surveyPopup: function() {
            return ['<div class="scrabblePopup surveyPopup">', '<span class="surveyPopupCloseBtn popupButton" data-action="PopupOKClicked"></span>', '<span class="surveyPopupTitle typo_lightBlue">', Scrabble.Dictionary.translate("Your opinion is important to us!"), "</span>", '<span class="surveyPopupMessage typo_lightBlue">', Scrabble.Dictionary.translate("Please take this short survey to help us make SCRABBLE even better!"), "</span>", '<span class="largeBlueButton popupButton" data-action="openSurveyLink"><p class="typo_white">', Scrabble.Dictionary.translate("Complete Survey"), "</p></span>", "</div>"].join("")
        },tosLegalPopup: function() {
            return ['<div class="scrabblePopup" id="legalTOSPopup">', '<span class="legalTipCloseBtn"></span>', '<span class="legalTipMessage typo_lightBlue">', Scrabble.Dictionary.translate("STR_TXT_DSAWRNGPP", {"[STR_LINK]": ('<br /><span class="typo_lightBlue" id="storeTosLink">' + Scrabble.Dictionary.translate("STR_TXT_DSA") + "</span>")}), "</span>", '<span class="mediumBlueBtn popupButton" id="storeTosCheck"><p class="typo_white">', Scrabble.Dictionary.translate("STR_BTN_DSAWRNGPP"), "</p></span>", "</div>"].join("")
        },purchaseSuccessfulPopup: function() {
            return ['<div class="scrabblePopup purchaseInfoTip" id="purchaseSuccessfulPopup">', '<span class="purchaseInfoMessage typo_lightBlue">', Scrabble.Dictionary.translate("STR_TXT_PRCHSSCCSFLPP"), "</span>", "</div>"].join("")
        },purchaseUnsuccessfulPopup: function() {
            return ['<div class="scrabblePopup purchaseInfoTip" id="purchaseUnsuccessfulPopup">', '<span class="legalTipCloseBtn"></span>', '<span class="purchaseInfoMessage typo_lightBlue">', Scrabble.Dictionary.translate("STR_TXT_PRCHSNOTSCCSFLPP"), "</span>", '<span class="smallBlueBtn popupButton"><p class="typo_white">', Scrabble.Dictionary.translate("FB_STORE_RETRY"), "</p></span>", "</div>"].join("")
        },endGamePopup: function(a, d, e) {
            var b, l, g, f;
            var k = ['<div id="eogBasicStats">', '<div id="eogPlayerContainer">'];
            var h = false;
            var c = 0;
            for (i = 0; i < a.length; i++) {
                resigned = (a[i].status.indexOf("RESIGNED") != -1);
                resigned2 = false;
                if (i > 0) {
                    resigned2 = (a[i - 1].status.indexOf("RESIGNED") != -1)
                }
                if (a[i].userid == e && resigned) {
                    h = true
                }
                b = String(Scrabble.PlayerManager.getPlayerInfo(a[i].userid, "first_name"));
                if (b == "false") {
                    b = Scrabble.Dictionary.translate("anonymous")
                }
                l = String(Scrabble.PlayerManager.getPlayerInfo(a[i].userid, "picUrl"));
                if (l == "false") {
                    l = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"
                }
                var g = a[i].bonus - a[i].penalty;
                if (g > 0) {
                    g = "+" + g
                }
                if (i > 0 && (a[i - 1].total > a[i].total || (resigned == true && resigned2 == false))) {
                    c += i - c
                }
                k = k.concat(['<div class="eogPlayer eog', (c + 1), 'Place" id="eog', (i + 1), 'Place">', '<span class="eogPlayerFrame"></span>', '<span class="playerPic_small">', (resigned) ? '<span class="hasForfeited"></span>' : "", '<img src="', l, '" class="avatar" alt="', b.capitalize(), '">', "</span>", '<span class="eogPlayerName typo_black">', trimName(b.capitalize(), "", 8), "</span>", '<div class="eogStats">', '<span class="label normalLabel typo_lightBlue">', Scrabble.Dictionary.translate("GSCNENDPP_LBL_GSTTS_PTS"), '</span><span class="value typo_black">', a[i].baseScore, "</span><br/>", '<span class="label centLabel typo_lightBlue">', Scrabble.Dictionary.translate("GSCNENDPP_LBL_GSTTS_TLSLFT").split(" ").join("<br />"), '</span><span class="value typo_black centered">', g, "</span>", "</div>", '<div class="eogTotal typo_black">', '<p class="label typo_lightBlue">', Scrabble.Dictionary.translate("GSCNENDPP_LBL_GSTTS_TPS"), '</p><div class="value">', a[i].total, "</div>", "</div>", "</div>"])
            }
            k = k.concat(["</div>", "</div>", '<div id="eogDiag">']);
            if (a[0].userscore != 0 && h == false) {
                k = k.concat(['<div class="fbShare_big" id="eogFBShare">', '<span class="shareLabel typo_black">', Scrabble.Dictionary.translate("GSCNEND_BTN_FBSHR"), "</span>", "</div>"])
            }
            k = k.concat(["</div>", "</div>"]);
            return k.join("")
        },nudgePopup: function() {
            return ['<div id="nudgePopupHeader">', '<span class="popupTitle typo_lightBlue">', Scrabble.Dictionary.translate("FCBK_TXT_NDGPP_TTL"), "</span>", '<span class="xButton" id="nudgeXButton"></span>', "</div>", '<span class="smallListBG"></span>', '<div id="nudgePopupContent">', '<div id="nudgeList"><span id="nudgeListHeader" class="typo_lightGrey">', Scrabble.Dictionary.translate("FCBK_TXT_NDGPP_MSG"), "</span></div>", "</div>", '<div id="nudgePopupFooter">', '<span class="nudgeButton popupButton">', Scrabble.Dictionary.translate("FCBK_LBL_NDGPP_NDG"), "</span>", '<span class="forfeitButton popupButton">', Scrabble.Dictionary.translate("FCBK_LBL_FRCFRFTPP_FRCFRFT"), "</span>", "</div>"].join("")
        },playWithFriendsPopup: function() {
            var a = ['<div class="friendBoarding typo_white">'];
            if (Scrabble.PlayerManager.countPlayers() - 1 == 0) {
                a = a.concat(["<h2>", Scrabble.Dictionary.translate("ONBRDNG_TXT_TLLYRFRNDS_TTL"), "</h2>", '<span class="ob_numFirends">', Scrabble.Dictionary.translate("ONBRDNG_TXT_INVTEFRNDS_MSG"), "</span>"])
            } else {
                a = a.concat(["<h2>", Scrabble.Dictionary.translate("ONBRDNG_TXT_TLLYRFRNDS_TTL"), "</h2>", '<span class="ob_numFirends">', Scrabble.Dictionary.translate("ONBRDNG_TXT_FCBK_TLLYRFRNDS_MSG", {X: '<span class="numFriends typo_lightBlue">' + (Scrabble.PlayerManager.countPlayers() - 1) + "</span>"}), "</span>"])
            }
            a = a.concat(['<div class ="onBoardDiag typo_white">', '<span class="tyrfrndsButton popupButton" data-action="SendFriendsConfirmed">', Scrabble.Dictionary.translate("ONBRDNG_BTN_TLLYRFRNDS_OK"), "</span>", "</div>", '<span class="xButton popupButton" data-action="PopupCancelClicked"></span>', "</div>"]);
            return a.join("")
        },moreFriendsPopup: function() {
            var a = ['<div class="moreFriendsBoarding typo_white">', "<h2>", Scrabble.Dictionary.translate("ONBRDNG_TXT_FCBK_MRFRNDS_TTL"), "</h2>", '<span class="ob_numFirends">', Scrabble.Dictionary.translate("ONBRDNG_TXT_FCBK_MRFRNDS_MSG"), "</span>", '<span class="ob_notOnWall">', Scrabble.Dictionary.translate("ONBRDNG_TXT_FCBK_MRFRNDS_MSG2"), "</span>", '<div class ="onBoardDiag typo_white">', '<span class="tyrfrndsButton popupButton" data-action="SendFriendsConfirmed">', Scrabble.Dictionary.translate("ONBRDNG_TXT_FCBK_MRFRNDS_OK"), "</span>", "</div>", '<span class="xButton popupButton" data-action="PopupCancelClicked"></span>', "</div>"];
            return a.join("")
        },zoomTutorialPopup: function() {
            var a = "ctrlImage";
            if (navigator.platform.indexOf("Mac") != -1) {
                a = "cmdImage"
            }
            return ['<div class="zoomTutorialPopup">', '<span class="popupTop"></span>', '<div class="popupMid">', '<span class="xButton popupButton" data-action="PopupOKClicked"></span>', '<span class="zoomTitle">', Scrabble.Dictionary.translate("FCBK_TXT_GMSZPP_TTL"), "</span>", '<span class="zoomInstructions">', Scrabble.Dictionary.translate("FCBK_TXT_GMSZPP_MSG"), "</span>", '<span class="zoomFooter">', Scrabble.Dictionary.translate("FCBK_TXT_GMSZPP_MSG2"), "</span>", "<span class=" + a + "></span>", '<span class="addImage"></span>', '<span class="plusImage"></span>', '<span class="minusImage"></span>', '<span class="zoomHold">', Scrabble.Dictionary.translate("FCBK_TXT_GMSZPP_HLD"), "</span>", '<span class="zoomSize">', Scrabble.Dictionary.batch(["FCBK_TXT_GMSZPP_BGGR", "FCBK_TXT_GMSZPP_OR", "FCBK_TXT_GMSZPP_SMLLR"]), "</span>", "</div>", '<span class="popupBot"></span>', "</div>"].join("")
        },suggestedGamesPopup: function(c) {
            var a = ['<div id= "suggestionTitle" class="typo_lightBlue">', Scrabble.Dictionary.translate("MENU_LBL_SGGSTDGMS_TTL"), "</div>", '<span id= "suggestionCloseBtn"></span>', '<div id= "suggestionHeader" class="typo_darkGrey">', Scrabble.Dictionary.translate("MENU_LBL_SGGSTDGMS_MSG"), "</div>", '<div id="suggestionList">'];
            for (var b = 0; b < c.length; b++) {
                a.push(Scrabble.DomBuilder.buildSuggestionFriend(c[b][0], c[b][1]))
            }
            a.push("</div>");
            return a.join("")
        },storeIntroPopup: function() {
            return ['<div class="storeIntroPopup">', '<p id="storeIntroTitle" class="typo_lightBlue">', Scrabble.Dictionary.translate("FACEBOOK_SCRABBLE_DAY_TITLE"), "</p>", '<span class="xButton popupButton" data-action="PopupCancelClicked"></span>', '<div id="storePromoTopString" class="typo_limeBlue">', Scrabble.Dictionary.translate("FACEBOOK_SCRABBLE_DAY_BODY"), "</div>", '<img src="' + Scrabble.config._cdnVersion + '/images/storeItems/newFeature/storePromoScrabbleDay.png" class="storeIntroFeaturedItems" alt="Featured Items" />', '<div id="storePromoBottomString" class="typo_lightBlue">', Scrabble.Dictionary.translate("FACEBOOK_SCRABBLE_DAY_SUBTEXT"), "</div>", '<span class="confirmButton popupButton largeBlueBtn" data-action="PopupOKClicked"><img src="' + Scrabble.config._cdnVersion + "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" /><p class="typo_white">', Scrabble.Dictionary.translate("NWFTR_BTN_NWSTR_GTNW"), "</p></span>", "</div>"].join("")
        },mattelIntroPopup: function() {
            var a;
            if (Scrabble.config.lang != "fr") {
                a = '<div class="mattelIntroFeature typo_paleBlue"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeStarPoint.png" class="star" /></span>' + Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_FT1").replace("(Collins)", '<img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeCollinsLogo.png"/>') + "</div>"
            } else {
                a = '<div class="mattelIntroFeature typo_paleBlue"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeStarPoint.png" class="star" /></span>' + Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_FT1").replace("(Larousse)", '<img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeLarousseLogo.png"/>') + "</div>"
            }
            return ['<div class="mattelIntroPopup">', '<div class="mattelIntroTitle typo_lightBlue">', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_TTL"), "</div>", '<span class="xButton popupButton" data-action="PopupCancelClicked"></span>', '<div class="mattelIntroSubTitle typo_paleBlue">', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_TXT1"), "</div>", a, '<div class="mattelIntroFeature typo_paleBlue"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeStarPoint.png" class="star" /></span>', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_FT2"), "</div>", '<div class="mattelIntroFeature typo_paleBlue"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeStarPoint.png" class="star" /></span>', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_FT3"), "</div>", '<div class="mattelIntroFeature typo_paleBlue"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popupWelcomeStarPoint.png" class="star" /></span>', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_FT4"), "</div>", '<div class="mattelIntroEnding typo_lightBlue">', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_SUBTXT"), "</div>", '<span class="confirmButton popupButton largeBlueBtn" data-action="PopupOKClicked"><p class="typo_white">', Scrabble.Dictionary.translate("FB_NEW_MATTEL_USER_PLAY"), "</p></span>", "</div>"].join("")
        },upsellPopup: function() {
            return ['<div id="upsellTopLeftImage"></div>', '<p id="upsellTitle" class="typo_black"></p>', '<div id="upsellCloseBtn"></div>', '<div id="upsellContent"></div>', '<div id="upsellOkBtn" class="wideBlueBtn"><p></p></div>'].join("")
        }}
}();
Scrabble.QuestBuilder = function() {
    var a = "normal";
    var b = $("#questPopup");
    return {basePopupHeader: function(d, c) {
            c = c || "";
            return ['<div id="questPopupHeader"', ((a == "warning") ? 'class="questWarning"' : ""), ">", '<span class="popupTitle ', c, '">', Scrabble.Dictionary.translate(d), "</span>", '<span class="xButton"></span>', "</div>"].join("")
        },toyotaProgress: function() {
            return [Scrabble.QuestPopup.toyotaWordProgress, "/", Scrabble.QuestPopup.toyotaReqWords].join("")
        },objectiveList: function(g) {
            var e, h, c = "", f = Scrabble.GameServerManager.currentGame();
            if (f == null) {
                f = "ENGLISH_TWL"
            } else {
                f = f.board.dictionary
            }
            for (var d = 0; d < g.length; d++) {
                e = (g[d].playedTimes != 0) ? "typo_darkRed" : "typo_lightBlue";
                h = (g[d].playedTimes != 0) ? (" x " + g[d].playedTimes) : "";
                c += ('<span class="questPopupObjective ' + e + '">' + g[d].display[f] + h + "</span>")
            }
            return ['<div class="questPopupObjectiveList">', '<span class="questPopupObjectivesTitle typo_white typo_turnpike">', Scrabble.Dictionary.translate("TYT_TXT_WRDLST"), "</span>", c, "</div>"].join("")
        },bToyota: function(d, g) {
            Scrabble.QuestBuilder.setNormalSize();
            if (d == 1) {
                return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_FRSTTYT_PPUPTTL", "typo_turnpike"), '<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTXT1"), "</span>", '<div class="questPopupCreative"><img src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaPromoGifts.png" alt="', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTTL"), '" /></div>', '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTXT2"), "<br />", Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTXT3"), "</span>", '<span class="confirmButton questPopupStoreBtn"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" /><p class="typo_white">', Scrabble.Dictionary.translate("NWFTR_BTN_NWSTR_GTNW"), "</p></span>", '<span class="questPopupLegalOptions typo_lightBlue">', Scrabble.Dictionary.translate("TYT_TXT_TYTLGLIF"), "</span>"].join("")
            } else {
                if (d == 2) {
                    return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_LXRTHMNSTLLDPPUPTTLE"), '<img src="', Scrabble.config._cdnVersion, '/images/storeItems/kits/storeItemsIconToyotaKit_hasbro.png" class="questPopupHeadDecoration" />', '<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_LXRTHMNSTLLDPPUPTXT1"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_LXRTHMNSTLLDPPUPTXT2"), "</span>", Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_LXRTHMNSTLLDPPUPTXT3"), "</span>", '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>"].join("")
                } else {
                    if (d == 3) {
                        var f = "TYT_TXT_LCKDTLSPPUP2TXT";
                        if (g.category == "board") {
                            f = "TYT_TXT_LCKDBRDPPUP1TXT"
                        } else {
                            if (g.category == "feature") {
                                f = "TYT_TXT_LCKDTLTRCKNGPPUP3TXT"
                            }
                        }
                        return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_LCKDTLSPPUPTTLE"), '<img src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaBoardTileLocked.png" class="questPopupHeadDecoration" />', '<span class="questPopupMessage">', Scrabble.Dictionary.translate(f + "1"), "</span>", (g.category == "feature") ? ('<span class="questPopupMessage">' + Scrabble.Dictionary.translate("TYT_TXT_LCKDTLTRCKNGUP3TXT2") + "</span>") : ('<span class="questPopupSubMessage">' + Scrabble.Dictionary.translate(f + "2") + "<br />" + Scrabble.Dictionary.translate(f + "3") + "</span>"), Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDCNTRTXT"), "</span>", '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>"].join("")
                    } else {
                        if (d == 4) {
                            return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_WRDPPUPTTLE"), '<img src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaBoardTile.png" class="questPopupHeadDecoration" />', '<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDPPUPTXT1", {"[WORD]": g.join()}), "</span>", Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDCNTRTXT"), "</span>", '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDPPUPTXT2"), "</span>"].join("")
                        } else {
                            if (d == 5) {
                                return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_WRDWNRWRDPPUPTTLE"), '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>", '<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDWNRWRDPPUPTXT1"), "</span>", Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_WRDWNRWRDPPUPTXT2"), "<br />", Scrabble.Dictionary.translate("TYT_TXT_WRDWNRWRDPPUPTXT3"), "<br />", Scrabble.Dictionary.translate("TYT_TXT_WRDWNRWRDPPUPTXT4"), "</span>", '<span class="confirmButton questPopupStoreBtn"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" /><p class="typo_white">', Scrabble.Dictionary.translate("NWFTR_BTN_NWSTR_GTNW"), "</p></span>"].join("")
                            } else {
                                if (d == 6) {
                                    var j = getDayDifference(Date.fromISO(Scrabble.QuestPopup.toyotaEndDate));
                                    if (j < 0) {
                                        j = j * -1
                                    }
                                    var h = "TYT_TXT_PPUP5DSLFTTTLE";
                                    var e = "TYT_TXT_PPUP5DSLFTXT1";
                                    if (j <= 1) {
                                        h = "TYT_TXT_PPUP1DSLFTTTLE";
                                        e = "TYT_TXT_PPUP1DSLFTXT2"
                                    }
                                    return [Scrabble.QuestBuilder.basePopupHeader(Scrabble.Dictionary.translate(h, {"[X]": j})), '<span class="questPopupMessage">', Scrabble.Dictionary.translate(e, {"[X]": j}), "</span>", '<div class="questPopupCreative"><img src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaPromoGifts.png" alt="', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTTL"), '" /></div>', '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_PRVWTLTRCKNGTXT2"), "</span>", '<span class="confirmButton questPopupStoreBtn"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" /><p class="typo_white">', Scrabble.Dictionary.translate("NWFTR_BTN_NWSTR_GTNW"), "</p></span>", '<span class="questPopupLegalOptions typo_lightBlue">', Scrabble.Dictionary.translate("TYT_TXT_TYTLGLIF"), "</span>"].join("")
                                } else {
                                    if (d == 7) {
                                        return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_EXPRTNPPUPCNDTN1TTLE"), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_EXPRTNPPUPCNDTN1TXT1"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate((Scrabble.QuestPopup.isToyotaQuestCompleted) ? "TYT_TXT_EXPRTNPPUPCNDTN2TXT2" : "TYT_TXT_EXPRTNPPUPCNDTN1TXT2"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_EXPRTNPPUPCNDTN1TXT3"), "</span>", '<span class="confirmButton questPopupStoreBtn"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/storePopupShopIcon_", Scrabble.config._branding, '.png" alt="(_)" /><p class="typo_white">', Scrabble.Dictionary.translate("NWFTR_BTN_NWSTR_GTNW"), "</p></span>"].join("")
                                    } else {
                                        if (d == -1) {
                                            Scrabble.QuestBuilder.setWarningSize();
                                            var c = "TYT_TXT_AVLNSPCLPPUPIFTBOTHRTLSTXT3";
                                            if (g.category == "board") {
                                                c = "TYT_TXT_AVLNSPCLPPUPIFTBOTHRBRDTXT3"
                                            }
                                            return [Scrabble.QuestBuilder.basePopupHeader("TYT_TXT_AVLNSPCLPPUPIFTBOTHRBRDTTLE", "typo_turnpike"), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_AVLNSPCLPPUPIFTBOTHRBRDTXT1"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_AVLNSPCLPPUPIFTBOTHRBRDTXT2"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate(c), "</span>", '<div class="smallRedBtn" id="avalonCancelItemEquip"><p class="typo_white">', Scrabble.Dictionary.translate("TYT_TXT_AVLNSPCLPPUPIFTBOTHR_BTNCNCL"), "</p></div>", '<div class="smallGreenBtn" id="avalonConfirmItemEquip"><p class="typo_white">', Scrabble.Dictionary.translate("TYT_TXT_AVLNSPCLPPUPIFTBOTHR_BTNCNTNE"), "</p></div>"].join("")
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            return ""
        },setNormalSize: function() {
            if (a != "normal") {
                a = "normal";
                $("#questPopup .xButton").show();
                b.css({"background-image": 'url("' + Scrabble.config._cdnVersion + '/images/skins/skin_toyota/popupToyota.png")',width: "449px",height: "575px",top: "55px"})
            }
        },setWarningSize: function() {
            if (a != "warning") {
                a = "warning";
                $("#questPopup .xButton").hide();
                b.css({"background-image": 'url("' + Scrabble.config._cdnVersion + '/images/skins/skin_default/popup07.png")',width: "356px",height: "350px",top: "185px"})
            }
        },optionsToyotaMenu: function() {
            if (Scrabble.QuestPopup.isToyotaQuestCompleted) {
                return ['<img class="questPopupLeftDecoration" src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaBoardTileExtra.png" alt="', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTTL"), '" />', '<h2 class="questPopupLeftMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNAFTRWNTXT1"), "</h2>", Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNTXT3"), "</span>", '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNAFTRWNTXT2"), Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNAFTRWNTXT3"), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNAFTRWNTXT4"), "</span>"].join("")
            }
            return ['<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNTXT1"), "</span>", '<img class="questPopupLeftDecoration" src="', Scrabble.config._cdnVersion, '/images/skins/skin_toyota/toyotaBoardTileLocked.png" alt="', Scrabble.Dictionary.translate("TYT_TXT_FRSTTYT_PPUPTTL"), '" />', '<span class="questPopupMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNTXT2"), "</span>", Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives), '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNTXT3"), "</span>", '<span class="questPopupProgressMessage typo_darkRed">', Scrabble.QuestBuilder.toyotaProgress(), "</span>", '<span class="questPopupSubMessage">', Scrabble.Dictionary.translate("TYT_TXT_TYTSPCLMNTXT4"), "</span>"].join("")
        }}
}();
Scrabble.TileFactory = function() {
    return {createTile: function(d, b, a) {
            if (b != "active") {
                b = "inactive"
            }
            var c = Scrabble.WordList.gameDictionary;
            if (Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch] != undefined) {
                c = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
            } else {
                if (Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch).board.dictionary != undefined) {
                    c = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch).board.dictionary
                }
            }
            if (Scrabble.TileSets[c][d] != undefined) {
                return this._createLetterMarkup(Scrabble.TileSets[c][d].letter, b, Scrabble.TileSets[c][d].id, a)
            } else {
                return this._createLetterMarkup(a, b, -1)
            }
        },_createLetterMarkup: function(c, f, h, d) {
            var a = "";
            var g = Scrabble.WordList.gameDictionary;
            if (Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch] != undefined) {
                g = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
            }
            if (c == " ") {
                if (d != undefined) {
                    c = d
                } else {
                    c = "BLANK"
                }
                a = "Red"
            }
            var e = ['<div class="tile ', f, '" data-tile_active="', f, '" data-letter="', c, '" data-id="', h, '">', '<span class="tileBase"></span>', '<span class="tileLetter', a, " letter_", c, '"></span>', '<span class="tileScore score_', (h == -1) ? "0" : Scrabble.TileSets[g][h].score, '"></span>', "</div>"];
            return e.join("")
        }}
}();
Scrabble.TipFactory = function() {
    return {genericTip: function(a) {
            return ['<div class="genTip tooltip">', '<div class="toolTip_top">', '<span class="ob_topLeft"></span><span class="ob_topMid"></span><span class="ob_topRight"></span>', "</div>", '<div class="toolTip_mid">', '<span class="ob_leftMid"></span>', '<span class="tipContent typo_black">', Scrabble.Dictionary.translate(a), "</span>", '<span class="ob_rightMid"></span>', "</div>", '<div class="toolTip_bot">', '<span class="ob_botLeft"></span><span class="ob_botMid"></span><span class="ob_botRight"></span>', "</div>", '<span class="tipArrow"></span>', "</div>"].join("")
        }}
}();
Scrabble.PlayerCards = function() {
    var a = false;
    return {initialized: false,tleftIn: null,init: function() {
            $("#cardZoneDivision").on("click", ".gameCard", Scrabble.PlayerCards.openPlayerProfile);
            Scrabble.PlayerCards.initialized = true
        },openPlayerProfile: function(c) {
            var b = $(c.currentTarget).attr("id").split("_")[1];
            if (b != "0") {
                Scrabble.ProfilePopup.show(b, false)
            }
        },buildPlayerCards: function(b, d, c, e) {
            if (!Scrabble.PlayerCards.initialized) {
                Scrabble.PlayerCards.init()
            }
            if (b == "curr") {
                b = Scrabble.GameServerManager.currentGame()
            }
            if (c != true) {
                $("#cardZoneDivision").empty()
            }
            if (d == true) {
                $("#cardZoneDivision").fadeTo(350, 0, function() {
                    Scrabble.PlayerCards.populateZone(b, d, c)
                })
            } else {
                Scrabble.PlayerCards.populateZone(b, d, c)
            }
        },populateZone: function(e, l, g, m) {
            var q = null;
            if (typeof e == "undefined") {
                e = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch);
                if (typeof e == "undefined") {
                    e = Scrabble.GameServerManager.currentGame()
                }
                if (typeof e == "undefined") {
                    setTimeout(function() {
                        Scrabble.PlayerCards.populateZone(undefined, l, g)
                    }, 500);
                    return false
                }
            }
            var d = e.mmatchusers.matchuser.length;
            var r = 6;
            if (d == undefined) {
                d = 1;
                e.mmatchusers.matchuser = [e.mmatchusers.matchuser];
                s = "duo";
                r = 12
            }
            var s;
            var t = 150;
            if (d == 2) {
                s = "duo";
                r = 12
            } else {
                if (d == 3) {
                    s = "trio";
                    t = 120;
                    r = 8
                } else {
                    if (d == 4) {
                        s = "quartet";
                        t = 98;
                        r = 4
                    } else {
                        s = "duo"
                    }
                }
            }
            var A, h, j, v, c = [];
            var z = [];
            var f = "";
            for (var o = 0; o < d; o++) {
                var k = false;
                A = e.mmatchusers.matchuser[o];
                var n = false;
                if (e.board.currentturnuserid == A.userid) {
                    n = true
                }
                if (A.racksize != 7 && A.userid != Scrabble.PlayerManager.currentUser.mayhemId) {
                    q = A.racksize
                } else {
                    q = null
                }
                if (A.status == "RESIGNED" || A.status == "RESIGNED_NOPENALTY") {
                    k = true
                }
                if (A.userid == Scrabble.PlayerManager.currentUser.mayhemId) {
                    h = Scrabble.Dictionary.translate("GSCN_TXT_PLYRCRD_PLYRNM_USERONLN")
                } else {
                    h = trimName(Scrabble.PlayerManager.getPlayerInfo(A.userid, "first_name"), "", r)
                }
                j = Scrabble.PlayerManager.getPlayerInfo(A.userid, "picUrl");
                if (h == false || j == false) {
                    c.push(A.userid);
                    h = trimName(Scrabble.Dictionary.translate("DFLT_TXT_LDNG"), "", r);
                    j = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"
                }
                if (j == undefined) {
                    j = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"
                }
                v = Scrabble.DomBuilder.gameCardConstruct(s, A.userid, h, A.userscore, j, n, k);
                if (q != null && q != 0 && e.state != "COMPLETE") {
                    f += Scrabble.DomBuilder.gameCardTilesLeftConstruct(q, o, s)
                }
                if (d == 1) {
                    v += Scrabble.DomBuilder.gameCardConstruct(s, "0", Scrabble.Dictionary.translate("GSCN_TXT_GMCRD_OPPNNTNM_SRCHNG"), "0", Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png", false, k)
                }
                z.push(v)
            }
            if (g != true) {
                var x = $("#cardZoneDivision");
                x.html(z.join(""));
                x.append(f);
                if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                    $(".gameCard .gameCardScore, .gameCard .gameCardName").css("color", "#EA8886");
                    $(".myTurn").parent().find(".gameCardScore, .gameCardName").css("color", "#FFFFFF")
                } else {
                    $(".gameCard").fadeTo(0, 0.5);
                    $(".myTurn").parent().fadeTo(0, 1)
                }
                if (e.plays.play && m) {
                    var u = 0;
                    if (e.plays.play.length == undefined) {
                        e.plays.play = [e.plays.play]
                    }
                    u = e.plays.play[e.plays.play.length - 1].score;
                    $(".scoreIndicatorMiddle p").html(u + "")
                }
                e = null;
                A = null;
                v = null;
                z = null;
                f = null;
                if (l) {
                    x.fadeTo(0, 0);
                    setTimeout(function() {
                        $("#cardZoneDivision").fadeTo(0, 0.2);
                        $("#cardZoneDivision").animate({opacity: 1,top: "0px"}, {duration: 500,queue: false,easing: "easeOutQuad"})
                    }, 100)
                } else {
                    x.animate({opacity: 1,top: "0px"}, 1)
                }
                var b = 0;
                switch (d) {
                    case 1:
                    case 2:
                        b = 306;
                        break;
                    case 3:
                        b = 450;
                        break;
                    case 4:
                        b = 420;
                        break
                }
                x = null
            }
            $("#cardZoneDivision").css("width", b + "px");
            if (c.length > 0) {
                if (!a) {
                    Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.PlayerCards.anonymousUserLoadedCallback);
                    a = true
                }
                Scrabble.PlayerManager.getAnonymousPlayersInfo(c)
            }
            $(".tilesLeft").fadeTo(0, 0);
            Scrabble.PlayerCards.tleftIn = setTimeout(function() {
                $(".tilesLeft").animate({opacity: 1}, 350)
            }, 1000);
            $(".tilesLeft").off("click", function() {
                $(".tilesLeft").animate({opacity: 0,"background-position-y": "-38px"}, 200, function() {
                    $(this).remove()
                })
            });
            $(".tilesLeft").on("click", function() {
                $(".tilesLeft").animate({opacity: 0,"background-position-y": "-38px"}, 200, function() {
                    $(this).remove()
                })
            })
        },destroy: function() {
            $("#" + divId).empty()
        },anonymousUserLoadedCallback: function(b) {
            var d = $("#gameCard_" + b);
            var c;
            if (d.hasClass("duo")) {
                c = 12
            } else {
                if (d.hasClass("trio")) {
                    c = 3
                } else {
                    if (d.hasClass("quartet")) {
                        c = 4
                    }
                }
            }
            d.find(".cardAvatar").attr("src", Scrabble.PlayerManager.getPlayerInfo(b, "picUrl"));
            d.find(".gameCardName").html(trimName(Scrabble.PlayerManager.getPlayerInfo(b, "first_name"), "", c))
        }}
}();
Scrabble.Chat = function() {
    var a = 180;
    return {currentChatRoom: null,emoticonsOpened: false,initialized: false,chatScrollApi: null,chatRoomScroller: null,chatRoomDOM: null,emoticonPage: 0,emoticonMaxPage: 5,entries: {},isChatGlowing: false,chatCounter: 0,chatRefreshTimer: null,lastEntries: null,currentChatRoomMatch: null,data: null,isLoaded: false,displaySize: 10,pageSize: 10,nIcon: null,nGlow: null,initialize: function() {
            this.initialized = true;
            $("#chatSendBtnTxt").html(Scrabble.Dictionary.translate("CHT_BTN_MTD_SND"));
            $("#emoticonBtn").click(function() {
                Scrabble.Chat.toggleEmoticonsTab()
            });
            $("#emoticonList").html(Scrabble.DomBuilder.emoticonListConstruct());
            this.toggleEmoticonPage(1);
            $(".emoticonPageBullet").click(function() {
                Scrabble.Chat.toggleEmoticonPage($(this).attr("id").substr(6))
            });
            this.chatRoomScroller = $("#chatRoom").jScrollPane({contentWidth: 231,showArrows: true});
            this.chatScrollApi = this.chatRoomScroller.data("jsp");
            this.chatRoomDOM = this.chatScrollApi.getContentPane();
            $("#chatRoom .jspContainer").css("height", "525px");
            $("#chatRoom .jspContainer .jspHorizontalBar").hide();
            $("#chatRoom").css("width", "231px");
            $("#chatSendBtn").click(function() {
                Scrabble.Chat.submitChatEntry();
                Scrabble.SoundManager.play_sfx("Chat")
            });
            $("#muteChatBtn").click(Scrabble.Chat.toggleChatMute);
            $("#emoticonPageArrowLeft").on("click", function() {
                Scrabble.Chat.changeEmoticonPage(-1)
            });
            $("#emoticonPageArrowRight").on("click", function() {
                Scrabble.Chat.changeEmoticonPage(1)
            });
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.ChatRoomLoaded, Scrabble.Chat.getChatRoom);
            Scrabble.Chat.setChatRefreshInterval(30000);
            $("#chatFootNote").html(Scrabble.Dictionary.translate("TYT_TXT_TYTLGLIF"));
            var b = $("#chatInputTxt");
            b.css({height: "18px"});
            b.select(Scrabble.Chat.setFocus);
            b.focus(Scrabble.Chat.setFocus);
            b.blur(function() {
                Scrabble.KeyboardManager.setEnterKeyCallback(null);
                Scrabble.KeyboardManager.disableBackspace()
            });
            b.autosize();
            b.on("keydown", Scrabble.Chat.checkLimit);
            b.on("keyup", Scrabble.Chat.checkLimit);
            b.on("change", Scrabble.Chat.checkLimit);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.Chat.anonymousUserLoadedCallback);
            Scrabble.Chat.nIcon = $("#chatIconGlow");
            Scrabble.Chat.nGlow = $("#chatIconGlow2")
        },setFocus: function() {
            Scrabble.KeyboardManager.setEnterKeyCallback(function() {
                Scrabble.Chat.submitChatEntry();
                Scrabble.SoundManager.play_sfx("Chat")
            });
            Scrabble.KeyboardManager.enableBackspace();
            Scrabble.TipManager.removeTips();
            Scrabble.Board.hideFocus()
        },update: function() {
            $("#chatRoom .jspContainer").css("width", "231px");
            $("#chatRoom").css("width", "231px");
            Scrabble.Chat.chatScrollApi.reinitialise();
            Scrabble.Chat.chatScrollApi.scrollToPercentY(100);
            $("#chatRoom .jspContainer .jspHorizontalBar").hide();
            $("#chatFooter").show()
        },anonymousUserLoadedCallback: function(b) {
            $('#chatRoom [data-name_user_id="' + b + '"]').html(trimName(Scrabble.PlayerManager.getPlayerInfo(b, "first_name"), "", 5));
            $('#chatRoom [data-pic_user_id="' + b + '"]').attr("src", Scrabble.PlayerManager.getPlayerInfo(b, "picUrl"))
        },setSize: function(d) {
            var c = $("#chatInputTxt");
            var f = parseInt(c.css("height").split("px")[0]);
            var b = f - 18;
            $("#chatFooterMiddle .expandableTextFieldMiddle").css("height", b + "px");
            $("#chatFooterMiddle").css("height", (b + 30) + "px")
        },checkLimit: function(d) {
            var c = $("#chatInputTxt");
            var f = c.val();
            var b = f.length;
            c.val(f.substr(0, a - 1));
            c.trigger("autosize");
            setTimeout(Scrabble.Chat.setSize, 1)
        },changeEmoticonPage: function(b) {
            $("#bullet" + Scrabble.Chat.emoticonPage).removeClass("emoticonPageBulletSelected");
            Scrabble.Chat.emoticonPage += b;
            if (Scrabble.Chat.emoticonPage < 1) {
                Scrabble.Chat.emoticonPage = 1
            } else {
                if (Scrabble.Chat.emoticonPage > Scrabble.Chat.emoticonMaxPage) {
                    Scrabble.Chat.emoticonPage = Scrabble.Chat.emoticonMaxPage
                } else {
                    Scrabble.SoundManager.play_sfx("Select")
                }
            }
            $("#bullet" + Scrabble.Chat.emoticonPage).addClass("emoticonPageBulletSelected");
            $(".emoticonPage").hide();
            $("#ePage" + Scrabble.Chat.emoticonPage).show()
        },toggleEmoticonPage: function(b) {
            if (Scrabble.Chat.emoticonPage != b) {
                $("#bullet" + Scrabble.Chat.emoticonPage).removeClass("emoticonPageBulletSelected");
                Scrabble.Chat.emoticonPage = parseInt(b);
                $("#bullet" + b).addClass("emoticonPageBulletSelected");
                $(".emoticonPage").hide();
                $("#ePage" + b).show()
            }
        },placeEmoticon: function(c) {
            var b = $("#chatInputTxt");
            b.focus();
            if (b.val().length <= a - c.length) {
                b.val(b.val() + c).trigger("autosize");
                Scrabble.Chat.setSize()
            }
        },reset: function() {
            Scrabble.Chat.data = [];
            Scrabble.Chat.isLoaded = false;
            Scrabble.Chat.chatRoomDOM.html("");
            Scrabble.Chat.displaySize = Scrabble.Chat.pageSize;
            Scrabble.Chat.stopPlusGlow()
        },refreshChatRoom: function(e) {
            Scrabble.Chat.chatCounter++;
            if (Scrabble.Chat.chatCounter >= 60) {
                clearInterval(Scrabble.Chat.chatRefreshTimer)
            }
            var c = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (c != undefined) {
                var e = c.chatroomuri.split("/")[2];
                var f;
                var b = "";
                var d;
                if (Scrabble.Chat.data != null) {
                    for (i = (Scrabble.Chat.data.length - 1); i >= 0; i--) {
                        d = Scrabble.Chat.data[i];
                        f = d.chatentryuri.split("/")[4];
                        if (f != "") {
                            b = f;
                            break
                        }
                    }
                }
                Scrabble.GameServerManager.getchatRoom(e, b)
            }
        },getChatRoom: function(f) {
            if (f != null && f.match == Scrabble.GameServerManager.currentMatch) {
                if (f.entries != undefined) {
                    $("#chatRoom [data-entry_id='']").remove();
                    var h = f.entries;
                    if (h.length > 1) {
                        h = f.entries
                    } else {
                        h = [f.entries]
                    }
                    Scrabble.Chat.data = Scrabble.Chat.data.concat($.makeArray(f.entries));
                    var m = $("#chatRoom .chatEntry");
                    var l = h.length + m.length;
                    var b = Scrabble.Chat.displaySize - l;
                    var c = Math.abs(b);
                    if (b < 0) {
                        var q = c;
                        if (q > m.length) {
                            q = m.length
                        }
                        for (e = 0; e < q; e++) {
                            $(m[e]).remove()
                        }
                        var d = c - q;
                        newEntries = [];
                        for (e = d; e < h.length; e++) {
                            newEntries.push(h[e])
                        }
                        h = newEntries
                    }
                    Scrabble.Chat.checkLoadMore();
                    var k = f.match;
                    var j = (k == Scrabble.Chat.currentChatRoomMatch) ? false : true;
                    Scrabble.Chat.currentChatRoomMatch = k;
                    Scrabble.Chat.lastEntries = h;
                    var g = ($("#chatPanel").css("display") == "none") ? true : false;
                    if (g) {
                        $("#chatPanel").show();
                        $("#wordListPanel").hide()
                    }
                    if (this.initialized == false) {
                        this.initialize()
                    }
                    var o = Scrabble.Chat.entries[Scrabble.Chat.currentChatRoom];
                    if (o == undefined) {
                        Scrabble.Chat.entries[Scrabble.Chat.currentChatRoom] = 0;
                        o = 0
                    }
                    for (var e = 0; e < h.length; e++) {
                        Scrabble.Chat.submitChatEntry(unParse(h[e].message), h[e].userid, h[e].date, h[e].chatentryuri.split("/")[4], j)
                    }
                    Scrabble.Chat.updateChatIn(250);
                    Scrabble.Chat.entries[Scrabble.Chat.currentChatRoom] = $("#chatRoom .chatEntryLeft").length;
                    if (g) {
                        $("#chatPanel").hide();
                        $("#wordListPanel").show()
                    }
                    var n;
                    if (f.entries.length) {
                        n = f.entries[f.entries.length - 1]
                    } else {
                        n = f.entries
                    }
                    if ((Scrabble.Chat.entries[Scrabble.Chat.currentChatRoom] - o) > 0 && Scrabble.AnimationManager.animationsEnabled && n.userid != Scrabble.PlayerManager.currentUser.mayhemId && dateToMilliseconds(n.date) < dateToMilliseconds(Scrabble.PlayerManager.currentUser.lastOnline)) {
                        Scrabble.SoundManager.play_sfx("Chat_Chimes");
                        if (Scrabble.RightMenu.isExpanded == false) {
                            Scrabble.Chat.startGlow()
                        } else {
                            if (Scrabble.RightMenu.pannelDisplayed != "chat") {
                                Scrabble.Chat.startGlow()
                            }
                        }
                        if (Scrabble.RightMenu.pannelDisplayed != "chat") {
                            Scrabble.Chat.entries[Scrabble.Chat.currentChatRoom] = o
                        }
                    } else {
                        if (Scrabble.RightMenu.pannelDisplayed == "chat") {
                            Scrabble.Chat.stopPlusGlow()
                        }
                    }
                } else {
                    Scrabble.Chat.chatScrollApi.reinitialise();
                    return false
                }
            } else {
                Scrabble.Chat.chatScrollApi.reinitialise();
                return false
            }
        },updateChatIn: function(b) {
            setTimeout(function() {
                $("#chatRoom .jspContainer").css("height", "568px");
                Scrabble.Chat.update()
            }, b)
        },setChatRefreshInterval: function(b) {
            Scrabble.Chat.chatRefreshTimer = setInterval(Scrabble.Chat.refreshChatRoom, b)
        },loadMoreChats: function() {
            clearInterval(Scrabble.Chat.chatRefreshTimer);
            var f = (Scrabble.Chat.data.length - Scrabble.Chat.displaySize);
            var c;
            if (f > Scrabble.Chat.pageSize) {
                c = Scrabble.Chat.pageSize
            } else {
                c = f
            }
            Scrabble.Chat.displaySize += c;
            var g = f - c;
            if (g < 0) {
                g = 0
            }
            var b;
            for (var d = (f - 1); d >= g; d--) {
                b = Scrabble.Chat.data[d].chatentryuri.split("/")[4];
                var e = $("#chatRoom [data-entry_id='" + b + "']");
                if (e.length == 0) {
                    Scrabble.Chat.submitChatEntry(unParse(Scrabble.Chat.data[d].message), Scrabble.Chat.data[d].userid, Scrabble.Chat.data[d].date, b, false, true)
                }
            }
            Scrabble.Chat.checkLoadMore();
            Scrabble.Chat.setChatRefreshInterval(60000)
        },checkLoadMore: function() {
            loading = $("#chatLoadMore");
            if (Scrabble.Chat.data.length > Scrabble.Chat.displaySize) {
                if (loading.length == 0) {
                    loading = $(Scrabble.DomBuilder.chatLoadMore());
                    $(Scrabble.Chat.chatRoomDOM).prepend(loading);
                    loading.off("click", Scrabble.Chat.loadMoreChats);
                    loading.on("click", Scrabble.Chat.loadMoreChats)
                } else {
                    loading.remove();
                    $(Scrabble.Chat.chatRoomDOM).prepend(loading);
                    loading.off("click", Scrabble.Chat.loadMoreChats);
                    loading.on("click", Scrabble.Chat.loadMoreChats)
                }
            } else {
                loading.remove()
            }
            Scrabble.Chat.chatScrollApi.reinitialise();
            $("#chatRoom .jspContainer").css("height", "568px");
            $("#chatRoom .jspContainer .jspHorizontalBar").hide();
            Scrabble.Chat.chatScrollApi.scrollToPercentY(0)
        },submitChatEntry: function(k, h, f, b, e, l) {
            var c = 0;
            Scrabble.Chat.emoticonsOpened = false;
            if (h == undefined) {
                c++;
                h = Scrabble.PlayerManager.currentUser.mayhemId
            }
            if (k == undefined || typeof k != "string") {
                c++;
                k = $("#chatInputTxt").val();
                if (k.charCodeAt(0) == 10) {
                    $("#chatInputTxt").val("");
                    $("#chatInputTxt").css({height: "18px"});
                    Scrabble.Chat.setSize();
                    return false
                }
            }
            if (f == undefined) {
                c++;
                f = "now"
            }
            if (b == undefined) {
                b = ""
            }
            if (k != "" && k.split(" ").join("") != "") {
                if ($("#emoticonBtn").hasClass("emoticonBtnSelected") == true) {
                    $("#emoticonBtn").removeClass("emoticonBtnSelected")
                }
                if (e !== false) {
                    var d = $("#chatInputTxt");
                    d.val("");
                    d.css({height: "18px"});
                    d = null;
                    Scrabble.Chat.setSize();
                    $("#emoticonList").hide();
                    $("#chatBottomCarrot").hide()
                }
                if (l == true) {
                    var g = $(Scrabble.Chat.chatRoomDOM).prepend(Scrabble.DomBuilder.chatEntryConstruct(h, k, f, b))
                } else {
                    var g = $(Scrabble.Chat.chatRoomDOM).append(Scrabble.DomBuilder.chatEntryConstruct(h, k, f, b))
                }
                Scrabble.Chat.chatScrollApi.reinitialise();
                $("#chatRoom .jspContainer").css("height", "568px");
                $("#chatRoom .jspContainer .jspHorizontalBar").hide();
                if (c >= 2) {
                    Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.ChatEntryPosted, function(m) {
                        $(g).attr("data-entry_id", m)
                    });
                    Scrabble.GameServerManager.postChat(Scrabble.Chat.currentChatRoom, k);
                    var j = Scrabble.Emoticons.detectSymbolTypes(k);
                    if (j.length > 0) {
                        j = j.join(",");
                        Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "emoticon", {subtype1: "features",subtype2: "chat",data: JSON.stringify({emoticonCategory: j})})
                    }
                }
                Scrabble.Chat.chatScrollApi.scrollToPercentY(100);
                return true
            } else {
                return false
            }
        },startGlow: function() {
            Scrabble.Chat.nIcon.hide();
            Scrabble.Chat.nGlow.hide();
            Scrabble.Chat.nIcon.fadeTo(1000, 1);
            Scrabble.Chat.isChatGlowing = true;
            Scrabble.Chat.doPlusGlow()
        },doPlusGlow: function() {
            $("#chatIconGlow2").hide();
            if (Scrabble.Chat.isChatGlowing) {
                if (Scrabble.Chat.nGlow.css("display") == "none") {
                    Scrabble.Chat.nGlow.css("display", "block");
                    Scrabble.Chat.nGlow.fadeTo(900, 0.1).fadeTo(300, 1).fadeTo(300, 0).fadeTo(300, 1).fadeTo(300, 0).fadeTo(300, 1).fadeTo(300, 0, function() {
                        setTimeout(Scrabble.Chat.doPlusGlow, 1000)
                    })
                }
            }
        },stopPlusGlow: function() {
            Scrabble.Chat.nIcon.hide();
            Scrabble.Chat.nGlow.hide();
            Scrabble.Chat.isChatGlowing = false
        },toggleEmoticonsTab: function() {
            $("#emoticonBtn").toggleClass("emoticonBtnSelected");
            if (Scrabble.Chat.emoticonsOpened == true) {
                $(".emoticonListItem").off(".emoticonListItem");
                Scrabble.SoundManager.play_sfx("Cancel");
                $("#emoticonList").hide();
                $("#chatBottomCarrot").hide();
                Scrabble.Chat.emoticonsOpened = false
            } else {
                $(".emoticonListItem").off(".emoticonListItem");
                $(".emoticonListItem").on("click.emoticonListItem", function() {
                    Scrabble.SoundManager.play_sfx("Select");
                    Scrabble.Chat.placeEmoticon($(this).attr("id"))
                });
                Scrabble.SoundManager.play_sfx("Generic_btn");
                $("#emoticonList").show();
                $("#chatBottomCarrot").show();
                Scrabble.Chat.emoticonsOpened = true
            }
        }}
}();
Scrabble.Board = function() {
    var a = "right";
    var b = "bottom";
    return {_wordTypeDirection: null,_wordTypePosition: null,_arrowPosition: {x: -1,y: -1},_tilesOrder: [],_currentTile: undefined,overlayOpened: false,lock: false,currentBoardModel: null,addTileToOrder: function(c) {
            var d = $(c).attr("data-id");
            Scrabble.Board._tilesOrder.push(d)
        },removeTileFromOrder: function(c) {
            var e = $(c).attr("data-id");
            var d = Scrabble.Board._tilesOrder.indexOf(e);
            Scrabble.Board._tilesOrder.splice(d, 1)
        },addTile: function(d, c, e) {
            if (c < 0 || c > 14 || e < 0 || e > 14) {
                console.warn("Board.addTile :: Tile is out of bounds");
                return false
            }
            document.getElementById("cell_" + c + "_" + e).innerHTML += d
        },createBoard: function(f, k) {
            this.currentBoardModel = f;
            if (k == null) {
                k = "def"
            }
            var e = [];
            var d = 0;
            var h = f.specialTiles.length;
            for (var j = 0; j < 15; j++) {
                for (var c = 0; c < 15; c++) {
                    d = 0;
                    for (var g = 0; g < h; g++) {
                        if (c == f.specialTiles[g][1] && j == f.specialTiles[g][2]) {
                            d = f.specialTiles[g][0]
                        }
                    }
                    e[e.length] = Scrabble.DomBuilder.boardSquareConstruct(c, j, f.cellTypes[d])
                }
            }
            $("#board").html(e.join(""));
            $("#gameScene .loadingWheel").hide();
            Scrabble.Board.setBoardSkin(k)
        },setBoardSkin: function(d, c) {
            var e;
            if (Scrabble.config._branding == "mattel" && d == "toyota2013") {
                d = "def"
            }
            c = c || false;
            if (d == "def" || d == "classic" || d == "vintage") {
                e = Scrabble.BoardSkins.skins[d + "_" + Scrabble.config._branding]
            } else {
                e = Scrabble.BoardSkins.skins[d]
            }
            if (e == null) {
                console.error("Trying to set non-existing tile skin '" + d + "'");
                Scrabble.Board.setBoardSkin("def");
                return false
            }
            $("#boardContainer").css("background-color", e.backgroundColor);
            $("#botMenu").css("background-color", e.backgroundColor);
            $("#boardSkinSelectionMenu").css("background-color", e.backgroundColor);
            $(".boardCell").css("background-image", e.url[Scrabble.config.lang]);
            $("#boardContainer").css("background-image", e.backgroundImage);
            Scrabble.BoardSkins.currentSkin = d;
            if (!c) {
                Scrabble.GameServerManager.updateBoardSkin(Scrabble.BoardSkins.currentSkin)
            }
        },setTileSkin: function(d, c) {
            c = c || false;
            d = d || "def";
            if (Scrabble.config._branding == "mattel" && d == "toyota2013") {
                d = "def"
            }
            if (d == "classic" && Scrabble.config._branding == "hasbro") {
                d = "def"
            }
            if (Scrabble.TileSkins.skins[d.toLowerCase()] == null) {
                console.error("Trying to set non-existing tile skin '" + d + "'");
                Scrabble.Board.setTileSkin("def");
                return false
            }
            $("#scrabbleGame").removeClass(Scrabble.TileSkins.currentSkin.toLowerCase() + "_skin");
            $("#scrabbleGame").addClass(d.toLowerCase() + "_skin");
            Scrabble.TileSkins.currentSkin = d;
            if (!c) {
                Scrabble.GameServerManager.updateTileSkin(Scrabble.TileSkins.currentSkin)
            }
        },inputFocus: function() {
            $(document).off("keydown", Scrabble.Board.keyPress)
        },inputBlur: function() {
            $(document).off("keydown", Scrabble.Board.keyPress);
            $(document).on("keydown", Scrabble.Board.keyPress)
        },enableBoard: function() {
            if ($("#board").find('[data-tile_active="active"]').length <= 0) {
                Scrabble.Board._tilesOrder = []
            }
            $(".boardCell").droppable({tolerance: "pointer",drop: function(m, l) {
                    Scrabble.SoundManager.playRoll("Drop_b", 5);
                    Scrabble.Board.endWordType();
                    if ($("#tileRackContainer .tile").length == 7) {
                        setTimeout(function() {
                            l.draggable.remove()
                        }, 1)
                    }
                    Scrabble.Board.addTileToOrder(l.draggable);
                    var j = [-1, -1];
                    var g = $(this).attr("id").split("_");
                    if (this.childNodes.length === 0 || (this.childNodes.length === 1 && this.childNodes[0].id == "wordTypeFocus")) {
                        j = [g[1], g[2]]
                    } else {
                        var k = false;
                        if ($("#cell_" + (parseInt(g[1]) + 1) + "_" + (g[2]) + " .tile").length == 0) {
                            var f = parseInt(g[1]) + 1;
                            if (f <= 14) {
                                j = [f, g[2]];
                                k = true
                            }
                        }
                        if ($("#cell_" + (g[1]) + "_" + (parseInt(g[2]) + 1) + " .tile").length == 0 && k == false) {
                            var f = parseInt(g[2]) + 1;
                            if (f <= 14) {
                                j = [g[1], parseInt(g[2]) + 1];
                                k = true
                            }
                        }
                        if ($("#cell_" + (g[1]) + "_" + (parseInt(g[2]) - 1) + " .tile").length == 0 && k == false) {
                            var f = parseInt(g[2]) - 1;
                            if (f >= 0) {
                                j = [g[1], parseInt(g[2]) - 1];
                                k = true
                            }
                        }
                        if ($("#cell_" + (parseInt(g[1]) - 1) + "_" + (g[2]) + " .tile").length == 0 && k == false) {
                            var f = parseInt(g[1]) - 1;
                            if (f >= 0) {
                                j = [parseInt(g[1]) - 1, g[2]];
                                k = true
                            }
                        }
                    }
                    if (j[0] != -1) {
                        var d = $("#cell_" + (j[0]) + "_" + (j[1]));
                        Scrabble.Board._currentTile = d.attr("data-id");
                        Scrabble.Board._wordTypeDirection = a;
                        nextCell = Scrabble.Board.findNextCell(j[0], j[1]);
                        d.append(l.draggable);
                        Scrabble.Board.setFocusKeyboard(nextCell);
                        Scrabble.Board.setFocusArrow(d);
                        l.draggable.offset({left: "0px",top: "0px"});
                        l.draggable.css({left: "-2px",top: "-2px"});
                        if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                            l.draggable.removeClass("fromRack").addClass("fromBoard")
                        }
                        l.draggable.removeClass("grabbed").addClass("dropped");
                        if ($(l.draggable).attr("data-letter") == "BLANK" && ($(l.draggable).attr("data-temp_letter") === undefined || $(l.draggable).attr("data-temp_letter") === "")) {
                            Scrabble.WildTilePopup.show(l.draggable[0])
                        }
                        Scrabble.Board.updateScorePreview();
                        Scrabble.GameScene.updateSkip()
                    }
                    if (Scrabble.GameServerManager.isMyTurn() == false) {
                        $("#board .active").fadeTo(0, 0.85)
                    }
                    var h = $(document);
                    h.off("click", Scrabble.Board.checkWordType);
                    h.on("click", Scrabble.Board.checkWordType);
                    h.off("keydown", Scrabble.Board.keyPress);
                    h.on("keydown", Scrabble.Board.keyPress);
                    $("#globalContainer").on("keydown", Scrabble.Board.test);
                    h = null
                }});
            var c = $(document);
            c.off("click", Scrabble.Board.checkWordType);
            c.on("click", Scrabble.Board.checkWordType);
            c = null
        },focusNextCell: function(c, e, d) {
            cell = Scrabble.Board.findNextCell(c, e, d);
            if (cell != undefined) {
                Scrabble.Board.setFocus(cell)
            } else {
                Scrabble.Board.hideFocus(false)
            }
        },findNextCell: function(c, e, d) {
            if (c > 14) {
                c = 14
            }
            if (e > 14) {
                e = 14
            }
            if (c < 0) {
                c = 0
            }
            if (e < 0) {
                e = 0
            }
            if (Scrabble.Board._wordTypeDirection == null) {
                Scrabble.Board._wordTypeDirection = a
            }
            cell = undefined;
            if (Scrabble.Board._wordTypeDirection == a) {
                cell = Scrabble.Board.findNextCellRight(c, e);
                if (cell == undefined && d != false) {
                    cell = Scrabble.Board.findNextCellBottom(c, e);
                    if (cell != undefined) {
                        Scrabble.Board._wordTypeDirection = b
                    }
                }
            } else {
                cell = Scrabble.Board.findNextCellBottom(c, e);
                if (cell == undefined && d != false) {
                    cell = Scrabble.Board.findNextCellRight(c, e);
                    if (cell != undefined) {
                        Scrabble.Board._wordTypeDirection = a
                    }
                }
            }
            return cell
        },findNextCellRight: function(d, e) {
            found = undefined;
            for (i = (parseInt(d) + 1); i <= 14; i++) {
                var c = $("#cell_" + i + "_" + e);
                if (c.children().length === 0 || (c.children().length === 1 && c.children()[0].id == "wordTypeFocus")) {
                    found = c;
                    break
                }
            }
            c = null;
            return found
        },findNextCellBottom: function(d, e) {
            found = undefined;
            for (i = (parseInt(e) + 1); i <= 14; i++) {
                var c = $("#cell_" + d + "_" + i);
                if (c.children().length === 0 || (c.children().length === 1 && c.children()[0].id == "wordTypeFocus")) {
                    found = c;
                    break
                }
            }
            c = null;
            return found
        },checkWordType: function(g) {
            if (Scrabble.GameServerManager.currentGame() != undefined) {
                Scrabble.Board.keyboardLock = false;
                var d = $(g.target);
                var f = false;
                if (d.hasClass("boardCell")) {
                    Scrabble.Board._wordTypeDirection = a;
                    Scrabble.Board.setFocus(d);
                    f = true
                } else {
                    if (d.attr("id") == "wordTypeFocus") {
                        Scrabble.Board.toggleFocus();
                        f = true
                    } else {
                        Scrabble.Board.hideFocus()
                    }
                }
                if (f == true) {
                    var c = $(document);
                    c.off("keydown", Scrabble.Board.keyPress);
                    c.on("keydown", Scrabble.Board.keyPress);
                    c = null
                }
            }
        },getIdByCell: function(c) {
            id = c.attr("id");
            id = id.split("_");
            return id
        },toggleFocus: function(e) {
            var d = $("#wordTypeFocus");
            if (d.hasClass("wordTypeFocusRight")) {
                d.removeClass("wordTypeFocusRight");
                d.addClass("wordTypeFocusBottom");
                Scrabble.Board._wordTypeDirection = b
            } else {
                d.removeClass("wordTypeFocusBottom");
                d.addClass("wordTypeFocusRight");
                Scrabble.Board._wordTypeDirection = a;
                if (e == undefined) {
                    Scrabble.Board.hideFocus();
                    $(document).off("keydown", Scrabble.Board.keyPress)
                }
            }
            var c = $("#cell_" + Scrabble.Board._arrowPosition.x + "_" + Scrabble.Board._arrowPosition.y);
            if (!(c.children().length === 0 || (c.children().length === 1 && c.children()[0].id == "wordTypeFocus"))) {
                var f = Scrabble.Board.findNextCell(Scrabble.Board._arrowPosition.x, Scrabble.Board._arrowPosition.y, false);
                if (f != undefined) {
                    Scrabble.Board.setFocusKeyboard(f);
                    Scrabble.Board.setFocusArrow(f, false)
                }
            }
            d = null;
            c = null
        },setFocus: function(c) {
            if (Scrabble.Board._wordTypeDirection == a || Scrabble.Board._wordTypeDirection == null) {
                Scrabble.Board.setFocusRight()
            } else {
                Scrabble.Board.setFocusBottom()
            }
            Scrabble.Board.setFocusArrow(c);
            Scrabble.Board.setFocusKeyboard(c);
            var d = $(document);
            $(document).off("keydown", Scrabble.Board.keyPress);
            $(document).on("keydown", Scrabble.Board.keyPress);
            d = null
        },setFocusArrow: function(c, e) {
            var d = $("#wordTypeFocus");
            if (e != false) {
                Scrabble.Board._arrowPosition = c.attr("id").split("_");
                Scrabble.Board._arrowPosition = {x: parseInt(Scrabble.Board._arrowPosition[1]),y: parseInt(Scrabble.Board._arrowPosition[2])}
            }
            if (c.children().length === 0 || (c.children().length === 1 && c.children()[0].id == "wordTypeFocus")) {
                d.show()
            } else {
                d.hide()
            }
            c.append(d);
            d = null
        },hideFocusArrow: function() {
            var c = $("#wordTypeFocus");
            c.css("display", "none");
            Scrabble.Board._arrowPosition = {x: -1,y: -1};
            c = null
        },setFocusKeyboard: function(c) {
            if (typeof c != "undefined") {
                var d = c.attr("id");
                d = d.split("_");
                Scrabble.Board._wordTypePosition = {x: parseInt(d[1]),y: parseInt(d[2])}
            }
        },setFocusRight: function() {
            var c = $("#wordTypeFocus");
            if (c.css("display") == "none") {
                c.show()
            }
            c.addClass("wordTypeFocusRight");
            c.removeClass("wordTypeFocusBottom");
            Scrabble.Board._wordTypeDirection = a;
            c = null
        },setFocusBottom: function() {
            var c = $("#wordTypeFocus");
            if (c.css("display") == "none") {
                c.show()
            }
            c.removeClass("wordTypeFocusRight");
            c.addClass("wordTypeFocusBottom");
            Scrabble.Board._wordTypeDirection = b;
            c = null
        },hideFocus: function(d) {
            var c = $("#wordTypeFocus");
            c.hide();
            Scrabble.Board._wordTypePosition = null;
            if (d != false) {
                $(document).off("keydown", Scrabble.Board.keyPress);
                Scrabble.Board._arrowPosition = {x: -1,y: -1}
            }
            c = null
        },addTileToCell: function(d, c) {
            if (Scrabble.Board._wordTypePosition != null) {
                if (Scrabble.GameServerManager.isMyTurn() == false) {
                    d.fadeTo(0, 0.85)
                } else {
                    d.fadeTo(0, 1)
                }
                Scrabble.Board._currentTile = d.attr("data-id");
                Scrabble.SoundManager.playRoll("Drop_b", 5);
                Scrabble.Board.addTileToOrder(d);
                $("#cell_" + Scrabble.Board._wordTypePosition.x + "_" + Scrabble.Board._wordTypePosition.y).append(d);
                if (d.attr("data-letter") == "BLANK") {
                    d.css("top", "-2px");
                    d.attr("data-letter", c);
                    d.attr("data-temp_letter", c);
                    var e = d.find(".tileLetterRed");
                    e.removeClass("letter_BLANK");
                    e.addClass("letter_" + c)
                }
                Scrabble.Board.focusNextCell(Scrabble.Board._wordTypePosition.x, Scrabble.Board._wordTypePosition.y, false);
                Scrabble.Board.updateScorePreview();
                Scrabble.GameScene.updateSkip()
            }
        },removeTileById: function(d) {
            var c = $('#board [data-id="' + d + '"]');
            Scrabble.Board.removeTile(c);
            c = null
        },removeTile: function(d) {
            d.css("opacity", 1);
            Scrabble.SoundManager.playRoll("Grab_b", 5);
            Scrabble.Board._currentTile = undefined;
            id = d.attr("data-id");
            for (i = 0; i < Scrabble.Board._tilesOrder.length; i++) {
                if (Scrabble.Board._tilesOrder[i] == id) {
                    Scrabble.Board._tilesOrder.splice(i, 1)
                }
            }
            var c = d.parent();
            $("#" + Scrabble.TileRack.getEmptyRackSpaceId()).append(d);
            var f = d.attr("data-temp_letter");
            if (f != undefined) {
                d.attr("data-letter", "BLANK");
                d.attr("data-temp_letter", "");
                var e = d.find(".tileLetterRed");
                e.removeClass("letter_" + f);
                e.addClass("letter_BLANK")
            }
            Scrabble.Board.setFocus(c);
            Scrabble.Board.updateScorePreview();
            Scrabble.GameScene.updateSkip()
        },endWordType: function() {
            $("#wordTypeFocus").hide();
            $(document).off("keydown", Scrabble.Board.keyPress)
        },keyPress: function(l) {
            if (Scrabble.Board.lock == false) {
                if (Scrabble.GameServerManager.currentGame() != undefined) {
                    var c = getLetterFromKey(l.which);
                    if (c != false) {
                        Scrabble.TipManager.removeTips();
                        c = c.toUpperCase();
                        var h = $('#tileRackContainer [data-letter="' + c + '"]');
                        if (h.length == 0) {
                            h = $('#tileRackContainer [data-letter="BLANK"]')
                        }
                        if (h.length > 0) {
                            var k = $(h[0]);
                            Scrabble.Board.addTileToCell(k, c)
                        }
                    } else {
                        if (l.which == 8 || l.which == 46) {
                            $(".active").trigger("mouseleave");
                            if (Scrabble.PopupManager.hasPopupOpened == false) {
                                l.stopPropagation();
                                l.preventDefault();
                                if (Scrabble.Board._currentTile == undefined) {
                                    var o;
                                    if (Scrabble.Board._wordTypeDirection == a) {
                                        o = "x"
                                    } else {
                                        o = "y"
                                    }
                                    var d = false;
                                    var d = false;
                                    while (d == false) {
                                        if ($("#board").find('[data-tile_active="active"]').length > 0) {
                                            Scrabble.Board._wordTypePosition[o]--;
                                            if (Scrabble.Board._wordTypePosition[o] < 0) {
                                                Scrabble.Board._wordTypePosition[o] = 0;
                                                break
                                            }
                                            var q = $("#cell_" + Scrabble.Board._wordTypePosition.x + "_" + Scrabble.Board._wordTypePosition.y);
                                            if (!(q.children().length === 0 || (q.children().length === 1 && q.children()[0].id == "wordTypeFocus"))) {
                                                var j = q.find('[data-tile_active="active"]');
                                                if (j.length > 0) {
                                                    d = true;
                                                    Scrabble.Board.removeTile(j)
                                                }
                                            }
                                            q = null
                                        } else {
                                            break
                                        }
                                    }
                                }
                                if (!d && Scrabble.Board._tilesOrder.length > 0) {
                                    if (Scrabble.Board._currentTile != undefined) {
                                        tileId = Scrabble.Board._currentTile
                                    } else {
                                        tileId = Scrabble.Board._tilesOrder.pop()
                                    }
                                    Scrabble.Board.removeTileById(tileId)
                                }
                            }
                            return false
                        } else {
                            if (l.which >= 37 && l.which <= 40) {
                                l.stopPropagation();
                                l.preventDefault();
                                var f, n;
                                if (l.which == 37) {
                                    f = "x";
                                    n = -1
                                } else {
                                    if (l.which == 38) {
                                        f = "y";
                                        n = -1
                                    } else {
                                        if (l.which == 39) {
                                            f = "x";
                                            n = 1
                                        } else {
                                            if (l.which == 40) {
                                                f = "y";
                                                n = 1
                                            }
                                        }
                                    }
                                }
                                var m = false;
                                var g = Scrabble.Board._wordTypePosition[f];
                                var q;
                                while (m == false) {
                                    Scrabble.Board._wordTypePosition[f] += n;
                                    if (Scrabble.Board._wordTypePosition[f] > 14 || Scrabble.Board._wordTypePosition[f] < 0) {
                                        Scrabble.Board._wordTypePosition[f] = g;
                                        break
                                    }
                                    q = $("#cell_" + Scrabble.Board._wordTypePosition.x + "_" + Scrabble.Board._wordTypePosition.y);
                                    if (q.children().length === 0 || (q.children().length === 1 && q.children()[0].id == "wordTypeFocus")) {
                                        Scrabble.Board.setFocus(q);
                                        m = true
                                    }
                                }
                                q = null;
                                return false
                            } else {
                                if (l.which == 32) {
                                    l.stopPropagation();
                                    l.preventDefault();
                                    Scrabble.Board.toggleFocus(false)
                                }
                            }
                        }
                    }
                }
            }
        },disableBoard: function() {
            var c = $(".boardCell");
            var d = $(document);
            c.droppable("disable");
            d.off("click", Scrabble.Board.checkWordType);
            d.off("keydown", Scrabble.Board.keyPress);
            c.unbind();
            d = null;
            c = null
        },reEnableBoard: function() {
            var c = $(document);
            $(".boardCell").droppable("enable");
            c.off("click", Scrabble.Board.checkWordType);
            c.on("click", Scrabble.Board.checkWordType);
            c.off("keydown", Scrabble.Board.keyPress);
            c.on("keydown", Scrabble.Board.keyPress);
            c = null
        },getFarTile: function(g) {
            var e = 0;
            var d = 0;
            var f = g.length;
            for (var c = 0; c < f; c++) {
                if (g[c].x > e) {
                    e = g[c].x
                }
                if (g[c].y > d) {
                    d = g[c].y
                }
            }
            return [e, d]
        },getCellBonus: function(c, g) {
            var f = Scrabble.Board.currentBoardModel.specialTiles;
            var e = f.length;
            for (var d = 0; d < e; d++) {
                if (f[d][1] == c && f[d][2] == g) {
                    return f[d][0]
                }
            }
            return 0
        },updateScorePreview: function() {
            if (Scrabble.Board.overlayOpened == false) {
                if (Scrabble.GameScene.lastPlayVisible == true) {
                    $("#lastScorePreviewIndicator").show()
                } else {
                    $("#lastScorePreviewIndicator").hide()
                }
                var d = Scrabble.PlayValidation.validatePlay();
                var c = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                if (c == undefined) {
                    c = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
                }
                if (c != undefined) {
                    if (d != false && d != "skip") {
                        var g = $("#scorePreviewIndicator");
                        g.show();
                        var f = d[0][d[0].length - 1];
                        if (f != undefined && f.x != undefined) {
                            var e = $("#cell_" + f.x + "_" + f.y).offset();
                            g.offset({left: e.left + 5,top: e.top + 24});
                            g.find("p").html(d[1]);
                            if (Scrabble.GameScene.lastPlayVisible == true) {
                                if (f.x == Scrabble.GameScene.lastPlayCoords[0] && f.y == Scrabble.GameScene.lastPlayCoords[1]) {
                                    $("#lastScorePreviewIndicator").hide()
                                } else {
                                    $("#lastScorePreviewIndicator").show()
                                }
                            }
                            e = null
                        }
                    } else {
                        $("#scorePreviewIndicator").hide()
                    }
                } else {
                    $("#scorePreviewIndicator").hide()
                }
            } else {
                $("#scorePreviewIndicator").hide()
            }
        }}
}();
Scrabble.GameScene = function() {
    var b = "delete";
    var f = "";
    var c = false;
    var j = false;
    var g = false;
    var d = false;
    var e = null;
    var a = false;
    var k = null;
    var h = 2;
    return {isWaitingForPlayValidation: false,_lastPlayObj: null,_wordSoundIndex: 0,_letterSoundIndex: 0,lastPlayVisible: false,lastPlayCoords: [-1, -1],boardAnimated: false,waitingConfirmation: false,isSkip: false,allowNextGame: false,hasSkipped: false,animationTimer: null,isNudgeEnabled: false,isForceForfeitEnabled: false,animatedPlayIsBingo: false,animatedPlayScore: null,animatedPrimaryWord: null,lastValidWord: null,scorePreviewAnimation: null,gameCardScoreAnimation: null,waitForNextPlay: false,isLaunch: true,seenSuggestions: false,seenSurveyPopup: false,cloneGameScene: function(l) {
            if (Scrabble.GameScene.waitingConfirmation || Scrabble.GameScene.isWaitingForPlayValidation) {
                Scrabble.GameScene.restoreAll(false)
            }
            $("#scorePreview").hide();
            Scrabble.LeftMenu.lockList();
            var q = $("#absoluteTileContainer .tile");
            if ($("#absoluteTileContainer .fromRack").length != 0) {
                q.offset({left: "0px",top: "0px"});
                q.css({left: "-2px",top: "-2px"});
                if (Scrabble.TileManager.tilePastSpace.find(".tile").length == 0) {
                    Scrabble.TileManager.tilePastSpace.append($("#absoluteTileContainer .tile"))
                } else {
                    var o = Scrabble.TileRack.getEmptyRackSpaceId();
                    $("#" + o).append($("#absoluteTileContainer .tile"))
                }
            }
            if ($("#absoluteTileContainer .fromBoard").length != 0) {
                q.offset({left: "0px",top: "0px"});
                q.css({left: "-2px",top: "-2px"});
                Scrabble.TileManager.tilePastCell.append($("#absoluteTileContainer .tile"))
            }
            q.remove();
            $("#oldGameScene").remove();
            var n = $("#boardContainer");
            var m = n.clone().attr("id", "newGameScene");
            n.before(m);
            n.attr("id", "oldGameScene");
            $("#newGameScene .tile").remove();
            $("#newGameScene").css("top", "550px");
            Scrabble.TileManager.destroyTiles(true);
            Scrabble.GameScene.transitionBoards()
        },transitionBoards: function() {
            Scrabble.GameScene.boardAnimated = true;
            $("#newGameScene").animate({top: "0px"}, 750, "easeOutQuad", function() {
                Scrabble.GameScene.boardAnimated = false;
                setTimeout(function() {
                    $("#newGameScene").attr("id", "boardContainer");
                    Scrabble.GameScene.init(true)
                }, 250)
            });
            $("#oldGameScene").animate({top: "-550px"}, 750, "easeOutQuad", function() {
                setTimeout(function() {
                    $("#oldGameScene").remove();
                    $("absoluteTileContainer .tile").remove()
                }, 250)
            })
        },init: function(m) {
            Scrabble.LeftMenu.unlockList();
            Scrabble.Board.lock = false;
            b = "";
            f = "";
            $("#gsLoadingMessage").html(Scrabble.Dictionary.translate("DFLT_TXT_LDNG"));
            $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_PASS"));
            $("#tradeTilesBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_EXCHANGE"));
            $("#shuffleBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_SHUFFLE"));
            $("#forfeitBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_FORFEIT"));
            $("#viewBoardBtn p").html(Scrabble.Dictionary.translate("GSCNEND_LBL_VEWBRD"));
            $("#rematchBtn p").html(Scrabble.Dictionary.translate("GSCNEND_LBL_RMTCH"));
            Scrabble.GameScene.hasSkipped = false;
            if (m == undefined) {
                Scrabble.Board.createBoard(Scrabble.BoardModels.boards.Default);
                Scrabble.TradeTilesPopup.init();
                Scrabble.TileRack.init();
                Scrabble.GameScene.setEnvironment()
            } else {
                Scrabble.Board.enableBoard();
                Scrabble.TileRack.enableTileRack();
                Scrabble.TileManager.enableTiles();
                $("#forfeitBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_FORFEIT"));
                Scrabble.GameScene.updateBotMenu()
            }
            if (Scrabble.GameScene.isLaunch) {
                var l = Scrabble.LocalStorageManager.get("showBonusLetters");
                if (l === "false") {
                    Scrabble.OptionsMenu.toggleShowBonusLetters()
                }
            }
            Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.TransitionComplete)
        },setMatch: function(r, s) {
            if (Scrabble.GameScene.isLaunch === true && Scrabble.config.firstTime != true) {
                Scrabble.GameScene.isLaunch = false;
                setTimeout(function() {
                    if (Scrabble.GameScene.seenSuggestions == false && $("#myTurnGamesList .match").length == 0) {
                        if (Scrabble.GameServerManager.currentGame() == undefined || Scrabble.GameServerManager.currentGame().board == undefined || Scrabble.GameServerManager.currentGame().board.currentturnuserid != Scrabble.GameServerManager.token().uid) {
                            if (Scrabble.GameServerManager.currentGame().state != "COMPLETE" && Scrabble.OnboardManager.onboardStepQueue.length == 0) {
                                Scrabble.GameScene.seenSuggestions = true;
                                Scrabble.PopupManager.add(Scrabble.SuggestionPopup)
                            }
                        }
                    }
                }, 3000)
            }
            $("#lastScorePreviewIndicator").hide();
            if (r.length) {
                var m = 0, l = 1, n = 2, u = 3, t = null, q = null;
                for (var o = 0; o < r.length; o++) {
                    q = r[o].split(",");
                    if (q.length > 1) {
                        t = Scrabble.TileFactory.createTile(q[n], false, q[u]);
                        Scrabble.Board.addTile(t, q[l], q[m])
                    }
                }
            }
            Scrabble.GameScene.lastPlayVisible = false;
            if (!Scrabble.GameScene.isWaitingForPlayValidation && s.hasOwnProperty("word") && s.hasOwnProperty("score")) {
                Scrabble.GameScene.highlightLastWord(s)
            } else {
                Scrabble.GameScene._lastPlayObj = s
            }
        },highlightLastWord: function(q) {
            var u;
            if (q.word instanceof Array) {
                u = q.word[0]
            } else {
                u = q.word
            }
            console.log(q);
            u = u.split(":")[1];
            var s = u.split(";");
            $("#board .yellowTileBase").removeClass("yellowTileBase");
            var t = s.length - 1;
            var l, A, r, z, m;
            for (var o = 0; o < t; o++) {
                l = s[o];
                A = l.split(",");
                r = A[2];
                z = $('[data-id="' + r + '"]');
                z.find(".tileBase").addClass("yellowTileBase");
                m = z.find(".tileGlow");
                m.show();
                m.toggleClass("yellowGlow");
                if (o == t - 1) {
                    var v = $("#lastScorePreviewIndicator");
                    var x = "Red";
                    if (q.user == Scrabble.PlayerManager.currentUser.mayhemId && $("#board .active").length == 0) {
                        x = "Blue"
                    }
                    v.find(".scoreIndicatorLeft").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsPointsIndicator_Left" + x + "_fix_" + Scrabble.config._branding + ".png')");
                    v.find(".scoreIndicatorMiddle").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsPointsIndicator_Middle" + x + "_" + Scrabble.config._branding + ".png')");
                    v.find(".scoreIndicatorRight").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsPointsIndicator_Right" + x + "_" + Scrabble.config._branding + ".png')");
                    v.find("p").html(q.score);
                    setTimeout(function() {
                        var B = z.offset();
                        v.show();
                        v.offset({left: B.left + 5,top: B.top + 26});
                        z = null;
                        v = null
                    }, 1000);
                    var n = z.parent().attr("id").split("_");
                    Scrabble.GameScene.lastPlayCoords = [n[1], n[2]];
                    Scrabble.GameScene.lastPlayVisible = true
                }
            }
            if ($("#endGamePopup").css("display") == "block") {
                $("#lastScorePreviewIndicator").hide()
            }
        },resetBoard: function() {
            Scrabble.TileManager.destroyTiles();
            $("#board .tile").remove();
            $("#tileRackContainer .tile").remove();
            $("#tradeTilesPopup").hide();
            $("#wildTilePopup").hide();
            $("#scorePreviewIndicator").hide()
        },setEnvironment: function() {
            Scrabble.Board.enableBoard();
            Scrabble.TileRack.enableTileRack();
            Scrabble.TileManager.enableTiles();
            Scrabble.GameScene.enableBotMenu();
            $("#versionNumber").on("click", function() {
                var l = $("#scorePreviewIndicator p");
                var m = parseInt(l.html());
                m += 20;
                Scrabble.AnimationManager.animateTextIncrementation(l, m)
            })
        },enableBotMenu: function() {
            $("#playBtn").click(Scrabble.GameScene._playClicked);
            $("#tradeTilesBtn").click(function() {
                if (!Scrabble.Board.wildTileOpened) {
                    if (Scrabble.Board.overlayOpened == false) {
                        Scrabble.SoundManager.play_sfx("Generic_btn");
                        Scrabble.TileRack.recallTiles();
                        Scrabble.TradeTilesPopup.show(j)
                    } else {
                        Scrabble.SoundManager.play_sfx("Cancel");
                        Scrabble.TradeTilesPopup.hide()
                    }
                }
            });
            $("#shuffleBtn").click(function() {
                if (g && Scrabble.Board.overlayOpened == false) {
                    if (Scrabble.PlayValidation.getActiveTiles().length == 0) {
                        if (Scrabble.GameScene.waitingConfirmation == false && Scrabble.GameScene.isWaitingForPlayValidation == false) {
                            Scrabble.TileRack.shuffleTiles()
                        }
                    } else {
                        $("#shuffleBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_SHUFFLE"));
                        $("#shuffleBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconShuffle00_" + Scrabble.config._branding + ".png')");
                        $("#scorePreview").hide();
                        Scrabble.TileRack.recallTiles()
                    }
                }
            });
            $("#forfeitBtn").click(function() {
                if (c && !Scrabble.Board.overlayOpened) {
                    Scrabble.SoundManager.play_sfx("Generic_btn");
                    Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forfeitConfirmed);
                    Scrabble.EventManager.bindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forfeitConfirmed);
                    var l = {type: "warningPopup",title: (b == "delete") ? Scrabble.Dictionary.translate("GSCNPP_TXT_DLTGM_TTL") : Scrabble.Dictionary.translate("GSCNPP_TXT_FRFTGM_TTL"),message: (b == "delete") ? Scrabble.Dictionary.translate("GSCNPP_TXT_DLTGM_MSG") : Scrabble.Dictionary.translate("GSCNPP_TXT_FRFTGM_MSG"),diag: {cancel: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNG_CNCL"},confirm: {action: Scrabble.UserEvents.ForfeitConfirmed,label: (b == "delete") ? "GSCNPP_BTN_DLTGM_OK" : "GSCNPP_BTN_FRFTGM_OK"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(l))
                }
            })
        },_playClicked: function() {
            if (!Scrabble.Board.overlayOpened) {
                if (f == "nudge") {
                    Scrabble.GameServerManager.postNudge(Scrabble.GameServerManager.currentMatch, "nudge", true);
                    f = "";
                    Scrabble.GameScene.showNextButton();
                    $("#gameScene .loadingWheel").show()
                } else {
                    if (f == "forceForfeit") {
                        var m = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                        Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forceForfeitConfirmed);
                        Scrabble.EventManager.bindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forceForfeitConfirmed);
                        var n = Scrabble.PlayerManager.getPlayerInfo(m.board.currentturnuserid, "first_name");
                        n = trimName(n, "", 11);
                        var l = {type: "warningPopup",title: Scrabble.Dictionary.translate("GSCNPP_TXT_FRCFRFTGM_TTL"),message: Scrabble.Dictionary.translate("GSCNPP_TXT_FRCFRFTGM_MSG", {"[PLAYER_NAME]": n}),diag: {cancel: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNG_CNCL"},confirm: {action: Scrabble.UserEvents.ForfeitConfirmed,label: "FCBK_BTN_FRCEFRFTPP_OK"}}};
                        Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(l));
                        if (Scrabble.config.lang == "fr") {
                            $("#scrabblePopup .popupMid").css("min-height", "125px");
                            $("#scrabblePopup .popupDialogZone").css("top", "145px")
                        }
                    } else {
                        if (Scrabble.GameScene.isSkip == true && Scrabble.GameScene.hasSkipped == false) {
                            Scrabble.GameScene.restoreAll(true);
                            Scrabble.GameScene.waitForNextPlay = true;
                            setTimeout(function() {
                                Scrabble.GameScene.waitForNextPlay = false
                            }, 500)
                        } else {
                            if (Scrabble.GameScene.allowNextGame == true && Scrabble.GameScene.waitingConfirmation == false && Scrabble.GameScene.isWaitingForPlayValidation == false && !Scrabble.GameScene.waitForNextPlay) {
                                setTimeout(function() {
                                    Scrabble.LeftMenu.loadFirstInList();
                                    Scrabble.GameScene.allowNextGame = false;
                                    Scrabble.GameScene.waitForNextPlay = false
                                }, 500)
                            } else {
                                if (Scrabble.GameScene.waitingConfirmation == false && Scrabble.GameScene.isWaitingForPlayValidation == false) {
                                    Scrabble.GameScene.submitPlay()
                                }
                            }
                        }
                    }
                }
            }
        },_forfeitConfirmed: function() {
            a = true;
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forfeitConfirmed);
            Scrabble.PopupManager.close();
            $("#shuffleBtn").hide();
            $("#forfeitBtn").hide();
            $("#tradeTilesBtn").hide();
            $(".tilesLeft").hide();
            $("#playBtn").hide();
            var m = Scrabble.PlayerManager.getCurrentGameOpponents();
            if (b == "forfeit") {
                Scrabble.TelemetryManager.sendGameEnd(Scrabble.GameServerManager.currentGame(), "forfeit_self");
                Scrabble.SocialPlatformManager.call("sendForfeit", m, function() {
                    Scrabble.EndGamePopup.show(true, false);
                    Scrabble.GameServerManager.deleteMatch(false)
                });
                Scrabble.LeftMenu.archiveMatch(Scrabble.GameServerManager.currentMatch, true)
            } else {
                if (b == "delete") {
                    var l = Scrabble.GameServerManager.currentGame();
                    Scrabble.TelemetryManager.sendGameEnd(l, "resign");
                    if (((Scrabble.GamesList.getPlaysFor(Scrabble.PlayerManager.currentUser.mayhemId, l) || (Scrabble.GamesList.hasValidPlay(l) && l.access == "PRIVATE")) || l.mmatchusers.matchuser.length > 2) && m != "") {
                        l = null;
                        Scrabble.SocialPlatformManager.call("sendResign", m, function() {
                            Scrabble.GameServerManager.deleteMatch(true)
                        })
                    } else {
                        Scrabble.GameServerManager.deleteMatch(true)
                    }
                }
            }
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchDeleted, Scrabble.GameScene.handleMatchDeleted)
        },_forceForfeitConfirmed: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameScene._forceForfeitConfirmed);
            Scrabble.PopupManager.close();
            if (f == "forceForfeit") {
                Scrabble.GameServerManager.postForceForfeit();
                $("#gameScene .loadingWheel").show();
                $(".tilesLeft").hide()
            }
            f = ""
        },submitPlay: function() {
            if ($("#popupContainer").css("display") == "none") {
                if (d) {
                    Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation);
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameScene._endAnimation);
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameScene.turnPlayed);
                    Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.SkipConfirmed, Scrabble.GameScene._confirmSkip);
                    $(".active").trigger("mouseleave");
                    var m = Scrabble.PlayValidation.validatePlay();
                    if (m != false && m != "skip" && Scrabble.PlayValidation.getActiveTiles().length != 0) {
                        Scrabble.SoundManager.play_sfx("Play");
                        Scrabble.GameScene._submitPlay();
                        Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameScene._endAnimation);
                        Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameScene.turnPlayed);
                        Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation);
                        Scrabble.GameScene.waitingConfirmation = true;
                        Scrabble.GameScene.isWaitingForPlayValidation = true
                    } else {
                        if (m == "skip") {
                            var n = "GSCNPP_TXT_PSSTRN_MSG";
                            if (Scrabble.GamesList.numSkips("SKIP_TURN") == 5) {
                                n = "GSCNPP_TXT_GMENDNGMVPSS_MSG"
                            }
                            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.SkipConfirmed, Scrabble.GameScene._confirmSkip);
                            var l = {type: "warningPopup",title: Scrabble.Dictionary.translate("GSCNPP_TXT_PSSTRN_TTL"),message: Scrabble.Dictionary.translate(n),diag: {cancel: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNG_CNCL"},confirm: {action: Scrabble.UserEvents.SkipConfirmed,label: "GSCN_LBL_PASS"}}};
                            Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(l));
                            if (Scrabble.config.lang == "fr" && Scrabble.GamesList.numSkips("SKIP_TURN") == 5) {
                                $("#scrabblePopup p:not(.popupTitle)").addClass("popupMessage  typo_black");
                                $("#scrabblePopup .popupMid").css("min-height", "110px");
                                $("#scrabblePopup .popupDialogZone").css("top", "135px")
                            }
                        } else {
                            var l = {type: "noticePopup",title: Scrabble.Dictionary.translate("GSCNPP_TXT_INVLDPLY_TTL"),message: Scrabble.Dictionary.translate(Scrabble.PlayValidation.errorMessage),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_TXT_INVLDWRD_CLS"}}};
                            Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(l))
                        }
                    }
                }
            }
        },_endAnimation: function() {
            if (Scrabble.GameScene.scorePreviewAnimation != null) {
                clearInterval(Scrabble.GameScene.scorePreviewAnimation);
                Scrabble.GameScene.scorePreviewAnimation = null
            }
            if (Scrabble.GameScene.gameCardScoreAnimation != null) {
                clearInterval(Scrabble.GameScene.gameCardScoreAnimation);
                Scrabble.GameScene.gameCardScoreAnimation = null
            }
            Scrabble.PlayerCards.buildPlayerCards("curr", false, false, true);
            if (Scrabble.GameServerManager.currentGame() != null) {
                Scrabble.GameScene.sendTurnAppRequest(Scrabble.GameServerManager.currentGame())
            } else {
                if (Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch) != null) {
                    Scrabble.GameScene.sendTurnAppRequest(Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch))
                }
            }
        },turnPlayed: function() {
            $(".tempPreviewIndicator .scoreIndicatorMiddle p").html(Scrabble.GameScene.animatedPlayScore);
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameScene.turnPlayed)
        },_submitPlay: function() {
            $("#gsLoadingMessage").html(Scrabble.Dictionary.translate("FCBK_TXT_SNDNGMV"));
            $("#gameScene .loadingWheel").show();
            $("#wordTypeFocus").hide();
            Scrabble.GameServerManager.postPlay(Scrabble.PlayValidation.getActiveTiles());
            Scrabble.TileManager.deactivateTilesOnBoard();
            j = false;
            d = false;
            var l = $("#playBtn");
            l.fadeTo(0, 0.5);
            l.addClass("fadedBtn");
            Scrabble.LeftMenu.lockList();
            Scrabble.GameScene.hasSkipped = false;
            $("#tempPreviewIndicator").hide();
            var m = $("#scorePreviewIndicator").clone();
            m.appendTo($("#scorePreviewIndicator").parent());
            m.addClass("tempPreviewIndicator");
            m.removeAttr("id");
            m.css("z-index", "100")
        },sendTurnAppRequest: function(l) {
            console.log("SEND TURN APP REQUEST");
            if (l == null) {
                return false
            }
            Scrabble.SocialPlatformManager.call("publishTurn", Scrabble.GameScene._finishTurn);
            if (!l.plays.play.length) {
                var n = [];
                for (var m = 0; m < l.mmatchusers.matchuser.length; m++) {
                    if (l.mmatchusers.matchuser[m].userid != Scrabble.PlayerManager.currentUser.mayhemId) {
                        n.push(Scrabble.PlayerManager.getPlayerInfo(l.mmatchusers.matchuser[m].userid, "fbId"))
                    }
                }
                if (n.length > 0) {
                    console.log("AAAAAAAAAAA");
                    players = n.join(",")
                } else {
                    console.log("BBBBBBBBBBB")
                }
            }
        },displayAd: function() {
            Scrabble.Interstitials.incrementTurnsPlayed()
        },_finishTurn: function() {
            if (!Scrabble.Interstitials.isShowingAdNextTurn()) {
                if (Scrabble.GameServerManager.currentGame().state != "COMPLETE") {
                    if (Scrabble.GameScene.seenSuggestions == false && ($("#myTurnGames .match").length) <= 0 && Scrabble.QuestPopup.isOpen != true && Scrabble.Store.isOpen != true) {
                        setTimeout(function() {
                            if (Scrabble.QuestPopup.isOpen != true) {
                                Scrabble.GameScene.seenSuggestions = true;
                                Scrabble.PopupManager.add(Scrabble.SuggestionPopup)
                            }
                        }, 1000)
                    }
                    if (Scrabble.GameScene.seenSurveyPopup == false && Scrabble.config.lang == "en" && parseInt(Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.TOTAL_GAMES.id]) >= 1) {
                        Scrabble.GameScene.seenSurveyPopup = true;
                        if (Scrabble.LocalStorageManager.localStorageEnabled) {
                            var l = Scrabble.LocalStorageManager.get("surveyShown");
                            if (l == true) {
                                return false
                            } else {
                                var m = Scrabble.LocalStorageManager.get("surveyQAttempts");
                                if (m != null && parseInt(m) < h) {
                                    Scrabble.LocalStorageManager.set("surveyQAttempts", parseInt(m) + 1)
                                } else {
                                    if (m == null) {
                                        Scrabble.LocalStorageManager.set("surveyQAttempts", 1)
                                    } else {
                                        return false
                                    }
                                }
                                if (Scrabble.config._marketingSurvey != "") {
                                    Scrabble.EventManager.bindEvent("openSurveyLink", Scrabble.GameScene._openSurvey);
                                    Scrabble.PopupManager.add(Scrabble.PopupFactory.surveyPopup())
                                }
                            }
                        }
                    }
                }
            }
            Scrabble.GameScene.displayAd()
        },_openSurvey: function() {
            Scrabble.EventManager.unbindEvent("openSurveyLink", Scrabble.GameScene._openSurvey);
            Scrabble.PopupManager.close();
            Scrabble.LocalStorageManager.set("surveyShown", true);
            var l = window.open();
            l.location = Scrabble.config._marketingSurvey
        },_confirmSkip: function() {
            Scrabble.TelemetryManager.sendPass(Scrabble.GameServerManager.currentGame());
            Scrabble.SoundManager.play_sfx("Play");
            Scrabble.GameScene.waitingConfirmation = true;
            Scrabble.PopupManager.close();
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.SkipConfirmed, Scrabble.GameScene._confirmSkip);
            Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.skipEnd);
            Scrabble.GameScene._submitPlay()
        },skipEnd: function() {
            Scrabble.SocialPlatformManager.call("publishTurn", Scrabble.GameScene._finishTurn);
            Scrabble.LeftMenu.unlockList()
        },handlePlayValidation: function(l) {
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation);
            Scrabble.GameScene.animationTimer = setTimeout(function() {
                var J = Scrabble.GameServerManager.matchList[l];
                var F = J.plays.play;
                var C;
                if (F instanceof Array) {
                    C = F[F.length - 1]
                } else {
                    C = F
                }
                Scrabble.GameScene.animatedPlayScore = C.score;
                var r = C.useruri.split("/")[2];
                var q = $("#gameCard_" + r + " .gameCardScore");
                var o;
                if (C.allwords.word instanceof Array) {
                    o = C.allwords.word
                } else {
                    o = [C.allwords.word]
                }
                var n = [];
                var E = C.playdata;
                var t = E.split(";");
                var m = [];
                for (var K = 0; K < (t.length - 1); K++) {
                    m.push(t[K].split(",")[2])
                }
                var v = o.length;
                var s, A, z, u, x;
                for (var H = 0; H < v; H++) {
                    var D = {};
                    s = o[H];
                    if (H == 0) {
                        Scrabble.GameScene.animatedPrimaryWord = parseWordData(s)
                    }
                    A = s.split(":");
                    D.score = A[0];
                    z = A[1].split(";");
                    D.letters = [];
                    x = z.length - 1;
                    for (var G = 0; G < x; G++) {
                        u = z[G].split(",");
                        D.letters.push(u[2])
                    }
                    n.push(D)
                }
                var I = (C.playdata.split(";").length == 8) ? true : false;
                var M = false;
                if (Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId] != undefined && C.score > Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.HIGH_WORD.id].score) {
                    M = true;
                    Scrabble.StatsManager.updateStatField(Scrabble.PlayerManager.currentUser.mayhemId, Scrabble.StatType.HIGH_WORD.id, {word: parseWordData(o[0]),score: C.score})
                }
                if (I && Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId] != undefined) {
                    Scrabble.StatsManager.updateStatField(Scrabble.PlayerManager.currentUser.mayhemId, Scrabble.StatType.TOTAL_BINGOS.id, Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.TOTAL_BINGOS.id] + 1)
                }
                v = o.length;
                var B = [];
                var L;
                for (H = 0; H < v; H++) {
                    s = o[H];
                    A = s.split(";");
                    x = A.length - 1;
                    L = "";
                    for (G = 0; G < x; G++) {
                        z = A[G].split(",");
                        L += z[3]
                    }
                    B.push(L)
                }
                Scrabble.TelemetryManager.sendPlay(B, C.score, I, M, J);
                Scrabble.GameScene.displayPlaySuccess(n, r, I, m, B)
            }, 350)
        },handleMatchDeleted: function(l) {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.MatchDeleted, Scrabble.GameScene.handleMatchDeleted);
            a = false
        },updateBotMenu: function(u, t, m) {
            console.warn("Updating bot menu");
            $("#tradeBagLabel").html(m);
            Scrabble.GameScene.isForceForfeitEnabled = false;
            Scrabble.GameScene.isNudgeEnabled = false;
            f = "";
            if (Scrabble.GameServerManager.currentMatch != "" && u != true) {
                if (Scrabble.GameServerManager.currentMatchState != "COMPLETE") {
                    var v = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                    if (v == undefined) {
                        v = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
                    }
                    if (v.board.currentturnuserid == Scrabble.PlayerManager.currentUser.mayhemId) {
                        if (v.board.bagsize >= 7) {
                            j = true
                        } else {
                            j = false
                        }
                        $("#tradeBagLabel").html(v.board.bagsize);
                        $("#board .tile").fadeTo(0, 1);
                        d = true;
                        var r = $("#playBtn");
                        r.removeClass("fadedBtn");
                        r.fadeTo(0, 1);
                        r.css("cursor", "pointer");
                        Scrabble.GameScene.allowNextGame = false;
                        Scrabble.GameScene.updateSkip()
                    } else {
                        $("#board .active").fadeTo(0, 0.85);
                        d = false;
                        if (Scrabble.GameScene.isWaitingForPlayValidation == true) {
                            var s = $("#playBtn");
                            s.fadeTo(0, 0.5);
                            s.addClass("fadedBtn")
                        } else {
                            Scrabble.GameScene.showNextButton()
                        }
                        j = false;
                        $("#tradeBagLabel").html(v.board.bagsize);
                        if (v.mmatchusers.matchuser.length) {
                            for (var q = 0; q < v.mmatchusers.matchuser.length; q++) {
                                if (v.mmatchusers.matchuser[q].userid != Scrabble.PlayerManager.currentUser.mayhemId) {
                                    if (v.mmatchusers.matchuser[q].nudgeavailability == "NUDGE_FORFEIT") {
                                        Scrabble.GameScene.isForceForfeitEnabled = true
                                    } else {
                                        if (v.mmatchusers.matchuser[q].nudgeavailability == "NUDGE") {
                                            Scrabble.GameScene.isNudgeEnabled = true
                                        }
                                    }
                                }
                            }
                        }
                    }
                    var l = $("#tradeTilesBtn");
                    l.fadeTo(0, 1);
                    l.removeClass("fadedBtn");
                    l.css("cursor", "pointer");
                    c = true;
                    var o = $("#forfeitBtn");
                    o.removeClass("fadedBtn");
                    o.fadeTo(0, 1);
                    o.css("cursor", "pointer");
                    g = true;
                    var x = $("#shuffleBtn");
                    x.removeClass("fadedBtn");
                    x.fadeTo(0, 1);
                    x.css("cursor", "pointer");
                    var n = 0;
                    if (v.plays.play) {
                        if (v.plays.play.length) {
                            for (var q = 0; q < v.plays.play.length; q++) {
                                var z = v.plays.play[q].playtype;
                                if (z == "SWAP_TILES" || z == "SKIP_TURN" || z == "PLAY_WORD") {
                                    if (v.plays.play[q].useruri.substring(7) == Scrabble.PlayerManager.currentUser.mayhemId) {
                                        n++
                                    }
                                }
                            }
                        } else {
                            var z = v.plays.play.playtype;
                            if (v.plays.play.useruri.substring(7) == Scrabble.PlayerManager.currentUser.mayhemId && (z == "SWAP_TILES" || z == "SKIP_TURN" || z == "PLAY_WORD")) {
                                n++
                            }
                        }
                    }
                    if (v.board.deleteavailability == "FORFEIT") {
                        b = "forfeit";
                        $("#forfeitBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconForfeit00_" + Scrabble.config._branding + ".png')");
                        $("#forfeitBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_FORFEIT"))
                    } else {
                        b = "delete";
                        $("#forfeitBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconResign00_" + Scrabble.config._branding + ".png')");
                        $("#forfeitBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_DELETE"))
                    }
                    if (Scrabble.GameScene.isForceForfeitEnabled) {
                        f = "forceForfeit";
                        $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconForceForfeit00_" + Scrabble.config._branding + ".png')");
                        $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_FFORFEIT"));
                        var s = $("#playBtn");
                        s.fadeTo(0, 1);
                        s.css("cursor", "pointer");
                        s.removeClass("fadedBtn")
                    } else {
                        if (Scrabble.GameScene.isNudgeEnabled) {
                            f = "nudge";
                            $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconNudge_" + Scrabble.config._branding + ".png')");
                            $("#playBtn p").html(Scrabble.Dictionary.translate("FCBK_LBL_NDGPP_NDG"));
                            var s = $("#playBtn");
                            s.fadeTo(0, 1);
                            s.css("cursor", "pointer");
                            s.removeClass("fadedBtn")
                        }
                    }
                    if (t || (v.state == "COMPLETE" && !Scrabble.GameScene.isWaitingForPlayValidation)) {
                        Scrabble.TileManager.disableTiles();
                        $("#shuffleBtn").hide();
                        $("#forfeitBtn").hide();
                        $("#tradeTilesBtn").hide();
                        $("#playBtn").hide();
                        $("#rematchBtn").show();
                        $("#viewBoardBtn").show()
                    } else {
                        Scrabble.TileManager.reEnableTiles();
                        $("#shuffleBtn").show();
                        $("#forfeitBtn").show();
                        $("#tradeTilesBtn").show();
                        $("#playBtn").show();
                        $("#rematchBtn").hide();
                        $("#viewBoardBtn").hide()
                    }
                } else {
                    $("#shuffleBtn").hide();
                    $("#forfeitBtn").hide();
                    $("#tradeTilesBtn").hide();
                    $("#playBtn").hide();
                    $("#rematchBtn").show();
                    $("#viewBoardBtn").show();
                    Scrabble.TileManager.disableTiles()
                }
            } else {
                c = false;
                var o = $("#forfeitBtn");
                o.fadeTo(0, 0.5);
                o.addClass("fadedBtn");
                o.css("cursor", "default");
                j = false;
                g = false;
                var x = $("#shuffleBtn");
                x.fadeTo(0, 0.5);
                x.addClass("fadedBtn");
                x.css("cursor", "default");
                d = false;
                var s = $("#playBtn");
                s.fadeTo(0, 0.5);
                s.addClass("fadedBtn");
                s.css("cursor", "default")
            }
        },showNextButton: function() {
            $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconNext00_" + Scrabble.config._branding + ".png')");
            $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_NEXT"));
            var m = $("#myTurnGamesList .match");
            if (m[1] != null || (m[0] != null && $(m[0]).attr("data-match_id") != Scrabble.GameServerManager.currentMatch.substring(9))) {
                Scrabble.GameScene.allowNextGame = true;
                var l = $("#playBtn");
                l.fadeTo(0, 1);
                l.removeClass("fadedBtn");
                l.css("cursor", "pointer")
            } else {
                Scrabble.GameScene.allowNextGame = false;
                var l = $("#playBtn");
                l.fadeTo(0, 0.5);
                l.addClass("fadedBtn");
                l.css("cursor", "default")
            }
        },updateSkip: function() {
            if (Scrabble.GameScene.isForceForfeitEnabled == false && Scrabble.GameScene.isNudgeEnabled == false) {
                if (Scrabble.PlayValidation.getActiveTiles().length == 0) {
                    if (Scrabble.GameScene.allowNextGame == false) {
                        $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_PASS"));
                        $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconSkip00_" + Scrabble.config._branding + ".png')")
                    }
                    $("#shuffleBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_SHUFFLE"));
                    $("#shuffleBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconShuffle00_" + Scrabble.config._branding + ".png')")
                } else {
                    if (Scrabble.GameScene.allowNextGame == false) {
                        $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_PLAY"));
                        $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconPlay00_" + Scrabble.config._branding + ".png')")
                    }
                    $("#shuffleBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_RECALL"));
                    $("#shuffleBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconRecall00_" + Scrabble.config._branding + ".png')")
                }
            } else {
                if (Scrabble.GameScene.isForceForfeitEnabled == true) {
                    $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconForceForfeit00_" + Scrabble.config._branding + ".png')");
                    $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_FFORFEIT"));
                    $("#playBtn").fadeTo(0, 1);
                    $("#playBtn").css("cursor", "pointer");
                    $("#playBtn").removeClass("fadedBtn")
                } else {
                    if (Scrabble.GameScene.isNudgeEnabled == true) {
                        $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconNudge_" + Scrabble.config._branding + ".png')");
                        $("#playBtn p").html(Scrabble.Dictionary.translate("FCBK_LBL_NDGPP_NDG"));
                        $("#playBtn").fadeTo(0, 1);
                        $("#playBtn").css("cursor", "pointer");
                        $("#playBtn").removeClass("fadedBtn")
                    }
                }
            }
        },displayPlaySuccess: function(q, u, G, o, A) {
            Scrabble.Board.lock = true;
            if (Scrabble.QuestPopup.isToyotaQuestActive == true && Scrabble.QuestPopup.isToyotaQuestCompleted == false) {
                Scrabble.QuestPopup.checkValidWord(A)
            }
            Scrabble.GameScene.lastValidWord = q[0];
            Scrabble.GameScene.animatedPlayIsBingo = G;
            Scrabble.GameScene.addSkipButton();
            $(".tempPreviewIndicator").hide();
            $("#scorePreviewIndicator p").html("0");
            $("#scorePreviewIndicator").show();
            Scrabble.GameScene._letterSoundIndex = 0;
            Scrabble.GameScene._wordSoundIndex = 0;
            Scrabble.SoundManager.play_sfx("Word_score");
            var v = q.length;
            var H, x, C, r, t, n, l;
            var m = 0;
            var F = 0;
            var B = [];
            var I = $("#boardContainer");
            for (var E = 0; E < v; E++) {
                H = q[E];
                x = H.letters.length;
                for (var D = 0; D < x; D++) {
                    F = 200 * E;
                    C = $('[data-id="' + H.letters[D] + '"]');
                    C.find(".tileBase").addClass("yellowTileBase");
                    r = $(Scrabble.DomBuilder.buildGlow("yellow"));
                    I.append(r);
                    var s = C.parent().offset();
                    s.left -= 5;
                    s.top -= 5;
                    r.css("z-index", 49 - E - D);
                    r.fadeIn(0);
                    r.offset(s);
                    r.fadeOut(0);
                    if (D == x - 1) {
                        t = true;
                        if (E == 0) {
                            n = C.offset();
                            $("#scorePreviewIndicator").offset({left: n.left + 8,top: n.top + 24})
                        }
                    } else {
                        t = false
                    }
                    var z;
                    if (o.indexOf(H.letters[D] + "") != -1) {
                        z = true
                    } else {
                        z = false
                    }
                    if (Scrabble.GameScene.hasSkipped != true) {
                        Scrabble.GameScene._successTileGlowInOut(C, r, D * 100 + m * 100 + F, t, H.score, u, G, z, q[0])
                    } else {
                        Scrabble.GameScene.removeSkipButton();
                        Scrabble.GameScene.hasSkipped = false;
                        return true
                    }
                }
                m += x
            }
            Scrabble.GameScene.animationTimer = setTimeout(function() {
                Scrabble.GameScene._successTilesHighlightCallback(u, G, q[0])
            }, m * 150 + F + 500)
        },_successTileGlowInOut: function(o, n, r, s, q, u, l, m, t) {
            Scrabble.AnimationManager.fadeInOut(n, r, 50, 50, function() {
                o.addClass("success");
                o.find(".tileBase").addClass("whiteTileBase")
            }, function() {
                var B = Scrabble.TileManager.getSquareType(o);
                if (B != "normalSquare" && m && Scrabble.GameScene.hasSkipped == false && Scrabble.AnimationManager.animationsEnabled) {
                    var A = B;
                    if (A == "startingPoint") {
                        A = "doubleWord"
                    }
                    if (A == "doubleWord" || A == "tripleWord") {
                        Scrabble.SoundManager.playSequence("Word", Scrabble.GameScene._wordSoundIndex, 7)
                    } else {
                        Scrabble.SoundManager.playSequence("Letter", Scrabble.GameScene._letterSoundIndex, 7)
                    }
                    var E = Scrabble.BonusSquareParticle.addParticle(A);
                    var z = $("#" + E);
                    var v = o.offset();
                    z.offset({left: v.left - 7,top: v.top - 20});
                    var D = Scrabble.TileManager.getSquarePosition(o);
                    var C = (parseInt(D.x) < 13) ? "+=50" : "-=50";
                    var x = (parseInt(D.y) < 1) ? "+=70" : "-=70";
                    z.animate({left: C,top: x}, {duration: 250,specialEasing: {left: "easeInQuad",top: "linear"},complete: function() {
                            z.find(".bonusSquareParticleGlow").fadeOut("slow", function() {
                            });
                            z.find(".bonusSquareParticle").fadeOut("slow", function() {
                                z.remove()
                            })
                        },queue: false});
                    z.find(".bonusSquareParticleGlow").animate({left: "-=10",top: "-=10",width: "+=20",height: "+=20"}, {duration: 249,queue: false})
                }
            }, function() {
                n.remove();
                o.removeClass("success");
                o.find(".tileBase").removeClass("whiteTileBase");
                if (s && Scrabble.GameScene.hasSkipped == false && Scrabble.GameScene.isWaitingForPlayValidation) {
                    Scrabble.GameScene._addScoreToIndicator(q)
                }
            })
        },_successTilesHighlightCallback: function(C, o, B) {
            Scrabble.Board.lock = false;
            if (Scrabble.GameScene.hasSkipped != true) {
                var s = $("#gameCard_" + C + " .gameCardScore");
                var l = s.offset();
                var z = $("#scrabbleGame").offset();
                var v = $("#scorePreviewIndicator p").html();
                var q = parseInt(s.html());
                var A = parseInt(v) + parseInt(q);
                $(".tempPreviewIndicator").remove();
                var x = $("#scorePreviewIndicator").clone();
                x.appendTo($("#scorePreviewIndicator").parent());
                x.addClass("tempPreviewIndicator");
                x.removeAttr("id");
                x.find("p").html(Scrabble.GameScene.animatedPlayScore);
                x.css("z-index", "39");
                $("#scorePreviewIndicator").hide();
                Scrabble.SoundManager.play_sfx("ScoreTravel");
                Scrabble.LeftMenu.unlockList();
                $("#board .yellowTileBase").removeClass("yellowTileBase");
                var u = B.letters.length;
                for (var r = 0; r < u; r++) {
                    $('[data-id="' + B.letters[r] + '"]').find(".tileBase").addClass("yellowTileBase")
                }
                if (o && Scrabble.AnimationManager.animationsEnabled) {
                    var m = Scrabble.BonusSquareParticle.addParticle("bingo");
                    var t = $("#" + m);
                    var n = s.offset();
                    t.offset({left: (n.left + 50),top: n.top});
                    t.css("display", "block");
                    Scrabble.SoundManager.play_sfx("Bingo");
                    Scrabble.AnimationManager.animateTextIncrementation($(".tempPreviewIndicator p"), parseInt(v) + 50);
                    t.animate({top: "+=50"}, 350, function() {
                        t.fadeOut(300, function() {
                            t.remove()
                        });
                        q = s.html();
                        A = parseInt(q) + 50;
                        s.html(A);
                        if (Scrabble.GameScene.isWaitingForPlayValidation) {
                            Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord, function() {
                                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, null);
                                Scrabble.GameScene.removeSkipButton();
                                Scrabble.GameScene.hasSkipped = false
                            })
                        } else {
                            Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord)
                        }
                        Scrabble.GameScene.isWaitingForPlayValidation = false
                    });
                    t.find(".bonusSquareParticleGlow").animate({left: "-=10",top: "-=10",width: "+=20",height: "+=20"}, {duration: 399,queue: false})
                } else {
                    if (o) {
                        if (Scrabble.GameScene.isWaitingForPlayValidation) {
                            Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord, function() {
                                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, null);
                                Scrabble.GameScene.removeSkipButton();
                                Scrabble.GameScene.hasSkipped = false
                            })
                        } else {
                            Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord)
                        }
                        Scrabble.GameScene.isWaitingForPlayValidation = false
                    } else {
                        if (Scrabble.GameScene.isWaitingForPlayValidation) {
                            Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, null)
                        }
                        Scrabble.GameScene.isWaitingForPlayValidation = false
                    }
                }
                Scrabble.GameScene.removeSkipButton();
                Scrabble.GameScene.hasSkipped = false
            } else {
                Scrabble.GameScene.removeSkipButton();
                Scrabble.GameScene.hasSkipped = false
            }
        },_addScoreToIndicator: function(m) {
            if (Scrabble.GameScene.scorePreviewAnimation != null) {
                clearInterval(Scrabble.GameScene.scorePreviewAnimation);
                Scrabble.GameScene.scorePreviewAnimation = null
            }
            if (Scrabble.GameScene.gameCardScoreAnimation != null) {
                clearInterval(Scrabble.GameScene.gameCardScoreAnimation);
                Scrabble.GameScene.gameCardScoreAnimation = null
            }
            var l = $("#scorePreviewIndicator p");
            var n = parseInt(l.html());
            var m = parseInt(m);
            Scrabble.GameScene.scorePreviewAnimation = Scrabble.AnimationManager.animateTextIncrementation(l, n + m);
            l = $("#cardZoneDivision .myTurn").parent().find(".gameCardScore");
            Scrabble.GameScene.gameCardScoreAnimation = Scrabble.AnimationManager.animateTextIncrementation(l, parseInt(l.html()) + m)
        },displayTilesError: function(l) {
            k = l;
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.GameScene._displayTilesError);
            $(".tempPreviewIndicator").remove()
        },_displayTilesError: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.GameScene._displayTilesError);
            Scrabble.LeftMenu.unlockList();
            var q = Scrabble.GameScene._getWordsPlayed();
            erroneousWords = k;
            if (erroneousWords && q != false) {
                var D = q[0];
                var z = q[1];
                var x = erroneousWords.length;
                var E, t, l, B, u, v, C;
                var s = 0;
                var A;
                for (var r = 0; r < x; r++) {
                    E = erroneousWords[r];
                    t = z.indexOf(E);
                    if (t == -1) {
                        continue
                    }
                    z.splice(t, 1);
                    l = D.splice(t, 1)[0];
                    var m = $("#boardContainer");
                    for (var o = 0; o < l.length; o++) {
                        u = l[o].id;
                        v = $('[data-id="' + u + '"]');
                        A = $(Scrabble.DomBuilder.buildGlow("red"));
                        m.append(A);
                        var n = v.parent().offset();
                        n.left -= 5;
                        n.top -= 5;
                        A.css("z-index", 49 - r - o);
                        A.fadeIn(0);
                        A.offset(n);
                        A.fadeOut(0);
                        Scrabble.GameScene._errorTileGlowInOut(A, s, v);
                        s += 75
                    }
                }
            }
            Scrabble.GameScene.waitingConfirmation = false;
            Scrabble.GameScene.isWaitingForPlayValidation = false
        },_errorTileGlowInOut: function(n, l, m) {
            Scrabble.AnimationManager.fadeInOut(n, l, 75, 75, null, null, function() {
                n.remove()
            })
        },restoreAll: function(n) {
            Scrabble.Board.lock = false;
            var m = $("#board .inactive").find(".yellowTileBase");
            m.removeClass(".tileBase yellowTileBase");
            if (Scrabble.GameScene.lastValidWord) {
                for (var l = 0; l < Scrabble.GameScene.lastValidWord.letters.length; l++) {
                    $('[data-id="' + Scrabble.GameScene.lastValidWord.letters[l] + '"]').find(".tileBase").addClass("yellowTileBase")
                }
            }
            clearTimeout(Scrabble.GameScene.animationTimer);
            Scrabble.GameScene.hasSkipped = true;
            if (Scrabble.GameScene.animatedPlayIsBingo) {
                if (n == true && Scrabble.GameScene.isWaitingForPlayValidation) {
                    Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord, function() {
                        Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, null)
                    });
                    Scrabble.GameScene.isWaitingForPlayValidation = false
                } else {
                    Scrabble.SocialPlatformManager.call("publishBingo", Scrabble.GameScene.animatedPlayScore, Scrabble.GameScene.animatedPrimaryWord)
                }
            }
            if (n == true) {
                if (Scrabble.GameScene.scorePreviewAnimation != null) {
                    clearInterval(Scrabble.GameScene.scorePreviewAnimation)
                }
                if (Scrabble.GameScene.gameCardScoreAnimation != null) {
                    clearInterval(Scrabble.GameScene.gameCardScoreAnimation)
                }
                setTimeout(function() {
                    Scrabble.PlayerCards.buildPlayerCards(Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch], false)
                }, 1000);
                if (Scrabble.GameScene.isWaitingForPlayValidation) {
                    Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, null)
                }
                setTimeout(function() {
                    $("#scorePreviewIndicator p").html(Scrabble.GameScene.animatedPlayScore)
                }, 1000)
            }
            $(".tempPreviewIndicator").remove();
            Scrabble.GameScene.waitingConfirmation = false;
            Scrabble.GameScene.isWaitingForPlayValidation = false;
            Scrabble.GameScene.removeSkipButton()
        },addSkipButton: function() {
            $("#playBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconPass00_" + Scrabble.config._branding + ".png')");
            $("#playBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_SKIP"));
            Scrabble.GameScene.isSkip = true;
            d = true;
            var l = $("#playBtn");
            l.fadeTo(0, 1);
            l.removeClass("fadedBtn");
            l.css("cursor", "pointer")
        },removeSkipButton: function() {
            Scrabble.GameScene.isSkip = false;
            d = false;
            Scrabble.GameScene.updateBotMenu()
        },_getWordsPlayed: function() {
            var l = Scrabble.PlayValidation.validatePlay();
            if (l != "skip") {
                var s = l[3];
                if (s) {
                    s.push(l[0])
                } else {
                    return false
                }
                var q = s.length;
                var t, o;
                var r = [];
                for (var n = 0; n < q; n++) {
                    t = s[n];
                    o = "";
                    for (var m = 0; m < t.length; m++) {
                        o += t[m].letter
                    }
                    r.push(o)
                }
                return [s, r]
            }
        }}
}();
Scrabble.TileRack = function() {
    return {containerId: "tileRackContainer",rackSpaceIdBase: "tileRackSpace_",containerChildNodes: null,isAnimating: false,isOnCooldown: false,matchesSavedTiles: {},currentRackMatchId: null,init: function() {
            document.getElementById(this.containerId).innerHTML = Scrabble.DomBuilder.tileRackConstruct(Scrabble.TileRack.rackSpaceIdBase);
            this.containerChildNodes = document.getElementById(this.containerId).childNodes;
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                if (typeof localStorage.matchesSavedTiles != "undefined") {
                    Scrabble.TileRack.matchesSavedTiles = JSON.parse(localStorage.matchesSavedTiles)
                }
            }
            $(window).unload(function() {
                Scrabble.TileRack.saveTilesOrdering()
            });
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.TileRack.removeOldGamesSavedTiles)
        },setBlank: function(a) {
            a.draggable.fadeTo(0, 1);
            a.draggable.removeClass("grabbed");
            a.draggable.offset({left: "0px",top: "0px"});
            a.draggable.css({left: "-2px",top: "-2px"});
            if (a.draggable[0].getAttribute("data-temp_letter") != undefined && !Scrabble.TileManager.tileLastContainer.hasClass("tileRackSpace")) {
                Scrabble.TileManager.removeWildTileValue(a.draggable[0])
            }
        },enableTileRack: function() {
            $(".tileRackSpace").droppable({tolerance: "pointer",drop: function(b, a) {
                    Scrabble.SoundManager.playRoll("Drop_r", 5);
                    Scrabble.Board.updateScorePreview();
                    if (this.childNodes.length === 0) {
                        $(this).append(a.draggable);
                        Scrabble.TileRack.setBlank(a)
                    }
                },over: function(h, j) {
                    thisChildNodes = this.childNodes;
                    if (thisChildNodes.length === 1) {
                        var a = $(this);
                        var f = parseInt(a.attr("id").substr(14, 1));
                        var b, l, d;
                        for (var c = f; c < 7; c++) {
                            b = $("#tileRackSpace_" + c);
                            l = b.children();
                            if (l.length == 0) {
                                d = parseInt(b.attr("id").substr(14, 1));
                                break
                            }
                        }
                        if (typeof emptyRackSpace == "undefined") {
                            for (c = f; c >= 0; c--) {
                                b = $("#tileRackSpace_" + c);
                                l = b.children();
                                if (l.length == 0) {
                                    d = parseInt(b.attr("id").substr(14, 1));
                                    break
                                }
                            }
                        }
                        var g, k;
                        if (d > f) {
                            for (c = f; c < d; c++) {
                                b = $("#tileRackSpace_" + c);
                                l = b.children();
                                g = $(l[0]);
                                k = $("#tileRackSpace_" + (c + 1));
                                k.append(g);
                                Scrabble.TileRack.isAnimating = true;
                                g.css("left", "-56px");
                                b = null;
                                l = null;
                                k = null;
                                g.animate({left: "-2px"}, 200, function() {
                                    Scrabble.TileRack.isAnimating = false
                                })
                            }
                        } else {
                            for (c = f; c > d; c--) {
                                b = $("#tileRackSpace_" + c);
                                l = b.children();
                                g = $(l[0]);
                                k = $("#tileRackSpace_" + (c - 1));
                                k.append(g);
                                Scrabble.TileRack.isAnimating = true;
                                g.css("left", "56px");
                                b = null;
                                l = null;
                                k = null;
                                g.animate({left: "-2px"}, 200, function() {
                                    Scrabble.TileRack.isAnimating = false
                                })
                            }
                        }
                    }
                }})
        },saveTilesOrdering: function() {
            if (Scrabble.TileRack.currentRackMatchId != null && $(".tileRackSpace .tile").length != 0) {
                Scrabble.TileRack.matchesSavedTiles[Scrabble.TileRack.currentRackMatchId] = [];
                var d = document.getElementById(this.containerId).childNodes;
                for (var c = 0; c < d.length; c++) {
                    if (d[c].childNodes.length > 0) {
                        var a = $(d[c].childNodes[0]).attr("data-id");
                        Scrabble.TileRack.matchesSavedTiles[Scrabble.TileRack.currentRackMatchId].push(a)
                    }
                }
                if (Scrabble.LocalStorageManager.localStorageEnabled) {
                    var b = Scrabble.GameServerManager.matchList[Scrabble.TileRack.currentRackMatchId];
                    if (b == null || b.state == "COMPLETE") {
                        return
                    }
                    if (typeof localStorage.matchesSavedTiles == "undefined") {
                        localStorage.matchesSavedTiles = "{}"
                    }
                    localStorage.matchesSavedTiles = JSON.stringify(Scrabble.TileRack.matchesSavedTiles)
                }
            }
        },removeOldGamesSavedTiles: function() {
            for (var a in Scrabble.TileRack.matchesSavedTiles) {
                if (Scrabble.GameServerManager.matchList.hasOwnProperty(a) == false) {
                    delete Scrabble.TileRack.matchesSavedTiles[a]
                }
            }
            localStorage.matchesSavedTiles = JSON.stringify(Scrabble.TileRack.matchesSavedTiles)
        },loadTiles: function(j, c) {
            Scrabble.TileRack.saveTilesOrdering();
            if (c && Scrabble.AnimationManager.animationsEnabled) {
                Scrabble.TileRack.popOutTiles(j)
            } else {
                Scrabble.TileRack.currentRackMatchId = Scrabble.GameServerManager.currentMatch;
                if (j != "[object Object]") {
                    $(".tileRackSpace .tile").remove();
                    var b = j.split(",");
                    if (b.length == 1 && b[0] == "") {
                        Scrabble.GameScene.updateBotMenu(true)
                    } else {
                        var f = null;
                        var a = Scrabble.TileRack.matchesSavedTiles[Scrabble.GameServerManager.currentMatch];
                        var g = true;
                        if (a != null && a.length == b.length) {
                            var d = {};
                            for (var e = 0; e < a.length; e++) {
                                d[a[e]] = 1
                            }
                            for (var e = 0; e < b.length; e++) {
                                if (d[b[e]] != 1) {
                                    g = false;
                                    break
                                }
                            }
                        } else {
                            g = false
                        }
                        if (a != null && g) {
                            for (var e = 0; e < b.length; e++) {
                                var h = Scrabble.TileRack.matchesSavedTiles[Scrabble.GameServerManager.currentMatch][e];
                                if (h != "") {
                                    f = Scrabble.TileFactory.createTile(h, "active");
                                    Scrabble.TileRack.addTileAsMarkup(f)
                                }
                            }
                        } else {
                            Scrabble.TileRack.matchesSavedTiles[Scrabble.GameServerManager.currentMatch] = [];
                            for (var e = 0; e < b.length; e++) {
                                if (b[e] != "") {
                                    f = Scrabble.TileFactory.createTile(b[e], "active");
                                    Scrabble.TileRack.addTileAsMarkup(f)
                                }
                            }
                        }
                        Scrabble.TileManager.enableTiles()
                    }
                }
            }
        },popOutTiles: function(a) {
            var b = $(".tileRackSpace .tile").length;
            $(".tileRackSpace .tile").each(function(c) {
                $(this).animate({top: "10px",opacity: 0}, 100, function() {
                    $(this).remove();
                    if (c == b - 1) {
                        setTimeout(function() {
                            Scrabble.TileRack.loadTiles(a);
                            Scrabble.TileRack.popInTiles()
                        }, 400)
                    }
                })
            });
            if ($(".tileRackSpace .tile").length == 0) {
                setTimeout(function() {
                    Scrabble.TileRack.loadTiles(a);
                    Scrabble.TileRack.popInTiles()
                }, 400)
            }
        },popInTiles: function() {
            var a = $(".tileRackSpace .tile");
            a.css("top", "-85px");
            a.css("opacity", 0);
            Scrabble.AnimationManager.animateElements(a, {top: "-2px",opacity: 1}, 150, "easeOutQuad", 50)
        },addTileAsMarkup: function(b) {
            var a = this.getEmptyRackSpaceId(true);
            if (a === false) {
                return false
            }
            var c = this.containerChildNodes[a];
            $("#tileRackSpace_" + a + " .tile").css({left: "-2px",top: "-2px"});
            c.innerHTML = b;
            return c.firstChild
        },addTileAsMarkupAt: function(b, a) {
            if (a < 0 || a > 5) {
                console.log("Invalid TileRack index '" + a + "' :: TileRack function addTileAsMarkupAt.");
                return false
            }
            if (this.containerChildNodes[a].childNodes.length === 0) {
                this.containerChildNodes[a].innerHTML = b
            }
            $("#tileRackSpace_" + a + " .tile").css({left: "-2px",top: "-2px"})
        },getEmptyRackSpaceId: function(b, d) {
            if (typeof d == "undefined") {
                d = 0
            }
            var c = false;
            var a = 0;
            while (!c && a < 7) {
                if (this.containerChildNodes[a].innerHTML == "") {
                    if (d == 0) {
                        c = true
                    } else {
                        d--;
                        a++
                    }
                } else {
                    a++
                }
            }
            if (b == true) {
                return a
            } else {
                return this.rackSpaceIdBase + a
            }
        },getTilesInRack: function() {
            var c = document.getElementById(this.containerId).childNodes;
            var a = [];
            for (var b = 0; b < c.length; b++) {
                if (c[b].childNodes.length > 0) {
                    a.push(c[b].childNodes[0])
                }
            }
            return a
        },recallTile: function(b) {
            if (this.isAnimating) {
                return false
            }
            Scrabble.TileRack.isAnimating = true;
            var a = Scrabble.TileRack.getEmptyRackSpaceId(false);
            Scrabble.TileRack.sendTileToRackSpace(b, a, true)
        },recallTiles: function() {
            if (this.isAnimating) {
                return false
            }
            $("#scorePreviewIndicator").hide();
            if ($("#absoluteTileContainer .dropped").length != 0) {
                var o = $("#absoluteTileContainer .tile");
                o.offset({left: "0px",top: "0px"});
                o.css({left: "-2px",top: "-2px"});
                Scrabble.TileManager.tilePastCell.append(o)
            }
            var d = $('[data-tile_active="active"]');
            var b = document.getElementById("board");
            var j = document.getElementById("tradeTilesPopup");
            var c = document.getElementById("absoluteTileContainer");
            var m = [];
            for (var h = 0; h < d.length; h++) {
                try {
                    if ($.contains(b, d[h])) {
                        m.push(d[h]);
                        if (d[h].hasAttribute("data-temp_letter")) {
                            Scrabble.TileManager.removeWildTileValue(d[h])
                        }
                        $(d[h]).removeClass("fromBoard").addClass("fromRack")
                    } else {
                        if ($.contains(j, d[h])) {
                            m.push(d[h])
                        } else {
                            if ($.contains(c, d[h])) {
                                m.push(d[h])
                            }
                        }
                    }
                } catch (k) {
                    console.log("Recall tiles error : " + k)
                }
            }
            if (m.length == 0) {
                return false
            }
            var a = [], n, g;
            var l = m.length;
            for (h = 0; h < l; h++) {
                a[h] = Scrabble.TileRack.getEmptyRackSpaceId(false, h);
                g = h * 100;
                var f = (h == l - 1) ? true : false;
                Scrabble.TileRack._sendTileToRackSpace(m[h], a[h], f, g)
            }
            Scrabble.TileRack.isAnimating = true;
            Scrabble.TelemetryManager.sendRecall(Scrabble.GameServerManager.currentGame())
        },_sendTileToRackSpace: function(b, d, c, a) {
            setTimeout(function() {
                Scrabble.TileRack.sendTileToRackSpace(b, d, c)
            }, a)
        },sendTileToRackSpace: function(a, d, b) {
            var c = $("#" + d);
            var a = $(a);
            if (Scrabble.AnimationManager.animationsEnabled) {
                tileOffset = a.offset();
                a.css("z-index", 200);
                c.append(a);
                c = null;
                a.offset(tileOffset);
                a.animate({left: "-2px",top: "-2px"}, {duration: 200,queue: false,easing: "easeInOutQuad",complete: function() {
                        Scrabble.SoundManager.playRoll("Drop_r", 5);
                        a.attr("style", "");
                        a.fadeTo(0, 1);
                        Scrabble.Board.removeTileFromOrder(a);
                        if (b) {
                            Scrabble.TileRack._recallEnd()
                        }
                    }})
            } else {
                c.append(a);
                a.css({left: "-2px",top: "-2px"});
                Scrabble.TileRack._recallEnd()
            }
        },_recallEnd: function() {
            Scrabble.TileRack.isAnimating = false;
            Scrabble.GameScene.updateSkip();
            Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.RecallAnimationDone)
        },shuffleTiles: function() {
            if (Scrabble.TileRack.isAnimating || Scrabble.GameScene.boardAnimated) {
                return
            }
            Scrabble.TileManager.disableTiles();
            Scrabble.TileRack.isAnimating = true;
            var b = Scrabble.TileRack.getTilesInRack();
            var a = [];
            var c;
            while (b.length > 0) {
                c = Math.round(Math.random() * (b.length - 1));
                a.push(b.splice(c, 1))
            }
            Scrabble.SoundManager.playRoll("Shuffle", 2);
            var f = a.length;
            var e, h;
            var g = false;
            for (var d = 0; d < f; d++) {
                e = $(a[d]);
                h = $("#tileRackSpace_" + d);
                if (d == f - 1) {
                    g = true
                }
                Scrabble.TileRack._shuffleTile(e, h, g)
            }
            Scrabble.TelemetryManager.sendShuffle(Scrabble.GameServerManager.currentGame())
        },_shuffleTile: function(g, d, e) {
            if (Scrabble.AnimationManager.animationsEnabled) {
                var a = g.offset();
                var k = d.offset();
                var c = g.parent().attr("id");
                c = c.split("_")[1];
                var f = d.attr("id");
                f = f.split("_")[1];
                if (f == c) {
                    if (e) {
                        g = null;
                        d = null;
                        setTimeout(function() {
                            Scrabble.TileRack.isAnimating = false;
                            Scrabble.TileManager.reEnableTiles()
                        }, 600)
                    }
                    return
                }
                var j = (k.left > a.left) ? -3 : -4;
                g.animate({left: k.left - a.left + j}, 500, "easeOutCirc", function() {
                    g.attr("style", "");
                    d.append(g);
                    if (e) {
                        g = null;
                        d = null;
                        setTimeout(function() {
                            Scrabble.TileRack.isAnimating = false
                        }, 250);
                        Scrabble.TileManager.reEnableTiles()
                    }
                });
                var h = (f > c) ? "-=18" : "+=18";
                var b = (f > c) ? "-2" : "-2";
                g.animate({top: h}, {duration: 250,queue: false,complete: function() {
                        g.animate({top: b}, {duration: 250,queue: false,easing: "easeOutQuad"})
                    }})
            } else {
                d.append(g);
                if (e) {
                    Scrabble.TileRack._shuffleEnd()
                }
            }
        },_shuffleEnd: function() {
            Scrabble.TileRack.isAnimating = false;
            Scrabble.TileManager.reEnableTiles()
        },sortTiles: function() {
            if (this.isAnimating) {
                return false
            }
            var a = this.getTilesInRack();
            AnimationManager.animateElements(a, {marginTop: "10px",opacity: 0}, 100, null, 50, TileRack._sort);
            this.isAnimating = true
        },_sort: function() {
            var b = TileRack.getTilesInRack();
            var a = b.slice();
            a.sort(TileRack._sortTilesAlphabeticallyAsc);
            if (b.compare(a)) {
                a.sort(TileRack._sortTilesAlphabeticallyDesc)
            }
            var d = document.getElementById(TileRack.containerId).childNodes;
            for (var c = 0; c < a.length; c++) {
                var e = d[c];
                if (e.childNodes.length > 0) {
                    e.removeChild(e.firstChild)
                }
                e.appendChild(a[c])
            }
            AnimationManager.animateElements(a, {marginTop: "0px",opacity: 100}, 100, null, 50, TileRack._sortEnd)
        },_sortEnd: function() {
            TileRack.isAnimating = false
        },_sortTilesAlphabeticallyAsc: function(d, c) {
            var f = d.getAttribute("data-letter");
            var e = c.getAttribute("data-letter");
            if (f < e) {
                return -1
            } else {
                if (f == e) {
                    return 0
                } else {
                    return 1
                }
            }
        },_sortTilesAlphabeticallyDesc: function(d, c) {
            var f = d.getAttribute("data-letter");
            var e = c.getAttribute("data-letter");
            if (f < e) {
                return 1
            } else {
                if (f == e) {
                    return 0
                } else {
                    return -1
                }
            }
        }}
}();
Scrabble.GamesList = function() {
    return {cover: null,trimWord: function(d, k, g) {
            var a;
            var e;
            var l = d.useruri.substring(7);
            var m = "";
            if (d instanceof Array) {
                a = d.allwords.word[0]
            } else {
                a = d.allwords.word
            }
            if (d.playdata.split) {
                e = d.playdata.split(";").length
            }
            if (d.playtype == "NUDGE" || d.playtype == "NUDGED_FORFEIT") {
                if (d.nextplayerturn == Scrabble.PlayerManager.currentUser.mayhemId) {
                    return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_USRNDGD")
                } else {
                    return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_OPPNNTNDGD")
                }
            }
            if (a == undefined) {
                if (d.playtype == "SKIP_TURN" || d.playtype == "SWAP_TILES") {
                    if (d.useruri.split("/")[2] == Scrabble.PlayerManager.currentUser.mayhemId) {
                        m = "MENU_TXT_GMCRD_NOWRDPLYD_USER"
                    } else {
                        m = "MENU_TXT_GMCRD_NOWRDPLYD"
                    }
                    return Scrabble.Dictionary.translate(m, {"[OPPONENT_FIRST_NAME]": trimName(Scrabble.PlayerManager.getPlayerInfo(l, "first_name"), "", 8)})
                }
            } else {
                if (typeof (a) != "string") {
                    a = a[0]
                }
            }
            var b = "";
            if (a) {
                var h = a.split(";");
                var o = h.length - 1;
                for (var f = 0; f < o; f++) {
                    var n = h[f];
                    var c = n.split(",")[3];
                    b += c
                }
                if (k) {
                    if (g != Scrabble.PlayerManager.currentUser.mayhemId) {
                        if (d.useruri.split("/")[2] == Scrabble.PlayerManager.currentUser.mayhemId) {
                            m = "MENU_TXT_GMCRD_PNTSFRBYUSR"
                        } else {
                            m = "MENU_TXT_GMCRD_PNTSFRBYWHO"
                        }
                    } else {
                        m = "MENU_TXT_GMCRD_PNTSFRLSTTRN"
                    }
                    return Scrabble.Dictionary.translate(m, {"[OPPONENT_FIRST_NAME]": trimName(Scrabble.PlayerManager.getPlayerInfo(l, "first_name"), "", 8),"[POINTS_SCORED]": d.score})
                } else {
                    return '"' + b + '"'
                }
            } else {
                if (d.playtype == "RESIGN" || d.playtype == "NUDGED_FORFEIT") {
                    return ""
                } else {
                    return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_PSSD", {"[OPPONENT_FIRST_NAME]": ""})
                }
            }
        },checkIfSurrender: function(c, b) {
            if (b.status.indexOf("RESIGNED") != -1) {
                return true
            }
            if (c.plays.play) {
                if (c.plays.play instanceof Array) {
                    for (var a = 0; a < c.plays.play.length; a++) {
                        if (c.plays.play[a].playtype == "RESIGN" || c.plays.play[a].playtype == "NUDGED_FORFEIT") {
                            if (c.plays.play[a].useruri.split("/")[2] == b.userid) {
                                return true
                            }
                        }
                    }
                } else {
                    if (c.plays.play.playtype == "RESIGN" || c.plays.play.playtype == "NUDGED_FORFEIT") {
                        if (c.plays.play.useruri.split("/")[2] == b.userid) {
                            return true
                        }
                    }
                }
            } else {
                return true
            }
            return false
        },trimMove: function(d, h) {
            var a;
            var e;
            var k = d.useruri.substring(7);
            if (d instanceof Array) {
                a = d.allwords.word[0]
            } else {
                a = d.allwords.word
            }
            if (d.playdata.split) {
                e = d.playdata.split(";").length
            }
            if (a == undefined) {
                if (d.playtype == "SKIP_TURN") {
                    return Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_MVS_PSSD")
                }
                if (d.playtype == "SWAP_TILES") {
                    return Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_MVS_EXCHNGD", {"[NUMBER_OF_TILES]": (e - 1)})
                }
                if (d.playtype == "RESIGN") {
                    if (Scrabble.GamesList.getPlaysFor(d.useruri, h) > 1) {
                        return Scrabble.Dictionary.translate("GSCNENDPP_TXT_GSTTS_FRFTED")
                    } else {
                        return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_PLRYRSGND")
                    }
                }
                if (d.playtype == "NUDGE") {
                    if (d.nextplayerturn == Scrabble.PlayerManager.currentUser.mayhemId) {
                        return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_USRNDGD")
                    } else {
                        return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_OPPNNTNDGD")
                    }
                }
                if (d.playtype == "NUDGED_FORFEIT") {
                    return Scrabble.Dictionary.translate("GSCNENDPP_TXT_GSTTS_FRFTED")
                }
            } else {
                if (typeof (a) != "string") {
                    a = a[0]
                }
            }
            var b = "";
            if (a) {
                var g = a.split(";");
                var m = g.length - 1;
                for (var f = 0; f < m; f++) {
                    var l = g[f];
                    var c = l.split(",")[3];
                    b += c
                }
                return '"' + b + '"'
            } else {
                return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_PSSD", {"[PLAYER_NAME]": trimName(Scrabble.PlayerManager.getPlayerInfo(k, "first_name"), "", 6)})
            }
        },trimMessage: function(d, g, k) {
            var a, e, q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_STRTD"), l = "normal";
            var m = d.useruri.substring(7);
            if (d instanceof Array) {
                a = d.allwords.word[0]
            } else {
                a = d.allwords.word
            }
            if (d.playdata.split) {
                e = d.playdata.split(";").length
            }
            if (a instanceof Array) {
                a = a[0]
            }
            var b = [];
            if (a && a.split) {
                var h = a.split(";");
                var o = h.length - 1;
                for (var f = 0; f < o; f++) {
                    var n = h[f];
                    var c = n.split(",")[3];
                    b.push(c)
                }
            }
            if (a == undefined) {
                if (d.playtype == "SKIP_TURN") {
                    q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_PSSD");
                    l = "upset"
                }
                if (d.playtype == "SWAP_TILES") {
                    if ((e - 1) == 1) {
                        q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_ONEEXCHNGD", {"[#_TILES]": (e - 1)})
                    } else {
                        q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_EXCHNGD", {"[#_TILES]": (e - 1)})
                    }
                    l = "trading"
                }
                if (d.playtype == "NUDGE") {
                    l = "upset";
                    if (d.nextplayerturn == Scrabble.PlayerManager.currentUser.mayhemId) {
                        q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_USRNDGD")
                    } else {
                        q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_OPPNNTNDGD")
                    }
                }
                if (d.playtype == "NUDGED_FORFEIT") {
                    l = "sad";
                    q = Scrabble.Dictionary.translate("GSCNENDPP_TXT_GSTTS_FRFTED")
                }
                if (d.playtype == "RESIGN") {
                    if (Scrabble.GamesList.getPlaysFor(d.useruri, k) > 1) {
                        q = Scrabble.Dictionary.translate("GSCNENDPP_TXT_GSTTS_FRFTED");
                        l = "mad"
                    } else {
                        q = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_PLRYRSGND");
                        l = "confuse"
                    }
                }
            } else {
                if (typeof (a) != "string") {
                    a = a[0]
                }
            }
            if (g == Scrabble.PlayerManager.currentUser.mayhemId && l != "confuse" && l != "upset") {
                l = "normal"
            }
            return {teacherMessage: q,teacherFace: l,wordArr: b}
        },hasValidPlay: function(a) {
            var c = 0;
            if (a.plays.play) {
                if (a.plays.play.length == undefined) {
                    a.plays.play = [a.plays.play]
                }
                for (var b = 0; b < a.plays.play.length; b++) {
                    if (a.plays.play[b].playtype != "RESIGN" && a.plays.play[b].playtype != "NUDGE") {
                        return true
                    }
                }
            }
            return false
        },getPlaysFor: function(b, a) {
            var d = 0;
            if (a.plays.play) {
                if (a.plays.play.length == undefined) {
                    a.plays.play = [a.plays.play]
                }
                for (var c = 0; c < a.plays.play.length; c++) {
                    if (a.plays.play[c].playtype != "RESIGN" && a.plays.play[c].playtype != "NUDGE") {
                        if (a.plays.play[c].useruri == b) {
                            d++
                        }
                    }
                }
            }
            return d
        },numSkips: function() {
            var a = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            var c = 0;
            if (a.plays.play) {
                if (a.plays.play.length == undefined) {
                    a.plays.play = [a.plays.play]
                }
                for (var b = a.plays.play.length - 1; b >= 0; b--) {
                    if (a.plays.play[b].playtype == "SKIP_TURN" || a.plays.play[b].playtype == "SWAP_TILES" || a.plays.play[b].playtype == "NUDGE") {
                        if (a.plays.play[b].playtype == "SKIP_TURN" || a.plays.play[b].playtype == "SWAP_TILES") {
                            c++
                        }
                    } else {
                        return c
                    }
                }
            }
            return c
        }}
}();
Scrabble.GameOptionsMenu = function() {
    $div = $("#gameOptionsPopup");
    return {initialized: false,isOpen: false,scrollList: null,dropDownCurrent: 0,dropDownOpen: false,lastOrigin: "",hide: function() {
            if ($div.css("display") != "none") {
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.GameOptionsMenu.isOpen = false;
                $div.hide();
                Scrabble.PopupManager.hideBlocker();
                Scrabble.Board.reEnableBoard();
                Scrabble.HelpMenu.hide();
                if (Scrabble.GameOptionsMenu.dropDownOpen) {
                    Scrabble.GameOptionsMenu.barrelUp()
                }
            }
        },show: function(a) {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.NewGameMenu.hide();
            Scrabble.GameOptionsMenu.lastOrigin = a;
            Scrabble.GameOptionsMenu.isOpen = true;
            if (!Scrabble.GameOptionsMenu.initialized) {
                Scrabble.GameOptionsMenu.initialize()
            }
            Scrabble.GameOptionsMenu.dropDownCurrent = Scrabble.GameServerManager.getDictionaryByName(Scrabble.MatchOptions.dictionary);
            $(".optionsDropdownMiddle").html($(".optionsDropdownItem[data-id=" + Scrabble.GameOptionsMenu.dropDownCurrent + "]").html());
            $div.show();
            Scrabble.PopupManager.showBlocker();
            Scrabble.Board.disableBoard()
        },initialize: function() {
            $div.html(Scrabble.DomBuilder.buildGameOptionsMenu());
            $(".popupCreateXBtn").click(Scrabble.GameOptionsMenu.hide);
            $("#wordsListInfoToken").on("click", Scrabble.GameOptionsMenu.showHelp);
            $("#newGamePopupFriendGameBtn").on("click", function() {
                Scrabble.NewGameMenu.show(Scrabble.GameOptionsMenu.lastOrigin)
            });
            $("#newGamePopupRandomOpponentBtn").on("click", Scrabble.GameOptionsMenu.startRandomGame);
            $(".optionsDropdownRight").click(Scrabble.GameOptionsMenu.barrelDown);
            $(".optionsDropdownMiddle").click(Scrabble.GameOptionsMenu.barrelDown);
            Scrabble.GameOptionsMenu.initialized = true;
            Scrabble.HelpMenu.initialize()
        },startRandomGame: function() {
            Scrabble.SoundManager.play_sfx("Gamescene");
            Scrabble.GameServerManager.postNewMatch(null, null, Scrabble.GameOptionsMenu.lastOrigin);
            Scrabble.GameOptionsMenu.hide()
        },barrelDown: function() {
            if (Scrabble.GameOptionsMenu.dropDownOpen) {
                Scrabble.GameOptionsMenu.barrelUp();
                return
            }
            Scrabble.GameOptionsMenu.dropDownOpen = true;
            $(".blocker").on("click", Scrabble.GameOptionsMenu.barrelUp);
            $(".optionsDropdownItem").on("click", Scrabble.GameOptionsMenu.barrelSelect);
            $dd = $(".optionsDropdown");
            $dd.css("height", "0px");
            $dd.show();
            $dd.animate({height: "294px"}, 200)
        },barrelUp: function() {
            Scrabble.GameOptionsMenu.dropDownOpen = false;
            $(".blocker").off("click", Scrabble.GameOptionsMenu.barrelUp);
            $(".optionsDropdownItem").off("click", Scrabble.GameOptionsMenu.barrelSelect);
            $dd.animate({height: "0px"}, 200), function() {
                $(this).hide()
            }
        },barrelSelect: function(b) {
            var a = $(this).data("id");
            if (a != Scrabble.GameOptionsMenu.dropDownCurrent) {
                Scrabble.GameOptionsMenu.dropDownCurrent = a;
                Scrabble.GameServerManager.updateDictionary(Scrabble.GameOptionsMenu.dropDownCurrent);
                Scrabble.SoundManager.playRoll("Barrel", 4);
                $(".optionsDropdownMiddle").html($(".optionsDropdownItem[data-id=" + Scrabble.GameOptionsMenu.dropDownCurrent + "]").html())
            }
            Scrabble.GameOptionsMenu.barrelUp()
        },showHelp: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.HelpMenu.insideQuickHelp = true;
            Scrabble.HelpMenu.selectTopic(Scrabble.Dictionary.translate("HLP_BTN_DCTNRY"), "HLP_TXT_GMPLY_WRDLST_TTL,FBHLP_TXT_GMPLY_WRDLST_MSG");
            Scrabble.HelpMenu.show()
        }}
}();
Scrabble.HelpMenu = function() {
    return {initialized: false,isOpen: false,insideTopic: false,scrollList: null,insideQuickHelp: false,hide: function(a) {
            Scrabble.HelpMenu.back();
            Scrabble.HelpMenu.isOpen = false;
            $("#helpPopup").hide();
            if (a != true) {
                Scrabble.PopupManager.hideBlocker()
            }
            Scrabble.Board.reEnableBoard()
        },show: function(a) {
            Scrabble.Board.disableBoard();
            Scrabble.HelpMenu.isOpen = true;
            Scrabble.PopupManager.showBlocker();
            $("#helpPopupHeader .popupTitle").html(Scrabble.Dictionary.translate("HLP_LBL_HLP"));
            if (!Scrabble.HelpMenu.initialized) {
                Scrabble.HelpMenu.initialize()
            }
            $("#helpPopup").show();
            $("#credits").hide();
            $("#avalon").hide();
            setTimeout(function() {
                Scrabble.HelpMenu.scrollList.data("jsp").reinitialise()
            }, 100)
        },initialize: function() {
            Scrabble.HelpMenu.initialized = true;
            $("#helpPopup").html(Scrabble.DomBuilder.buildHelpMenu());
            $("#helpCloseButton").click(function() {
                Scrabble.HelpMenu.hide();
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.OptionsMenu.hide()
            });
            $("#helpPopup .smallBackBtn").click(function() {
                Scrabble.HelpMenu.backToHelp();
                Scrabble.SoundManager.play_sfx("Cancel")
            });
            Scrabble.HelpMenu.scrollList = $("#helpList").jScrollPane({showArrows: true});
            Scrabble.HelpMenu.ListDOM = Scrabble.HelpMenu.scrollList.data("jsp").getContentPane();
            $(".helpMenuSctBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.HelpMenu.selectTopic($(this).find("p").html(), $(this).data("content"))
            });
            lang = Scrabble.config.lang;
            $("#scrabbleSupportBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openLink(Scrabble.Dictionary.translate("LNK_TXT_CSTMRSPPRT"))
            });
            $("#scrabbleAgreementBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                window.open(Scrabble.Dictionary.translate("LNK_TXT_EULA"), "_blank")
            });
            $("#scrabblePrivacyBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openLink(Scrabble.Dictionary.translate("LNK_TXT_PRVCYPLCY"))
            });
            $("#scrabbleTermsBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openLink(Scrabble.Dictionary.translate("LNK_TXT_TOS"))
            });
            setTimeout(function() {
                Scrabble.HelpMenu.scrollList.data("jsp").reinitialise()
            }, 100)
        },backToHelp: function() {
            if (Scrabble.HelpMenu.insideTopic == false || Scrabble.HelpMenu.insideQuickHelp) {
                Scrabble.HelpMenu.back();
                Scrabble.HelpMenu.insideQuickHelp = false;
                Scrabble.HelpMenu.hide(true)
            } else {
                Scrabble.HelpMenu.insideTopic = false;
                Scrabble.HelpMenu.back();
                setTimeout(function() {
                    Scrabble.HelpMenu.scrollList.data("jsp").reinitialise()
                }, 100)
            }
        },showCredits: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.HelpMenu.show();
            Scrabble.HelpMenu.insideQuickHelp = true;
            $("#helpPopupHeader .popupTitle").html(Scrabble.Dictionary.translate("ABT_BTN_CREDITS"));
            $("#topicList").hide();
            $("#topicContent").hide();
            $("#credits").show();
            $("#avalon").hide();
            setTimeout(function() {
                Scrabble.HelpMenu.scrollList.data("jsp").reinitialise()
            }, 100)
        },showAvalon: function() {
            Scrabble.HelpMenu.show();
            Scrabble.HelpMenu.insideQuickHelp = true;
            Scrabble.SoundManager.play_sfx("Popup_close");
            $("#helpPopupHeader .popupTitle").html(Scrabble.Dictionary.translate("TYT_BTN_OPTNTYTSPCLBTN"));
            $("#topicList").hide();
            $("#topicContent").hide();
            $("#credits").hide();
            $("#avalon").show();
            setTimeout(function() {
                Scrabble.HelpMenu.scrollList.data("jsp").reinitialise()
            }, 100);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "special_button", {subtype1: "features",subtype2: "option",subtype3: "Toyota"})
        },back: function() {
            $("#topicList").show();
            $("#topicContent").hide();
            $("#helpPopupHeader .popupTitle").html(Scrabble.Dictionary.translate("HLP_LBL_HLP"));
            Scrabble.HelpMenu.insideTopic = false
        },selectTopic: function(d, c) {
            Scrabble.HelpMenu.insideTopic = true;
            $("#topicList").hide();
            $("#topicContent").show();
            var a = c.split(",");
            for (var b = 0; b < a.length; b++) {
                a[b] = Scrabble.Dictionary.translate(a[b]).split("\n").join("<br /><br />")
            }
            a[0] = "<h2>" + a[0] + "</h2>";
            $("#topicContent").html("<div>" + a.join("<br /><br />") + '</div><div class="verticalSpacer"></div>');
            $("#helpPopupHeader .popupTitle").html(d);
            setTimeout(Scrabble.HelpMenu.scrollList.data("jsp").reinitialise, 100);
            if (d = "HLP_TXT_GMPLY_WRDLST_TTL") {
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "help", {subtype1: "options",subtype2: "dictionary"})
            }
        },showAbout: function() {
            SurveyBridge.openLink("https://www.playfish.com/support_page/index.html")
        }}
}();
Scrabble.LeaderBoard = function() {
    var d = 106;
    var c = 100;
    var k = ["RATING", "HIGH_WORD", "TOTAL_BINGOS"];
    var a = {TOTAL_WINS: "FCBK_LBL_LDRBRDS_WNS",HIGH_WORD: "GSCNENDPP_LBL_ADVNCDSTTS_CMP_BSTWRD",HIGH_GAME: "GSCNENDPP_LBL_ADVNCDSTTS_BSTGM",TOTAL_BINGOS: "STTS_LBL_BNGS_TTL",RATING: "FCBK_LBL_LDRBRDS_RTNG"};
    var b = 758;
    var f = 990;
    var j = 4;
    var e = 6;
    var h = 0;
    var g = e;
    return {scrollableAnimating: false,currentStatType: k[0],currentSize: 2,totalScrollableItems: 0,_inviteFriendsCardFilled: false,_friendsList: null,friends: [],_mousedownInterval: null,peoples: 0,isExpanded: true,buffered: false,init: function() {
            $("#lbScrollerLeft").on("mousedown", function(m) {
                if (m.which == 1) {
                    Scrabble.SoundManager.play_sfx("Select");
                    Scrabble.LeaderBoard.leftScroll();
                    Scrabble.LeaderBoard._mousedownInterval = setInterval(Scrabble.LeaderBoard.leftScroll, c - 75);
                    var n = function() {
                        clearInterval(Scrabble.LeaderBoard._mousedownInterval)
                    };
                    $(this).on("mouseup", n);
                    $(this).on("mouseout", n);
                    Scrabble.ProfilePopup.hideIfFromLeaderBoard()
                }
            });
            $("#lbScrollerRight").on("mousedown", function(m) {
                if (m.which == 1) {
                    Scrabble.SoundManager.play_sfx("Select");
                    Scrabble.LeaderBoard.rightScroll();
                    Scrabble.LeaderBoard._mousedownInterval = setInterval(Scrabble.LeaderBoard.rightScroll, c - 75);
                    var n = function() {
                        clearInterval(Scrabble.LeaderBoard._mousedownInterval)
                    };
                    $(this).on("mouseup", n);
                    $(this).on("mouseout", n);
                    Scrabble.ProfilePopup.hideIfFromLeaderBoard()
                }
            });
            $("#lbScrollerMaxLeft").on("mousedown", function(m) {
                if (m.which == 1) {
                    Scrabble.LeaderBoard.maxLeftScroll();
                    Scrabble.SoundManager.play_sfx("SlideTransition")
                }
            });
            $("#lbScrollerMaxRight").on("mousedown", function(m) {
                if (m.which == 1) {
                    Scrabble.LeaderBoard.maxRightScroll();
                    Scrabble.SoundManager.play_sfx("SlideTransition")
                }
            });
            $("#lbOptionLeft").on("click", Scrabble.LeaderBoard.selectOptionLeft);
            $("#lbOptionTitle").on("click", Scrabble.LeaderBoard.selectOptionLeft);
            $("#lbOptionRight").on("click", Scrabble.LeaderBoard.selectOptionRight);
            $("#optionsButton .leftMenuLabel").html(Scrabble.Dictionary.translate("MENU_LBL_OPTIONS"));
            $("#statsButton .leftMenuLabel").html(Scrabble.Dictionary.translate("MENU_LBL_STATS"));
            $("#refreshButton .leftMenuLabel").html(Scrabble.Dictionary.translate("FCBK_TXT_MENU_RFRSH"));
            $("#lbCollapseLabel").html(Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_HD"));
            var l = Scrabble.LocalStorageManager.get("lbexpanded");
            if (l != null && l == "false") {
                Scrabble.LeaderBoard.isExpanded = false;
                Scrabble.LeaderBoard.collapse();
                $("#lbCollapseArrow").removeClass("isExpanded").addClass("isCollapsed");
                $("#lbCollapseLabel").html(Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_SHW"))
            }
            $("#lbCollapseButton").on("click", Scrabble.LeaderBoard.toggleLBCollapse);
            $("#lbScrollable").on("click", ".lbFriendCard", function(m) {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.LeaderBoard.inviteClickHandler(m)
            });
            $(".inviteFriendsBtn").on("click", function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.SocialPlatformManager.call("inviteFriends", "leaderboard_friends", [])
            });
            $("#lbScrollable").on("click", ".currentUserCard,.friendUserCard,.score,.name,.largePosition,.smallPosition", function(m) {
                Scrabble.ProfilePopup.show($(this).parent().attr("data-lb_user_id"), true)
            });
            $("#lbScrollable").on("click", ".playBtn", Scrabble.LeaderBoard.play_from_leaderboard);
            $(".inviteFriendsBtn p").html(Scrabble.Dictionary.translate("FRNDLSTPP_TXT_NOFRNDSWTHSCRABBLE_TTL"));
            $("#lbLeftFeedbackBtn .feedbackTitle").html(Scrabble.Dictionary.translate("FCBK_BTN_PRSSTNTBNT_TTL"));
            $("#lbLeftFeedbackBtn .feedbackSubTitle").html(Scrabble.Dictionary.translate("FCBK_BTN_PRSSTNTBNT_MSG"));
            Scrabble.LeaderBoard.updateOptionTitle();
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.LeaderBoard.fillScrollable);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.GameResized, Scrabble.LeaderBoard.adjustSize)
        },toggleLBCollapse: function() {
            if (Scrabble.LeaderBoard.isExpanded) {
                $("#lbCollapseArrow").removeClass("isExpanded").addClass("isCollapsed");
                $("#lbCollapseLabel").html(Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_SHW"));
                Scrabble.LocalStorageManager.set("lbexpanded", "false");
                Scrabble.LeaderBoard.collapse()
            } else {
                $("#lbCollapseArrow").removeClass("isCollapsed").addClass("isExpanded");
                $("#lbCollapseLabel").html(Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_HD"));
                Scrabble.LocalStorageManager.set("lbexpanded", "true");
                Scrabble.LeaderBoard.expand()
            }
        },collapse: function() {
            $("#lbCollapsed").show();
            $("#lbCollapsedMid").append($("#lbHeader"));
            $("#lbHeader").css("left", "219px");
            $("#lbCollapseButton").css("right", "250px");
            $("#leaderBoard").hide();
            Scrabble.LeaderBoard.isExpanded = false;
            $("#popupContainer").css("height", "81%");
            $("#game_container").css("height", "-=135")
        },expand: function() {
            $("#leaderBoard").show();
            $("#lbMid").prepend($("#lbHeader"));
            $("#lbHeader").css("left", "0px");
            $("#lbCollapseButton").css("right", "-2px");
            $("#lbCollapsed").hide();
            Scrabble.LeaderBoard.isExpanded = true;
            $("#popupContainer").css("height", "97%");
            $("#game_container").css("height", "+=135")
        },adjustSize: function(l) {
            if (l == 2) {
                g = e
            } else {
                g = j
            }
            if (h < Scrabble.LeaderBoard.getMaxScroll()) {
                Scrabble.LeaderBoard.maxRightScroll()
            }
        },getMaxScroll: function() {
            var l = Math.max(Scrabble.LeaderBoard.totalScrollableItems - g, 0);
            return l * d * -1
        },leftScroll: function(l) {
            if (l == undefined) {
                l = 1
            }
            if (!Scrabble.LeaderBoard.scrollableAnimating) {
                Scrabble.LeaderBoard.scrollableAnimating = true;
                h += (d * l);
                if (h > 0) {
                    h = 0
                }
                $("#lbScrollable").animate({left: h + "px"}, c, Scrabble.LeaderBoard.animationDone)
            }
        },maxLeftScroll: function() {
            if (!Scrabble.LeaderBoard.scrollableAnimating) {
                Scrabble.LeaderBoard.scrollableAnimating = true;
                h = 0;
                $("#lbScrollable").animate({left: "0"}, c, Scrabble.LeaderBoard.animationDone)
            }
        },rightScroll: function(n) {
            if (n == undefined) {
                n = 1
            }
            if (!Scrabble.LeaderBoard.scrollableAnimating) {
                var l = h;
                h -= (d * n);
                var m = Scrabble.LeaderBoard.getMaxScroll();
                if (h < m) {
                    h = m
                }
                if (h != l) {
                    Scrabble.LeaderBoard.scrollableAnimating = true;
                    $("#lbScrollable").animate({left: h + "px"}, c, Scrabble.LeaderBoard.animationDone)
                }
            }
        },maxRightScroll: function() {
            if (!Scrabble.LeaderBoard.scrollableAnimating) {
                var l = h;
                var m = Scrabble.LeaderBoard.getMaxScroll();
                h = m;
                if (h != l) {
                    Scrabble.LeaderBoard.scrollableAnimating = true;
                    $("#lbScrollable").animate({left: h + "px"}, c, Scrabble.LeaderBoard.animationDone)
                }
            }
        },selectOptionLeft: function() {
            Scrabble.SoundManager.play_sfx("SlideTransition");
            var l = k.indexOf(Scrabble.LeaderBoard.currentStatType);
            l--;
            if (l < 0) {
                l = k.length - 1
            }
            Scrabble.LeaderBoard.currentStatType = k[l];
            Scrabble.LeaderBoard.updateOptionTitle();
            Scrabble.LeaderBoard.fillScrollable();
            Scrabble.ProfilePopup.hideIfFromLeaderBoard();
            Scrabble.LeaderBoard.maxLeftScroll()
        },selectOptionRight: function() {
            Scrabble.SoundManager.play_sfx("SlideTransition");
            var l = k.indexOf(Scrabble.LeaderBoard.currentStatType);
            l++;
            if (l > k.length - 1) {
                l = 0
            }
            Scrabble.LeaderBoard.currentStatType = k[l];
            Scrabble.LeaderBoard.updateOptionTitle();
            Scrabble.LeaderBoard.fillScrollable();
            Scrabble.ProfilePopup.hideIfFromLeaderBoard();
            Scrabble.LeaderBoard.maxLeftScroll()
        },play_from_leaderboard: function(m) {
            var l = $(m.currentTarget).parent().attr("data-lb_user_id");
            Scrabble.SoundManager.play_sfx("Gamescene");
            Scrabble.GameServerManager.postNewMatch([l], null, "leaderboard")
        },fillScrollable: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.FacebookFriendsRefreshed, Scrabble.LeaderBoard.update);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.FacebookFriendsRefreshed, Scrabble.LeaderBoard.update);
            var N = Scrabble.StatsManager.stats;
            var v = Scrabble.LeaderBoard.currentStatType;
            var A = Scrabble.StatType[v].id;
            var m = [];
            var x;
            for (var O in N) {
                x = true;
                if (N[O].hasOwnProperty(A)) {
                    x = false
                }
                if (!x && v == "HIGH_WORD" && N[O][A].word == "-") {
                    x = true
                }
                if (x) {
                    if (O != Scrabble.PlayerManager.currentUser.mayhemId) {
                        m.push(O)
                    }
                }
            }
            if (m.length) {
                var z = Scrabble.StatType[v].code;
                Scrabble.GameServerManager.getStatList(m, z, false, false);
                return false
            }
            var L = [];
            var B, K, F, I;
            var l, o;
            for (var O in N) {
                if (Scrabble.PlayerManager.getPlayerInfo(O, "isFriend") == true) {
                    B = Scrabble.PlayerManager.getPlayerInfo(O, "first_name");
                    if (B == false) {
                        B = Scrabble.Dictionary.translate("DFLT_TXT_LDNG");
                        K = Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"
                    }
                    if (B != Scrabble.Dictionary.translate("DFLT_TXT_LDNG")) {
                        B += " " + Scrabble.PlayerManager.getPlayerInfo(O, "last_name");
                        K = Scrabble.PlayerManager.getPlayerInfo(O, "picUrl")
                    }
                    if (v != "HIGH_WORD") {
                        I = "";
                        F = Scrabble.LeaderBoard.getValueWithSmallSuffix(N[O][Scrabble.StatType[v].id], v);
                        smallValue = N[O][Scrabble.StatType[v].id]
                    } else {
                        l = N[O][Scrabble.StatType[v].id].word;
                        if (l == 0) {
                            l = ""
                        }
                        I = l.toLowerCase().capitalize();
                        F = Scrabble.LeaderBoard.getValueWithSmallSuffix(N[O][Scrabble.StatType[v].id].score, v);
                        smallValue = N[O][Scrabble.StatType[v].id].score
                    }
                    if (O == Scrabble.PlayerManager.currentUser.mayhemId) {
                        B = Scrabble.Dictionary.translate("MENU_TXT_GMCRD_USRNM")
                    }
                    L.push({mayhemId: O,userName: B,picUrl: K,isAppUser: true,value: F,smallValue: smallValue,description: I})
                }
            }
            L = L.sort(Scrabble.LeaderBoard.sortStatsArray);
            var s = L.length;
            var D = 0;
            var t = -1;
            var r = Scrabble.PlayerManager.currentUser.mayhemId;
            var G, q;
            for (var J = 0; J < s; J++) {
                if (t != L[J].value) {
                    D = J + 1;
                    t = L[J].value
                }
                if (L[J].mayhemId == r) {
                    G = D;
                    q = L[J].smallValue
                }
                L[J].position = D;
                if (D < 10) {
                    L[J].positionClass = "largePosition"
                } else {
                    L[J].positionClass = "smallPosition"
                }
            }
            if (G === undefined) {
                G = 1;
                q = 0
            }
            var n = Scrabble.LeaderBoard.getLeaderboardHeaderText(v, G + '<span class="ordinal">' + Scrabble.Ordinals.getOrdinalIndicator(G) + "</span>", q);
            $("#lbHeaderDesc").html(n);
            Scrabble.LeaderBoard.currStatsArr = L;
            Scrabble.LeaderBoard.fillInviteFriends();
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.FacebookFriendsBuilt, Scrabble.LeaderBoard.fillInviteFriends);
            if (Scrabble.PlayerManager.friends.length <= 10) {
                L = L.concat(Scrabble.PlayerManager.friends)
            } else {
                var C = [];
                var u;
                for (var J = 1; J <= 10; J++) {
                    exist = true;
                    found = false;
                    while (exist == true) {
                        u = Math.floor(Math.random() * (Scrabble.PlayerManager.friends.length));
                        found = false;
                        for (var H = 0; H < C.length; H++) {
                            if (C[H].facebookId == Scrabble.PlayerManager.friends[u].facebookId) {
                                found = true;
                                break
                            }
                        }
                        if (found == false) {
                            break
                        }
                    }
                    C.push(Scrabble.PlayerManager.friends[u])
                }
                L = L.concat(C)
            }
            Scrabble.LeaderBoard.totalScrollableItems = L.length;
            var M = false;
            if (v != "HIGH_WORD") {
                M = true
            }
            Scrabble.LeaderBoard.peoples = L.length;
            var E = Scrabble.DomBuilder.buildLeaderBoardScrollable(L, M);
            $("#lbScrollable").html(E)
        },fillInviteFriends: function() {
            if (!Scrabble.LeaderBoard._inviteFriendsCardFilled) {
                $("#lbRight").css("width", "32px");
                $("#lbMid").css("margin-right", "40px");
                Scrabble.LeaderBoard.setSize(Scrabble.LeaderBoard.currentSize);
                if (Scrabble.PlayerManager.friends.length == 0) {
                    $("#inviteFriendsFriend").attr("src", Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png")
                } else {
                    $("#inviteFriendsFriend").attr("src", Scrabble.PlayerManager.friends[Math.floor(Math.random() * (Scrabble.PlayerManager.friends.length - 1))].picUrl);
                    Scrabble.LeaderBoard._inviteFriendsCardFilled = true;
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.FacebookFriendsBuilt, Scrabble.LeaderBoard.fillInviteFriends)
                }
            }
            Scrabble.LeaderBoard._alignCenter()
        },_alignCenter: function() {
            if (Scrabble.LeaderBoard.currStatsArr == undefined) {
                return
            }
            var q = Scrabble.LeaderBoard.currStatsArr;
            var n = 0;
            var l = 0;
            var m = 0;
            var o = q.length;
            for (n = 0; n < o; n++) {
                if (q[n].mayhemId == Scrabble.PlayerManager.currentUser.mayhemId) {
                    l = n;
                    break
                }
            }
            if (l == 0) {
                Scrabble.LeaderBoard.maxLeftScroll();
                m = l = q = o = n = null;
                return
            }
            if (l == o - 1 && o > 7) {
                h = 0;
                m = l - g;
                Scrabble.LeaderBoard.rightScroll(m);
                m = l = q = o = n = null;
                return
            }
            if (o <= g) {
                Scrabble.LeaderBoard.maxLeftScroll();
                m = l = q = o = n = null;
                return
            }
            if (l >= 4) {
                h = 0;
                m = l - Math.round(g * 0.5);
                Scrabble.LeaderBoard.rightScroll(m);
                m = l = q = o = n = null;
                return
            }
            Scrabble.LeaderBoard.maxLeftScroll()
        },getLeaderboardHeaderText: function(n, l, m) {
            switch (n) {
                case "HIGH_WORD":
                    return Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_PLCMNTRNKG_BSTWRD_MNMZD", {"[PLACEMENT]": l,"[#_VALUE]": m});
                    break;
                case "HIGH_GAME":
                    return Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_PLCMNTRNKG_BSTGM_MNMZD", {"[PLACEMENT]": l,"[#_VALUE]": m});
                    break;
                case "TOTAL_WINS":
                    return Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_PLCMNTRNKG_WNS_MNMZD", {"[PLACEMENT]": l,"[#_WINS]": m}) + " " + Scrabble.Dictionary.translate("FCBK_LBL_LDRBRDS_WNS");
                    break;
                case "TOTAL_BINGOS":
                    return Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_PLCMNTRNKG_BNGS_MNMZD", {"[PLACEMENT]": l,"[#_BINGOS]": m});
                case "RATING":
                    return Scrabble.Dictionary.translate("FCBK_BTN_LDRBRDS_PLCMNTRNKG_RTNG_MNMZD", {"[PLACEMENT]": l,"[#_RATING]": m})
            }
        },getValueWithSmallSuffix: function(m, l) {
            switch (l) {
                case "HIGH_WORD":
                    return Scrabble.Dictionary.translate("FBPSTSPP_TXT_BSTWRD_VALUE", {"[#_POINTS_SCORED]": m});
                    break;
                case "AVG_WORD":
                    return Scrabble.Dictionary.translate("FBPSTSPP_TXT_BSTWRD_VALUE", {"[#_POINTS_SCORED]": m});
                    break;
                case "AVG_GAME":
                    return Scrabble.Dictionary.translate("FBPSTSPP_TXT_BSTWRD_VALUE", {"[#_POINTS_SCORED]": m});
                    break;
                case "HIGH_GAME":
                    return Scrabble.Dictionary.translate("FBPSTSPP_TXT_BSTWRD_VALUE", {"[#_POINTS_SCORED]": m});
                    break;
                case "TOTAL_WINS":
                    return m + " " + Scrabble.Dictionary.translate("STTS_TXT_WIN");
                    break;
                case "TOTAL_BINGOS":
                    return m + " " + Scrabble.Dictionary.translate("STTS_LBL_BNGS_TTL");
                default:
                    return m;
                    break
            }
        },setSize: function(l) {
            $("#leaderBoard").stop(true, true);
            if (l != Scrabble.LeaderBoard.currentSize) {
                switch (l) {
                    case 0:
                        $("#leaderBoard").animate({width: LB_SIZE_SMALL + "px"}, {duration: 300,queue: false});
                        break;
                    case 1:
                        $("#leaderBoard").animate({width: b + "px"}, {duration: 300,queue: false});
                        $("#lbCollapsedMid").css("width", "748px");
                        break;
                    case 2:
                        $("#leaderBoard").animate({width: f + "px"}, {duration: 300,queue: false});
                        $("#lbCollapsedMid").css("width", "978px");
                        break
                }
            }
            Scrabble.LeaderBoard.currentSize = l;
            Scrabble.ProfilePopup.hideIfFromLeaderBoard()
        },updateOptionTitle: function() {
            var l = Scrabble.Dictionary.translate(a[Scrabble.LeaderBoard.currentStatType]);
            $("#lbOptionTitle").html(l)
        },update: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.FacebookFriendsRefreshed, Scrabble.LeaderBoard.update);
            Scrabble.LeaderBoard.fillScrollable()
        },animationDone: function() {
            Scrabble.LeaderBoard.scrollableAnimating = false
        },sortStatsArray: function(m, l) {
            return parseInt(l.value) - parseInt(m.value)
        },inviteClickHandler: function(m) {
            var l = $(m.currentTarget).find(".inviteFriendBtn").attr("data-friend_id");
            Scrabble.SocialPlatformManager.call("inviteFriend", "leaderboard_friend", l, function() {
                Scrabble.GameServerManager.postNewMatch([], [l], "play_leaderboard")
            }, null)
        }}
}();
Scrabble.LeftMenu = function() {
    var b = "#topPlusGlow";
    var a = "#topPlusGlow2";
    return {isExpanded: true,width: 230,scrollList: null,scrollApi: null,isPlusGlowing: false,currentOpponents: [],acceptedSuggestions: [],shuffleCount: 0,suggestedFriendsLocked: false,isCompletedExpanded: true,isTheirTurnExpanded: true,lastManualRefreshTime: 0,init: function() {
            $("#leftMenu .body").html(Scrabble.DomBuilder.buildMainMenu());
            $("#leftMenu").append(Scrabble.DomBuilder.leftMenuCover());
            $("#newGameBtn").on("click", function() {
                Scrabble.TipManager.removeTips();
                Scrabble.LeftMenu.toggleNewGameMenu("create_new_game")
            });
            $("#leftMenu").on("click", "#menuFeedbackBtn", function() {
                Scrabble.TipManager.removeTips();
                SurveyBridge.openSurvey()
            });
            $("#leftMenu").on("click", ".mainMenuCrossPromotion", function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openLink("http://www.eamobile.com/scrabble");
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "play_anywhere", {subtype1: "upsell"})
            });
            $("#leftMenu").on("click", "#lbLeftFeedbackBtn", function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openSurvey()
            });
            $("#lbLeftFeedbackArea").on("click", "#statsButton", function() {
                Scrabble.TipManager.removeTips();
                Scrabble.ProfilePopup.show(Scrabble.PlayerManager.currentUser.mayhemId, false, false, true)
            });
            $("#lbLeftFeedbackArea").on("click", "#optionsButton", function() {
                if (Scrabble.OptionsMenu.isOpen) {
                    Scrabble.OptionsMenu.hide()
                } else {
                    Scrabble.OptionsMenu.show()
                }
            });
            var c = Scrabble.LocalStorageManager.get("completedExpended");
            if (c != null && c == "false") {
                Scrabble.LeftMenu.isCompletedExpanded = false
            }
            var d = Scrabble.LocalStorageManager.get("theirTurnExpended");
            if (d != null && d == "false") {
                Scrabble.LeftMenu.isTheirTurnExpanded = false
            }
            $("#lbLeftFeedbackArea").on("click", "#refreshButton", function() {
                Scrabble.LeftMenu.refreshGamesList(true)
            });
            $("#leftMenu").on("click", "#completedGames .collapseArrow", Scrabble.LeftMenu.toggleCompletedGamesCollapse);
            $("#leftMenu").on("click", "#theirTurnGames .collapseArrow", Scrabble.LeftMenu.toggleTheirTurnCollapse);
            $("#newGameLabel").html(Scrabble.Dictionary.translate("FCBK_BTN_NWGM"));
            this.scrollList = $("#leftMenu .body").jScrollPane({contentWidth: 230,showArrows: true});
            this.scrollApi = this.scrollList.data("jsp");
            this.scrollDOM = this.scrollApi.getContentPane();
            $("#leftMenu .jspPane").ready(function() {
                Scrabble.LeftMenu.scrollApi.reinitialise()
            });
            Scrabble.LeftMenu.lastManualRefreshTime = new Date().getTime();
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.LeftMenu.addGames);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.MatchSelectedFromList, Scrabble.LeftMenu.matchSelect);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.ArchiveSelectedFromList, Scrabble.LeftMenu.archiveSelect);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.LeftMenu.anonymousUserLoadedCallback)
        },toggleCompletedGamesCollapse: function() {
            if (Scrabble.LeftMenu.isCompletedExpanded) {
                $("#completedGamesList").hide();
                $("#completeCollapsed").show();
                $(this).removeClass("isExpanded").addClass("isCollapsed");
                Scrabble.LocalStorageManager.set("completedExpended", "false");
                Scrabble.LeftMenu.isCompletedExpanded = false
            } else {
                $("#completedGamesList").show();
                $("#completeCollapsed").hide();
                $(this).removeClass("isCollapsed").addClass("isExpanded");
                Scrabble.LocalStorageManager.set("completedExpended", "true");
                Scrabble.LeftMenu.isCompletedExpanded = true
            }
            $("#leftMenu .jspPane").ready(function() {
                Scrabble.LeftMenu.scrollApi.reinitialise()
            });
            Scrabble.LeftMenu.scrollApi.scrollToPercentY(100)
        },toggleTheirTurnCollapse: function() {
            if (Scrabble.LeftMenu.isTheirTurnExpanded) {
                $("#theirTurnGamesList").hide();
                $("#theirTurnCollapsed").show();
                $(this).removeClass("isExpanded").addClass("isCollapsed");
                Scrabble.LocalStorageManager.set("theirTurnExpended", "false");
                Scrabble.LeftMenu.isTheirTurnExpanded = false
            } else {
                $("#theirTurnGamesList").show();
                $("#theirTurnCollapsed").hide();
                $(this).removeClass("isCollapsed").addClass("isExpanded");
                Scrabble.LocalStorageManager.set("theirTurnExpended", "true");
                Scrabble.LeftMenu.isTheirTurnExpanded = true
            }
            $("#leftMenu .jspPane").ready(function() {
                Scrabble.LeftMenu.scrollApi.reinitialise()
            });
            Scrabble.LeftMenu.scrollApi.scrollToPercentY(100)
        },anonymousUserLoadedCallback: function(c) {
            $('#leftMenu [data-user_id="' + c + '"]').attr("src", Scrabble.PlayerManager.getPlayerInfo(c, "picUrl"));
            $('#myTurnGamesList [data-name_user_id="' + c + '"], #theirTurnGamesList [data-name_user_id="' + c + '"]').html(trimName(Scrabble.PlayerManager.getPlayerInfo(c, "first_name"), Scrabble.PlayerManager.getPlayerInfo(c, "last_name"), 20));
            $('#completedGamesList [data-name_user_id="' + c + '"]').html(trimName(Scrabble.PlayerManager.getPlayerInfo(c, "first_name"), Scrabble.PlayerManager.getPlayerInfo(c, "last_name"), 8))
        },toggleNewGameMenu: function(c) {
            if (Scrabble.NewGameMenu.isOpen == true || Scrabble.GameOptionsMenu.isOpen == true) {
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.NewGameMenu.hide();
                Scrabble.GameOptionsMenu.hide()
            } else {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.GameOptionsMenu.show(c)
            }
        },refreshGamesList: function(d) {
            var c = new Date();
            var e = c.getTime();
            if (e - Scrabble.LeftMenu.lastManualRefreshTime > 10000) {
                Scrabble.LeftMenu.lastManualRefreshTime = e;
                if (d) {
                    Scrabble.LeftMenu.showLoadingCover()
                }
                Scrabble.GameServerManager.refreshMatches();
                setTimeout(Scrabble.LeftMenu.hideLoadingCover, 4000)
            } else {
                Scrabble.LeftMenu.showLoadingCover();
                setTimeout(Scrabble.LeftMenu.hideLoadingCover, 2000)
            }
        },showLoadingCover: function() {
            Scrabble.LeftMenu.lockList();
            $("#lbLeftFeedbackArea #refreshButton").attr("id", "lockedRefreshButton")
        },hideLoadingCover: function() {
            console.log("Hiding cover!");
            Scrabble.LeftMenu.unlockList();
            $("#lbLeftFeedbackArea #lockedRefreshButton").attr("id", "refreshButton")
        },lockList: function() {
            $("#leftMenu .cover").fadeTo(10, 1)
        },unlockList: function() {
            $("#leftMenu .cover").fadeTo(200, 0, function() {
                $(this).hide()
            })
        },addSingleGame: function(e, d) {
            Scrabble.LeftMenu.suggestedFriendsLocked = false;
            $(".suggestionFriend").unbind();
            Scrabble.LeftMenu.hideLoadingCover();
            Scrabble.LeftMenu.stopPlusGlow();
            var c = Scrabble.GameServerManager.matchList[e];
            if ($('[data-match_id="' + e.substring(9) + '"]').hasClass("match")) {
                $('[data-match_id="' + e.substring(9) + '"]').animate({height: "0px","z-index": -1}, 250);
                $('[data-match_id="' + e.substring(9) + '"]').find(".matchElementView").animate({height: "0px"}, 250, function() {
                    Scrabble.LeftMenu.finishAddSingleGame(e, d)
                });
                return true
            } else {
                Scrabble.LeftMenu.finishAddSingleGame(e, d)
            }
        },finishAddSingleGame: function(f, e) {
            $('[data-match_id="' + f.substring(9) + '"]').remove();
            var c = Scrabble.GameServerManager.matchList[f];
            var d = Scrabble.LeftMenu.getMatchData(f);
            if (c == null || d == null) {
                return false
            }
            if (c.board.currentturnuserid == Scrabble.PlayerManager.currentUser.mayhemId) {
                $("#myTurnGames").show();
                $("#myTurnGamesList").prepend(d.dom)
            } else {
                $("#theirTurnGames").show();
                $("#theirTurnGamesList").prepend(d.dom)
            }
            if ($("#myTurnGames .match").length == 0) {
                $("#myTurnGames").hide();
                Scrabble.LeftMenu.startPlusGlow()
            } else {
                if ($("#myTurnGames .match").length == 1) {
                    $("#myTurnGames .match").removeClass("listElement");
                    $("#myTurnGames .match").removeClass("currentGame");
                    $("#myTurnGames .match").addClass("lastListElement");
                    $("#myTurnGames .match").addClass("lastCurrentGame")
                }
            }
            Scrabble.LeftMenu.checkEnds();
            Scrabble.LeftMenu.scrollApi.scrollToPercentY(0);
            $('[data-match_id="' + f.substring(9) + '"]').css("height", "0px");
            $('[data-match_id="' + f.substring(9) + '"]').fadeTo(0, 0);
            if (e === true) {
                $(".match").removeClass("currentGame");
                $(".match").removeClass("lastCurrentGame");
                $(".archivedMatch").removeClass("currentGame");
                $(".archivedMatch").removeClass("lastCurrentGame");
                if ($('[data-match_id="' + f.substring(9) + '"]').hasClass("listElement")) {
                    $('[data-match_id="' + f.substring(9) + '"]').addClass("currentGame")
                } else {
                    $('[data-match_id="' + f.substring(9) + '"]').addClass("lastCurrentGame")
                }
            }
            setTimeout(function() {
                $('[data-match_id="' + f.substring(9) + '"]').animate({height: "70px",opacity: 1}, 250, function() {
                    Scrabble.LeftMenu.scrollApi.reinitialise();
                    $(".match .matchElementView").off("click");
                    $(".match .matchElementView").on("click", function() {
                        Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.MatchSelectedFromList, $(this));
                        Scrabble.ProfilePopup.hide()
                    })
                })
            }, 300)
        },checkEnds: function() {
            if ($("#myTurnGames :last").hasClass("listElement")) {
                $("#myTurnGames :last").removeClass("listElement").addClass("lastListElement")
            }
            if ($("#myTurnGames :last").hasClass("currentGame")) {
                $("#myTurnGames :last").removeClass("currentGame").addClass("lastCurrentGame")
            }
            if ($("#theirTurnGames :last").hasClass("listElement")) {
                $("#theirTurnGames :last").removeClass("listElement").addClass("lastListElement")
            }
            if ($("#theirTurnGames :last").hasClass("currentGame")) {
                $("#theirTurnGames :last").removeClass("currentGame").addClass("lastCurrentGame")
            }
        },addGames: function() {
            Scrabble.LeftMenu.scrollDOM.html(Scrabble.DomBuilder.buildMainMenu());
            var h = [];
            var c = [];
            var k = Scrabble.GameServerManager.matchList;
            Scrabble.LeftMenu.hideLoadingCover();
            for (var e in k) {
                if (e == Scrabble.GameServerManager.currentMatch) {
                    if (k[e].board.currentturnuserid != Scrabble.GameServerManager.currentMatchUserTurn) {
                        Scrabble.GameServerManager.loadMatch(e)
                    }
                }
                if (k[e].board.currentturnuserid == Scrabble.PlayerManager.currentUser.mayhemId) {
                    h.push(k[e])
                } else {
                    c.push(k[e])
                }
            }
            var f = 0;
            var e = {};
            if (h.length >= 1) {
                h.sort(Scrabble.LeftMenu.sortMatchesByDate);
                $("#myTurnGames").show();
                Scrabble.LeftMenu.stopPlusGlow();
                for (f = 0; f < h.length; f++) {
                    e = Scrabble.LeftMenu.getMatchData(f, h);
                    $("#myTurnGamesList").append(e.dom)
                }
            } else {
                $("#myTurnGames").hide();
                Scrabble.LeftMenu.startPlusGlow()
            }
            if (c.length >= 1) {
                c.sort(Scrabble.LeftMenu.sortMatchesByDate);
                $("#theirTurnGames").show();
                for (f = 0; f < c.length; f++) {
                    e = Scrabble.LeftMenu.getMatchData(f, c);
                    $("#theirTurnGamesList").append(e.dom)
                }
                $("#theirTurnCollapsed").html(Scrabble.LeftMenu.theirTurnString())
            } else {
                $("#theirTurnGames").hide()
            }
            var g = h.length + c.length;
            if (g == 0) {
            }
            var d = Scrabble.StatsManager.archives;
            var j = false;
            d.sort(Scrabble.LeftMenu.sortMatchesByDate);
            if (d.length > 0) {
                for (f = 0; f < 10; f++) {
                    if (d[f] != undefined) {
                        if (f == 9 || d[f + 1] == undefined) {
                            j = true
                        }
                        $("#completedGamesList").append(Scrabble.DomBuilder.buildArchiveMatch(d[f], j))
                    } else {
                        break
                    }
                }
                $("#completeCollapsed").html(Scrabble.LeftMenu.completedGameString())
            } else {
                $("#completedGames").hide()
            }
            d = null;
            k = null;
            h = null;
            c = null;
            setTimeout(function() {
                Scrabble.LeftMenu.scrollApi.reinitialise();
                $(".match .matchElementView").off("click");
                $(".match .matchElementView").on("click", function() {
                    Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.MatchSelectedFromList, $(this));
                    Scrabble.ProfilePopup.hide()
                });
                $(".archivedMatch .matchElementView").off("click");
                $(".archivedMatch .matchElementView").on("click", function() {
                    Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.ArchiveSelectedFromList, $(this));
                    Scrabble.ProfilePopup.hide()
                })
            }, 100);
            if (Scrabble.LeftMenu.isCompletedExpanded == false) {
                $("#completedGamesList").hide();
                $("#completeCollapsed").show();
                $("#completedGames .collapseArrow").removeClass("isExpanded").addClass("isCollapsed");
                $("#leftMenu .jspPane").ready(Scrabble.LeftMenu.scrollApi.reinitialise)
            }
            if (Scrabble.LeftMenu.isTheirTurnExpanded == false) {
                $("#theirTurnGamesList").hide();
                $("#theirTurnCollapsed").show();
                $("#theirTurnGames .collapseArrow").removeClass("isExpanded").addClass("isCollapsed");
                $("#leftMenu .jspPane").ready(Scrabble.LeftMenu.scrollApi.reinitialise)
            }
        },completedGameString: function() {
            var c = $(".archivedMatch .matchElementView").length;
            if (c > 1) {
                return Scrabble.Dictionary.translate("MENU_TXT_NWCMPLTDGMS")
            } else {
                if (c == 1) {
                    return Scrabble.Dictionary.translate("MENU_TXT_ONENWCMPLTDGM")
                }
            }
            return ""
        },theirTurnString: function() {
            var c = $("#theirTurnGamesList .match").length;
            if (c > 1) {
                return Scrabble.Dictionary.translate("MENU_TXT_XNWTHRTRNGM")
            } else {
                if (c == 1) {
                    return Scrabble.Dictionary.translate("MENU_TXT_ONENWTHRTRNGM")
                }
            }
            return ""
        },sortMatchesByDate: function(d, c) {
            return c.lastupdatedtime - d.lastupdatedtime
        },archiveMatch: function(c, d) {
            var g = Scrabble.GameServerManager.matchList[c];
            if (typeof g != "undefined") {
                Scrabble.StatsManager.archives.unshift(g);
                if (Scrabble.StatsManager.archives.length > 10) {
                    Scrabble.StatsManager.archives.pop()
                }
            }
            delete Scrabble.GameServerManager.matchList[c];
            $('[data-match_id="' + c.substring(9) + '"]').remove();
            if (g && g.plays) {
                var f = false;
                var e = $("#completedGamesList");
                if ($("#completedGamesList .archivedMatch").length == 0) {
                    f = true;
                    e.show()
                }
                e.prepend(Scrabble.DomBuilder.buildArchiveMatch(g, f, d));
                if ($(".archivedMatch").length > 10) {
                    $(".archivedMatch :last").remove()
                }
                e = null;
                setTimeout(function() {
                    Scrabble.LeftMenu.scrollApi.reinitialise();
                    $(".archivedMatch .matchElementView").off("click");
                    $(".archivedMatch .matchElementView").on("click", function() {
                        Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.ArchiveSelectedFromList, $(this));
                        Scrabble.ProfilePopup.hide()
                    });
                    Scrabble.LeftMenu.checkEnds()
                }, 100)
            }
            if ($("#myTurnGamesList .match").length == 0) {
                $("#myTurnGames").hide()
            }
        },checkCurrentOpponents: function(c) {
            for (var d = 0; d < Scrabble.LeftMenu.currentOpponents.length; d++) {
                if (c == Scrabble.LeftMenu.currentOpponents[d]) {
                    return false
                }
            }
            return true
        },updateCurrentOpponents: function() {
            Scrabble.LeftMenu.currentOpponents = [];
            for (var c in Scrabble.GameServerManager.matchList) {
                if (Scrabble.GameServerManager.matchList[c].mmatchusers.matchuser.length == undefined) {
                    Scrabble.LeftMenu.currentOpponents.push(Scrabble.GameServerManager.matchList[c].mmatchusers.matchuser.userid)
                } else {
                    for (var d = 0; d < Scrabble.GameServerManager.matchList[c].mmatchusers.matchuser.length; d++) {
                        Scrabble.LeftMenu.currentOpponents.push(Scrabble.GameServerManager.matchList[c].mmatchusers.matchuser[d].userid)
                    }
                }
            }
            for (var d = 0; d < Scrabble.LeftMenu.acceptedSuggestions.length; d++) {
                Scrabble.LeftMenu.currentOpponents.push(Scrabble.LeftMenu.acceptedSuggestions[d])
            }
            Scrabble.LeftMenu.acceptedSuggestions = []
        },getMatchData: function(q, n) {
            var f, k, r, e, s, l, d, o, t, c, u = "";
            var m = {dom: ""};
            if (n != null) {
                o = n[q]
            } else {
                o = Scrabble.GameServerManager.matchList[q]
            }
            if (o == null) {
                return null
            }
            if (n == null) {
                l = false
            } else {
                l = (q == n.length - 1)
            }
            f = (l) ? "lastListElement" : "listElement";
            k = o.board.currentturnuserid;
            e = o.mmatchusers.matchuser;
            r = [];
            for (var h = 0; h < e.length; h++) {
                r.push(e[h].userid)
            }
            r.splice(r.indexOf(k), 1);
            c = getMatchLeader(o);
            if (o.plays.play == undefined) {
                d = null
            } else {
                if (o.plays.play instanceof Array) {
                    d = o.plays.play[o.plays.play.length - 1]
                } else {
                    d = o.plays.play
                }
            }
            var g = "left";
            if (k != Scrabble.PlayerManager.currentUser.mayhemId) {
                g = "right"
            }
            if (d != null) {
                t = Scrabble.GamesList.trimWord(d, true, k) + "^" + getTimeAgo(o.lastupdateddate);
                u = Scrabble.GamesList.trimMessage(d, k, o);
                if (k == Scrabble.PlayerManager.currentUser.mayhemId || d.playtype == "NUDGED_FORFEIT") {
                    k = d.useruri.split("/")[2]
                }
            } else {
                t = "^" + getTimeAgo(o.lastupdateddate);
                u = {teacherMessage: Scrabble.Dictionary.translate("MENU_TXT_GMCRD_STRTD"),teacherFace: "new",wordArr: []}
            }
            m.dom = Scrabble.DomBuilder.matchConstruct(o, k, r, c, t, u, f, g);
            m.id = o.matchuri.substring(9);
            return m
        },matchSelect: function(g) {
            Scrabble.TipManager.removeTips();
            var d = $(g).parent();
            var h = d.attr("data-match_id");
            Scrabble.OptionsMenu.hide();
            if (h != Scrabble.GameServerManager.currentMatch.substring(9)) {
                Scrabble.SoundManager.play_sfx("Gamescene");
                var c = $(".match");
                var f = $(".archivedMatch");
                c.removeClass("currentGame");
                c.removeClass("lastCurrentGame");
                f.removeClass("currentGame");
                f.removeClass("lastCurrentGame");
                if (d.hasClass("listElement")) {
                    d.addClass("currentGame")
                } else {
                    d.addClass("lastCurrentGame")
                }
                Scrabble.GameServerManager.loadMatch("/matches/" + h, true)
            }
        },loadFirstInList: function() {
            if ($(".match").length > 0) {
                Scrabble.LeftMenu.matchSelect($(".match:first .matchElementView"));
                Scrabble.LeftMenu.scrollApi.scrollToPercentY(0);
                return true
            }
            if ($(".archivedMatch").length > 0) {
                Scrabble.LeftMenu.archiveSelect($(".archivedMatch:first .matchElementView"));
                return true
            }
            $(".gameCard").remove();
            $("#gameScene .tile").remove();
            return false
        },archiveSelect: function(g) {
            Scrabble.TipManager.removeTips();
            var d = $(g).parent();
            var h = d.attr("data-match_id");
            Scrabble.OptionsMenu.hide();
            if (h != Scrabble.GameServerManager.currentMatch.substring(9)) {
                Scrabble.SoundManager.play_sfx("Select");
                var c = $(".match");
                var f = $(".archivedMatch");
                c.removeClass("currentGame");
                c.removeClass("lastCurrentGame");
                f.removeClass("currentGame");
                f.removeClass("lastCurrentGame");
                if (d.hasClass("listElement")) {
                    d.addClass("currentGame")
                } else {
                    d.addClass("lastCurrentGame")
                }
                Scrabble.StatsManager.loadArchive("/matches/" + h, false)
            }
        },hide: function() {
            var d = $("#leftMenu");
            var c = $("#scrabbleGame");
            d.stop(true, true);
            c.stop(true, true);
            Scrabble.LeftMenu.isExpanded = false;
            if (Scrabble.AnimationManager.animationsEnabled) {
                d.animate({width: "0px"}, 300);
                c.animate({left: "0px"}, 300, function() {
                    $("#leftMenu").hide
                })
            } else {
                d.css("width", "0px");
                c.css("left", "0px");
                $("#leftMenu").hide()
            }
            $("#toggleLeftMenuBtn").show();
            $("#scrabbleGame .topButton").after($("#topPlusBtn"));
            $("#toggleLeftMenuBtn p").html(Scrabble.Dictionary.translate("home"));
            $("#toggleLeftMenuBtn span").attr("id", "homeBtnImage");
            $("#topPlusBtn").css("left", "43px");
            $("#cardZoneDivision").css("left", "100px");
            $("#lbLeftFeedbackArea").hide()
        },show: function() {
            var d = $("#leftMenu");
            var c = $("#scrabbleGame");
            d.stop(true, true);
            c.stop(true, true);
            Scrabble.LeftMenu.isExpanded = true;
            if (Scrabble.AnimationManager.animationsEnabled) {
                d.animate({width: Scrabble.LeftMenu.width + "px"}, 300);
                c.animate({left: "230px"}, 300)
            } else {
                d.css("width", Scrabble.LeftMenu.width + "px");
                c.css("left", Scrabble.LeftMenu.width + "px")
            }
            $("#toggleLeftMenuBtn").hide();
            $("#leftMenu .top").append($("#topPlusBtn"));
            $("#topPlusBtn").css("left", "175px");
            $("#cardZoneDivision").css("left", "5px");
            $("#lbLeftFeedbackArea").show();
            d.show();
            d.find(".jspScrollable").css("width", "230px");
            d.find(".jspContainer").css("width", "230px");
            d.find(".jspPane").css("left", "0px");
            Scrabble.LeftMenu.scrollApi.reinitialise()
        },startPlusGlow: function() {
            if (Scrabble.AnimationManager.animationsEnabled) {
                Scrabble.LeftMenu.isPlusGlowing = true;
                $(a).fadeTo(0, 0);
                Scrabble.LeftMenu.doPlusGlow()
            }
        },doPlusGlow: function() {
            if (Scrabble.LeftMenu.isPlusGlowing) {
                var c = $(a);
                if (c.css("opacity") == 0) {
                    c.animate({opacity: 1}, 1000).animate({opacity: 0.9}, 1000).animate({opacity: 0}, 1000)
                }
            } else {
                $(a).hide()
            }
        },stopPlusGlow: function() {
            Scrabble.LeftMenu.isPlusGlowing = false
        },toggleDisplay: function() {
            Scrabble.LeftMenu.isExpanded = !Scrabble.LeftMenu.isExpanded;
            if (Scrabble.LeftMenu.isExpanded) {
                Scrabble.LeftMenu.show()
            } else {
                Scrabble.LeftMenu.hide()
            }
        }}
}();
Scrabble.NewGameMenu = function() {
    DIV_ID = "newGamePopup";
    SLIDERS_RANGE = 355;
    return {initialized: false,isOpen: false,scrollList: null,scrollApi: null,ListDOM: null,playersSelected: 0,currentPage: 0,friendsPage: 24,twoPlayerRange: [0, 24],multiPlayerRange: [0, 24],twoPlayerListLoaded: false,multiPlayerListLoaded: false,singlePlayerSearch: undefined,multiPlayerSearch: undefined,playerListOpened: null,lastOrigin: null,hide: function() {
            Scrabble.NewGameMenu.isOpen = false;
            $("#newGamePopup").hide();
            Scrabble.PopupManager.hideBlocker();
            Scrabble.Board.reEnableBoard();
            $("#newGameListMultiPlayerList").removeClass("maxSelected");
            $("#newGameListMultiPlayerSelected").html("");
            $("#newGameListMultiPlayerSeparator").hide();
            Scrabble.NewGameMenu.empty()
        },empty: function() {
            Scrabble.NewGameMenu.emptySingle();
            Scrabble.NewGameMenu.emptyMulti()
        },emptySingle: function() {
            Scrabble.NewGameMenu.twoPlayerRange = [0, 24];
            Scrabble.NewGameMenu.twoPlayerListLoaded = false;
            $("#newGameListSinglePlayer").html("");
            Scrabble.NewGameMenu.singlePlayerSearch = undefined
        },emptyMulti: function() {
            Scrabble.NewGameMenu.multiPlayerRange = [0, 24];
            Scrabble.NewGameMenu.multiPlayerListLoaded = false;
            $("#newGameListMultiPlayerList").html("");
            Scrabble.NewGameMenu.multiPlayerSearch = undefined
        },show: function(a) {
            Scrabble.NewGameMenu.lastOrigin = a;
            if (Scrabble.OptionsMenu.isOpen) {
                Scrabble.OptionsMenu.hide()
            }
            if (Scrabble.GameOptionsMenu.isOpen) {
                Scrabble.GameOptionsMenu.hide()
            }
            Scrabble.Board.disableBoard();
            Scrabble.NewGameMenu.playersSelected = 0;
            Scrabble.NewGameMenu.playerListOpened = "SinglePlayer";
            Scrabble.NewGameMenu.isOpen = true;
            Scrabble.PopupManager.showBlocker();
            if (!Scrabble.NewGameMenu.initialized) {
                Scrabble.NewGameMenu.initialize()
            } else {
                Scrabble.NewGameMenu.reinitialize()
            }
            $("#newGamePopup").show();
            Scrabble.NewGameMenu.showTwoPlayerMatchMaking();
            Scrabble.NewGameMenu.scrollApi.scrollToPercentY(0)
        },initialize: function() {
            Scrabble.NewGameMenu.initialized = true;
            $("#newGamePopup").html(Scrabble.DomBuilder.buildNewGameMenu());
            var a = $("#newGameCloseButton");
            a.click(function() {
                Scrabble.NewGameMenu.hide();
                Scrabble.SoundManager.play_sfx("Cancel")
            });
            a.click(function() {
                Scrabble.NewGameMenu.hide();
                Scrabble.SoundManager.play_sfx("Cancel")
            });
            Scrabble.NewGameMenu.scrollList = $("#newGameList").jScrollPane({showArrows: true,verticalDragMinHeight: 50});
            Scrabble.NewGameMenu.scrollApi = Scrabble.NewGameMenu.scrollList.data("jsp");
            Scrabble.NewGameMenu.ListDOM = Scrabble.NewGameMenu.scrollApi.getContentPane();
            setTimeout(Scrabble.NewGameMenu.scrollList.data("jsp").reinitialise, 100);
            $("#newGameListSinglePlayer").on("click", ".singlePlayerFriendPic", function(d) {
                Scrabble.NewGameMenu.showProfile(d);
                d.stopPropagation()
            });
            $("#newGameListMultiPlayer").on("click", ".multiPlayerFriendPic", function(d) {
                Scrabble.NewGameMenu.showProfile(d);
                d.stopPropagation()
            });
            $("#newGameListSinglePlayer:not(#LoadingSinglePlayer)").on("click", ".singlePlayerFriend", function(d) {
                if ($(d.currentTarget).attr("data-friendId")) {
                    Scrabble.NewGameMenu.startSinglePlayerMatch(d)
                } else {
                    if ($(d.currentTarget).attr("id") != "LoadingSinglePlayer") {
                        Scrabble.NewGameMenu.inviteSinglePlayer(d)
                    }
                }
            });
            $("#newGameListMultiPlayerList:not(#LoadingMultiPlayer)").on("click", ".multiPlayerFriend", function(d) {
                if (!$(d.target).hasClass("newGameFriendPicContainer")) {
                    if ($(d.currentTarget).attr("data-friendId") != undefined) {
                        Scrabble.NewGameMenu.selectPlayer(d)
                    } else {
                        Scrabble.NewGameMenu.selectFriend(d)
                    }
                }
            });
            $("#newGameListMultiPlayerSelected").on("click", ".multiPlayerFriend", function(d) {
                if (!$(d.target).hasClass("newGameFriendPicContainer")) {
                    Scrabble.NewGameMenu.deselectPlayer(d)
                }
            });
            $("#newGameListMultiPlayerSeparator").on("click", ".wideGreenBtn", Scrabble.NewGameMenu.startMultiPlayerMatch);
            var c = $("#newGamePopupSubHeader");
            c.on("click", "#twoPlayerRadioBtn", function(d) {
                Scrabble.SoundManager.play_sfx("Radio_btn");
                Scrabble.NewGameMenu.showTwoPlayerMatchMaking()
            });
            c.on("click", "#multiPlayerRadioBtn", function(d) {
                Scrabble.SoundManager.play_sfx("Radio_btn");
                Scrabble.NewGameMenu.showMultiPlayerMatchMaking()
            });
            var b = $("#newGameSearchField");
            b.on("keyup", Scrabble.NewGameMenu.onSearchKeyup);
            b.on("blur", Scrabble.NewGameMenu.onSearchBlur);
            b.on("focus", Scrabble.NewGameMenu.onSearchFocus);
            b.blur()
        },reinitialize: function() {
            var a = $("#newGameSearchField");
            a.val(Scrabble.Dictionary.translate("FCBK_TXT_SRCHFLD"))
        },onSearchKeyup: function() {
            Scrabble.NewGameMenu.search(Scrabble.NewGameMenu.playerListOpened)
        },onSearchBlur: function() {
            Scrabble.KeyboardManager.setEnterKeyCallback(null);
            Scrabble.KeyboardManager.disableBackspace();
            var a = $(this);
            if (a.val() == "") {
                a.addClass("typo_lighterBlue");
                a.removeClass("typo_lightBlue");
                a.val(a[0].title)
            }
        },onSearchFocus: function() {
            Scrabble.KeyboardManager.setEnterKeyCallback(function() {
            });
            Scrabble.KeyboardManager.enableBackspace();
            var a = $(this);
            if (a.val() == a[0].title) {
                a.removeClass("typo_lighterBlue");
                a.addClass("typo_lightBlue");
                a.val("")
            }
        },_sortNewAppUsers: function(d, c) {
            var e = new Date();
            e = e.getTime();
            var g = e - d.signupTime;
            var f = e - c.signupTime;
            if ((Scrabble.NewGameMenu.isNew(g) && Scrabble.NewGameMenu.isNew(f)) || (!Scrabble.NewGameMenu.isNew(g) && !Scrabble.NewGameMenu.isNew(f))) {
                return 0
            } else {
                if (Scrabble.NewGameMenu.isNew(g) && !Scrabble.NewGameMenu.isNew(f)) {
                    return -1
                } else {
                    return 1
                }
            }
        },_sortUsersByName: function(d, c) {
            var f = d.userName.toLowerCase(), e = c.userName.toLowerCase();
            if (f < e) {
                return -1
            }
            if (f > e) {
                return 1
            }
            return 0
        },showTwoPlayerMatchMaking: function() {
            $("#newGameListMultiPlayer").hide();
            $("#newGameListSinglePlayer").show();
            var b = $("#multiPlayerRadioBtn");
            b.removeClass("selected");
            b.addClass("notSelected");
            var a = $("#twoPlayerRadioBtn");
            a.removeClass("notSelected");
            a.addClass("selected");
            Scrabble.NewGameMenu.twoPlayerListLoaded = true;
            Scrabble.NewGameMenu.search("SinglePlayer");
            Scrabble.NewGameMenu.playerListOpened = "SinglePlayer"
        },showMultiPlayerMatchMaking: function() {
            $("#newGameListSinglePlayer").hide();
            $("#newGameListMultiPlayer").show();
            var a = $("#twoPlayerRadioBtn");
            a.removeClass("selected");
            a.addClass("notSelected");
            var b = $("#multiPlayerRadioBtn");
            b.removeClass("notSelected");
            b.addClass("selected");
            Scrabble.NewGameMenu.search("", false);
            Scrabble.NewGameMenu.playerListOpened = "MultiPlayer"
        },loadMoreFriends: function(b, f, e, a, h, g) {
            if (g == true && a[1] > f.length) {
                a[1] = f.length - 1
            }
            if (a[1] <= f.length) {
                var d;
                if (g == true) {
                    d = $(Scrabble.DomBuilder.buildLoadButton(h))
                } else {
                    a[0] = a[1] + 1;
                    a[1] += a[0] + Scrabble.NewGameMenu.friendsPage;
                    d = $("#" + h);
                    d.remove()
                }
                if (a[1] > f.length - 1) {
                    a[1] = f.length - 1
                }
                var c = Scrabble.DomBuilder.buildSingleFriends(b, f, a[0], a[1]);
                e.append(c);
                if (a[1] < f.length - 1) {
                    e.append(d);
                    d.click(function() {
                        Scrabble.NewGameMenu.loadMoreFriends(b, f, e, a, h)
                    })
                }
                Scrabble.NewGameMenu.scrollApi.reinitialise()
            }
        },loadData: function() {
            console.warn("FROM NEW GAME MENU2")
        },search: function(f, e) {
            var a;
            if ($("#newGameSearchField").val() == Scrabble.Dictionary.translate("FCBK_TXT_SRCHFLD")) {
                a = ""
            } else {
                a = simplifyText($("#newGameSearchField").val())
            }
            var d = false;
            if (f == "SinglePlayer") {
                Scrabble.NewGameMenu.emptySingle();
                listTarget = $("#newGameListSinglePlayer");
                range = Scrabble.NewGameMenu.twoPlayerRange;
                loading = "SINGLE";
                exclude = "";
                listId = "singlePlayerFriend";
                if (Scrabble.NewGameMenu.singlePlayerSearch != a) {
                    Scrabble.NewGameMenu.singlePlayerSearch = a;
                    d = true
                }
            } else {
                Scrabble.NewGameMenu.emptyMulti();
                listTarget = $("#newGameListMultiPlayerList");
                range = Scrabble.NewGameMenu.multiPlayerRange;
                loading = "MULTI";
                exclude = "#newGameListMultiPlayerSelected";
                listId = "multiPlayerFriend";
                if (Scrabble.NewGameMenu.multiPlayerSearch != a) {
                    Scrabble.NewGameMenu.multiPlayerSearch = a;
                    d = true
                }
            }
            if (d == true) {
                var c = Scrabble.NewGameMenu.searchData(a, Scrabble.PlayerManager.players, exclude);
                if (f == "SinglePlayer") {
                    listTarget.append(Scrabble.DomBuilder.buildSinglePlayers(c))
                } else {
                    listTarget.append(Scrabble.DomBuilder.buildMultiPlayers(c))
                }
                if (e != false) {
                    var b = Scrabble.NewGameMenu.searchData(a, Scrabble.PlayerManager.friends, "");
                    Scrabble.NewGameMenu.loadMoreFriends(listId, b, listTarget, range, loading, true)
                }
                Scrabble.NewGameMenu.scrollApi.reinitialise();
                Scrabble.NewGameMenu.scrollApi.scrollToPercentY(0)
            }
        },searchData: function(f, d, b) {
            var a = [];
            var e;
            for (var c = 0; c < d.length; c++) {
                e = d[c];
                if (simplifyText(e.userName.substring(0, f.length)) == f) {
                    if (b == "") {
                        a.push(e)
                    } else {
                        if ($(b).find('[data-friendid="' + e.mayhemId + '"]').length == 0) {
                            a.push(e)
                        }
                    }
                }
            }
            return a
        },isNew: function(a) {
            if (a < 1209600000) {
                return true
            } else {
                return false
            }
        },startSinglePlayerMatch: function(b) {
            Scrabble.SoundManager.play_sfx("Gamescene");
            var a = $(b.currentTarget).attr("data-friendId");
            Scrabble.GameServerManager.postNewMatch([a], null, Scrabble.NewGameMenu.lastOrigin);
            Scrabble.NewGameMenu.hideProfile(true);
            Scrabble.NewGameMenu.hide()
        },inviteSinglePlayer: function(b) {
            Scrabble.SoundManager.play_sfx("Gamescene");
            var a = $(b.currentTarget).find(".smallOrangeBtn").attr("data-friendId");
            Scrabble.SocialPlatformManager.call("inviteFriend", Scrabble.NewGameMenu.lastOrigin, a, function() {
                Scrabble.GameServerManager.postNewMatch([], [a], Scrabble.NewGameMenu.lastOrigin);
                Scrabble.NewGameMenu.hideProfile(true);
                Scrabble.NewGameMenu.hide()
            }, null)
        },startMultiPlayerMatch: function(h) {
            Scrabble.SoundManager.play_sfx("Gamescene");
            var b = $("#newGameListMultiPlayerSelected").find(".multiPlayerFriend");
            var g = [];
            var a = [];
            var f = b.length;
            var d;
            for (var c = 0; c < f; c++) {
                d = $(b[c]).attr("data-friendId");
                if (d == undefined) {
                    a.push($(b[c]).find(".smallRedBtn").attr("data-friendId"))
                } else {
                    g.push(d)
                }
            }
            Scrabble.GameServerManager.postNewMatch(g, a, Scrabble.NewGameMenu.lastOrigin);
            Scrabble.NewGameMenu.playersSelected = 0;
            Scrabble.NewGameMenu.hide()
        },selectFriend: function(c) {
            if (Scrabble.NewGameMenu.playersSelected == 0) {
                $("#newGameListMultiPlayerSeparator").show();
                Scrabble.NewGameMenu.scrollApi.reinitialise()
            }
            if (Scrabble.NewGameMenu.playersSelected < 3) {
                Scrabble.SoundManager.play_sfx("Select");
                Scrabble.NewGameMenu.playersSelected++;
                var b = $(c.currentTarget);
                var a = $(c.currentTarget).find(".smallOrangeBtn");
                $("#newGameListMultiPlayerSelected").append(b);
                a.addClass("smallRedBtn");
                a.removeClass("smallOrangeBtn");
                a.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYR_RMVOPP"));
                Scrabble.NewGameMenu.scrollApi.scrollToPercentY(0)
            }
            if (Scrabble.NewGameMenu.playersSelected == 3) {
                $("#newGameListMultiPlayerList").addClass("maxSelected")
            }
        },selectPlayer: function(c) {
            if (Scrabble.NewGameMenu.playersSelected == 0) {
                $("#newGameListMultiPlayerSeparator").show();
                Scrabble.NewGameMenu.scrollApi.reinitialise()
            }
            if (Scrabble.NewGameMenu.playersSelected < 3) {
                Scrabble.SoundManager.play_sfx("Select");
                Scrabble.NewGameMenu.playersSelected++;
                var b = $(c.currentTarget);
                var a = $(c.currentTarget).find(".smallBlueBtn");
                $("#newGameListMultiPlayerSelected").append(b);
                a.addClass("smallRedBtn");
                a.removeClass("smallBlueBtn");
                a.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYR_RMVOPP"));
                Scrabble.NewGameMenu.scrollApi.scrollToPercentY(0)
            }
            if (Scrabble.NewGameMenu.playersSelected == 3) {
                $("#newGameListMultiPlayerList").addClass("maxSelected")
            }
        },selectPlayerFromProfile: function(b) {
            var a = $(b.currentTarget).attr("data-friendId");
            var c = $('#newGameListMultiPlayerList [data-friendId="' + a + '"]');
            Scrabble.NewGameMenu.selectPlayer({currentTarget: c});
            Scrabble.NewGameMenu.hideProfile()
        },deselectPlayerFromProfile: function(b) {
            var a = $(b.currentTarget).attr("data-friendId");
            var c = $('#newGameListMultiPlayerSelected [data-friendId="' + a + '"]');
            Scrabble.NewGameMenu.deselectPlayer({currentTarget: c});
            Scrabble.NewGameMenu.hideProfile()
        },deselectPlayer: function(c) {
            Scrabble.SoundManager.play_sfx("Select");
            var a = $(c.currentTarget);
            var b = a.find(".smallRedBtn");
            $("#newGameListMultiPlayerList").prepend(a);
            b.addClass("smallBlueBtn");
            b.removeClass("smallRedBtn");
            b.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYRSLCT"));
            $("#newGameListMultiPlayerList").removeClass("maxSelected");
            Scrabble.NewGameMenu.playersSelected--;
            if (Scrabble.NewGameMenu.playersSelected == 0) {
                $("#newGameListMultiPlayerSeparator").hide();
                Scrabble.NewGameMenu.scrollApi.reinitialise()
            }
            Scrabble.NewGameMenu.search("")
        },deselectFriend: function(c) {
            Scrabble.SoundManager.play_sfx("Select");
            var a = $(c.currentTarget);
            var b = a.find(".smallRedBtn");
            $("#newGameListMultiPlayerList").prepend(a);
            b.addClass("smallOrangeBtn");
            b.removeClass("smallRedBtn");
            b.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_INVT_SLCT"));
            $("#newGameListMultiPlayerList").removeClass("maxSelected");
            Scrabble.NewGameMenu.playersSelected--;
            if (Scrabble.NewGameMenu.playersSelected == 0) {
                $("#newGameListMultiPlayerSeparator").hide();
                Scrabble.NewGameMenu.scrollApi.reinitialise()
            }
        },showProfile: function(k) {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            var b = $(k.currentTarget).parent().attr("data-friendId");
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                Scrabble.NewGameMenu.showProfile(k)
            });
            if (!Scrabble.StatsManager.checkUserStatsLoaded(b, [1, 2, 3, 4, 5, 6, 7, 8])) {
                Scrabble.StatsManager.loadSingleUserStats(b);
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                    Scrabble.NewGameMenu.showProfile(k)
                });
                return false
            }
            var g = Scrabble.PlayerManager.getPlayerInfo(b, "fbId");
            var j = Scrabble.PlayerManager.playerList[g];
            var h = Scrabble.StatsManager.stats[b];
            $("#newGamePlayerProfileContent").html(Scrabble.DomBuilder.buildNewGamePlayerProfile(j, h));
            $("#newGamePlayerProfile").show();
            $("#newGamePlayerProfile").on("click", ".smallBackBtn", function() {
                Scrabble.NewGameMenu.hideProfile()
            });
            var f = $("#newGamePlayerProfileBtn");
            if (Scrabble.NewGameMenu.playerListOpened == "SinglePlayer") {
                f.removeClass("wideBlueBtn");
                f.addClass("wideGreenBtn");
                f.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_PLY"));
                f.off("click", function(c) {
                    Scrabble.NewGameMenu.selectPlayerFromProfile(c)
                });
                f.on("click", function(c) {
                    Scrabble.NewGameMenu.startSinglePlayerMatch(c)
                })
            } else {
                f.removeClass("wideGreenBtn");
                var m = $("#newGameListMultiPlayerSelected");
                var l = $(k.currentTarget).parent();
                var a = m.find(l);
                var n = m.find($(".multiPlayerFriend")).length;
                if (a.length == 0) {
                    f.addClass("wideBlueBtn");
                    if (n >= 3) {
                        f.css("opacity", 0.5);
                        f.removeClass("wideBlueBtn");
                        f.addClass("wideBlueBtnNoHover");
                        f.off("click", function(c) {
                            Scrabble.NewGameMenu.selectPlayerFromProfile(c)
                        })
                    } else {
                        f.css("opacity", 1);
                        f.addClass("wideBlueBtn");
                        f.removeClass("wideBlueBtnNoHover");
                        f.on("click", function(c) {
                            Scrabble.NewGameMenu.selectPlayerFromProfile(c)
                        })
                    }
                    f.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYRSLCT"))
                } else {
                    f.addClass("wideRedBtn");
                    f.find("p").html(Scrabble.Dictionary.translate("FRNDLST_BNT_MLTPLYR_RMVOPP"));
                    f.on("click", function(c) {
                        Scrabble.NewGameMenu.deselectPlayerFromProfile(c)
                    })
                }
                f.off("click", function(c) {
                    Scrabble.NewGameMenu.startSinglePlayerMatch(c)
                })
            }
        },hideProfile: function(b) {
            if (!b) {
                Scrabble.SoundManager.play_sfx("Cancel")
            }
            $("#newGamePlayerProfile").hide();
            $("#newGamePlayerProfile").off("click", ".smallBackBtn", function() {
                Scrabble.NewGameMenu.hideProfile()
            });
            var a = $("#newGamePlayerProfile .wideGreenBtn");
            a.off("click", function(c) {
                Scrabble.NewGameMenu.selectPlayerFromProfile(c)
            });
            a.off("click", function(c) {
                Scrabble.NewGameMenu.deselectPlayerFromProfile(c)
            });
            a.off("click", function(c) {
                Scrabble.NewGameMenu.startSinglePlayerMatch(c)
            })
        }}
}();
Scrabble.OptionsMenu = function() {
    DIV_ID = "optionsPopup";
    SLIDERS_RANGE = 360;
    return {initialized: false,isOpen: false,scrollList: null,options: {musicVolumeOption: 0,sfxVolumeOption: 50,showBonusLetters: true,showTipOfTheDay: true},musicVolumeOnShow: null,sfxVolumeOnShow: null,_lastNudgeSwitchPosition: 51,hide: function() {
            if ($("#optionsPopup").css("display") != "none") {
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.OptionsMenu.isOpen = false;
                $("#optionsPopup").hide();
                Scrabble.PopupManager.hideBlocker();
                Scrabble.Board.reEnableBoard();
                Scrabble.HelpMenu.hide();
                if (Scrabble.OptionsMenu.musicVolumeOnShow != Scrabble.OptionsMenu.options.musicVolumeOption) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "change", {subtype1: "options",subtype2: "music",data: "{old:" + Scrabble.OptionsMenu.musicVolumeOnShow + ", new:" + Scrabble.OptionsMenu.options.musicVolumeOption + "}"})
                }
                if (Scrabble.OptionsMenu.sfxVolumeOnShow != Scrabble.OptionsMenu.options.sfxVolumeOption) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "change", {subtype1: "options",subtype2: "sfx",data: "{old:" + Scrabble.OptionsMenu.sfxVolumeOnShow + ", new:" + Scrabble.OptionsMenu.options.sfxVolumeOption + "}"})
                }
            }
        },show: function(a) {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.NewGameMenu.hide();
            Scrabble.GameOptionsMenu.hide();
            Scrabble.OptionsMenu.isOpen = true;
            if (!Scrabble.OptionsMenu.initialized) {
                Scrabble.OptionsMenu.initialize()
            }
            if (Scrabble.QuestPopup.isToyotaQuestActive) {
                $("#avalon").html(Scrabble.QuestBuilder.optionsToyotaMenu());
                $("#optionsAvalonBtn").show()
            } else {
                $("#optionsAvalonBtn").hide()
            }
            SLIDERS_RANGE = parseInt($(".optionsSliderBackground").css("width"));
            console.warn(SLIDERS_RANGE);
            Scrabble.OptionsMenu.musicVolumeOnShow = Scrabble.OptionsMenu.options.musicVolumeOption;
            Scrabble.OptionsMenu.sfxVolumeOnShow = Scrabble.OptionsMenu.options.sfxVolumeOption;
            $("#optionsPopup").show();
            Scrabble.PopupManager.showBlocker();
            Scrabble.Board.disableBoard();
            Scrabble.OptionsMenu.showOptions()
        },initialize: function() {
            $("#optionsPopup").html(Scrabble.DomBuilder.buildOptionsMenu());
            $("#scrabbleStoreOptBtn").click(function() {
                Scrabble.OptionsMenu.hide();
                Scrabble.Store.show()
            });
            $("#optionsCloseButton").click(Scrabble.OptionsMenu.hide);
            $("#scrabbleAboutBtn").click(Scrabble.OptionsMenu.showAbout);
            $("#lastHelpBtn").click(Scrabble.HelpMenu.showCredits);
            $("#optionsAvalonBtn").click(Scrabble.HelpMenu.showAvalon);
            Scrabble.OptionsMenu.scrollList = $("#optionsList").jScrollPane({showArrows: true});
            Scrabble.OptionsMenu.ListDOM = Scrabble.OptionsMenu.scrollList.data("jsp").getContentPane();
            if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                $("#musicVolumeOption").hide();
                $("#sfxVolumeOption").hide()
            } else {
                $("#musicVolumeOption .optionsSliderBtn").draggable({containment: $("#musicVolumeOption .optionsSliderBackground"),axis: "x",scroll: false,drag: function(d, e) {
                        Scrabble.Board.disableBoard();
                        if (parseInt(e.position.left) > SLIDERS_RANGE) {
                            $(e).css("left", SLIDERS_RANGE + "px");
                            e.position.left = SLIDERS_RANGE
                        }
                        Scrabble.OptionsMenu._onSliderDrag("musicVolumeOption", e.position.left)
                    },stop: function(d, e) {
                        Scrabble.OptionsMenu._onSliderStop("musicVolumeOption", e.position.left)
                    }});
                $("#musicVolumeOption .optionsSliderForeground").on("click", function(d) {
                    if (!d.offsetX) {
                        var f = Math.min(d.originalEvent.layerX, SLIDERS_RANGE)
                    } else {
                        var f = Math.min(d.offsetX, SLIDERS_RANGE)
                    }
                    Scrabble.OptionsMenu.setSliderValue("musicVolumeOption", Math.round(f / SLIDERS_RANGE * 100))
                });
                $("#sfxVolumeOption .optionsSliderBtn").draggable({containment: $("#sfxVolumeOption .optionsSliderBackground"),axis: "x",scroll: false,drag: function(d, e) {
                        Scrabble.Board.disableBoard();
                        if (parseInt(e.position.left) > SLIDERS_RANGE) {
                            $(e).css("left", SLIDERS_RANGE + "px");
                            e.position.left = SLIDERS_RANGE
                        }
                        Scrabble.OptionsMenu._onSliderDrag("sfxVolumeOption", e.position.left)
                    },stop: function(d, e) {
                        Scrabble.OptionsMenu._onSliderStop("sfxVolumeOption", e.position.left);
                        Scrabble.SoundManager.play_sfx("Radio_btn")
                    }});
                $("#sfxVolumeOption .optionsSliderForeground").on("click", function(d) {
                    if (!d.offsetX) {
                        var f = Math.min(d.originalEvent.layerX, SLIDERS_RANGE)
                    } else {
                        var f = Math.min(d.offsetX, SLIDERS_RANGE)
                    }
                    Scrabble.OptionsMenu.setSliderValue("sfxVolumeOption", Math.round(f / SLIDERS_RANGE * 100));
                    Scrabble.SoundManager.play_sfx("Radio_btn")
                })
            }
            $("#nudgesInfoToken").on("click", function(d) {
                Scrabble.OptionsMenu.showHelp();
                Scrabble.HelpMenu.insideQuickHelp = true;
                Scrabble.HelpMenu.selectTopic(Scrabble.Dictionary.translate("FCBK_HLP_BTN_TRNNTFCTNS"), "FCBK_HLP_BTN_TRNNTFCTNS,FCBK_HLP_TXT_TRNNTFCTNS_MSG")
            });
            $("#bonusLettersOption").on("click", Scrabble.OptionsMenu.toggleShowBonusLetters);
            $("#showTipOfTheDayOption").on("click", Scrabble.OptionsMenu.toggleShowTipOfTheDay);
            $("#scrabbleHelpBtn").click(Scrabble.OptionsMenu.showHelp);
            $("#scrabbleForumsBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                SurveyBridge.openLink("http://forum.ea.com/eaforum/categories/show/230.page")
            });
            $("#scrabbleFollowBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                window.open("https://www.facebook.com/ScrabbleEA", "_blank")
            });
            $("#scrabbleFeedbackBtn").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.TelemetryManager.sendFeedback("feedback", null, "click", null, null);
                SurveyBridge.openSurvey()
            });
            $(".optionsDropdownRight").click(Scrabble.OptionsMenu.barrelDown);
            Scrabble.OptionsMenu.initialized = true;
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                var b = Scrabble.LocalStorageManager.get("sfxVolumeOption");
                if (b != undefined) {
                    Scrabble.OptionsMenu.setSliderValue("sfxVolumeOption", b, true)
                } else {
                    Scrabble.OptionsMenu.setSliderValue("sfxVolumeOption", 50, true)
                }
                b = Scrabble.LocalStorageManager.get("musicVolumeOption");
                if (b != undefined) {
                    Scrabble.OptionsMenu.setSliderValue("musicVolumeOption", b, true)
                } else {
                    Scrabble.OptionsMenu.setSliderValue("musicVolumeOption", 0, true)
                }
                var a = Scrabble.LocalStorageManager.get("showBonusLetters");
                if (a === "false") {
                    $("#bonusLettersOption").toggleClass("checked")
                }
                var c = Scrabble.LocalStorageManager.get("showTipOfTheDay");
                if (c === "false") {
                    $("#showTipOfTheDayOption").toggleClass("checked");
                    Scrabble.OptionsMenu.options.showTipOfTheDay = false
                }
            } else {
                Scrabble.OptionsMenu.setSliderValue("sfxVolumeOption", 50, true);
                Scrabble.OptionsMenu.setSliderValue("musicVolumeOption", 0, true)
            }
            Scrabble.HelpMenu.initialize();
            setTimeout(function() {
                Scrabble.OptionsMenu.scrollList.data("jsp").reinitialise()
            }, 100)
        },_onSliderDrag: function(b, a) {
            $("#" + b + " .optionsSliderForeground").find(".optionsSliderMiddle").width(a + "px")
        },_onSliderStop: function(b, a) {
            $("#" + b + " .optionsSliderForeground").find(".optionsSliderMiddle").width(a + "px");
            var c = Math.round(a / SLIDERS_RANGE * 100);
            Scrabble.OptionsMenu.options[b] = c;
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                Scrabble.LocalStorageManager.set(b, c)
            }
            if (b == "sfxVolumeOption") {
                Scrabble.SoundManager.setVolume("sfx", c)
            } else {
                if (b == "musicVolumeOption") {
                    Scrabble.SoundManager.setVolume("music", c)
                }
            }
        },showOptions: function() {
            $("#optionsElementList").show();
            $("#credits").hide();
            $("#avalon").hide();
            setTimeout(function() {
                Scrabble.OptionsMenu.scrollList.data("jsp").reinitialise()
            }, 100)
        },showAbout: function() {
            SurveyBridge.openLink("https://www.playfish.com/support_page/index.html")
        },setSliderValue: function(b, c, d) {
            Scrabble.OptionsMenu.options[b] = c;
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                Scrabble.LocalStorageManager.set(b, c)
            }
            var a = Math.round(c / 100 * SLIDERS_RANGE);
            $("#" + b + " .optionsSliderForeground").find(".optionsSliderMiddle").width(a + "px");
            $("#" + b + " .optionsSliderBtn").css("left", a + "px");
            if (b == "sfxVolumeOption" && !d) {
                Scrabble.SoundManager.setVolume("sfx", c)
            } else {
                if (b == "musicVolumeOption" && !d) {
                    Scrabble.SoundManager.setVolume("music", c)
                }
            }
        },toggleShowBonusLetters: function() {
            Scrabble.OptionsMenu.options.showBonusLetters = !Scrabble.OptionsMenu.options.showBonusLetters;
            if (Scrabble.OptionsMenu.options.showBonusLetters) {
                Scrabble.SoundManager.play_sfx("Generic_btn")
            } else {
                Scrabble.SoundManager.play_sfx("Cancel")
            }
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                Scrabble.LocalStorageManager.set("showBonusLetters", Scrabble.OptionsMenu.options.showBonusLetters)
            }
            $("#bonusLettersOption").toggleClass("checked");
            $("#scrabbleGame").toggleClass("hideBonusLetters")
        },toggleShowTipOfTheDay: function() {
            Scrabble.OptionsMenu.options.showTipOfTheDay = !Scrabble.OptionsMenu.options.showTipOfTheDay;
            if (Scrabble.OptionsMenu.options.showTipOfTheDay) {
                Scrabble.SoundManager.play_sfx("Generic_btn")
            } else {
                Scrabble.SoundManager.play_sfx("Cancel")
            }
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                Scrabble.LocalStorageManager.set("showTipOfTheDay", Scrabble.OptionsMenu.options.showTipOfTheDay)
            }
            $("#showTipOfTheDayOption").toggleClass("checked")
        },showHelp: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.HelpMenu.show()
        }}
}();
Scrabble.RightMenu = function() {
    return {isExpanded: true,isTransitioning: false,pannelDisplayed: null,width: 231,hide: function(a) {
            if (Scrabble.RightMenu.isTransitioning == true && !a) {
                return false
            }
            Scrabble.RightMenu.isTransitioning = true;
            Scrabble.RightMenu.isExpanded = false;
            if (a == undefined) {
                Scrabble.SoundManager.play_sfx("Popup_close")
            }
            var b = $("#rightMenu");
            b.stop(true, true);
            b.css("z-index", "2");
            b.animate({left: "527px"}, 300, function() {
                var c = document.getElementById("boardSkinSelectorBtn");
                var f = $("#scrabbleGame .top");
                if (c != null) {
                    f.append(c);
                    c.style.left = "388px"
                }
                var d = document.getElementById("toggleChatBtn");
                if (d != null) {
                    f.append(d);
                    d.style.left = "480px"
                }
                var e = document.getElementById("toggleWordListBtn");
                if (e != null) {
                    f.append(e);
                    e.style.left = "434px"
                }
                Scrabble.RightMenu.isTransitioning = false
            })
        },show: function(e) {
            var f = $("#rightMenu");
            if (Scrabble.RightMenu.isTransitioning == true && !e) {
                return false
            }
            Scrabble.RightMenu.isTransitioning = true;
            var b = "758px";
            if (Scrabble.ResolutionManager.widthBracket == 1) {
                b = "528px"
            }
            Scrabble.RightMenu.isExpanded = true;
            f.stop(true, true);
            f.animate({left: b}, 300, function() {
                f.css("z-index", "20");
                Scrabble.RightMenu.isTransitioning = false;
                Scrabble.Chat.chatScrollApi.reinitialise()
            });
            var a = $("#boardSkinSelectorBtn");
            if (a != null) {
                $("#rightMenu .top").append(a);
                a.css("left", "0px")
            }
            var c = $("#toggleChatBtn");
            if (c != null) {
                $("#rightMenu .top").append(c);
                c.css("left", "181px")
            }
            var d = $("#toggleWordListBtn");
            if (d != null) {
                $("#rightMenu .top").append(d);
                d.css("left", "90px")
            }
        },showChat: function() {
            Scrabble.Chat.stopPlusGlow();
            $("#rightMenu").show();
            Scrabble.RightMenu.pannelDisplayed = "chat";
            $("#rightMenuCarrot").css("left", "195px");
            $("#chatPanel").show();
            $("#wordListPanel").hide();
            Scrabble.Chat.getChatRoom(Scrabble.Chat.lastEntries);
            Scrabble.Chat.update();
            var a = {matchID: Scrabble.GameServerManager.currentGame().matchuri.substring(9)};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "click", {subtype1: "features",subtype2: "chat",data: JSON.stringify(a)})
        },showWordList: function() {
            $("#rightMenu").show();
            Scrabble.RightMenu.pannelDisplayed = "wordList";
            $("#rightMenuCarrot").css("left", "105px");
            $("#wordListPanel").show();
            $("#chatPanel").hide();
            Scrabble.WordList.reinitialize();
            var c = Scrabble.GameServerManager.currentGame();
            if (typeof c != "undefined") {
                var b = {matchID: c.matchuri.substring(9)}
            } else {
                var b = {}
            }
            var a = Scrabble.TelemetryManager._getMatchType(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, {subtype1: "features",subtype2: "dictionary",subtype3: "click",data: JSON.stringify(b)})
        }}
}();
Scrabble.TopMenu = function() {
    var a = "chat";
    return {boardSelectorEnabled: true,initialize: function() {
            var c = $("#scrabbleBody");
            c.on("click", "#toggleLeftMenuBtn", function() {
                Scrabble.TopMenu.toggleLeftMenu();
                Scrabble.SoundManager.play_sfx("Generic_btn")
            });
            c.on("click", "#boardSkinSelectorBtn", function() {
                Scrabble.Store.show("menu");
                Scrabble.SoundManager.play_sfx("Generic_btn")
            });
            c.on("click", "#toggleChatBtn", function() {
                Scrabble.TopMenu.toggleChat();
                Scrabble.SoundManager.play_sfx("Generic_btn")
            });
            c.on("click", "#toggleWordListBtn", function() {
                Scrabble.TopMenu.toggleWordList();
                Scrabble.SoundManager.play_sfx("Generic_btn")
            });
            $("#toggleLeftMenuBtn").attr("title", Scrabble.Dictionary.translate("GSCN_LBL_MENU"));
            $("#boardSkinSelectorBtn").attr("title", Scrabble.Dictionary.translate("STR_BTN_STRMNMNU"));
            $("#boardSkinSelectorImage").html(Scrabble.Dictionary.translate("STR_BTN_STRMNMNU"));
            $("#toggleChatBtn").attr("title", Scrabble.Dictionary.translate("GSCN_LBL_CHAT"));
            $("#toggleWordListBtn").attr("title", Scrabble.Dictionary.translate("GSCN_LBL_WRDLST"));
            $("#cardZoneDivision").on("click", ".gameCard", function() {
                var d = $(this).attr("id");
                var e = d.substring(d.indexOf("_") + 1);
                Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.ShowPlayerProfile, e)
            });
            if ($("#messageBoard").length) {
                var b;
                if (Scrabble.config.lang == "en") {
                    b = (Scrabble.config._mBoardDisplay == true) ? Scrabble.config._messageBoard_EN : Scrabble.Dictionary.translate("FCBK_TXT_IEOLDVRSN")
                } else {
                    b = (Scrabble.config._mBoardDisplay == true) ? Scrabble.config._messageBoard_FR : Scrabble.Dictionary.translate("FCBK_TXT_IEOLDVRSN")
                }
                $("#mBoard_message").html(b);
                $("#game_container").css("height", "946px");
                $("#mBoard_close").click(Scrabble.TopMenu.closeMessageBoard)
            }
            $("#viewBoardBtn").hide();
            $("#rematchBtn").hide();
            $(".headerButtonMiddle").each(function(d) {
                $(this).children("a").html(Scrabble.Dictionary.translate($(this).children("a").attr("title")));
                $(this).children("a").attr("title", Scrabble.Dictionary.translate($(this).children("a").attr("title")))
            })
        },closeMessageBoard: function() {
            Scrabble.TipManager.removeTips();
            $("#messageBoard").animate({height: "0px"}, 150, function() {
                $(this).remove();
                if (Scrabble.LeaderBoard.isExpanded) {
                    $("#game_container").css("height", "910px")
                } else {
                    $("#game_container").css("height", "775px")
                }
            })
        },toggleLeftMenu: function() {
            if (Scrabble.ResolutionManager.widthBracket == 2) {
                return false
            }
            Scrabble.LeftMenu.toggleDisplay();
            if (Scrabble.LeftMenu.isExpanded) {
                Scrabble.RightMenu.hide()
            } else {
                if (!Scrabble.LeftMenu.isExpanded && Scrabble.ResolutionManager.widthBracket != 0) {
                    Scrabble.RightMenu.show()
                }
            }
        },toggleRightMenu: function(b) {
            Scrabble.ResolutionManager.updateResolution();
            if (Scrabble.ResolutionManager.widthBracket == 2) {
                Scrabble.RightMenu.show();
                Scrabble.LeftMenu.show()
            } else {
                if (Scrabble.ResolutionManager.widthBracket == 1) {
                    if (Scrabble.RightMenu.isExpanded) {
                        if (Scrabble.RightMenu.pannelDisplayed == b) {
                            Scrabble.RightMenu.hide();
                            Scrabble.LeftMenu.show()
                        }
                    } else {
                        Scrabble.RightMenu.show();
                        Scrabble.LeftMenu.hide()
                    }
                } else {
                    if (Scrabble.RightMenu.isExpanded) {
                        if (Scrabble.RightMenu.pannelDisplayed == b) {
                            Scrabble.RightMenu.hide()
                        }
                    } else {
                        Scrabble.LeftMenu.hide();
                        Scrabble.RightMenu.show()
                    }
                }
            }
        },toggleChat: function() {
            if (Scrabble.RightMenu.pannelDisplayed == "chat" && Scrabble.RightMenu.isExpanded) {
                Scrabble.ResolutionManager.reduceResolution();
                Scrabble.RightMenu.pannelDisplayed = null
            } else {
                Scrabble.TopMenu.toggleRightMenu("chat");
                Scrabble.RightMenu.showChat()
            }
        },toggleWordList: function() {
            if (Scrabble.RightMenu.pannelDisplayed != "wordList") {
                Scrabble.TopMenu.toggleRightMenu("wordList");
                Scrabble.RightMenu.showWordList()
            } else {
                Scrabble.ResolutionManager.reduceResolution();
                Scrabble.RightMenu.pannelDisplayed = null
            }
        },createPlayerCards: function() {
            $("#cardZoneDivision").before(Scrabble.DomBuilder.playerCardsConstruct)
        }}
}();
Scrabble.BonusSquareParticle = function() {
    return {lastId: 0,addParticle: function(b) {
            var c = "bonusSquareParticle_" + Scrabble.BonusSquareParticle.generateId();
            var a = Scrabble.DomBuilder.bonusSquareParticle(c, b);
            $("#particleHolder").append(a);
            return c
        },generateId: function() {
            Scrabble.BonusSquareParticle.lastId++;
            return Scrabble.BonusSquareParticle.lastId
        }}
}();
Scrabble.EndGamePopup = function() {
    return {initialized: false,counting: false,currentMatchLoaded: "",init: function(q, h) {
            Scrabble.LeftMenu.lockList();
            var o = Scrabble.PlayerManager.currentUser.mayhemId;
            var c;
            var m = Scrabble.StatsManager.stats[o];
            var l = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (l == undefined) {
                l = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
            }
            Scrabble.EndGamePopup.currentMatchLoaded = Scrabble.GameServerManager.currentMatch;
            var b = {};
            var j = 0;
            var e = [];
            for (j = 0; j < l.mmatchusers.matchuser.length; j++) {
                if (l.mmatchusers.matchuser[j].userid == o && q == true) {
                    l.mmatchusers.matchuser[j].status = "RESIGNED"
                }
                b[l.mmatchusers.matchuser[j].userid] = l.mmatchusers.matchuser[j];
                b[l.mmatchusers.matchuser[j].userid].bingos = 0;
                b[l.mmatchusers.matchuser[j].userid].turnPlayed = 0;
                b[l.mmatchusers.matchuser[j].userid].totalPoints = 0;
                b[l.mmatchusers.matchuser[j].userid].highestWord = 0;
                if (b[l.mmatchusers.matchuser[j].userid].bonus.toExponential == undefined) {
                    b[l.mmatchusers.matchuser[j].userid].bonus = 0
                }
                if (b[l.mmatchusers.matchuser[j].userid].penalty.toExponential == undefined) {
                    b[l.mmatchusers.matchuser[j].userid].penalty = 0
                }
                b[l.mmatchusers.matchuser[j].userid].total = b[l.mmatchusers.matchuser[j].userid].userscore;
                b[l.mmatchusers.matchuser[j].userid].baseScore = b[l.mmatchusers.matchuser[j].userid].penalty - b[l.mmatchusers.matchuser[j].userid].bonus + b[l.mmatchusers.matchuser[j].userid].userscore
            }
            $("#viewBoardBtn").show();
            Scrabble.TileManager.disableTiles();
            $("#rematchBtn").show();
            var n = $("#overlayContainer");
            n.off("click", "#viewBoardBtn", Scrabble.EndGamePopup.toggleViewBoard);
            n.on("click", "#viewBoardBtn", Scrabble.EndGamePopup.toggleViewBoard);
            n.off("click", "#rematchBtn", Scrabble.EndGamePopup.beginRematch);
            n.on("click", "#rematchBtn", Scrabble.EndGamePopup.beginRematch);
            if (l.plays) {
                if (l.plays.play) {
                    if (l.plays.play.length) {
                        for (j = 0; j < l.plays.play.length; j++) {
                            var d = l.plays.play[j];
                            if (d.playtype == "PLAY_WORD") {
                                if (d.playdata.split(";").length == 7) {
                                    b[d.useruri.split("/")[2]].bingos++
                                }
                                b[d.useruri.split("/")[2]].turnPlayed++;
                                b[d.useruri.split("/")[2]].totalPoints += d.score;
                                if (d.score > b[d.useruri.split("/")[2]].highestWord) {
                                    b[d.useruri.split("/")[2]].highestWord = d.score
                                }
                            }
                        }
                    }
                }
            }
            for (var a in b) {
                e.push(b[a])
            }
            e = e.sort(Scrabble.EndGamePopup._sortUsersByRanks);
            for (j = 0; j < e.length; j++) {
                if (e[j].userid == o) {
                    if (!h) {
                        Scrabble.SoundManager.play_sfx("Rank_" + (j + 1))
                    }
                    c = j + 1
                }
            }
            $("#endGamePopup").html(Scrabble.PopupFactory.endGamePopup(e, m, o));
            $("#eogDiag .cancelButton").click(Scrabble.EndGamePopup.hide);
            if (Scrabble.AnimationManager.animationsEnabled) {
                var k = $("#eogPlayerContainer");
                var r = k.css("left");
                k.css("left", (r - 500) + "px");
                k.animate({left: (r) + "px"}, 750, "easeOutQuad", function() {
                    Scrabble.EndGamePopup.startCounting(e)
                });
                $("#eogFBShare").css("left", (r - 500) + "px");
                $("#eogFBShare").animate({left: (r) + "px"}, 750, "easeOutQuad")
            } else {
                Scrabble.EndGamePopup.startCounting(e)
            }
            var s = function() {
                Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.FacebookWallPost)
            };
            var g = [];
            for (var a in b) {
                if (a != o) {
                    g.push(Scrabble.PlayerManager.getPlayerInfo(a, "first_name"))
                }
            }
            if (c > 1) {
                if (b[e[0].userid].total == b[o].total) {
                    c = 0
                }
            } else {
                if (e[1] != null && b[e[0].userid].total == b[e[1].userid].total) {
                    c = 0
                }
            }
            var f = {score: b[o].total,name: Scrabble.PlayerManager.getPlayerInfo(o, "first_name"),opponents: g,rank: c};
            $("#endGamePopup").css("top", (((530 - $("#endGamePopup").innerHeight()) / 2) + 34) + "px");
            $("#eogFBShare").click(function() {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.SocialPlatformManager.call("publishWonGame", s, f)
            })
        },_sortUsersByRanks: function(d, c) {
            if (d.status == "RESIGNED" && c.status != "RESIGNED") {
                return 1
            } else {
                if (d.status != "RESIGNED" && (c.status == "RESIGNED" || c.status == "RESIGNED_NOPENALTY")) {
                    return -1
                } else {
                    return c.total - d.total
                }
            }
        },toggleViewBoard: function() {
            Scrabble.TileManager.disableTiles();
            if ($("#endGamePopup").css("display") == "block") {
                Scrabble.SoundManager.play_sfx("Cancel");
                $("#endGamePopup").hide();
                $("#gameScene .blocker").fadeTo(200, 0, function() {
                    $(this).remove()
                });
                $("#viewBoardBtn p").html(Scrabble.Dictionary.translate("GSCNEND_LBL_VEWSTTS"))
            } else {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                $("#gameScene .blocker").remove();
                $("#gameScene").append('<span class="blocker"></span>');
                $("#gameScene .blocker").show();
                $("#endGamePopup").show();
                $("#viewBoardBtn p").html(Scrabble.Dictionary.translate("GSCNEND_LBL_VEWBRD"))
            }
        },beginRematch: function() {
            var e = $("#rematchBtn");
            e.css("opacity", 0.5);
            e.removeClass("smallGreenBtn");
            e.addClass("smallGreenBtnNoHover");
            Scrabble.SoundManager.play_sfx("Gamescene");
            $("#overlayContainer").off("click", "#rematchBtn", Scrabble.EndGamePopup.beginRematch);
            var b = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (b == undefined) {
                b = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
            }
            if (b.mmatchusers.matchuser.length <= 1) {
                Scrabble.GameServerManager.postNewMatch()
            } else {
                if (b != undefined) {
                    var d = Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.RATING.id];
                    var a = {};
                    a.uid = Scrabble.PlayerManager.currentUser.mayhemId;
                    a.title = "Scrabble rematch with " + Scrabble.PlayerManager.currentUser.first_name;
                    a.description = " ";
                    a.access = "PRIVATE";
                    a.dictionary = b.board.dictionary;
                    a.speed = Scrabble.MatchOptions.gameSpeed;
                    a.userRating = d;
                    a.ratingRange = Scrabble.MatchOptions.opponentRatingRange;
                    a.startUserCount = b.startusercount;
                    var g = [];
                    var f = [];
                    for (var c = 0; c < b.mmatchusers.matchuser.length; c++) {
                        if (b.mmatchusers.matchuser[c].userid != Scrabble.PlayerManager.currentUser.mayhemId) {
                            f.push(Scrabble.PlayerManager.getPlayerInfo(b.mmatchusers.matchuser[c].userid, "fbId"));
                            g.push(b.mmatchusers.matchuser[c].userid)
                        }
                    }
                    a.matchUserIds = g.join(",");
                    Scrabble.GameServerManager.postRematch(a, f)
                } else {
                    console.error("Could not initiate a rematch with original Id : " + Scrabble.GameServerManager.currentMatch)
                }
            }
        },startCounting: function(a) {
            $("#shuffleBtn").hide();
            $("#forfeitBtn").hide();
            $("#tradeTilesBtn").hide();
            $("#playBtn").hide();
            $("#rematchBtn").show();
            $("#viewBoardBtn").show();
            Scrabble.TileManager.disableTiles();
            Scrabble.EndGamePopup.counting = false;
            Scrabble.LeftMenu.unlockList()
        },hide: function() {
            $("#shuffleBtn").show();
            $("#forfeitBtn").show();
            $("#tradeTilesBtn").show();
            $("#playBtn").show();
            $("#rematchBtn").hide();
            $("#viewBoardBtn").hide();
            $("#endGamePopup").hide();
            $("#gameScene .blocker").fadeTo(200, 0, function() {
                $(this).remove()
            })
        },show: function(a, c) {
            if (!Scrabble.EndGamePopup.initialized) {
                if (Scrabble.EndGamePopup.currentMatchLoaded != Scrabble.GameServerManager.currentMatch) {
                    Scrabble.EndGamePopup.init(a, c);
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameServerManager.endGame)
                }
            }
            var b = $("#rematchBtn");
            b.css("opacity", 1);
            b.removeClass("smallGreenBtnNoHover");
            b.addClass("smallGreenBtn");
            $("#endGamePopup").show();
            $("#gameScene .blocker").remove();
            $("#gameScene").append('<span class="blocker"></span>');
            $("#gameScene .blocker").show();
            $("#playBtn").hide();
            $("#viewBoardBtn p").html(Scrabble.Dictionary.translate("GSCNEND_LBL_VEWBRD"));
            Scrabble.GameScene.isWaitingForPlayValidation = false;
            Scrabble.GameScene.waitingConfirmation = false
        }}
}();
Scrabble.MultiFriendSelectorPopup = function() {
    var b = 25;
    var c = false;
    var a = null;
    return {numInvitedFriends: 0,numFriendsToInvite: 0,currentlySelectedFriends: {},currentlySelectedPage: 0,currentlySelectedTab: "None",sessionInvitedFriends: {},friendsOrdering: [],wordFriendCount: 0,init: function() {
            Scrabble.MultiFriendSelectorPopup.numFriendsToInvite = 0;
            c = true;
            a = Scrabble.PopupFactory.multiFriendSelectorPopup()
        },show: function() {
            if (c != true) {
                Scrabble.MultiFriendSelectorPopup.init()
            }
            Scrabble.PopupManager.add(a);
            Scrabble.MultiFriendSelectorPopup.buildFriendsOrdering(true);
            Scrabble.MultiFriendSelectorPopup.numFriendsToInvite = Scrabble.MultiFriendSelectorPopup.friendsOrdering.length;
            Scrabble.MultiFriendSelectorPopup.updateProgressBar();
            Scrabble.MultiFriendSelectorPopup.showFriendsPage(0);
            Scrabble.MultiFriendSelectorPopup.currentlySelectedTab = "All";
            if (Scrabble.WordGameUtils.didReceiveWGFInformation) {
                $(".mfsTurnOnWGFButton").hide()
            }
            $(".mfsCloseButton").click(Scrabble.MultiFriendSelectorPopup.closeButtonCallback);
            $("#allFriendsTab").click(Scrabble.MultiFriendSelectorPopup.allFriendsTabSelected);
            $("#wordGameFriendsTab").click(Scrabble.MultiFriendSelectorPopup.wordGameFriendsTabSelected);
            $(".mfsCard").click(Scrabble.MultiFriendSelectorPopup.friendCardClickCallback);
            $(".mfsSelectAllButton").click(Scrabble.MultiFriendSelectorPopup.selectAllButtonCallback);
            $(".mfsSendButton").click(Scrabble.MultiFriendSelectorPopup.sendButtonCallback);
            $(".mfsLeftArrow").click(Scrabble.MultiFriendSelectorPopup.leftArrowClickCallback);
            $(".mfsRightArrow").click(Scrabble.MultiFriendSelectorPopup.rightArrowClickCallback);
            $(".mfsTurnOnWGFButton").click(Scrabble.MultiFriendSelectorPopup.showExtendedPermissionPopup)
        },hide: function() {
            if (Scrabble.MultiFriendSelectorPopup.onboardCloseCallback != null) {
                Scrabble.MultiFriendSelectorPopup.onboardCloseCallback();
                Scrabble.MultiFriendSelectorPopup.onboardCloseCallback = null
            }
            Scrabble.PopupManager.close()
        },showExtendedPermissionPopup: function() {
            var e = Scrabble.PopupFactory.enableWGFPermissionsPopup();
            var d = $("#mfsPopupContainer");
            mfsPopupContainer.html(e);
            mfsPopupContainer.find(".popupButton").off("click", Scrabble.MultiFriendSelectorPopup.extendedPermissionOk);
            mfsPopupContainer.find(".xButton").off("click", Scrabble.MultiFriendSelectorPopup.extendedPermissionCancel);
            mfsPopupContainer.find(".popupButton").on("click", Scrabble.MultiFriendSelectorPopup.extendedPermissionOk);
            mfsPopupContainer.find(".xButton").on("click", Scrabble.MultiFriendSelectorPopup.extendedPermissionCancel);
            mfsPopupContainer.show()
        },extendedPermissionOk: function() {
            $("#mfsPopupContainer").hide();
            Scrabble.SocialPlatformManager.call("askForExtendedPermissions", Scrabble.MultiFriendSelectorPopup.extendedPermissionSuccess, Scrabble.MultiFriendSelectorPopup.extendedPermissionFailure)
        },extendedPermissionCancel: function() {
            var d = Scrabble.PopupFactory.wgfFallbackPopup();
            $("#mfsPopupContainer").html(d);
            $("#mfsPopupContainer").find(".popupButton").off("click", Scrabble.MultiFriendSelectorPopup.fallbackOk);
            $("#mfsPopupContainer").find(".popupButton").on("click", Scrabble.MultiFriendSelectorPopup.fallbackOk);
            $("#mfsPopupContainer").show()
        },extendedPermissionSuccess: function() {
            Scrabble.SocialPlatformManager.call("findWordGameFriends", Scrabble.MultiFriendSelectorPopup.wgfFoundCallback)
        },extendedPermissionFailure: function() {
            var d = Scrabble.PopupFactory.wgfFallbackPopup();
            $("#mfsPopupContainer").html(d);
            $("#mfsPopupContainer").find(".popupButton").off("click", Scrabble.MultiFriendSelectorPopup.fallbackOk);
            $("#mfsPopupContainer").find(".popupButton").on("click", Scrabble.MultiFriendSelectorPopup.fallbackOk);
            $("#mfsPopupContainer").show()
        },wgfFoundCallback: function() {
            Scrabble.MultiFriendSelectorPopup.hide();
            Scrabble.MultiFriendSelectorPopup.show()
        },fallbackOk: function() {
            $("#mfsPopupContainer").hide()
        },buildFriendsOrdering: function(l) {
            Scrabble.MultiFriendSelectorPopup.friendsOrdering = [];
            Scrabble.MultiFriendSelectorPopup.wordFriendCount = 0;
            var g = Scrabble.PlayerManager.friends;
            var h = Scrabble.PlayerManager.playerList;
            var k = [];
            var e = [];
            if (Scrabble.WordGameUtils.didReceiveWGFInformation == false) {
                for (var f = 0; f <= Math.ceil(g.length / (b - 1)); f++) {
                    e.push(Math.floor(Math.random() * b) + f * b)
                }
            }
            var d = 0;
            for (var f = 0; f < g.length; f++) {
                if ((f + d) == e[d]) {
                    Scrabble.MultiFriendSelectorPopup.friendsOrdering.push(-1);
                    d++
                }
                if (h[g[f].facebookId].likesWordGames && Scrabble.MultiFriendSelectorPopup.sessionInvitedFriends[g[f].facebookId] != true) {
                    k.push(g[f].facebookId);
                    Scrabble.MultiFriendSelectorPopup.wordFriendCount++;
                    if (l) {
                        Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[g[f].facebookId] = true
                    }
                } else {
                    if (Scrabble.MultiFriendSelectorPopup.sessionInvitedFriends[g[f].facebookId] != true) {
                        Scrabble.MultiFriendSelectorPopup.friendsOrdering.push(g[f].facebookId)
                    }
                }
            }
            Scrabble.MultiFriendSelectorPopup.friendsOrdering = k.concat(Scrabble.MultiFriendSelectorPopup.friendsOrdering);
            if (Scrabble.MultiFriendSelectorPopup.wordFriendCount > 0) {
                $("#mfsWordGameFriendsJewel").show();
                $("#mfsWordGameFriendsJewel").html(Scrabble.MultiFriendSelectorPopup.wordFriendCount)
            } else {
                $("#mfsWordGameFriendsJewel").hide()
            }
        },showFriendsPage: function(d, h) {
            var j = $("#mfsCardArea");
            var e = null;
            var g = null;
            Scrabble.MultiFriendSelectorPopup.currentlySelectedPage = d;
            for (var f = b * d; f < b * (d + 1); f++) {
                e = j.children("#mfsCard" + f % b);
                g = Scrabble.PlayerManager.playerList[Scrabble.MultiFriendSelectorPopup.friendsOrdering[f]];
                if (Scrabble.MultiFriendSelectorPopup.friendsOrdering[f] == -1 && !h) {
                    e.children(".mfsCardName").html("Word game Friends");
                    e.children(".mfsCardPicture").attr("src", Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png");
                    e.show();
                    continue
                } else {
                    if (g == null || (h && f >= Scrabble.MultiFriendSelectorPopup.wordFriendCount)) {
                        e.hide();
                        continue
                    } else {
                        e.show()
                    }
                }
                e.children(".mfsCardName").html(trimName(g.first_name, g.last_name, 22));
                e.children(".mfsCardPicture").attr("src", g.picUrl);
                if (f < Scrabble.MultiFriendSelectorPopup.wordFriendCount) {
                    e.children(".mfsCardWordGameFriend").show()
                } else {
                    e.children(".mfsCardWordGameFriend").hide()
                }
                if (Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[g.fbId] == true) {
                    e.addClass("mfsCardSelected");
                    e.children(".mfsCardCheckmark").show()
                } else {
                    e.removeClass("mfsCardSelected");
                    e.children(".mfsCardCheckmark").hide()
                }
            }
        },showWordGameFriendsPage: function(d) {
            Scrabble.MultiFriendSelectorPopup.showFriendsPage(d, true)
        },updateProgressBar: function() {
            var d = Scrabble.MultiFriendSelectorPopup.numInvitedFriends + " of " + Scrabble.MultiFriendSelectorPopup.numFriendsToInvite + " friends";
            $("#mfsContent").children(".mfsProgressBar").html(d)
        },allFriendsTabSelected: function() {
            if (Scrabble.MultiFriendSelectorPopup.currentlySelectedTab != "All" || Scrabble.MultiFriendSelectorPopup.currentlySelectedPage != 0) {
                Scrabble.MultiFriendSelectorPopup.currentlySelectedTab = "All";
                Scrabble.MultiFriendSelectorPopup.showFriendsPage(0)
            }
        },wordGameFriendsTabSelected: function() {
            if (!Scrabble.WordGameUtils.didReceiveWGFInformation) {
                Scrabble.MultiFriendSelectorPopup.showExtendedPermissionPopup()
            }
            if (Scrabble.MultiFriendSelectorPopup.currentlySelectedTab != "WGF" || Scrabble.MultiFriendSelectorPopup.currentlySelectedPage != 0) {
                Scrabble.MultiFriendSelectorPopup.currentlySelectedTab = "WGF";
                Scrabble.MultiFriendSelectorPopup.showWordGameFriendsPage(0)
            }
        },selectAllButtonCallback: function() {
            var e = 0;
            for (friend in Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends) {
                if (Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[friend] == true) {
                    e++
                }
            }
            if (e != Scrabble.MultiFriendSelectorPopup.numFriendsToInvite) {
                for (var d = 0; d < Scrabble.MultiFriendSelectorPopup.friendsOrdering.length; d++) {
                    Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[Scrabble.MultiFriendSelectorPopup.friendsOrdering[d]] = true
                }
                $("#mfsCardArea").find(".mfsCard").each(function(f) {
                    $(this).removeClass("mfsCardSelected");
                    $(this).addClass("mfsCardSelected")
                })
            } else {
                Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends = {};
                $("#mfsCardArea").find(".mfsCardSelected").removeClass("mfsCardSelected")
            }
        },sendButtonCallback: function() {
            var e = [];
            for (var d in Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends) {
                e.push(d)
            }
            Scrabble.SocialPlatformManager.call("sendSelectedFriendsInvite", e, Scrabble.MultiFriendSelectorPopup.sendConfirmedCallback);
            Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends = {}
        },sendConfirmedCallback: function(e) {
            for (var d = 0; d < e.length; d++) {
                Scrabble.MultiFriendSelectorPopup.sessionInvitedFriends[e[d]] = true;
                numInvitedFriends++
            }
            Scrabble.MultiFriendSelectorPopup.buildFriendsOrdering();
            if (Scrabble.MultiFriendSelectorPopup.currentlySelectedTab == "All") {
                Scrabble.MultiFriendSelectorPopup.showFriendsPage(0)
            } else {
                Scrabble.MultiFriendSelectorPopup.showWordGameFriendsPage(0)
            }
        },friendCardClickCallback: function(f) {
            var d = $(this);
            var g = parseInt(d.attr("id").substring(7));
            var e = g + b * Scrabble.MultiFriendSelectorPopup.currentlySelectedPage;
            if (!d.hasClass("mfsCardSelected")) {
                Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[Scrabble.MultiFriendSelectorPopup.friendsOrdering[e]] = true;
                if (Scrabble.MultiFriendSelectorPopup.friendsOrdering[e] == -1) {
                    Scrabble.MultiFriendSelectorPopup.showExtendedPermissionPopup()
                }
                d.addClass("mfsCardSelected");
                d.children(".mfsCardCheckmark").show()
            } else {
                Scrabble.MultiFriendSelectorPopup.currentlySelectedFriends[Scrabble.MultiFriendSelectorPopup.friendsOrdering[e]] = false;
                d.removeClass("mfsCardSelected");
                d.children(".mfsCardCheckmark").hide()
            }
        },leftArrowClickCallback: function(e) {
            var d = Scrabble.MultiFriendSelectorPopup.currentlySelectedPage;
            if (d == 0) {
                return false
            }
            if (Scrabble.MultiFriendSelectorPopup.currentlySelectedTab == "All") {
                Scrabble.MultiFriendSelectorPopup.showFriendsPage(--d)
            } else {
                Scrabble.MultiFriendSelectorPopup.showWordGameFriendsPage(--d)
            }
            if (d == 0) {
                $("#mfsLeftArrow").hide()
            }
            $("#mfsRightArrow").show()
        },rightArrowClickCallback: function(e) {
            var d = Scrabble.MultiFriendSelectorPopup.currentlySelectedPage;
            if (d >= Math.floor((Scrabble.MultiFriendSelectorPopup.numFriendsToInvite - 1) / b)) {
                return false
            }
            if (Scrabble.MultiFriendSelectorPopup.currentlySelectedTab == "All") {
                Scrabble.MultiFriendSelectorPopup.showFriendsPage(++d)
            } else {
                Scrabble.MultiFriendSelectorPopup.showWordGameFriendsPage(++d)
            }
            if (d >= Math.floor((Scrabble.MultiFriendSelectorPopup.numFriendsToInvite - 1) / b)) {
                $("#mfsRightArrow").hide()
            }
            $("#mfsLeftArrow").show()
        },turnOnLegendCallback: function() {
            showExtendedPermissionsPopup()
        },closeButtonCallback: function() {
            Scrabble.MultiFriendSelectorPopup.hide()
        }}
}();
Scrabble.NudgePopup = function() {
    return {initialized: false,scrollList: null,ListDOM: null,scrollApi: null,action: "",isOpen: false,hide: function(a) {
            if (Scrabble.NudgePopup.isOpen == true) {
                Scrabble.NudgePopup.isOpen = false;
                Scrabble.SoundManager.play_sfx("Cancel");
                $("#nudgePopup").hide();
                Scrabble.PopupManager.close();
                Scrabble.Board.reEnableBoard();
                if (a == true) {
                    var b;
                    $("#nudgePopup .medCheckBtn").each(function(c) {
                        b = $(this).parent().attr("data-matchid");
                        Scrabble.TelemetryManager.sendNudgeFeature(Scrabble.GameServerManager.matchList[b], Scrabble.NudgePopup.action, "cancel")
                    })
                }
            }
        },show: function() {
            if (Scrabble.NudgePopup.isOpen == false) {
                Scrabble.NudgePopup.isOpen = true;
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.NewGameMenu.hide();
                Scrabble.PopupManager.showBlocker();
                if (!Scrabble.NudgePopup.initialized) {
                    Scrabble.NudgePopup.initialize()
                }
                $("#nudgePopup").show();
                Scrabble.NudgePopup.scrollApi.reinitialise();
                Scrabble.Board.disableBoard()
            }
        },initialize: function() {
            $("#nudgePopup").html(Scrabble.PopupFactory.nudgePopup());
            $("#nudgePopup #nudgeXButton").click(Scrabble.NudgePopup.hide);
            Scrabble.NudgePopup.scrollList = $("#nudgeList").jScrollPane({showArrows: true});
            Scrabble.NudgePopup.scrollApi = Scrabble.NudgePopup.scrollList.data("jsp");
            Scrabble.NudgePopup.ListDOM = Scrabble.NudgePopup.scrollApi.getContentPane();
            $("#nudgePopup .nudgeButton").click(Scrabble.NudgePopup.nudgeSelected);
            $("#nudgePopup .forfeitButton").click(Scrabble.NudgePopup.nudgeSelected);
            $("#nudgePopup .xButton").click(function() {
                Scrabble.NudgePopup.sendCancel();
                Scrabble.NudgePopup.hide()
            });
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.NudgePopup.anonymousUserLoadedCallback);
            Scrabble.NudgePopup.initialized = true
        },nudgeSelected: function() {
            if (Scrabble.NudgePopup.action == "forfeit" && $("#nudgePopup .medCheckedBtn").length > 0) {
                Scrabble.EventManager.bindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.NudgePopup.sendNudgeRequest);
                var a = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_LBL_FRCFRFTPP_FRCFRFT"),message: Scrabble.Dictionary.translate("FCBK_TXT_FRCFRFTPP_MSG2"),diag: {cancel: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNG_CNCL"},confirm: {action: Scrabble.UserEvents.ForfeitConfirmed,label: "FCBK_BTN_FRCEFRFTPP_OK"}}};
                Scrabble.PopupManager.close();
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(a), true);
                return
            }
            Scrabble.NudgePopup.sendNudgeRequest()
        },sendNudgeRequest: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.NudgePopup.sendNudgeRequest);
            var b = $("#nudgePopup .medCheckedBtn");
            var a = b.length;
            b.each(function(c) {
                Scrabble.GameServerManager.postNudge($(this).parent().attr("data-matchid"), Scrabble.NudgePopup.action, (c == a - 1))
            });
            Scrabble.NudgePopup.hide(true);
            Scrabble.PopupManager.close()
        },set: function(b, c) {
            if (!Scrabble.NudgePopup.initialized) {
                Scrabble.NudgePopup.initialize()
            }
            if (c == "forfeit") {
                $("#nudgePopup .popupTitle").html(Scrabble.Dictionary.translate("FCBK_TXT_FRCFRFTPP_TTL"));
                $("#nudgePopup #nudgeListHeader").html(Scrabble.Dictionary.translate("FCBK_TXT_FRCFRFTPP_MSG") + "<br/><span class='typo_orangeRed'>" + Scrabble.Dictionary.translate("FCBK_TXT_FRCFRFTPP_MSG2") + "</span>")
            }
            Scrabble.NudgePopup.action = c;
            if (c == "nudge") {
                $("#nudgePopup .nudgeButton").show();
                $("#nudgePopup .forfeitButton").hide()
            } else {
                $("#nudgePopup .nudgeButton").hide();
                $("#nudgePopup .forfeitButton").show()
            }
            Scrabble.NudgePopup.ListDOM.append(b);
            $("#nudgePopup .jspPane").ready(Scrabble.NudgePopup.scrollApi.reinitialise);
            var a = $("#nudgePopup");
            a.on("click", ".medCheckBtn", Scrabble.NudgePopup.check);
            a.on("click", ".medCheckedBtn", Scrabble.NudgePopup.uncheck);
            Scrabble.PopupManager.add(Scrabble.NudgePopup)
        },uncheck: function(a) {
            $(this).removeClass("medCheckedBtn").addClass("medCheckBtn")
        },check: function(a) {
            $(this).removeClass("medCheckBtn").addClass("medCheckedBtn")
        },anonymousUserLoadedCallback: function(a) {
            $('.nudgePlayerPicImage[data-userid="' + a + '"]').attr("src", Scrabble.PlayerManager.getPlayerInfo(a, "picUrl"));
            $('.nudgePlayerName[data-userid="' + a + '"]').html(trimName(Scrabble.PlayerManager.getPlayerInfo(a, "first_name"), Scrabble.PlayerManager.getPlayerInfo(a, "last_name"), 28))
        },sendCancel: function() {
            var a;
            $("#nudgePopup .medCheckedBtn, #nudgePopup .medCheckBtn").each(function(b) {
                a = $(this).parent().attr("data-matchid");
                Scrabble.TelemetryManager.sendNudgeFeature(Scrabble.GameServerManager.matchList[a], Scrabble.NudgePopup.action, "cancel")
            })
        }}
}();
Scrabble.OnBoardPopup = function() {
    var a = null;
    return {showNext: function(b) {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, function() {
                Scrabble.OnBoardPopup.showNext("getAppPopup")
            });
            setTimeout(function() {
                Scrabble.PopupManager.add(Scrabble.OnBoardPopup[b]())
            }, 300)
        },toggleBoardSizePopup: function() {
            var b = $(".zoomTutorialPopup");
            if (b.length == 1 && Scrabble.PopupManager.hasPopupOpened) {
                Scrabble.PopupManager.close()
            } else {
                Scrabble.OnBoardPopup.showNext("boardSizePopup")
            }
        },boardSizePopup: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.closeBoardSizePopup);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.closeBoardSizePopup);
            a = Scrabble.PopupFactory.zoomTutorialPopup();
            return a
        },mattelIntroPopup: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.mattelOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.mattelCancelCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.mattelOkCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.mattelCancelCallback);
            a = Scrabble.PopupFactory.mattelIntroPopup();
            return a
        },storeIntroPopup: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.storeOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.storeCancelCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.storeOkCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.storeCancelCallback);
            a = Scrabble.PopupFactory.storeIntroPopup();
            return a
        },toyotaQuestPopup: function() {
            if (Scrabble.QuestPopup.isToyotaQuestCompleted == false && Scrabble.QuestPopup.isToyotaQuestActive == false) {
                Scrabble.QuestPopup.set("Toyota", 1);
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "open", {subtype1: "Toyota",subtype2: "popup",subtype3: "welcome"});
                return Scrabble.QuestPopup
            } else {
                Scrabble.PopupManager.hideBlocker();
                Scrabble.OnboardManager.nextOnboardingStep();
                return ""
            }
        },toyotaQuestDaysLeftPopup: function() {
            if (Scrabble.QuestPopup.isToyotaQuestCompleted == false) {
                Scrabble.QuestPopup.set("Toyota", 6);
                return Scrabble.QuestPopup
            } else {
                Scrabble.OnboardManager.nextOnboardingStep();
                return ""
            }
        },toyotaQuestOverPopup: function() {
            Scrabble.QuestPopup.removeToyotaKit();
            Scrabble.QuestPopup.set("Toyota", 7);
            return Scrabble.QuestPopup
        },playWithFriendsPopup: function() {
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.SendFriendsConfirmed, Scrabble.OnBoardPopup.playWithFriendsCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.playWithFriendsCancelCallback);
            a = Scrabble.PopupFactory.playWithFriendsPopup();
            return a
        },moreFriendsPopup: function() {
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.SendFriendsConfirmed, Scrabble.OnBoardPopup.moreFriendsCallback);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.moreFriendsCancelCallback);
            a = Scrabble.PopupFactory.moreFriendsPopup();
            return a
        },playWithFriendsCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.SendFriendsConfirmed, Scrabble.OnBoardPopup.playWithFriendsCallback);
            Scrabble.TelemetryManager.sendTutorial("spread_the_word", "click");
            Scrabble.PopupManager.close();
            Scrabble.SocialPlatformManager.call("sendFriendsInvite", "spead_the_word", Scrabble.OnboardManager.nextOnboardingStep)
        },moreFriendsCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.SendFriendsConfirmed, Scrabble.OnBoardPopup.moreFriendsCallback);
            Scrabble.TelemetryManager.sendTutorial("bring_your_friends", "click");
            Scrabble.PopupManager.close();
            Scrabble.SocialPlatformManager.call("inviteFriends", "bring_your_friends", [], null, Scrabble.OnboardManager.nextOnboardingStep, Scrabble.OnboardManager.nextOnboardingStep)
        },playWithFriendsCancelCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.playWithFriendsCancelCallback);
            Scrabble.TelemetryManager.sendTutorial("spread_the_word", "cancel");
            Scrabble.OnboardManager.nextOnboardingStep()
        },moreFriendsCancelCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.moreFriendsCancelCallback);
            Scrabble.TelemetryManager.sendTutorial("bring_your_friends", "cancel");
            Scrabble.OnboardManager.nextOnboardingStep()
        },closeBoardSizePopup: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.closeBoardSizePopup);
            Scrabble.PopupManager.close()
        },storeOkCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.storeOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.storeCancelCallback);
            Scrabble.PopupManager.pause();
            Scrabble.PopupManager.close();
            var b = {subtype1: "store",subtype2: "onboarding"};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "open_store", b);
            Scrabble.Store.show("onboarding");
            setTimeout(function() {
                Scrabble.Store.displayPage("coins", "onboarding")
            }, 1000)
        },storeCancelCallback: function() {
            console.warn("CLOSING STORE INTRO");
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.storeOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.storeCancelCallback);
            Scrabble.PopupManager.close();
            Scrabble.OnboardManager.nextOnboardingStep();
            var b = {subtype1: "store",subtype2: "onboarding"};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close_store", b)
        },mattelOkCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.mattelOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.mattelCancelCallback);
            Scrabble.PopupManager.close();
            var b = {subtype1: "mattel",subtype2: "onboarding"};
            Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "play_clicked", b);
            Scrabble.OnboardManager.nextOnboardingStep()
        },mattelCancelCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.OnBoardPopup.mattelOkCallback);
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.PopupCancelClicked, Scrabble.OnBoardPopup.mattelCancelCallback);
            Scrabble.PopupManager.close();
            Scrabble.OnboardManager.nextOnboardingStep();
            var b = {subtype1: "mattel",subtype2: "onboarding"};
            Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "close_clicked", b)
        }}
}();
Scrabble.ProfilePopup = function() {
    var e = "profilePopup";
    var d = "profileContent";
    var c = "fullGameOverlayTransparent";
    var b;
    var a;
    return {initialized: false,currentPlayerId: null,openedFromLeaderBoard: null,init: function() {
            $("#profilePopupContentTitleText").html("PLAYER_PROFILE");
            $("#profileCompletedGames .profileStatTitle").html(Scrabble.Dictionary.translate("STTS_LBL_RCRD_TTL"));
            $("#profileAvgWordScore .profileStatTitle").html(Scrabble.Dictionary.translate("STTS_LBL_AVGWRD_TTL"));
            $("#profileAvgGameScore .profileStatTitle").html(Scrabble.Dictionary.translate("STTS_LBL_AVGGM_TTL"));
            $("#profileBestWordScore .profileStatTitle").html(Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BSTWRD_TTL"));
            $("#profileBestGameScore .profileStatTitle").html(Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BSTGM_TTL"));
            $("#profileBingos .profileStatTitle").html(Scrabble.Dictionary.translate("FRNDLSTPRFL_LBL_BNGS_TTL"));
            $("#profileRating .profileStatTitle").html(Scrabble.Dictionary.translate("FCBK_LBL_LDRBRDS_RTNG"));
            $("#profilePopupMessageBtn p").html(Scrabble.Dictionary.translate("FDBCK_LBL_MSGFLD_TTL"));
            var f = $("#profilePopupMessageBtn");
            f.off("click", Scrabble.ProfilePopup.commentOnStat);
            f.on("click", Scrabble.ProfilePopup.commentOnStat);
            b = $("#profilePopupCarrot").width();
            a = $("#profilePopupBottomCarrot").width();
            $("#profilePopupCarrot").offset({left: 0});
            Scrabble.ProfilePopup.initialized = true
        },commentOnStat: function(g) {
            var f = $(g.currentTarget).attr("data-id");
            if (f != Scrabble.PlayerManager.currentUser.mayhemId) {
                Scrabble.SocialPlatformManager.call("publishStatComment", Scrabble.PlayerManager.currentUser.first_name, Scrabble.PlayerManager.getPlayerInfo(f, "fbId"))
            }
        },checkClose: function(f) {
            Scrabble.ProfilePopup.hide()
        },hide: function(f) {
            if ($("#" + e).css("display") != "none") {
                if (!f) {
                    Scrabble.SoundManager.play_sfx("Cancel")
                }
                $("#" + e).hide();
                Scrabble.ProfilePopup.currentPlayerId = null;
                $(document).off("click", Scrabble.ProfilePopup.checkClose)
            }
        },show: function(D, I, J, f) {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                Scrabble.ProfilePopup.show(D, I, J, f)
            });
            if (!Scrabble.StatsManager.checkUserStatsLoaded(D, [1, 2, 3, 4, 5, 6, 7, 8])) {
                Scrabble.StatsManager.loadSingleUserStats(D);
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                    Scrabble.ProfilePopup.show(D, I, J, f)
                });
                return false
            }
            if (Scrabble.OptionsMenu.isOpen) {
                Scrabble.OptionsMenu.hide()
            }
            $("#messageBoard").animate({height: "0px"}, 150, $(this).remove);
            $(document).off("click", Scrabble.ProfilePopup.checkClose);
            setTimeout(function() {
                $(document).on("click", Scrabble.ProfilePopup.checkClose)
            }, 1);
            if (f === true) {
                if ($(".match").length == 0 && $(".archivedMatch").length == 0) {
                    I = true
                }
            }
            if (typeof I == "undefined") {
                I = false
            }
            if (!Scrabble.ProfilePopup.initialized) {
                Scrabble.ProfilePopup.init()
            }
            if (D == Scrabble.ProfilePopup.currentPlayerId) {
                if (!J) {
                    Scrabble.ProfilePopup.hide();
                    Scrabble.ProfilePopup.currentPlayerId = null;
                    return false
                }
            } else {
                Scrabble.SoundManager.play_sfx("Generic_btn");
                Scrabble.ProfilePopup.currentPlayerId = D;
                if (I && f != true) {
                    Scrabble.TelemetryManager.sendStats("leaderboard", D)
                } else {
                    if (f) {
                        Scrabble.TelemetryManager.sendStats("stats_btn", D)
                    } else {
                        Scrabble.TelemetryManager.sendStats("score", D)
                    }
                }
            }
            if (D == Scrabble.PlayerManager.currentUser.mayhemId) {
                $("#profilePopupContentTitleText").html(Scrabble.Dictionary.translate("FDBCK_TXT_RPRTBG_DDSTTS"))
            } else {
                $("#profilePopupContentTitleText").html(Scrabble.Dictionary.translate("GSCNPP_LBL_PLYRPRFL_TTL"))
            }
            var B = $("#" + e);
            B.show();
            Scrabble.ProfilePopup.openedFromLeaderBoard = I;
            if (!I) {
                var r = $("#gameCard_" + D + " .cardAvatar");
                var u = r.offset();
                var h = r.width();
                B.css({top: "83px",left: "325px"});
                if (r.length) {
                    var s = $("#profilePopupBottomCarrot");
                    s.hide();
                    var q = $("#profilePopupCarrot");
                    q.show();
                    var x = u.left + h / 2 - b / 2;
                    q.offset({left: x});
                    if (x < 500) {
                        B.css("left", "230px")
                    } else {
                        if (x > 800) {
                            B.css("left", "410px")
                        }
                    }
                    q.offset({left: x});
                    var l = r.parent();
                    var o;
                    if (l.parent().children().length == 7 && l.parent().children().index(l) == 0) {
                        var o = B.css("left").split("px");
                        B.css("left", (o[0] - 90) + "px");
                        o = q.offset().left;
                        q.offset({left: (o + 90)})
                    }
                    if (l.parent().children().length == 5 && l.parent().children().index(l) == 0) {
                        var o = B.css("left").split("px");
                        B.css("left", (o[0] - 90) + "px");
                        o = q.offset().left;
                        q.offset({left: (o + 90)})
                    }
                } else {
                    $("#profilePopupBottomCarrot").hide();
                    $("#profilePopupCarrot").hide()
                }
            } else {
                var C = $("#profilePopupCarrot");
                C.hide();
                var s = $("#profilePopupBottomCarrot");
                s.show();
                B.css({top: "327px"});
                var j = $('[data-lb_user_id="' + D + '"] img');
                var H = j.offset();
                var v = j.width();
                var g = H.left + v / 2 - a / 2;
                s.offset({left: g});
                var E = s.css("left");
                E = parseInt(E.substring(0, E.length - 2));
                if (E < 36) {
                    B.offset({left: g - 36})
                } else {
                    if (E > 307) {
                        B.offset({left: g - 307 + a})
                    }
                }
                s.offset({left: g})
            }
            var m = Scrabble.PlayerManager.getPlayerInfo(D, "mayhemId");
            var t = trimName(Scrabble.PlayerManager.getPlayerInfo(D, "first_name"), Scrabble.PlayerManager.getPlayerInfo(D, "last_name"), 23);
            var z = Scrabble.PlayerManager.getPlayerInfo(D, "fbId");
            var G = Scrabble.PlayerManager.getPlayerInfo(D, "signupTime");
            signupDateTxt = parseSignupDate(G);
            var A = Scrabble.PlayerManager.getPlayerInfo(D, "picUrl");
            var F = Scrabble.StatsManager.stats[m];
            if (typeof F == "undefined") {
                Scrabble.StatsManager.loadSingleUserStats(m);
                Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.ProfilePopup.statsLoadedCallback);
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.ProfilePopup.statsLoadedCallback);
                return
            }
            $("#profilePopupContentHeaderName").html(t);
            $("#profilePopupContentHeaderPlayingSince").html(Scrabble.Dictionary.translate("STTS_TXT_PLYTMAGO", {"[PLAYED_SINCE_AGO]": signupDateTxt}));
            $("#profilePopupContentHeaderPic").attr("src", A);
            var k = $("#profilePopupMessageBtn");
            if (D == Scrabble.PlayerManager.currentUser.mayhemId) {
                k.hide()
            } else {
                if (I) {
                    k.show();
                    k.attr("data-id", D)
                } else {
                    k.hide()
                }
            }
            var n = (parseInt(F[Scrabble.StatType.TOTAL_GAMES.id]) > 0) ? parseInt((F[Scrabble.StatType.TOTAL_WINS.id] / F[Scrabble.StatType.TOTAL_GAMES.id]) * 100) : 0;
            $("#profileCompletedGames .profileScore").html(n + '<span class="smallerPoints">%</span>');
            $("#profileCompletedGames .profileAdditionalText").html('<span class="profileAdditionalInner">' + F[Scrabble.StatType.TOTAL_WINS.id] + " " + Scrabble.Dictionary.translate("STTS_TXT_WIN") + '</span><span class="profileAdditionalInner">' + F[Scrabble.StatType.TOTAL_LOSSES.id] + " " + Scrabble.Dictionary.translate("STTS_TXT_LOSS") + '</span><span class="profileAdditionalInner">' + F[Scrabble.StatType.TOTAL_DRAWS.id] + " " + Scrabble.Dictionary.translate("STTS_TXT_DRWS") + "</span>");
            $("#profileBestWordScore .profileScore").html(F[Scrabble.StatType.HIGH_WORD.id].score + '<span class="smallerPoints">' + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN3").toLowerCase() + "</span>");
            $("#profileBestWordScore .profileAdditionalText").html('"' + F[Scrabble.StatType.HIGH_WORD.id].word + '"');
            $("#profileBestGameScore .profileScore").html(F[Scrabble.StatType.HIGH_GAME.id] + '<span class="smallerPoints">' + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN3").toLowerCase() + "</span>");
            $("#profileBingos .profileScore").html(F[Scrabble.StatType.TOTAL_BINGOS.id]);
            $("#profileRating .profileScore").html(F[Scrabble.StatType.RATING.id]);
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.GameResized, Scrabble.ProfilePopup.hide);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.GameResized, Scrabble.ProfilePopup.hide)
        },statsLoadedCallback: function() {
            Scrabble.ProfilePopup.show(Scrabble.ProfilePopup.currentPlayerId, false, true);
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.ProfilePopup.statsLoadedCallback)
        },hideIfFromLeaderBoard: function() {
            if (Scrabble.ProfilePopup.openedFromLeaderBoard) {
                Scrabble.ProfilePopup.hide()
            }
        }}
}();
Scrabble.QuestPopup = function() {
    var a = "proxy/challenge/rest/";
    var b = "proxy/challenge/rest/challenge/";
    return {isOpen: false,chapter: 0,questName: "",pendingValidWord: false,pendingWords: [],popupOpenTime: null,isToyotaQuestActive: false,isToyotaQuestCompleted: false,toyotaSeenCongrats: false,toyotaQuestId: 0,toyotaObjectives: [],toyotaWordProgress: 0,toyotaReqWords: 0,toyotaEndDate: 0,toyotaKitIndex: 0,progressPostCallStatus: null,checkCurrentChallenges: function() {
            var f, d, e = Scrabble.LocalStorageManager.get("toyotaActive");
            d = Scrabble.LocalStorageManager.get("toyotaChallenge");
            if (d == null) {
                Scrabble.QuestPopup._get("challenge", a, (";jsessionid=" + Scrabble.Store.sessionId + "?type=toyotaWordList"))
            } else {
                Scrabble.QuestPopup.parseChallenge(d)
            }
            if (e == "true") {
                Scrabble.QuestPopup.setToyotaKit(false);
                Scrabble.QuestPopup.toyotaSeenCongrats = true;
                Scrabble.QuestPopup.toyotaEndDate = Scrabble.LocalStorageManager.get("toyotaEndDate")
            } else {
                f = Scrabble.LocalStorageManager.get("lastSeenToyotaInsentive");
                if (f == null) {
                    f = Scrabble.CookieManager.readCookie("toyotaInsentive")
                }
                if (f == null || isOlderThanDays(f, 7)) {
                    var c = new Date();
                    if (c >= (new Date(2013, 3, 1, 3)) && c < new Date(2013, 6, 1, 0)) {
                        Scrabble.QuestPopup.set("Toyota", 1);
                        Scrabble.PopupManager.add(Scrabble.QuestPopup);
                        Scrabble.LocalStorageManager.set("lastSeenToyotaInsentive", c);
                        Scrabble.CookieManager.createCookie("toyotaInsentive", c, 7)
                    }
                }
            }
        },set: function(d, f, c) {
            if (f == 3) {
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "open", {subtype1: "Toyota",subtype2: "popup",subtype3: "locked",data: JSON.stringify({itemName: c.name,itemprice: c.price})})
            }
            if (f == 4) {
                if (c != undefined) {
                    for (var e = 0; e < Scrabble.QuestPopup.toyotaObjectives.length; e++) {
                        if (c[Scrabble.QuestPopup.toyotaObjectives[e].word] != undefined) {
                            c = Scrabble.QuestPopup.toyotaObjectives[e].translations[Scrabble.GameServerManager.currentGame().board.dictionary];
                            break
                        }
                    }
                }
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "complete", {subtype1: "Toyota",subtype2: "popup",subtype3: "game",data: JSON.stringify({advancement: Scrabble.QuestPopup.toyotaWordProgress,wordPlayed: c.join()})})
            }
            if (f == 5) {
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "get_reward", {subtype1: "Toyota",subtype2: "popup",subtype3: "game",data: JSON.stringify({wordPlayed: c.join()})})
            }
            $("#questPopup").html(Scrabble.QuestBuilder["b" + d](f, c));
            Scrabble.QuestPopup["q" + d](f, c)
        },show: function() {
            Scrabble.QuestPopup.isOpen = true;
            Scrabble.PopupManager.showBlocker();
            Scrabble.EndGamePopup.hide();
            $("#questPopup").show();
            Scrabble.QuestPopup.popupOpenTime = new Date().getTime()
        },hide: function() {
            Scrabble.SoundManager.play_sfx("Popup_close");
            Scrabble.QuestPopup.isOpen = false;
            Scrabble.PopupManager.close();
            Scrabble.PopupManager.hideBlocker();
            $("#questPopup").hide();
            Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.QuestPopupDissmissed)
        },_post: function(f, e, c, g) {
            g = g || [];
            c = c || "";
            Scrabble.QuestPopup[f + "PostCallStatus"] = "sent";
            var d = $.ajax({url: Scrabble.config._storeProxyUrl + e + f + c,dataType: "jsonp",cache: false,crossDomain: true,contentType: "application/javascript; charset=utf-8",type: "POST",jsonp: "callback",timeout: 31000,data: {tntId: Scrabble.config.tntId,words: ('["' + g.join('","') + '"]'),dictionary: Scrabble.GameServerManager.currentGame().board.dictionary,_method: "POST","X-facebookId": Scrabble.config.fbId},jsonpCallback: "Scrabble.QuestPopup.p" + f.capitalize(),});
            d.error(function(h) {
                Scrabble.QuestPopup[f + "PostCallStatus"] = null
            })
        },_get: function(h, g, c) {
            var e;
            c = c || "";
            Scrabble.QuestPopup[h + "CallStatus"] = "sent";
            var d = "&";
            if (c.indexOf("?") == -1) {
                d = "?"
            }
            var f = $.ajax({url: Scrabble.config._storeProxyUrl + g + h + c + d + "X-facebookId=" + Scrabble.config.fbId,dataType: "jsonp",crossDomain: true,contentType: "application/javascript; charset=utf-8",cache: false,jsonp: "callback",timeout: 31000,jsonpCallback: "Scrabble.QuestPopup.g" + h.capitalize()});
            f.error(function(j) {
                Scrabble.QuestPopup[h + "CallStatus"] = null
            })
        },qToyota: function(c) {
            $("#questPopup .xButton").off();
            $("#questPopup .xButton").on("click", function() {
                Scrabble.QuestPopup.hide();
                if (c == 1) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close", {subtype1: "Toyota",subtype2: "popup",subtype3: "welcome",data: JSON.stringify({timeSpent: (new Date().getTime() - Scrabble.QuestPopup.popupOpenTime)})})
                }
                if (c == 2) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close", {subtype1: "Toyota",subtype2: "popup",subtype3: "purchase",data: JSON.stringify({timeSpent: (new Date().getTime() - Scrabble.QuestPopup.popupOpenTime)})})
                }
                if (c == 3) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close", {subtype1: "Toyota",subtype2: "popup",subtype3: "locked",data: JSON.stringify({timeSpent: (new Date().getTime() - Scrabble.QuestPopup.popupOpenTime)})})
                } else {
                    if (c == 6 || c == 7) {
                        Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close", {subtype1: "Toyota",subtype2: "popup",subtype3: "expiration"})
                    }
                }
            });
            $("#questPopup .confirmButton").off();
            $("#questPopup .confirmButton").on("click", function() {
                Scrabble.Store.show("toyota");
                Scrabble.QuestPopup.hide();
                if (c == 1) {
                    Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "open_store", {subtype1: "Toyota",subtype2: "popup",subtype3: "welcome",data: JSON.stringify({timeSpent: (new Date().getTime() - Scrabble.QuestPopup.popupOpenTime)})})
                }
                if (c == 6 || c == 7) {
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "open_store", {subtype1: "Toyota",subtype2: "popup",subtype3: "expiration"})
                }
            });
            if (c == 7) {
                Scrabble.QuestPopup.removeToyotaKit()
            }
            $("#avalonCancelItemEquip").on("click", function() {
                Scrabble.QuestPopup.hide();
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "cancel", {subtype1: "Toyota",subtype2: "popup",subtype3: "special"})
            });
            $("#avalonConfirmItemEquip").on("click", function() {
                Scrabble.Store.purchaseItem(Scrabble.QuestPopup.tempItem);
                Scrabble.QuestPopup.hide();
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "continue", {subtype1: "Toyota",subtype2: "popup",subtype3: "special"})
            })
        },setToyotaKit: function(c) {
            if (Scrabble.config.tntId != undefined) {
                $("#bullet5").show();
                Scrabble.Chat.emoticonMaxPage = 5;
                Scrabble.QuestPopup.isToyotaQuestActive = true;
                $("body").removeClass("skin_default").addClass("skin_toyota");
                $("#questWordsListBtnTxt").show();
                $("#chatFootNote").show();
                Scrabble.WordList.updateQuestTabContent();
                Scrabble.Board.setTileSkin("toyota2013");
                Scrabble.Board.setBoardSkin("toyota2013");
                Scrabble.Store.update();
                if (c) {
                    if (Scrabble.QuestPopup.toyotaSeenCongrats == false && !Scrabble.QuestPopup.isToyotaQuestCompleted) {
                        Scrabble.QuestPopup.set("Toyota", 2);
                        Scrabble.PopupManager.add(Scrabble.QuestPopup);
                        Scrabble.QuestPopup.toyotaSeenCongrats = true
                    }
                    Scrabble.LocalStorageManager.set("toyotaActive", "true")
                }
                Scrabble.WordList.openQuestWordsList()
            }
        },parseChallenge: function(e) {
            if (Scrabble.QuestPopup.toyotaQuestId == 0) {
                Scrabble.QuestPopup.toyotaQuestId = Scrabble.LocalStorageManager.get("toyotaChallengeId");
                Scrabble.QuestPopup.toyotaEndDate = Scrabble.LocalStorageManager.get("toyotaEndDate")
            }
            e = JSON.parse(e);
            Scrabble.QuestPopup.toyotaReqWords = e.shared.wordGoal;
            Scrabble.QuestPopup.toyotaObjectives = [];
            var c = e.shared.words.length, f = null;
            for (var d = 0; d < c; d++) {
                f = e.shared.words[d];
                f.playedTimes = 0;
                Scrabble.QuestPopup.toyotaObjectives[Scrabble.QuestPopup.toyotaObjectives.length] = f
            }
            Scrabble.QuestPopup.getProgress()
        },removeToyotaKit: function(c) {
            Scrabble.QuestPopup.isToyotaQuestActive = false;
            $("body").removeClass("skin_toyota").addClass("skin_default");
            $("#questWordsListBtnTxt").hide();
            $("#wordsListQuestList").hide();
            Scrabble.Chat.changeEmoticonPage(-4);
            Scrabble.Chat.emoticonMaxPage = 4;
            $("#bullet5").hide();
            $("#chatFootNote").hide();
            Scrabble.WordList.openMovesList();
            Scrabble.Board.setTileSkin("def");
            Scrabble.Board.setBoardSkin("def");
            Scrabble.LocalStorageManager.set("toyotaActive", "false");
            if (c != "board" && c != "tileset") {
                Scrabble.Store.update()
            }
        },toggleToyota: function(d) {
            console.log($(this));
            if (Scrabble.Store.storeItems[Scrabble.QuestPopup.toyotaKitIndex].purchased != true) {
                var c = {subtype1: "store",subtype2: "shopping",subtype3: "action"};
                c.data = JSON.stringify({itemName: "avalon Luxury Kit",coinsSpent: "0"});
                Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "item_purchase", c);
                Scrabble.StoreSynchronizer.postItemPurchase(Scrabble.Store.storeItems[Scrabble.QuestPopup.toyotaKitIndex])
            }
            if ($(this).hasClass("unchecked")) {
                $(this).removeClass("unchecked").addClass("checked");
                Scrabble.QuestPopup.setToyotaKit(true)
            } else {
                $(this).removeClass("checked").addClass("unchecked");
                Scrabble.QuestPopup.removeToyotaKit("all")
            }
            if (d.stopPropagation) {
                d.stopPropagation();
                window.event.cancelBubble = true
            }
        },gChallenge: function(d) {
            Scrabble.QuestPopup.challengeCallStatus = null;
            var c;
            for (c = 0; c < d.length; c++) {
                if (d[c].type == "toyotaWordList") {
                    break
                }
            }
            if (c < d.length) {
                Scrabble.QuestPopup.toyotaQuestId = d[c].key;
                Scrabble.QuestPopup.toyotaEndDate = d[c].endDate;
                Scrabble.QuestPopup.parseChallenge(d[c].metadata);
                Scrabble.LocalStorageManager.set("toyotaChallenge", d[c].metadata);
                Scrabble.LocalStorageManager.set("toyotaChallengeId", d[c].key);
                Scrabble.LocalStorageManager.set("toyotaEndDate", d[c].endDate)
            }
        },checkValidWord: function(c) {
            Scrabble.QuestPopup.pendingWords = c;
            Scrabble.QuestPopup._post("progress", b, (";jsessionid=" + Scrabble.Store.sessionId + "?challengeKey=" + Scrabble.QuestPopup.toyotaQuestId), c)
        },getProgress: function() {
            Scrabble.QuestPopup._get("achievement", b, (";jsessionid=" + Scrabble.Store.sessionId + "?challengeKey=" + Scrabble.QuestPopup.toyotaQuestId + "&tntId=" + Scrabble.config.tntId))
        },gAchievement: function(g) {
            Scrabble.QuestPopup.achievementCallStatus = null;
            var f, e, h, d = 0, c = [];
            if (g.length != undefined && g.length > 0) {
                for (f = 0; f < g.length; f++) {
                    if (g[f].challengeKey == Scrabble.QuestPopup.toyotaQuestId) {
                        break
                    }
                }
                e = JSON.parse(g[f].data);
                for (w = 0; w < Scrabble.QuestPopup.toyotaObjectives.length; w++) {
                    if (e[Scrabble.QuestPopup.toyotaObjectives[w].word] != undefined) {
                        d += e[Scrabble.QuestPopup.toyotaObjectives[w].word];
                        Scrabble.QuestPopup.toyotaObjectives[w].playedTimes = e[Scrabble.QuestPopup.toyotaObjectives[w].word]
                    }
                    for (p = 0; p < Scrabble.QuestPopup.pendingWords.length; p++) {
                        if (Scrabble.QuestPopup.pendingWords[p] == Scrabble.QuestPopup.toyotaObjectives[w].translations[Scrabble.GameServerManager.currentGame().board.dictionary]) {
                            c.push(Scrabble.QuestPopup.pendingWords[p])
                        }
                    }
                }
                Scrabble.QuestPopup.toyotaWordProgress = d;
                if (g[f].achieved == true) {
                    Scrabble.QuestPopup.isToyotaQuestCompleted = true;
                    Scrabble.TradeTilesPopup.tileTracking = true;
                    Scrabble.StoreSynchronizer.forceUpdate("purchase", true)
                }
                if (Scrabble.QuestPopup.pendingValidWord == true) {
                    Scrabble.QuestPopup.pendingValidWord = false;
                    if (g[f].achieved == true) {
                        Scrabble.QuestPopup.set("Toyota", 5, c);
                        Scrabble.QuestPopup.show()
                    } else {
                        Scrabble.QuestPopup.set("Toyota", 4, c);
                        Scrabble.QuestPopup.show()
                    }
                }
            }
            if ((Scrabble.TileSkins.currentSkin == "toyota2013" || Scrabble.BoardSkins.currentSkin == "toyota2013") && Scrabble.QuestPopup.isToyotaQuestCompleted == false && Scrabble.QuestPopup.isToyotaQuestActive == false) {
                Scrabble.QuestPopup.removeToyotaKit()
            }
            Scrabble.WordList.updateQuestTabContent()
        },pProgress: function(c) {
            Scrabble.QuestPopup.progressPostCallStatus = null;
            Scrabble.QuestPopup.pendingValidWord = true;
            Scrabble.QuestPopup.getProgress()
        }}
}();
Scrabble.SplashScreen = function() {
    var a = 760;
    return {eventsReceived: 0,visible: true,_matchTypeRefreshed: false,_statsLoaded: false,_assetsLoaded: false,initialize: function() {
            $("#splashLoadingMessage").html(Scrabble.Dictionary.translate("DFLT_TXT_LDNG"));
            if (Scrabble.config.lang == "fr") {
                $("#loadingIcone").css("left", -5);
                $("#splashLoadingMessage").css("left", 52)
            }
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, function() {
                Scrabble.SplashScreen.hide(Scrabble.SystemEvents.MatchTypeRefreshed)
            });
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                Scrabble.SplashScreen.hide(Scrabble.SystemEvents.StatsLoaded)
            });
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AssetsLoaded, function() {
                Scrabble.SplashScreen.hide(Scrabble.SystemEvents.AssetsLoaded)
            })
        },hide: function(c) {
            if (Scrabble.SplashScreen.visible === true) {
                var h = new Date();
                var b = h.getTime();
                var f = b - Scrabble.ImageLoader.loadStartTime;
                if (c == Scrabble.SystemEvents.AssetsLoaded) {
                    Scrabble.TelemetryManager.gameLoad("complete", "assets", f);
                    Scrabble.SplashScreen._assetsLoaded = true
                } else {
                    if (c == Scrabble.SystemEvents.StatsLoaded) {
                        Scrabble.SplashScreen._statsLoaded = true
                    } else {
                        Scrabble.SplashScreen._matchTypeRefreshed = true
                    }
                    if (Scrabble.SplashScreen._matchTypeRefreshed && Scrabble.SplashScreen._statsLoaded) {
                        Scrabble.TelemetryManager.gameLoad("complete", "data", f)
                    }
                }
                Scrabble.SplashScreen.eventsReceived++;
                if (Scrabble.SplashScreen.eventsReceived == 3) {
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, function() {
                        Scrabble.SplashScreen.hide(Scrabble.SystemEvents.MatchTypeRefreshed)
                    });
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, function() {
                        Scrabble.SplashScreen.hide(Scrabble.SystemEvents.StatsLoaded)
                    });
                    Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.AssetsLoaded, function() {
                        Scrabble.SplashScreen.hide(Scrabble.SystemEvents.AssetsLoaded)
                    });
                    var g = Scrabble.PlayerManager.getPlayerInfo(Scrabble.config.fbId, "signupTime");
                    var e = Scrabble.LocalStorageManager.get("resolutionSetting");
                    if (e == 1) {
                        Scrabble.ResolutionManager.setResolution(a, null, true)
                    } else {
                        if (!checkIfNewUser(g)) {
                            Scrabble.RightMenu.showWordList();
                            Scrabble.WordList.toggleSubMenu({target: {id: "movesListBtnTxt"}})
                        }
                    }
                    Scrabble.config.showNewGameTip = false;
                    Scrabble.SplashScreen.visible = false;
                    Scrabble.OnboardManager.setupOnboarding();
                    if (Scrabble.OnboardManager.onboardEnabled == false) {
                        Scrabble.GameServerManager.checkNudgables()
                    }
                    setTimeout(function() {
                        Scrabble.LeaderBoard._alignCenter();
                        $("#splashScreen").fadeOut(1000);
                        var d = new Date().getTime();
                        var j = d - Scrabble.phpStartTime;
                        Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "complete", {subtype1: "game_load",data: "{loadTime:" + j + ",requestTime:" + Scrabble.phpStartTime + "}"})
                    }, 100)
                }
            }
        }}
}();
Scrabble.SuggestionPopup = function() {
    return {initialized: false,suggestions: [],popup: null,init: function() {
            Scrabble.SuggestionPopup.initialized = true;
            var j = 25;
            var f = 0;
            Scrabble.LeftMenu.updateCurrentOpponents();
            var b = Scrabble.PlayerManager.players.concat();
            if (b.length > 0) {
                var h = 0;
                var c = new Date();
                c = c.getTime();
                var e;
                if (b.length < j) {
                    j = b.length
                }
                b.sort(function(l, k) {
                    return k.signupTime - l.signupTime
                });
                for (h = 0; h < j; h++) {
                    e = c - b[h].signupTime;
                    if (e < 1209600000) {
                        if (b[h] != undefined) {
                            if (Scrabble.LeftMenu.currentOpponents.indexOf(b[h].mayhemId) == -1) {
                                Scrabble.SuggestionPopup.suggestions.push([b[h].mayhemId, 0]);
                                b.splice(h, 1);
                                j--;
                                break
                            }
                        }
                    } else {
                        f++;
                        break
                    }
                }
                if (b.length > 0) {
                    b.sort(function(l, k) {
                        return k.lastActivity - l.lastActivity
                    });
                    var a = b.splice(0, 5);
                    a.sort(randomSort);
                    for (h = 0; h < j; h++) {
                        if (a[h] != undefined && a[h].lastActivity != undefined) {
                            var d = parseInt(a[h].lastActivity.split(":")[0]);
                            if (Scrabble.LeftMenu.currentOpponents.indexOf(a[h].mayhemId) == -1 && d < 14) {
                                Scrabble.SuggestionPopup.suggestions.push([a[h].mayhemId, 1]);
                                if (f == 0) {
                                    break
                                } else {
                                    f--
                                }
                            }
                        }
                    }
                }
            }
            var g = 0;
            while (Scrabble.SuggestionPopup.suggestions.length < 3) {
                g++;
                Scrabble.SuggestionPopup.suggestions.push(["random", 2])
            }
            if (b < 5 || g > 1) {
                Scrabble.SuggestionPopup.popup = $("#singleSuggestionPopup");
                Scrabble.SuggestionPopup.popup.html(Scrabble.PopupFactory.suggestedGamesPopup([["random", 2]]))
            } else {
                Scrabble.SuggestionPopup.popup = $("#suggestionPopup");
                Scrabble.SuggestionPopup.popup.html(Scrabble.PopupFactory.suggestedGamesPopup(Scrabble.SuggestionPopup.suggestions))
            }
            Scrabble.SuggestionPopup.popup.on("click", ".smallGreenBtn", Scrabble.SuggestionPopup.playPressed);
            Scrabble.SuggestionPopup.popup.on("click", "#suggestionCloseBtn", Scrabble.SuggestionPopup.hide)
        },playPressed: function() {
            Scrabble.SuggestionPopup.hide();
            Scrabble.SoundManager.play_sfx("Gamescene");
            if (String($(this).attr("data-friendId")) != "random") {
                Scrabble.GameServerManager.postNewMatch([String($(this).attr("data-friendId"))], [], "suggested_players")
            } else {
                Scrabble.GameServerManager.postNewMatch(null, null, "suggested_players")
            }
        },show: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.NewGameMenu.hide();
            Scrabble.PopupManager.showBlocker();
            if (!Scrabble.SuggestionPopup.initialized) {
                Scrabble.SuggestionPopup.init()
            }
            Scrabble.SuggestionPopup.popup.show();
            Scrabble.Board.disableBoard()
        },hide: function() {
            if (Scrabble.SuggestionPopup.popup == null) {
                $("#singleSuggestionPopup").css("display", "none");
                $("#suggestionPopup").css("display", "none")
            } else {
                if (Scrabble.SuggestionPopup.popup.css("display") != "none") {
                    Scrabble.SuggestionPopup.popup.hide();
                    Scrabble.PopupManager.close();
                    Scrabble.Board.reEnableBoard()
                }
            }
            Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.SuggestionPopupClosed)
        }}
}();
Scrabble.TradeTilesPopup = function() {
    var a = "tradeTilesPopup";
    var d = 528;
    var c = 183;
    var b = 24;
    return {isAnimating: false,tileTracking: false,branding: true,isOpen: false,init: function() {
            var e = Scrabble.PopupFactory.tradeTilesPopup();
            document.getElementById(a).innerHTML = e;
            $("#tradeTilesAccept").on("click", null, Scrabble.TradeTilesPopup.acceptTrade);
            $("#tradeTilesCancel").on("click", null, Scrabble.TradeTilesPopup.hide);
            $("#tradeTilesPopup .infoToken").on("click", null, Scrabble.TradeTilesPopup.showInfo);
            $("#tradeTilesPopupXBtn").on("click", null, Scrabble.TradeTilesPopup.hide);
            $("#tileTrackingInfo .xButton").on("click", null, Scrabble.TradeTilesPopup.hideInfo);
            $(".tradeRackSpace").droppable({tolerance: "pointer",drop: function(g, f) {
                    f.draggable.removeClass("grabbed");
                    if (this.childNodes.length === 0) {
                        $(this).append(f.draggable);
                        f.draggable.css("left", 0);
                        f.draggable.css("top", 0);
                        Scrabble.GameScene.updateSkip()
                    } else {
                        console.log("slot not available, get next empty slot");
                        $(".tradeRackSpace").each(function(h) {
                            if (this.childNodes.length === 0) {
                                $(this).append(f.draggable);
                                f.draggable.css("left", 0);
                                f.draggable.css("top", 0);
                                Scrabble.GameScene.updateSkip();
                                return false
                            }
                        })
                    }
                    Scrabble.SoundManager.playRoll("Drop_r", 5)
                },start: function(g, f) {
                    Scrabble.GameScene.updateSkip()
                }})
        },show: function(g) {
            if (!Scrabble.TradeTilesPopup.isAnimating && Scrabble.TradeTilesPopup.isOpen == false) {
                Scrabble.TradeTilesPopup.init();
                if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                } else {
                    if (g === true) {
                        $activeTiles = $('[data-tile_active="active"]');
                        $activeTiles.off("click", Scrabble.TradeTilesPopup.onTileClick);
                        $activeTiles.on("click", Scrabble.TradeTilesPopup.onTileClick);
                        $activeTiles.draggable({delay: 10})
                    }
                }
                Scrabble.Board.overlayOpened = true;
                Scrabble.TradeTilesPopup.isAnimating = true;
                Scrabble.TradeTilesPopup.isOpen = true;
                Scrabble.Board.disableBoard();
                $boardButtons = $("#shuffleBtn,#forfeitBtn,#playBtn");
                $boardButtons.fadeTo(0, 0.5);
                $boardButtons.css("cursor", "default");
                var e = $("#tradeTilesPopup");
                if (Scrabble.TradeTilesPopup.tileTracking) {
                    var f = new Date();
                    if (f >= (new Date(2013, 3, 1, 3)) && f < new Date(2013, 6, 1, 0) && Scrabble.TradeTilesPopup.branding == true) {
                        e.css({"background-image": 'url("' + Scrabble.config._cdnVersion + '/images/skins/skin_default/tileTrackingBranded.png")',height: "389px"});
                        $("#tradeTilesRackMessage").css("bottom", "35px");
                        $("#tradeRack").css("bottom", "25px");
                        $("#tradeTilesCancel").css("bottom", "70px");
                        $("#tradeTilesAccept").css("bottom", "65px");
                        d += b;
                        c -= b;
                        b = 0
                    }
                }
                e.show();
                e.css("top", d + "px");
                e.animate({top: c + "px"}, 200, function() {
                    Scrabble.TradeTilesPopup.isAnimating = false;
                    e = null
                });
                $("#scorePreview").hide();
                $("#lastScorePreviewIndicator").css("z-index", 2);
                if (g == false) {
                    $("#tradeTilesAccept").fadeTo(0, 0.5);
                    $("#tradeTilesAccept").css("cursor", "default");
                    if (Scrabble.GameServerManager.currentGame().board.bagsize < 7) {
                        $("#tradeTilesRackMessage").html(Scrabble.Dictionary.translate("EX_TXT_NTENOUGHTLS"))
                    } else {
                        $("#tradeTilesRackMessage").html("")
                    }
                    $("#tradeTilesAccept").off("click", null, Scrabble.TradeTilesPopup.acceptTrade)
                }
                Scrabble.TelemetryManager.sendExchange(Scrabble.GameServerManager.currentGame(), "open")
            }
        },hide: function(g) {
            if (!Scrabble.TradeTilesPopup.isAnimating && Scrabble.TradeTilesPopup.isOpen == true) {
                $('[data-tile_active="active"]').off("click", Scrabble.TradeTilesPopup.onTileClick);
                Scrabble.Board.overlayOpened = false;
                Scrabble.TradeTilesPopup.isAnimating = true;
                Scrabble.TradeTilesPopup.isOpen = false;
                Scrabble.Board.reEnableBoard();
                var f = $("#shuffleBtn,#forfeitBtn,#playBtn");
                f.fadeTo(0, 1);
                f.css("cursor", "pointer");
                Scrabble.TileManager.emptyAbsoluteContainer();
                if (g !== true) {
                    var e = $(".tradeRackSpace .tile");
                    if (e.length != 0) {
                        Scrabble.TileRack.recallTiles();
                        Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.RecallAnimationDone, Scrabble.TradeTilesPopup.recallAnimationDoneCallback)
                    } else {
                        $("#tradeTilesPopup").animate({top: d + "px"}, 200, function() {
                            $(this).hide();
                            Scrabble.TradeTilesPopup.isAnimating = false;
                            $("#lastScorePreviewIndicator").css("z-index", 50)
                        });
                        Scrabble.Board.updateScorePreview()
                    }
                } else {
                    $("#tradeTilesPopup").animate({top: d + "px"}, 200, function() {
                        $(this).hide();
                        Scrabble.TradeTilesPopup.isAnimating = false;
                        $("#lastScorePreviewIndicator").css("z-index", 50)
                    });
                    Scrabble.Board.updateScorePreview()
                }
                Scrabble.TelemetryManager.sendExchange(Scrabble.GameServerManager.currentGame(), "close")
            }
        },showInfo: function() {
            $("#tileTrackingInfo").show();
            $("#tileTrackingInfoTitle").html(Scrabble.Dictionary.translate((Scrabble.TradeTilesPopup.tileTracking) ? "EX_TXT_EXTLTRCKNG_EPLNTNTTL" : "EX_TXT_EXTLDSTRBTN"));
            $("#tileTrackingInfoMsg").html(Scrabble.Dictionary.translate((Scrabble.TradeTilesPopup.tileTracking) ? "EX_TXT_EXTLTRCKNG_EPLNTNTXT" : "EX_TXT_EXTLDSTRBTN_EPLNTNTXT"))
        },hideInfo: function() {
            $("#tileTrackingInfo").hide()
        },onTileClick: function(h, e) {
            var g = $(this);
            if (e != undefined) {
                g = e
            }
            if (g.parent(".tradeRackSpace").length != 0) {
                var f = Scrabble.TileRack.getEmptyRackSpaceId(false);
                Scrabble.TileRack.sendTileToRackSpace(g, f, true);
                return false
            } else {
                $(".tradeRackSpace").each(function(j) {
                    if (this.childNodes.length === 0) {
                        Scrabble.SoundManager.playRoll("Drop_r", 5);
                        $(this).append(g);
                        g.css("left", 0);
                        g.css("top", 0);
                        Scrabble.GameScene.updateSkip();
                        return false
                    }
                })
            }
        },recallAnimationDoneCallback: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.RecallAnimationDone, Scrabble.TradeTilesPopup.recallAnimationDoneCallback);
            $("#tradeTilesPopup").animate({top: d + "px"}, 200, function() {
                $(this).hide();
                Scrabble.TradeTilesPopup.isAnimating = false;
                $("#lastScorePreviewIndicator").css("z-index", 50)
            });
            Scrabble.Board.updateScorePreview()
        },deleteTiles: function() {
            $("#tradeTilesPopup .tile").remove()
        },acceptTrade: function() {
            Scrabble.TileManager.emptyAbsoluteContainer();
            var g = $("#tradeRack .tile");
            var f = g.length;
            if (f == 0) {
                var e = {type: "warningPopup",title: Scrabble.Dictionary.translate("GSCN_LBL_EXCHANGE"),message: Scrabble.Dictionary.translate("GSCNPP_TXT_EXCHNG_MSG1"),diag: {ok: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(e))
            } else {
                Scrabble.SoundManager.play_sfx("Popup_confirm");
                if (Scrabble.GamesList.numSkips() == 5) {
                    Scrabble.EventManager.bindEvent(Scrabble.UserEvents.SkipConfirmed, Scrabble.TradeTilesPopup.completeTrade);
                    var e = {type: "warningPopup",title: Scrabble.Dictionary.translate("GSCN_LBL_EXCHANGE"),message: Scrabble.Dictionary.translate("GSCNPP_TXT_GMENDNGMVEXCHNG_MSG"),diag: {cancel: {action: Scrabble.UserEvents.PopupCancelClicked,label: "GSCNPP_BTN_EXCHNG_CNCL"},confirm: {action: Scrabble.UserEvents.SkipConfirmed,label: "GSCNPP_BTN_EXCHNG_OK"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(e))
                } else {
                    Scrabble.TradeTilesPopup.completeTrade()
                }
            }
        },completeTrade: function() {
            Scrabble.PopupManager.close();
            Scrabble.SoundManager.play_sfx("Play");
            var h = $("#tradeRack .tile");
            var g = h.length;
            var e = [];
            for (var f = 0; f < g; f++) {
                e.push({id: h[f].getAttribute("data-id"),letter: h[f].getAttribute("data-letter"),x: 0,y: 0})
            }
            $("#gameScene .loadingWheel").show();
            Scrabble.TradeTilesPopup.hide(true);
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.TradeTilesPopup.endTurn);
            Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.TradeTilesPopup.endTurn);
            Scrabble.TelemetryManager.sendExchange(Scrabble.GameServerManager.currentGame(), "validate");
            Scrabble.GameServerManager.postPlay(e, "SWAP_TILES")
        },endTurn: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.TradeTilesPopup.endTurn);
            Scrabble.SocialPlatformManager.call("publishTurn", Scrabble.GameScene._finishTurn);
            Scrabble.LeftMenu.addSingleGame(Scrabble.GameServerManager.currentGame().matchuri, true)
        }}
}();
Scrabble.UpsellPopup = function() {
    isInit = false;
    popupId = "#upsellPopup";
    return {isInit: false,popupElement: null,popupsList: {hasbro: ["options_show_bonus_letters", "ad_removal", "winter_board", "vintage_board", "tile_distribution", "word_lists", "leaderboard", "dictionary", "word_check", "chat", "statistics", "store", "on_the_go"],mattel: ["legacy_board_mattel", "options_show_bonus_letters", "ad_removal", "winter_board", "vintage_board", "tile_distribution", "word_lists", "leaderboard", "statistics", "dictionary", "word_check", "chat", "store", "on_the_go"]},init: function() {
            isInit = true;
            var a = Scrabble.PopupFactory.upsellPopup();
            $(popupId).html(a)
        },show: function() {
            var b = Scrabble.UpsellPopup.popupsList[Scrabble.config._branding];
            if (b.length == 0) {
                $(popupId).hide();
                return
            }
            Scrabble.SoundManager.play_sfx("Generic_btn");
            if (!isInit) {
                Scrabble.UpsellPopup.init()
            }
            Scrabble.PopupManager.showBlocker();
            var c = Math.round(Math.random() * (b.length - 1));
            var a = Scrabble.UpsellPopup.getPopupObject(b[c]);
            $("#upsellTopLeftImage").css("background-image", "url(" + a.topLeftImage + ")");
            $("#upsellTitle").html(a.title);
            $("#upsellContent").html(a.content);
            $("#upsellOkBtn p").html(a.btnText);
            $("#upsellOkBtn").on("click", a.btnAction);
            $("#upsellCloseBtn").on("click", Scrabble.UpsellPopup.hide);
            $("#upsellPopup").show()
        },hide: function() {
            Scrabble.SoundManager.play_sfx("Cancel");
            $("#upsellCloseBtn").off("click");
            $("#upsellPopup").hide();
            Scrabble.PopupManager.close()
        },getPopupObject: function(a) {
            switch (a) {
                case "legacy_board_mattel":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup24.png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_LEGACY_TITLE"),content: Scrabble.UpsellPopup.legacyBoardMarkup,btnText: Scrabble.Dictionary.translate("FB_BUTTON_OPENSTORE"),btnAction: function() {
                            Scrabble.Store.show("upsell_popup");
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "options_show_bonus_letters":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup26_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_SHOWBONUS_TITLE"),content: Scrabble.UpsellPopup.bonusLettersMarkup,btnText: Scrabble.Dictionary.translate("FB_BUTTON_OPEN_OPTIONS"),btnAction: function() {
                            Scrabble.OptionsMenu.show();
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "ad_removal":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup05_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_AD_TITLE"),content: Scrabble.UpsellPopup.adRemovalMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_AD_BUTTON"),btnAction: function() {
                            Scrabble.Store.show("upsell_popup");
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "winter_board":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup07_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_WINTER_TITLE"),content: Scrabble.UpsellPopup.winterBoardMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_WINTER_BUTTON"),btnAction: function() {
                            Scrabble.Store.show("upsell_popup");
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "vintage_board":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_VINTAGE_TITLE"),content: Scrabble.UpsellPopup.vintageBoardMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_VINTAGE_BUTTON"),btnAction: function() {
                            Scrabble.Store.show("upsell_popup");
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "tile_distribution":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup03_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_TILE_TITLE"),content: Scrabble.UpsellPopup.tileDistributionMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_TILE_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "word_lists":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_DICO_TITLE"),content: Scrabble.UpsellPopup.wordListsMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_DICO_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "leaderboard":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_LDBRD_TITLE"),content: Scrabble.UpsellPopup.leaderboardMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_LDBRD_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "dictionary":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_MVLIST_TITLE"),content: Scrabble.UpsellPopup.dictionaryMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_MVLIST_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "word_check":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup19_" + Scrabble.config._branding + "_" + Scrabble.config.lang.toUpperCase() + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_CHECK_TITLE"),content: Scrabble.UpsellPopup.wordCheckMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_CHECK_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "chat":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup21_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_CHAT_TITLE"),content: Scrabble.UpsellPopup.chatMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_CHAT_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "statistics":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_STATS_TITLE"),content: Scrabble.UpsellPopup.statisticsMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_STATS_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "store":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup01_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_STORE_TITLE"),content: Scrabble.UpsellPopup.storeMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_STORE_BUTTON"),btnAction: function() {
                            Scrabble.Store.show("upsell_popup");
                            Scrabble.UpsellPopup.hide()
                        }};
                    break;
                case "on_the_go":
                    return {topLeftImage: Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup09_" + Scrabble.config._branding + ".png",title: Scrabble.Dictionary.translate("FB_INTROPOPUP_MOBILE_TITLE"),content: Scrabble.UpsellPopup.onTheGoMarkup,btnText: Scrabble.Dictionary.translate("FB_INTROPOPUP_MOBILE_BUTTON"),btnAction: function() {
                            Scrabble.UpsellPopup.hide()
                        }};
                    break
            }
        },legacyBoardMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_LEGACY_BODY"), "</p>", '<img src="', Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup25.png", '"/>'].join("")
        },bonusLettersMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_SHOWBONUS_BODY"), "</p>", '<img src="', Scrabble.config._cdnVersion + "/images/skins/skin_default/upsellPopup27_" + Scrabble.config._branding + '.png"/>'].join("")
        },adRemovalMarkup: function() {
            return ['<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup06_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_AD_BODY1"), "</p>"].join("")
        },winterBoardMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_WINTER_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup08_", Scrabble.config._branding, '.png"/>'].join("")
        },vintageBoardMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_VINTAGE_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup10_", Scrabble.config._branding, '.png"/>'].join("")
        },wordListsMarkup: function() {
            return ['<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup13_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_DICO_BODY1"), "</p>"].join("")
        },leaderboardMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_LDBRD_BODY1"), "</p>", '<img class="spaceTop" src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup14_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_LDBRD_BODY2"), "</p>"].join("")
        },dictionaryMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_MVLIST_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup15_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>'].join("")
        },wordCheckMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_CHECK_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup20_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>'].join("")
        },chatMarkup: function() {
            return ['<img class="spaceTop" src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup22_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_CHAT_BODY1"), "</p>"].join("")
        },statisticsMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_STATS_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup23_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_STATS_BODY2"), "</p>"].join("")
        },tileDistributionMarkup: function() {
            return ['<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_TILE_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup12_", Scrabble.config._branding, "_", Scrabble.config.lang.toUpperCase(), '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_TILE_BODY2"), "</p>"].join("")
        },storeMarkup: function() {
            return ['<div class="imageTextGroup spaceTop">', '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup02_", Scrabble.config._branding, '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_STORE_BODY1"), "</p>", "</div>", '<div class="imageTextGroup">', '<img class="pouchMargin" src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup03_", Scrabble.config._branding, '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_STORE_BODY2"), "</p>", "</div>", '<div class="imageTextGroup">', '<img class="interdictionMargin" src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup04_", Scrabble.config._branding, '.png"/>', '<p class="typo_lightBlue upsellTextSmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_STORE_BODY3"), "</p>", "</div>"].join("")
        },onTheGoMarkup: function() {
            var b = (Scrabble.config._branding == "hasbro") ? "http://smarturl.it/tippophasbro" : "http://smarturl.it/tippopupmattelios";
            var a = (Scrabble.config._branding == "hasbro") ? "http://smarturl.it/tippopuphasbroGP" : "http://smarturl.it/mattelFBgamepopupGP";
            return ['<p class="typo_lightBlue upsellTextSmall spaceTop">', Scrabble.Dictionary.translate("FB_INTROPOPUP_MOBILE_BODY1"), "</p>", '<img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup16_", Scrabble.config._branding, '.png"/>', '<div class="downloadButtons">', '<a class="upsellAppStoreBtn" href="', b, '" target="_blank"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup17", Scrabble.config.lang.toUpperCase(), '.png"/></a>', '<a class="upsellGooglePlayBtn" href="', a, '" target="_blank"><img src="', Scrabble.config._cdnVersion, "/images/skins/skin_default/upsellPopup18", Scrabble.config.lang.toUpperCase(), '.png"/></a>', "</div>", '<p class="typo_lightBlue upsellTextVerySmall">', Scrabble.Dictionary.translate("FB_INTROPOPUP_MOBILE_BODY2"), "</p>"].join("")
        }}
}();
Scrabble.WildTilePopup = function() {
    var a = "wildTilePopup";
    return {currentWildTile: null,init: function() {
            var b = Scrabble.PopupFactory.wildTilePopup({});
            document.getElementById(a).innerHTML = b;
            $(".lastTileRow").css("width", ($(".lastTileRow .wildLetter").length * 38) + "px");
            $("#wildTileCloseBtn").click(Scrabble.WildTilePopup.dismiss)
        },show: function(b) {
            Scrabble.WildTilePopup.init();
            Scrabble.Board.overlayOpened = true;
            Scrabble.Board.disableBoard();
            Scrabble.Board.wildTileOpened = true;
            var c = $("#shuffleBtn,#forfeitBtn,#playBtn,#tradeTilesBtn");
            c.fadeTo(0, 0.5);
            c.css("cursor", "default");
            Scrabble.WildTilePopup.currentWildTile = b;
            $("#wildTilePopup").show();
            $("#scorePreview").hide();
            $("#wildTilePopup").on("click", ".wildLetter", Scrabble.WildTilePopup.setBlankTileValue)
        },hide: function() {
            Scrabble.Board.overlayOpened = false;
            Scrabble.Board.reEnableBoard();
            Scrabble.Board.wildTileOpened = false;
            var c = $("#shuffleBtn,#forfeitBtn,#playBtn,#tradeTilesBtn");
            c.fadeTo(0, 1);
            c.css("cursor", "pointer");
            var b = $("#wildTilePopup");
            b.hide();
            Scrabble.Board.updateScorePreview();
            b.off("click", ".wildLetter", Scrabble.WildTilePopup.setBlankTileValue);
            $(document).off("click", Scrabble.WildTilePopup.dismiss)
        },dismiss: function(b) {
            Scrabble.TileManager.removeWildTileValue(Scrabble.WildTilePopup.currentWildTile);
            Scrabble.TileRack.recallTile(Scrabble.WildTilePopup.currentWildTile);
            Scrabble.WildTilePopup.hide()
        },setBlankTileValue: function(b) {
            Scrabble.SoundManager.playRoll("Grab_r", 5);
            var c = $(this).attr("id").substring(11);
            Scrabble.TileManager.setWildTileValue(Scrabble.WildTilePopup.currentWildTile, c);
            Scrabble.WildTilePopup.hide()
        }}
}();
Scrabble.WordList = function() {
    return {subMenu: "tlwl",word: "",tlwl: [],defaultString: "",wordListScroller: null,wordListScrollApi: null,wordListDOM: null,playsDisplayed: null,gameDictionary: null,initialize: function() {
            $("#wordsListTLWL").html(Scrabble.DomBuilder.tlwlConstruct([], []));
            $("#movesListHeader .th00").html("<p>" + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN1") + "</p>");
            $("#movesListHeader .th01").html("<p>" + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN2") + "</p>");
            $("#movesListHeader .th02").html("<p>" + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN3") + "</p>");
            $("#movesListHeader .th03").html("<p>" + Scrabble.Dictionary.translate("GSCNPP_LBL_WRDLST_MVS_CLMN4") + "</p>");
            $("#dictionaryHeader p").html(Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_TTL"));
            $("#twoLetterWordListBtnTxt").html(Scrabble.Dictionary.translate("GSCNPP_BTN_WRDLST_2LTTRWRDS"));
            $("#movesListBtnTxt").html(Scrabble.Dictionary.translate("GSCNPP_BTN_WRDLST_MVS"));
            $("#questWordsListBtnTxt").html(Scrabble.Dictionary.translate("TYT_TXT_DCTNRTYTTBTTLE"));
            $("#rightSubMenuSelect").on("click", Scrabble.WordList.toggleSubMenu);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.DictionaryUpdated, Scrabble.WordList.updatetlwl);
            Scrabble.WordList.openTwoLetterList();
            this.defaultString = Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_MSG");
            var c = $("#lookupTxt");
            c.val(this.defaultString);
            c.addClass("greyText");
            c.select(Scrabble.WordList.setFocus);
            c.focus(Scrabble.WordList.setFocus);
            c.blur(function() {
                Scrabble.WordList.addGrey();
                Scrabble.KeyboardManager.disableBackspace();
                Scrabble.KeyboardManager.setEnterKeyCallback(null)
            });
            var b = $("#wordsListTLWL");
            b.on("click", ".tlwl_tile", Scrabble.WordList.onTileClick);
            b.on("click", "#tlwlShowAllBtn", Scrabble.WordList.onShowAllClicked);
            var a = $("#movesListContainer");
            var d = a.html();
            this.wordListScroller = a.jScrollPane({contentWidth: 231,showArrows: true});
            this.wordListScrollApi = this.wordListScroller.data("jsp");
            this.wordListDOM = this.wordListScrollApi.getContentPane();
            $(d.wordListDOM).append(d);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.WordList.anonymousUserLoadedCallback)
        },setFocus: function() {
            Scrabble.WordList.removeGrey();
            Scrabble.KeyboardManager.enableBackspace();
            Scrabble.KeyboardManager.setEnterKeyCallback(Scrabble.WordList.lookupWord);
            Scrabble.Board.hideFocus()
        },reinitialize: function() {
            Scrabble.WordList.wordListScrollApi.reinitialise();
            $("#movesListContainer .jspContainer .jspHorizontalBar").hide();
            $("#tlwlTileCollection .selected").removeClass("selected");
            $("#tlwlShowAllBtn").hide();
            Scrabble.WordList.updatetlwlFilter("")
        },onShowAllClicked: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            $("#tlwlTileCollection .selected").removeClass("selected");
            $("#tlwlShowAllBtn").hide();
            Scrabble.WordList.updatetlwlFilter("")
        },onTileClick: function(b) {
            Scrabble.SoundManager.playRoll("Grab_r", 5);
            $("#tlwlTileCollection .selected").removeClass("selected");
            var c = $(b.currentTarget);
            c.addClass("selected");
            $("#tlwlShowAllBtn").show();
            var a = c.attr("id").substring(c.attr("id").lastIndexOf("_") + 1);
            a = Scrabble.Dictionary.translate(a, {CH: "}",RR: "[",LL: "]"});
            Scrabble.WordList.updatetlwlFilter(a)
        },updateIcon: function(a) {
            $("#wordsBtnImage").attr("title", getLocalizedDictionary(a));
            $("#wordsBtnImage").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconDictionary_" + a + "_" + Scrabble.config._branding + ".png')");
            $("#dictionaryHeader p").html(getWordListDictionary(a))
        },updatetlwlFilter: function(e) {
            var c = [];
            var a = Scrabble.WordList.tlwl.length;
            for (var b = 0; b < a; b++) {
                if (Scrabble.WordList.tlwl[b].indexOf(e.toUpperCase()) != -1) {
                    var d = Scrabble.WordList.tlwl[b].split("");
                    if (d[0] != undefined) {
                        d[0] = Scrabble.Dictionary.translate(d[0], {"}": "CH","[": "RR","]": "LL"});
                        d[1] = Scrabble.Dictionary.translate(d[1], {"}": "CH","[": "RR","]": "LL"});
                        d = '<span class="typo_2lwlDark">' + d[0] + '</span><span class="typo_2lwlLight">' + d[1] + "</span>";
                        c.push(d)
                    }
                }
            }
            if (c.length == 0) {
                c.push(Scrabble.Dictionary.translate("FCBK_TXT_NO2LTTRWRDS", {"}": "CH","[": "RR","]": "LL"}))
            }
            $("#tlwlWordCollection").html(c.join(" "))
        },updateQuestTabContent: function() {
            if (Scrabble.QuestPopup.isToyotaQuestCompleted) {
                $("#wordsListQuestList").html('<span class="questTabMessage typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_DCTNRAFTRWNTTLE") + '</span><span class="questTabCreative"><img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_toyota/toyotaBoardTileExtra.png" alt="Toyota" /></span><span class="questTabMessage typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_DCTNRAFTRWNTXT1") + Scrabble.Dictionary.translate("TYT_TXT_DCTNRAFTRWNTXT2") + '</span><span class="questTabMessage typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_DCTNRAFTRWNTXT3") + "</span>")
            } else {
                $("#wordsListQuestList").html('<span class="questTabMessage typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_DCTNRTYTTBTTXT1") + "</span>" + Scrabble.QuestBuilder.objectiveList(Scrabble.QuestPopup.toyotaObjectives) + '<span class="questTabMessage typo_lightBlue">' + Scrabble.Dictionary.translate("TYT_TXT_DCTNRTYTTBTTXT2") + '</span><span class="questPopupProgressMessage typo_darkRed">' + Scrabble.QuestBuilder.toyotaProgress() + "</span>")
            }
        },updatetlwl: function(a, b) {
            Scrabble.WordList.tlwl = a;
            $("#wordsListTLWL").html(Scrabble.DomBuilder.tlwlConstruct(a, Scrabble.TileSets.getAlphabet(b)));
            Scrabble.WordList.updatetlwlFilter("")
        },lookupWord: function() {
            var e = Scrabble.WordList;
            var c = ($("#lookupTxt").val()).split(" ").join("");
            if (e.word != c) {
                e.word = c;
                if (e.word != "") {
                    var b = e.word;
                    if (Scrabble.WordList.gameDictionary == "SPANISH") {
                        b = Scrabble.Dictionary.translate(e.word.toUpperCase(), {CH: "}",RR: "[",LL: "]"})
                    }
                    Scrabble.GameServerManager.findWordInDictionary(b, Scrabble.WordList.gameDictionary);
                    var f = Scrabble.GameServerManager.currentGame();
                    var d = {matchID: f.matchuri.substring(9)};
                    var a = Scrabble.TelemetryManager._getMatchType(f);
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, {subtype1: "features",subtype2: "dictionary",subtype3: "submit",data: JSON.stringify(d)});
                    return true
                }
            }
            return false
        },displaylookupResult: function(a) {
            var b = Scrabble.WordList;
            if (a) {
                Scrabble.SoundManager.play_sfx("Generic_btn")
            } else {
                Scrabble.SoundManager.play_sfx("Delete")
            }
            $("#lookupResult").html(Scrabble.DomBuilder.lookupResultConstruct(b.word.toUpperCase(), a))
        },toggleSubMenu: function(a) {
            if (Scrabble.WordList.subMenu != "moves" && a.target.id == "movesListBtnTxt") {
                Scrabble.WordList.openMovesList()
            } else {
                if (Scrabble.WordList.subMenu != "tlwl" && a.target.id == "twoLetterWordListBtnTxt") {
                    Scrabble.WordList.openTwoLetterList()
                } else {
                    if (Scrabble.WordList.subMenu != "quest" && a.target.id == "questWordsListBtnTxt") {
                        Scrabble.WordList.openQuestWordsList()
                    }
                }
            }
        },openTwoLetterList: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.WordList.subMenu = "tlwl";
            $("#rightSubMenuSelect").attr("class", "twoLetterWordListSelected");
            $("#wordsListMovesList").hide();
            $("#wordsListQuestList").hide();
            $("#wordsListTLWL").show()
        },openMovesList: function() {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.WordList.subMenu = "moves";
            $("#rightSubMenuSelect").attr("class", "movesListSelected");
            $("#wordsListTLWL").hide();
            $("#wordsListQuestList").hide();
            $("#wordsListMovesList").show();
            Scrabble.WordList.wordListScrollApi.reinitialise();
            $("#movesListContainer .jspContainer .jspHorizontalBar").hide();
            $("#movesListContainer .jspContainer").css("height", "400px");
            Scrabble.WordList.wordListScrollApi.scrollToPercentY(100)
        },openQuestWordsList: function() {
            Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "open", {subtype1: "features",subtype2: "dictionary",subtype3: "Toyota"});
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.WordList.subMenu = "toyota";
            $("#rightSubMenuSelect").attr("class", "questTabSelected");
            $("#wordsListMovesList").hide();
            $("#wordsListTLWL").hide();
            $("#wordsListQuestList").show()
        },removeGrey: function() {
            var a = $("#lookupTxt");
            if (a.val() == Scrabble.WordList.defaultString) {
                a.val("");
                a.removeClass("greyText")
            }
        },addGrey: function() {
            var a = $("#lookupTxt");
            if (a.val() == "") {
                a.val(Scrabble.WordList.defaultString);
                a.addClass("greyText")
            }
        },buildMovesList: function(c, j) {
            if (Scrabble.WordList.gameDictionary != j.board.dictionary) {
                Scrabble.WordList.gameDictionary = j.board.dictionary;
                Scrabble.WordList.word = ""
            }
            Scrabble.WordList.playsDisplayed = c;
            if (c == undefined) {
                $("#movesList").children("tbody").html("");
                return false
            }
            if (c.length == undefined) {
                c = [c]
            }
            var k = c.length;
            var n = [], f = 0, d, g, e, m, b, l = {}, a = "", o = [];
            for (var h = 0; h < k; h++) {
                d = c[h];
                if (d.playtype != "NUDGE") {
                    e = d.useruri.split("/")[2];
                    g = trimName(Scrabble.PlayerManager.getPlayerInfo(e, "first_name"), "", 6);
                    if (g == "false ") {
                        g = "Anonymous"
                    }
                    m = d.score;
                    b = Scrabble.GamesList.trimMove(d, j);
                    b = b.replace("}", "CH");
                    b = b.replace("]", "LL");
                    b = b.replace("[", "RR");
                    if (l[e] == undefined) {
                        l[e] = 0
                    }
                    l[e] += parseInt(m);
                    if (o.indexOf(e) >= 0 && d.playtype != "RESIGN") {
                        f += 1;
                        o = [];
                        o.push(e)
                    } else {
                        o.push(e)
                    }
                    if (n[f] == undefined) {
                        n[f] = []
                    }
                    if (b == "_SKIP") {
                        n[f].push({id: e,name: g,word: "SKIP_TURN",score: "-",total: "-"})
                    } else {
                        if (b == "SWAP_TILES") {
                            n[f].push({id: e,name: g,word: "SWAP_TILES",score: "-",total: "-"})
                        } else {
                            n[f].push({id: e,name: g,word: b,score: m,total: l[e]})
                        }
                    }
                }
            }
            $("#movesList").children("tbody").html(Scrabble.DomBuilder.movesListConstruct(n));
            Scrabble.WordList.wordListScrollApi.reinitialise();
            $("#movesListContainer .jspContainer .jspHorizontalBar").hide();
            Scrabble.WordList.wordListScrollApi.scrollToPercentY(100);
            $("#movesListContainer .jspContainer").css("height", "400px")
        },anonymousUserLoadedCallback: function(a) {
            $('#movesList [data-name_user_id="' + a + '"]').html(trimName(Scrabble.PlayerManager.getPlayerInfo(a, "first_name"), "", 6))
        }}
}();
Scrabble.MayhemEvents = function() {
    return {GetToken: "GetToken",GetUserIndirect: "GetUserIndirect",GetUserDirect: "GetUserDirect",PostUserList: "PostUserList",PostUser: "PostUser",GetUserSettings: "GetUserSettings",PostUserSettings: "PostUserSettings",GetScrabbleMatches: "GetScrabbleMatches",RefreshSingleMatch: "GetMatch",FindWordInDictionary: "FindWordInDictionary",GetStatsList: "GetStatsList",GetChatRoom: "GetChatRoom",PostPlay: "PostPlay",PostChat: "PostChat",PostMatchUser: "PostMatchUser",PostMatch: "PostMatch",MatchCreated: "MatchCreated",ProxyUpdated: "ProxyUpdated",ChatEntryPosted: "ChatEntryPosted",GetScrabbleAds: "GetScrabbleAds",GetInvitedFriends: "GetInvitedFriends",PostInvitedFriends: "PostInvitedFriends",PostMatchInvite: "PostMatchInvite"}
}();
Scrabble.SystemEvents = function() {
    return {Test: "Test",TokenReceived: "TokenReceived",FacebookFriendsLoaded: "facebookFriendsLoaded",FacebookFriendsRefreshed: "facebookFriendsRefreshed",FacebookFriendsBuilt: "FacebookFriendsBuilt",GameListLoaded: "gameListLoaded",AnonymousUserLoaded: "anonymousUserLoaded",SingleMatchRefreshed: "singleMatchRefreshed",MatchTypeRefreshed: "matchTypeRefreshed",ChatRoomLoaded: "ChatRoomLoaded",PublicGamesLoaded: "PublicGamesLoaded",NoPublicGamesFound: "NoPublicGamesFound",DictionaryUpdated: "DictionaryUpdated",PublicGameJoined: "PublicGameJoined",PublicGameFailed: "PublicGameFailed",StatsLoaded: "StatsLoaded",ShowEndOfGame: "ShowEndOfGame",ValidPlayAnimationDone: "ValidPlayAnimationDone",GameResized: "GameResized",MatchDeleted: "MatchDeleted",RecallAnimationDone: "RecallAnimationDone",AssetsLoaded: "AssetsLoaded",TransitionComplete: "TransitionComplete",StoreSyncComplete: "StoreSyncComplete",TNTUserReceived: "TNTUserReceived"}
}();
Scrabble.UserEvents = function() {
    return {PlayerSelectedFromList: "PlayerSelectedFromList",ArchiveSelectedFromList: "ArchiveSelectedFromList",FindQuickMatch: "FindQuickMatch",ShowPlayerProfile: "ShowPlayerProfile",MatchSelectedFromList: "matchSelectedFromList",ForfeitConfirmed: "ForfeitConfirmed",SkipConfirmed: "SkipConfirmed",PopupOKClicked: "PopupOKClicked",PopupCancelClicked: "PopupCancelClicked",FacebookWallPost: "FacebookWallPost",ReloadClicked: "ReloadClicked",HasAppConfirmed: "HasAppConfirmed",GetAppConfirmed: "GetAppConfirmed",SendFriendsConfirmed: "SendFriendsConfirmed",TileGrabbed: "TileGrabbed",SuggestionPopupClosed: "SuggestionPopupClosed",LegalTipClosed: "LegalTipClosed",QuestPopupDissmissed: "QuestPopupDissmissed"}
}();
Scrabble.AnimationManager = function() {
    var a = "0";
    return {animationData: {},animationsEnabled: true,init: function() {
            if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                Scrabble.AnimationManager.animationsEnabled = false
            }
        },animateElements: function(b, j, h, c, g, k, e) {
            var l = this._generateAnimationId();
            var d = {elementsArray: b.slice(),animationProperties: j,currentAnimationIndex: 0,completedAnimations: 0};
            if (typeof h == "undefined" || h == null) {
                h = 200
            }
            d.animationDuration = h;
            if (typeof c == "undefined" || c == null) {
                c = "linear"
            }
            d.animationEasing = c;
            if (typeof g == "undefined" || g == null) {
                g = 0
            }
            d.animationDelay = g;
            if (typeof k == "undefined" || k == null) {
                k = null
            }
            d.completeCallback = k;
            if (typeof e == "undefined" || e == null) {
                e = null
            }
            d.progressCallback = e;
            this.animationData[l] = d;
            var f = 0;
            while (f < b.length) {
                setTimeout(function() {
                    var n = Scrabble.AnimationManager.animationData[l];
                    var m = n.currentAnimationIndex;
                    n.currentAnimationIndex++;
                    $(n.elementsArray[m]).animate(n.animationProperties, n.animationDuration, n.animationEasing, function() {
                        Scrabble.AnimationManager._animateElementsProgressCallback(l)
                    })
                }, f * d.animationDelay);
                f++
            }
        },_animateElementsProgressCallback: function(c) {
            var b = Scrabble.AnimationManager.animationData[c];
            b.completedAnimations++;
            if (b.progressCallback != null) {
                b.progressCallback()
            }
            if (b.completedAnimations >= b.elementsArray.length && b.completeCallback != null) {
                b.completeCallback();
                Scrabble.AnimationManager._destroyAnimationObject(c)
            }
        },_destroyAnimationObject: function(b) {
            delete this.animationData[b]
        },fadeInOut: function(d, c, f, g, b, e, h) {
            setTimeout(function() {
                if (b != null) {
                    b()
                }
                d.fadeIn(f, function() {
                    if (e != null) {
                        e()
                    }
                    d.fadeOut(g, function() {
                        if (h != null) {
                            h()
                        }
                    })
                })
            }, c)
        },animateTextIncrementation: function(c, j, b, f) {
            var h, g, e = 25, d;
            b = b || 500;
            j = parseInt(j);
            if (f) {
                if (Scrabble.config.lang == "fr") {
                    g = parseInt(accounting.unformat(c.html(), ","))
                } else {
                    g = parseInt(accounting.unformat(c.html()))
                }
            } else {
                g = parseInt(c.html())
            }
            if (j == g) {
                return false
            }
            if (typeof f == "undefined") {
                f = false
            }
            h = parseInt((j - g) / (b / e));
            d = setInterval(function() {
                c.html(g += h);
                if (h > 0) {
                    if (g >= j) {
                        j = (f == true) ? convertToReadableNumber(j, false) : j;
                        c.html(j);
                        clearInterval(d)
                    }
                } else {
                    if (g <= j) {
                        j = (f == true) ? convertToReadableNumber(j, false) : j;
                        c.html(j);
                        clearInterval(d)
                    }
                }
            }, e);
            return true
        },_generateAnimationId: function() {
            var b = parseInt(a);
            a = (++b) + "";
            return a
        }}
}();
Scrabble.CookieManager = function() {
    return {createCookie: function(c, d, e) {
            if (e) {
                var b = new Date();
                b.setTime(b.getTime() + (e * 24 * 60 * 60 * 1000));
                var a = "; expires=" + b.toGMTString()
            } else {
                var a = ""
            }
            document.cookie = c + "=" + d + a + "; path=/"
        },readCookie: function(b) {
            var e = b + "=";
            var a = document.cookie.split(";");
            for (var d = 0; d < a.length; d++) {
                var f = a[d];
                while (f.charAt(0) == " ") {
                    f = f.substring(1, f.length)
                }
                if (f.indexOf(e) == 0) {
                    return f.substring(e.length, f.length)
                }
            }
            return null
        },eraseCookie: function(a) {
            createCookie(a, "", -1)
        }}
}();
Scrabble.EventManager = function() {
    return {bindstack: {},errors: 0,diagnose: function(b) {
            var d = 0;
            for (event in Scrabble.EventManager.bindstack) {
                var a = Scrabble.EventManager.bindstack[event].length;
                if (b >= 1) {
                    console.log("Event " + event + " has " + a + " bound functions");
                    if (b >= 2) {
                        for (var c = 0; c < a; c++) {
                            console.log("\t function:" + Scrabble.EventManager.bindstack[event][c])
                        }
                    }
                }
                d += a
            }
            console.log("Total number of event-function binds is " + d)
        },dispatchEvent: function(a, b) {
            Scrabble.EventManager.runStack(a, b)
        },bindEvent: function(a, b) {
            if (Scrabble.EventManager.bindstack[a] == undefined) {
                Scrabble.EventManager.bindstack[a] = [b]
            } else {
                Scrabble.EventManager.bindstack[a].push(b)
            }
        },unbindEvent: function(a, e) {
            var d = false;
            var c = false;
            if (Scrabble.EventManager.bindstack[a] != undefined) {
                for (var b = 0; b < Scrabble.EventManager.bindstack[a].length; ++b) {
                    if (String(Scrabble.EventManager.bindstack[a][b]) == String(e)) {
                        d = true;
                        Scrabble.EventManager.bindstack[a].splice(b, 1)
                    }
                }
                if (Scrabble.EventManager.bindstack[a].length == 0 || e == undefined) {
                    d = true;
                    delete Scrabble.EventManager.bindstack[a]
                }
            } else {
                c = true
            }
            if (d == false && c == false) {
                Scrabble.EventManager.errors += 1
            }
        },runStack: function(b, c) {
            if (Scrabble.EventManager.bindstack[b] != undefined) {
                var d = Scrabble.EventManager.bindstack[b].length - 1;
                for (var a = d; a >= 0; a--) {
                    if (typeof Scrabble.EventManager.bindstack[b][a] == "function") {
                        Scrabble.EventManager.bindstack[b][a](c)
                    }
                }
            }
        }}
}();
Scrabble.GameServerManager = function() {
    var e = {uid: null,sessionKey: null,expirationDate: null};
    var d = null;
    var c = ["ENGLISH_TWL", "ENGLISH_MW", "ENGLISH_COLLINS", "FRENCH_FWL", "ITALIAN", "GERMAN", "SPANISH", "PORTUGUESE"];
    var q = 0;
    var x = 0;
    var b = 0;
    var B = 200;
    var g = 0;
    var j = 0;
    var h = 0;
    var o = 0;
    var z = 0;
    var u = false;
    var m = false;
    var a = true;
    var s = true;
    var r = 0;
    var A = 0;
    var t = 0;
    var f = 0;
    var v = false;
    var l = 0;
    var k = 0;
    var n = Scrabble.AjaxProxy;
    return {initialized: false,matchList: {},nudgeShown: false,pendingDelete: "",refreshedTimes: 0,refreshTimer: null,currentMatch: "",currentMatchState: "",currentMatchUserTurn: "",mh_auth_params: "",inGame: false,showAnim: false,userSettings: {defaultDictionary: 0,notifications: true},twoLetterWordList: {},maxActiveMatches: 50,gameCreatedEvent: function() {
        },changeProxy: function(C) {
            $.ajaxSetup({transport: "xhr"});
            n = Scrabble.AjaxProxy;
            delete Scrabble.MayhemBridge;
            Scrabble.GameServerManager.getUserIndirect()
        },getToken: function() {
            n.get(Scrabble.MayhemEvents.GetToken, {mayhemId: e.uid,mh_auth_params: ""}, Scrabble.GameServerManager.handleTokenRetrieved)
        },getUserIndirect: function(C) {
            Scrabble.GameServerManager.initialized = true;
            Scrabble.GameServerManager.mh_auth_params = Scrabble.config.accessToken;
            if (C == undefined) {
                C = Scrabble.config.fbId
            }
            n.get(Scrabble.MayhemEvents.GetUserIndirect, {applicationUserId: C}, Scrabble.GameServerManager.handleUserIndirectRetrieved)
        },token: function() {
            return e
        },getUserDirect: function(E) {
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                var C = Scrabble.LocalStorageManager.get("idMap");
                if (C != undefined) {
                    var C = JSON.parse(C);
                    for (var D in C) {
                        if (C[D] == E) {
                            Scrabble.EventManager.dispatchEvent(Scrabble.MayhemEvents.GetUserDirect, {user: {lastapplicationuseduserid: D}});
                            return true
                        }
                    }
                }
            }
            if (E != "-1") {
                n.get(Scrabble.MayhemEvents.GetUserDirect, {uid: E}, this.handleUserDirectRetrieved, E)
            }
        },getPlayers: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.FacebookFriendsLoaded, Scrabble.GameServerManager.getPlayers);
            Scrabble.GameServerManager.postUserList()
        },postUserList: function() {
            var E = [];
            var D = lookupIdMap("*");
            var F;
            for (var C = Scrabble.PlayerManager.players.length - 1; C >= 0; C--) {
                F = null;
                if (D != null && D[Scrabble.PlayerManager.players[C].fbId] != null) {
                    F = D[Scrabble.PlayerManager.players[C].fbId]["mayhemId"]
                }
                if (F != "0" && F != undefined && F != "") {
                    Scrabble.PlayerManager.updatePlayer(Scrabble.PlayerManager.players[C].fbId, "mayhemId", F);
                    Scrabble.PlayerManager.updatePlayer(Scrabble.PlayerManager.players[C].fbId, "signupTime", D[Scrabble.PlayerManager.players[C].fbId]["signupTime"]);
                    Scrabble.PlayerManager.updatePlayer(Scrabble.PlayerManager.players[C].fbId, "lastActivity", D[Scrabble.PlayerManager.players[C].fbId]["lastActivity"])
                } else {
                    E.push(Scrabble.PlayerManager.players[C].fbId)
                }
            }
            if (E.length > 0) {
                n.get(Scrabble.MayhemEvents.PostUserList, {applicationUserIds: E.join(","),mh_auth_params: ""}, this.handleUserListRetrieved)
            } else {
                Scrabble.GameServerManager.checkQuickLoad();
                Scrabble.StatsManager.loadStats(Scrabble.StatType[Scrabble.LeaderBoard.currentStatType].code)
            }
        },postUser: function(C) {
            n.post(Scrabble.MayhemEvents.PostUser, {applicationUserId: C,mh_auth_params: ""}, this.handleUserRetrieved)
        },getUserSettings: function() {
            n.get(Scrabble.MayhemEvents.GetUserSettings, {uid: e.uid,mh_session_key: "",mh_uid: ""}, Scrabble.GameServerManager.handleUserSettingsRetrieved)
        },postUserSettings: function() {
            n.post(Scrabble.MayhemEvents.PostUserSettings, {defaultDictionary: c[Scrabble.GameServerManager.userSettings.defaultDictionary],uid: e.uid,putOverride: true,mh_session_key: "",mh_uid: ""})
        },updateDictionary: function(C) {
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "change", {subtype1: "options",subtype2: "dictionary",data: JSON.stringify({old_dict: Scrabble.MatchOptions.dictionary,new_dict: c[C]})});
            Scrabble.GameServerManager.userSettings.defaultDictionary = C;
            Scrabble.MatchOptions.dictionary = c[C];
            n.post(Scrabble.MayhemEvents.PostUserSettings, {defaultDictionary: c[Scrabble.GameServerManager.userSettings.defaultDictionary],uid: e.uid,putOverride: true,mh_session_key: "",mh_uid: ""})
        },getDictionaryByName: function(C) {
            return c.indexOf(C)
        },updateBoardSkin: function(C) {
            Scrabble.GameServerManager.userSettings.boardLayout = C + "$$" + Scrabble.TileSkins.currentSkin;
            n.post(Scrabble.MayhemEvents.PostUserSettings, {boardLayout: Scrabble.GameServerManager.userSettings.boardLayout,defaultDictionary: c[Scrabble.GameServerManager.userSettings.defaultDictionary],uid: e.uid,putOverride: true,mh_session_key: "",mh_uid: ""})
        },updateTileSkin: function(C) {
            Scrabble.GameServerManager.userSettings.boardLayout = Scrabble.BoardSkins.currentSkin + "$$" + C;
            n.post(Scrabble.MayhemEvents.PostUserSettings, {boardLayout: Scrabble.GameServerManager.userSettings.boardLayout,defaultDictionary: c[Scrabble.GameServerManager.userSettings.defaultDictionary],uid: e.uid,putOverride: true,mh_session_key: "",mh_uid: ""})
        },getTwoLetterWordList: function(D) {
            var C;
            switch (D) {
                case "ENGLISH_TWL":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_TWL";
                    break;
                case "ENGLISH_MW":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_MW";
                    break;
                case "ENGLISH_COLLINS":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_COLLINS";
                    break;
                case "FRENCH_FWL":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_FWL";
                    break;
                case "ITALIAN":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_IWL";
                    break;
                case "GERMAN":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_GWL";
                    break;
                case "SPANISH":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_SWL";
                    break;
                case "PORTUGUESE":
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_POR";
                    break;
                default:
                    C = "GSCNPP_TXT_WRDLST_2LTTRWRDS_TWL";
                    break
            }
            return Scrabble.Dictionary.translate(C)
        },refreshMatches: function() {
            r = 0;
            A = 0;
            t = 0;
            f = 0;
            if (u == false) {
                h = 0;
                j = 3;
                z = 0;
                o = 1;
                q = 0;
                u = true;
                a = false;
                n.post(Scrabble.MayhemEvents.GetScrabbleMatches, {lastRefreshTime: g,dictionaryList: c,speed: "ALL",page: 0,pageSize: B,matchState: Scrabble.MatchStates.ACTIVE,uid: e.uid,mh_session_key: "",mh_uid: ""}, this.handleMatchTypeRefresh, null);
                n.post(Scrabble.MayhemEvents.GetScrabbleMatches, {lastRefreshTime: g,dictionaryList: c,speed: "TURBO",page: 0,pageSize: 10,matchState: Scrabble.MatchStates.WAITING_USERS,uid: e.uid,mh_session_key: "",mh_uid: ""}, this.handleMatchTypeRefresh, null);
                n.post(Scrabble.MayhemEvents.GetScrabbleMatches, {lastRefreshTime: g,dictionaryList: c,speed: "ALL",page: 0,pageSize: 10,matchState: Scrabble.MatchStates.COMPLETE,uid: e.uid,mh_session_key: "",mh_uid: ""}, this.handleMatchTypeRefresh, null)
            }
        },refreshSingleMatch: function(D, C) {
            if (C == undefined) {
                Scrabble.GameServerManager.showAnim = true
            } else {
                Scrabble.GameServerManager.showAnim = C
            }
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameServerManager.loadMatch);
            Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameServerManager.loadMatch);
            n.get(Scrabble.MayhemEvents.RefreshSingleMatch, {lastRefreshTime: g,matchId: D,uid: e.uid,mh_session_key: "",mh_uid: ""}, Scrabble.GameServerManager.handleSingleMatchRefresh)
        },refreshBoard: function() {
            if (Scrabble.config._autoRefresh == "true") {
                if (Scrabble.PlayValidation.getActiveTiles().length == 0 && Scrabble.OptionsMenu.isOpen == false && Scrabble.TipManager.tipVisible == false && Scrabble.Board.overlayOpened == false && $("#absoluteTileContainer .tile").length == 0) {
                    if (Scrabble.GameServerManager.refreshedTimes < 5) {
                        if (!s) {
                            Scrabble.LeftMenu.refreshGamesList(false)
                        } else {
                            s = false
                        }
                        Scrabble.GameServerManager.refreshedTimes++
                    }
                }
                setTimeout(Scrabble.GameServerManager.refreshBoard, parseInt(Scrabble.config._autoRefreshDelay))
            }
        },findWordInDictionary: function(C, D) {
            n.get(Scrabble.MayhemEvents.FindWordInDictionary, {word: C,dictionary: D}, this.handleWordRetreived)
        },getStatList: function(E, D, G, I) {
            if (m == false) {
                m = true;
                var F = [];
                var H = [];
                var C = 0;
                H.push(e.uid);
                for (C = 0; C < E.length; C++) {
                    H[H.length] = E[C].mayhemId || E[C];
                    if (H.length >= 4) {
                        F[F.length] = H;
                        H = []
                    }
                }
                if (H.length > 0) {
                    F[F.length] = H
                }
                l = 0;
                k = 0;
                Scrabble.GameServerManager._requestStat(F, D, G, I)
            }
        },_requestStat: function(G, D, F, H) {
            var E;
            for (var C = 0; C < G.length; ++C) {
                ++l;
                E = {};
                E.userList = G[C].join(",");
                E.realTime = F;
                if (D != "all") {
                    E.statTypeCode = D
                }
                n.get(Scrabble.MayhemEvents.GetStatsList, E, this.handleStatsListRetrieved, H)
            }
        },postPlay: function(C, F) {
            var G = "";
            var E = "PLAY_WORD";
            if (F != undefined) {
                E = F
            }
            for (var D = 0; D < C.length; D++) {
                if (C[D].letter == "SPANISH_CH") {
                    C[D].letter = "}"
                } else {
                    if (C[D].letter == "SPANISH_LL") {
                        C[D].letter = "]"
                    } else {
                        if (C[D].letter == "SPANISH_RR") {
                            C[D].letter = "["
                        }
                    }
                }
                G += [C[D].y, C[D].x, C[D].id, C[D].letter].join(",") + ";"
            }
            if (G == "") {
                E = "SKIP_TURN"
            }
            n.post(Scrabble.MayhemEvents.PostPlay, {uid: e.uid,matchId: Scrabble.GameServerManager.currentMatch.substring(9),playType: E,playData: G,game: "scrabble",timeout: 10,mh_session_key: "",mh_uid: ""}, this.handlePostPlaySuccess)
        },postForceForfeit: function() {
            Scrabble.TelemetryManager.sendGameEnd(Scrabble.GameServerManager.currentGame(), "forfeit_other");
            Scrabble.SocialPlatformManager.call("addNudge", Scrabble.PlayerManager.getPlayerInfo(Scrabble.GameServerManager.currentGame().board.currentturnuserid, "fbId"));
            n.post(Scrabble.MayhemEvents.PostPlay, {uid: e.uid,playData: Scrabble.GameServerManager.currentGame().board.currentturnuserid,matchId: Scrabble.GameServerManager.currentMatch.substring(9),playType: "NUDGE",game: "scrabble",timeout: 10,mh_session_key: "",mh_uid: ""}, this.handlePostNudgeSuccess, {match: Scrabble.GameServerManager.currentGame(),action: "single",reload: true,type: "forfeit"})
        },postNudge: function(F, E, D) {
            if (E == "forfeit") {
                Scrabble.TelemetryManager.sendGameEnd(Scrabble.GameServerManager.matchList[F], "forfeit_other")
            }
            Scrabble.TelemetryManager.sendNudgeFeature(Scrabble.GameServerManager.matchList[F], E, "sent");
            Scrabble.SocialPlatformManager.call("addNudge", Scrabble.PlayerManager.getPlayerInfo(Scrabble.GameServerManager.matchList[F].board.currentturnuserid, "fbId"));
            var C;
            if (E == "forfeit") {
                C = "forfeit"
            } else {
                C = "nudge"
            }
            n.post(Scrabble.MayhemEvents.PostPlay, {uid: e.uid,playData: Scrabble.GameServerManager.matchList[F].board.currentturnuserid,matchId: F.substring(9),playType: "NUDGE",game: "scrabble",timeout: 10,mh_session_key: "",mh_uid: ""}, Scrabble.GameServerManager.handlePostNudgeSuccess, {match: Scrabble.GameServerManager.matchList[F],action: E,reload: D,type: C})
        },currentGame: function() {
            var C = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (C == undefined) {
                C = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
            }
            return C
        },postChat: function(D, C) {
            Scrabble.TelemetryManager.sendChatSent(Scrabble.GameServerManager.currentGame());
            C = C.replaceAll("+", "%2B");
            C = C.replaceAll("&", "%26");
            n.post(Scrabble.MayhemEvents.PostChat, {chatRoomId: D,userId: e.uid,message: C,mh_session_key: "",mh_uid: ""}, this.handleChatEntryPosted)
        },deleteMatch: function(C) {
            if (Scrabble.GameServerManager.pendingDelete != Scrabble.GameServerManager.currentMatch) {
                Scrabble.GameServerManager.pendingDelete = Scrabble.GameServerManager.currentMatch;
                Scrabble.PopupManager.close();
                Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.ForfeitConfirmed, Scrabble.GameServerManager.deleteMatch);
                n.post(Scrabble.MayhemEvents.PostPlay, {tokenId: e.uid,uid: e.uid,matchId: Scrabble.GameServerManager.currentMatch.substring(9),playType: "RESIGN",game: "scrabble",timeout: 10,fbToken: Scrabble.config.accessToken,mh_session_key: "",mh_uid: ""}, Scrabble.GameServerManager.handlePostDeleteSuccess, C)
            }
        },checkMatchLimit: function() {
            var F = 0;
            for (var D in Scrabble.GameServerManager.matchList) {
                F++
            }
            if (F >= Scrabble.GameServerManager.maxActiveMatches) {
                Scrabble.LeftMenu.suggestedFriendsLocked = false;
                var G = Scrabble.Dictionary.translate("NGMPP_TXT_MAXSNGLPLYR_TTL");
                var E = Scrabble.Dictionary.translate("FCBK_TXT_GMLMTRCHD_MSG");
                var C = {type: "noticePopup",title: G,message: E,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "FCBK_BTN_GMLMTRCHD_OK"}}};
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C));
                return false
            }
            return true
        },postNewMatch: function(E, H, K) {
            if (Scrabble.GameServerManager.checkMatchLimit() == false) {
                return
            }
            Scrabble.NewGameMenu.hide();
            var L = {};
            var D = [];
            if (E == undefined) {
                E = []
            }
            if (H == undefined) {
                H = []
            }
            var F = K;
            var I;
            if (E.length == 0 && H.length == 0) {
                I = "2p_rand"
            } else {
                var J = E.length + H.length;
                switch (J) {
                    case 1:
                        if (H.length > 0) {
                            I = "2p_invite"
                        } else {
                            I = "2p_friends"
                        }
                        break;
                    case 2:
                        I = "mp_3";
                        break;
                    case 3:
                        I = "mp_4";
                        break
                }
            }
            Scrabble.GameServerManager.gameCreatedEvent = function(O, N) {
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, I, {subtype1: "game_start",subtype2: F,data: "{matchID:" + O + ",Played_first:" + N + "}"})
            };
            var M = 1200;
            var C = 200;
            if (Scrabble.StatsManager.stats[e.uid] != undefined) {
                M = Scrabble.StatsManager.stats[e.uid][Scrabble.StatType.RATING.id]
            }
            L.uid = e.uid;
            L.title = "Scrabble with " + Scrabble.PlayerManager.currentUser.first_name;
            L.description = " ";
            L.access = "PRIVATE";
            L.dictionary = Scrabble.MatchOptions.dictionary;
            L.speed = Scrabble.MatchOptions.gameSpeed;
            L.userRating = M;
            L.joinRatingRange = (M - C) + "-" + (M + C);
            if (E.length == 0 && H.length == 0) {
                L.access = "PUBLIC";
                L.startUserCount = 2;
                L.speed = "TURBO";
                L.joinMatch = true;
                L.matchUserApplication = "facebook"
            } else {
                L.startUserCount = E.length + H.length + 1;
                L.matchUserIds = E.join(",");
                L.matchUserApplicationIds = H.join(",");
                for (var G = 0; G < E.length; G++) {
                    D.push(Scrabble.PlayerManager.getPlayerInfo(E[G], "fbId"))
                }
                if (H.length > 0) {
                    L.matchUserApplication = "facebook";
                    Scrabble.LeftMenu.showLoadingCover();
                    L.mh_session_key = "";
                    L.mh_uid = "";
                    L.mh_auth_params = "";
                    delete L.matchUserApplication;
                    delete L.matchUserApplicationIds;
                    n.post(Scrabble.MayhemEvents.PostMatch, L, this.handlePostMatchWithInvite, H.join(","));
                    return true
                }
            }
            Scrabble.LeftMenu.showLoadingCover();
            L.mh_session_key = "";
            L.mh_uid = "";
            L.mh_auth_params = "";
            n.post(Scrabble.MayhemEvents.PostMatch, L, this.handlePostMatch, D.join(","))
        },postRematch: function(C, G) {
            if (Scrabble.GameServerManager.checkMatchLimit() == false) {
                return
            }
            var E = "rematch";
            var D;
            if (G.length == 1) {
                if (Scrabble.PlayerManager.getPlayerInfo(G[0], "isFriend") == true) {
                    D = "2p_friends"
                } else {
                    D = "2p_rand"
                }
            } else {
                var F = G.length;
                switch (F) {
                    case 2:
                        D = "mp_3";
                        break;
                    case 3:
                        D = "mp_4";
                        break
                }
            }
            Scrabble.GameServerManager.gameCreatedEvent = function(H) {
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, D, {subtype1: "game_start",subtype2: E,data: "{matchID:" + H + ",Played_first:true}"})
            };
            C.mh_session_key = "";
            C.mh_uid = "";
            n.post(Scrabble.MayhemEvents.PostMatch, C, this.handlePostMatch, G.join(","))
        },checkQuickLoad: function() {
            if (Scrabble.config.quickloadMatch != "" && Scrabble.config.quickloadMatch != undefined) {
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.GameServerManager.launchQuickLoadMatch)
            } else {
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.GameServerManager.loadFirstGame)
            }
            Scrabble.GameServerManager.refreshMatches()
        },getchatRoom: function(F, C) {
            if (F) {
                var D = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                if (D == undefined) {
                    D = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
                }
                var E = {chatRoomId: F,mh_session_key: "",mh_uid: ""};
                if (C != undefined && C != "") {
                    E.afterChatEntryId = C
                } else {
                    E.afterChatEntryId = ""
                }
                n.get(Scrabble.MayhemEvents.GetChatRoom, E, this.handleChatRoomRetrieved, null, false)
            }
        },handleChatRoomRetrieved: function(C) {
            if (C.resources) {
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.ChatRoomLoaded, {entries: C.resources.chatentry,match: Scrabble.GameServerManager.currentMatch})
            } else {
            }
        },launchQuickLoadMatch: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.GameServerManager.launchQuickLoadMatch);
            if (Scrabble.GameServerManager.matchList["/matches/" + Scrabble.config.quickloadMatch] != null) {
                Scrabble.GameServerManager.loadMatch("/matches/" + Scrabble.config.quickloadMatch)
            } else {
                if (Scrabble.GameServerManager.matchList[Scrabble.config.quickloadMatch] != null) {
                    Scrabble.GameServerManager.loadMatch(Scrabble.config.quickloadMatch)
                } else {
                    if (Scrabble.StatsManager.getArchive("/matches/" + Scrabble.config.quickloadMatch) != null) {
                        Scrabble.StatsManager.loadArchive("/matches/" + Scrabble.config.quickloadMatch)
                    } else {
                        if (Scrabble.StatsManager.getArchive(Scrabble.config.quickloadMatch) != null) {
                            Scrabble.StatsManager.loadArchive(Scrabble.config.quickloadMatch)
                        } else {
                            Scrabble.GameServerManager.loadFirstGame()
                        }
                    }
                }
            }
        },loadFirstGame: function(E) {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.MatchTypeRefreshed, Scrabble.GameServerManager.loadFirstGame);
            var D = null;
            for (var C in Scrabble.GameServerManager.matchList) {
                if (D == null) {
                    D = C
                }
                if (Scrabble.GameServerManager.matchList[C].board.currentturnuserid == Scrabble.PlayerManager.currentUser.mayhemId) {
                    Scrabble.GameServerManager.loadMatch(C, E);
                    return
                }
            }
            if (D != null) {
                Scrabble.GameServerManager.loadMatch(D, false)
            } else {
                $("#tileRackContainer .tileRackSpace").html("");
                $("#board .boardCell").html("");
                $("#cardZoneDivision").html("");
                $("#chatInputTxt").val("").trigger("autosize");
                Scrabble.Chat.setSize();
                $(Scrabble.Chat.chatRoomDOM).html("");
                $("#scorePreviewIndicator").hide()
            }
        },isMyTurn: function() {
            if (Scrabble.GameServerManager.currentGame().board.currentturnuserid == Scrabble.PlayerManager.currentUser.mayhemId) {
                return true
            }
            return false
        },mergeMatchList: function(C, E) {
            if (C != undefined) {
                if (C.length) {
                    for (var D = 0; D < C.length; D++) {
                        Scrabble.GameServerManager.matchList[C[D].matchuri] = C[D]
                    }
                } else {
                    Scrabble.GameServerManager.matchList[C.matchuri] = C
                }
                if (E) {
                    if (C.length == 1) {
                        if (Scrabble.GameScene.isWaitingForPlayValidation == false) {
                            Scrabble.LeftMenu.addSingleGame(C[0].matchuri, true)
                        } else {
                            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, function() {
                                Scrabble.LeftMenu.addSingleGame(C[0].matchuri, true)
                            });
                            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, function() {
                                Scrabble.LeftMenu.addSingleGame(C[0].matchuri, true)
                            })
                        }
                    } else {
                        Scrabble.LeftMenu.showLoadingCover();
                        Scrabble.GameServerManager.refreshMatches()
                    }
                }
            }
        },loadMatch: function(F, H) {
            if (Scrabble.GameServerManager.inGame == false) {
                Scrabble.GameServerManager.inGame = true;
                Scrabble.SoundManager.play_song();
                Scrabble.GameServerManager.refreshBoard()
            }
            clearTimeout(Scrabble.PlayerCards.tleftIn);
            Scrabble.EndGamePopup.hide();
            Scrabble.TipManager.removeTips(false);
            Scrabble.TradeTilesPopup.deleteTiles();
            Scrabble.TradeTilesPopup.hide();
            Scrabble.WildTilePopup.hide();
            Scrabble.SuggestionPopup.hide();
            $("#absoluteTileContainer").empty();
            $("#scorePreviewIndicator").hide();
            $("#lastScorePreviewIndicator").hide();
            $("#tempPreviewIndicator").hide();
            $("#dictionary").show();
            if (Scrabble.GameServerManager.showAnim == true) {
                H = true;
                Scrabble.GameServerManager.showAnim = false
            }
            H = H && Scrabble.AnimationManager.animationsEnabled;
            var C = Scrabble.GameServerManager.matchList[F];
            if (C != undefined) {
                var E = [];
                if (H != true) {
                    Scrabble.TileRack.saveTilesOrdering();
                    Scrabble.GameScene.resetBoard()
                }
                var J = {};
                if (C.plays.play != undefined) {
                    if (C.plays.play instanceof Array) {
                        for (var G = 0; G < C.plays.play.length; ++G) {
                            var I = C.plays.play[G];
                            if (I.playtype == "PLAY_WORD") {
                                E = E.concat(I.playdata.split(";"));
                                J = {word: I.allwords.word,score: I.score,user: I.useruri.split("/")[2]}
                            }
                        }
                    } else {
                        if (C.plays.play.playtype == "PLAY_WORD") {
                            E = E.concat(C.plays.play.playdata.split(";"));
                            var I = C.plays.play;
                            J = {word: I.allwords.word,score: I.score,user: I.useruri.split("/")[2]}
                        }
                    }
                }
                Scrabble.GameServerManager.refreshedTimes = 0;
                Scrabble.GameServerManager.currentMatch = F;
                Scrabble.GameServerManager.currentMatchState = C.state;
                Scrabble.GameServerManager.currentMatchUserTurn = C.board.currentturnuserid;
                Scrabble.WordList.updatetlwl(Scrabble.GameServerManager.getTwoLetterWordList(C.board.dictionary).split(" "), C.board.dictionary);
                Scrabble.WordList.buildMovesList(C.plays.play, C);
                Scrabble.WordList.updateIcon(C.board.dictionary);
                Scrabble.PlayValidation.currentDictionary = C.board.dictionary;
                Scrabble.Chat.currentChatRoom = (C.chatroomuri.split("/")[2]);
                Scrabble.GameServerManager.getchatRoom(C.chatroomuri.split("/")[2]);
                Scrabble.GameScene.updateBotMenu(H, false, C.board.bagsize);
                setTimeout(Scrabble.GameScene.updateBotMenu, 1000);
                $("#shuffleBtn p").html(Scrabble.Dictionary.translate("GSCN_LBL_SHUFFLE"));
                $("#shuffleBtn .botMenuIcon").css("background-image", "url('" + Scrabble.config._cdnVersion + "/images/skins/skin_default/gsIconShuffle00_" + Scrabble.config._branding + ".png')");
                if (Scrabble.GameScene.waitingConfirmation == false) {
                    $(".tempPreviewIndicator").remove();
                    Scrabble.PlayerCards.buildPlayerCards(C, H)
                } else {
                    Scrabble.GameScene.waitingConfirmation = false;
                    Scrabble.PlayerCards.buildPlayerCards(C, H, true)
                }
                if (H === true) {
                    Scrabble.GameScene.cloneGameScene(C)
                }
                if (C.rack.tileids != undefined && (C.rack.tileids + "").length > 0) {
                    Scrabble.TileRack.loadTiles(C.rack.tileids + "", H)
                }
                Scrabble.GameScene.setMatch(E, J);
                if (C.state == "COMPLETE") {
                    Scrabble.StatsManager.loadSingleUserStats(Scrabble.PlayerManager.currentUser.mayhemId);
                    Scrabble.Board.hideFocusArrow();
                    if (I.playtype != "PLAY_WORD" || I.useruri.split("/")[2] != Scrabble.PlayerManager.currentUser.mayhemId) {
                        setTimeout(function() {
                            Scrabble.GameServerManager.endGame()
                        }, 100)
                    } else {
                        Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameServerManager.endGame);
                        Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.ValidPlayAnimationDone, Scrabble.GameServerManager.endGame)
                    }
                }
                if (Scrabble.OnboardManager.showHowToPlayTip == true) {
                    var D;
                    if (C.plays.play == null || J == {}) {
                        D = "ONBRDNG_TXT_HWTPLYTP";
                        Scrabble.OnboardManager.showHowToPlayTip = false;
                        Scrabble.TipManager.removeTips(false);
                        Scrabble.TipManager.showTip("#botMenu", Scrabble.TipFactory.genericTip(D), "over")
                    }
                    Scrabble.OnboardManager.nextOnboardingStep()
                }
            }
            Scrabble.Chat.reset();
            if (Scrabble.QuestPopup.isToyotaQuestActive) {
                Scrabble.WordList.updateQuestTabContent()
            }
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameServerManager.loadMatch)
        },checkFriendsLoaded: function() {
            if (Scrabble.PlayerManager.friendsLoaded == true) {
                Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.FacebookFriendsLoaded, Scrabble.GameServerManager.getPlayers);
                Scrabble.GameServerManager.getPlayers()
            } else {
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.FacebookFriendsLoaded, Scrabble.GameServerManager.getPlayers)
            }
            setTimeout(Scrabble.GameServerManager.getUserSettings, 100)
        },endGame: function() {
            Scrabble.TelemetryManager.sendGameEnd(Scrabble.GameServerManager.currentGame(), "check");
            Scrabble.EndGamePopup.show(false, false);
            Scrabble.LeftMenu.archiveMatch(Scrabble.GameServerManager.currentMatch)
        },checkNudgables: function() {
            if (Scrabble.GameServerManager.nudgeShown == false) {
                Scrabble.GameServerManager.nudgeShown = true;
                var L = [];
                var H = [];
                var I = new Date();
                var D = new Date();
                D.setDate(D.getDate() - 3);
                for (var M in Scrabble.GameServerManager.matchList) {
                    var G = Scrabble.GameServerManager.matchList[M];
                    var E = G.lastupdateddate.split(":");
                    for (var F = 0; F < G.mmatchusers.matchuser.length; F++) {
                        if (G.mmatchusers.matchuser[F].userid != e.uid) {
                            if (E[0] >= 2) {
                                if (G.board.currentturnuserid != e.uid && G.board.currentturnuserid != "-1") {
                                    if (G.mmatchusers.matchuser[F].nudgeavailability != "NUDGE_FORFEIT") {
                                        L.push(Scrabble.DomBuilder.buildNudgeable(G, G.board.currentturnuserid, "nudge"));
                                        break
                                    }
                                }
                            } else {
                                if (G.mmatchusers.matchuser[F].nudgeavailability == "NUDGE") {
                                    L.push(Scrabble.DomBuilder.buildNudgeable(G, G.mmatchusers.matchuser[F].userid, "nudge"))
                                }
                            }
                            if (G.mmatchusers.matchuser[F].nudgeavailability == "NUDGE_FORFEIT") {
                                H.push(Scrabble.DomBuilder.buildNudgeable(G, G.mmatchusers.matchuser[F].userid, "forfeit"))
                            }
                        }
                    }
                }
                if (Scrabble.LocalStorageManager.localStorageEnabled == true) {
                    var J = Scrabble.LocalStorageManager.get("lastNudgeDate");
                    var K = Scrabble.LocalStorageManager.get("lastForfeitDate");
                    if (K == null) {
                        Scrabble.LocalStorageManager.set("lastForfeitDate", (D.getDate() + "/" + D.getMonth()));
                        K = (D.getDate() + "/" + D.getMonth())
                    }
                    var C = K.split("/");
                    if (C[0] <= D.getDate() && C[1] <= D.getMonth()) {
                        if (H.length != 0) {
                            Scrabble.LocalStorageManager.set("lastForfeitDate", (I.getDate() + "/" + I.getMonth()));
                            Scrabble.NudgePopup.set(H.join(""), "forfeit");
                            return
                        }
                    }
                    if (J != (I.getDate() + "/" + I.getMonth())) {
                        if (L.length != 0) {
                            Scrabble.LocalStorageManager.set("lastNudgeDate", (I.getDate() + "/" + I.getMonth()));
                            Scrabble.NudgePopup.set(L.join(""), "nudge");
                            return
                        }
                    }
                } else {
                    if (I.getDay() == 1 || I.getDay() == 4) {
                        if (H.length != 0) {
                            Scrabble.NudgePopup.set(H.join(""), "forfeit")
                        }
                    } else {
                        if (L.length != 0) {
                            Scrabble.NudgePopup.set(L.join(""), "nudge")
                        }
                    }
                }
            }
        },handleTokenRetrieved: function(D) {
            if (d == null) {
                if (D.token) {
                    var F = D.token.expirationdate.split(":");
                    var H = (F[0] * 360 * 24 * 1000) + (F[1] * 360 * 1000) + (F[2] * 60 * 1000) + (F[3] * 1000);
                    d = true;
                    e.sessionKey = D.token.sessionkey;
                    e.expirationDate = D.token.expirationdate;
                    if (Scrabble.config.firstTime == true) {
                        Scrabble.SplashScreen.hide()
                    }
                    Scrabble.GameServerManager.mh_uid = e.uid;
                    Scrabble.GameServerManager.mh_session_key = e.sessionKey;
                    Scrabble.GameServerManager.checkFriendsLoaded();
                    Scrabble.SocialPlatformManager.call("clearAllAppRequests");
                    Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.TokenReceived);
                    return
                }
            } else {
                if (D.token) {
                    e.sessionKey = D.token.sessionkey;
                    Scrabble.GameServerManager.mh_session_key = e.sessionKey;
                    Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.TokenReceived);
                    return
                }
            }
            var G = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLNTLDNG_TTL");
            var E = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLNTLDNG_MSG");
            var C = {type: "noticePopup",title: G,message: E,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
            Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C))
        },handleUserIndirectRetrieved: function(D) {
            var C = Scrabble.PlayerManager.currentUser;
            if (D.resources && D.resources.uri) {
                Scrabble.PlayerManager.currentUser.mayhemId = D.resources.uri.substr(7);
                Scrabble.PlayerManager.currentUser.signupTime = D.resources.signuptime;
                e.uid = D.resources.uri.substr(7);
                Scrabble.PlayerManager.currentUser.lastOnline = D.resources.lastactivity;
                Scrabble.GameServerManager.getToken();
                updateIdMap(Scrabble.config.fbId, "mayhemId", e.uid);
                updateIdMap(Scrabble.config.fbId, "signupTime", D.resources.signuptime);
                if (Scrabble.PlayerManager.currentUser.lastOnline) {
                    if (getIfPreHtmlUser(Scrabble.PlayerManager.currentUser.lastOnline)) {
                        Scrabble.config.firstTime = true
                    }
                }
            } else {
                Scrabble.GameServerManager.postUser(Scrabble.config.fbId);
                Scrabble.config.firstTime = true
            }
            Scrabble.Interstitials.firstTime = Scrabble.config.firstTime
        },handleUserDirectRetrieved: function(C, D) {
            Scrabble.EventManager.dispatchEvent(Scrabble.MayhemEvents.GetUserDirect, C);
            updateIdMap(C.user.lastapplicationuseduserid, "mayhemId", D)
        },handleUserRetrieved: function(D) {
            if (D.resources && D.resources.uri) {
                Scrabble.PlayerManager.currentUser.mayhemId = D.resources.uri.substr(7);
                e.uid = D.resources.uri.substr(7);
                Scrabble.GameServerManager.getToken();
                console.warn("From postUserPost:");
                updateIdMap(Scrabble.config.fbId, "mayhemId", e.uid)
            } else {
                var F = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTLDNG_TTL");
                var E = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTLDNG_MSG");
                if (D.error) {
                    if (D.error.code != "409") {
                        F = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTCMPLTD_TTL");
                        E = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTCMPLTD_MSG")
                    }
                } else {
                    F = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_TTL");
                    E = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_MSG");
                    Scrabble.LocalStorageManager.reset()
                }
                var C = {type: "noticePopup",title: F,message: E,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C))
            }
        },handleUserListRetrieved: function(E) {
            if (E.userlist) {
                if (E.userlist.user) {
                    var H = {};
                    if (E.userlist.user.length) {
                        for (var D = 0; D < E.userlist.user.length; D++) {
                            Scrabble.PlayerManager.updatePlayer(E.userlist.user[D].applicationuserid, "mayhemId", E.userlist.user[D].mayhemuserid);
                            Scrabble.PlayerManager.updatePlayer(E.userlist.user[D].applicationuserid, "signupTime", E.userlist.user[D].signuptime);
                            Scrabble.PlayerManager.updatePlayer(E.userlist.user[D].applicationuserid, "lastActivity", E.userlist.user[D].lastactivity);
                            Scrabble.PlayerManager.mayhemIdToFacebookIdList[E.userlist.user[D].mayhemuserid] = E.userlist.user[D].applicationuserid;
                            H[E.userlist.user[D].applicationuserid] = Scrabble.PlayerManager.playerList[E.userlist.user[D].applicationuserid]
                        }
                    } else {
                        Scrabble.PlayerManager.updatePlayer(E.userlist.user.applicationuserid, "mayhemId", E.userlist.user.mayhemuserid);
                        Scrabble.PlayerManager.updatePlayer(E.userlist.user.applicationuserid, "signupTime", E.userlist.user.signuptime);
                        Scrabble.PlayerManager.updatePlayer(E.userlist.user.applicationuserid, "lastActivity", E.userlist.user.lastactivity);
                        Scrabble.PlayerManager.mayhemIdToFacebookIdList[E.userlist.user.mayhemuserid] = E.userlist.user.applicationuserid;
                        H[E.userlist.user.applicationuserid] = Scrabble.PlayerManager.playerList[E.userlist.user.applicationuserid]
                    }
                    console.warn("From handlepostUserlist:");
                    advUpdateIdMap(H)
                } else {
                }
            } else {
                var G = Scrabble.Dictionary.translate("FCBK_TXT_FRNDSLSTNTLDNG_TTL");
                var F = Scrabble.Dictionary.translate("FCBK_TXT_FRNDSLSTNTLDNG_MSG");
                var C = {type: "noticePopup",title: G,message: F,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C))
            }
            Scrabble.GameServerManager.checkQuickLoad();
            Scrabble.StatsManager.loadStats(Scrabble.StatType[Scrabble.LeaderBoard.currentStatType].code)
        },handleUserSettingsRetrieved: function(E) {
            if (E.settings) {
                for (var D = 0; D < c.length; D++) {
                    if (c[D] == E.settings.defaultdictionary) {
                        Scrabble.GameServerManager.userSettings.defaultDictionary = D;
                        Scrabble.MatchOptions.dictionary = c[D]
                    }
                }
                Scrabble.GameServerManager.userSettings.notifications = E.settings.notificationprompts;
                var C;
                if (E.settings.boardlayout != undefined && E.settings.boardlayout != "normal") {
                    C = String(E.settings.boardlayout).split("$$")
                } else {
                    C = ["def", "def"]
                }
                Scrabble.GameServerManager.userSettings.boardLayout = C[0] + "$$" + C[1];
                Scrabble.Board.setBoardSkin(C[0], true);
                Scrabble.Board.setTileSkin(C[1], true);
                Scrabble.Store.syncEquiped();
                Scrabble.TelemetryManager.sendUserInformation("userSettings")
            }
        },handleMatchTypeRefresh: function(D) {
            if (D.resources) {
                if (D.resources.match) {
                    try {
                        var G = Scrabble.PlayerManager.currentUser.mayhemId;
                        if (D.resources.match.length) {
                            if (D.resources.match[0].state == "ACTIVE") {
                                var F = D.resources.match.length;
                                for (var C = 0; C < F; C++) {
                                    if (D.resources.match[C].board.currentturnuserid == G) {
                                        A++
                                    } else {
                                        r++
                                    }
                                }
                            } else {
                                if (D.resources.match[0].state == "AWAITING_USERS") {
                                    f += D.resources.match.length
                                } else {
                                    if (D.resources.match[0].state == "COMPLETE") {
                                        t = D.resources.match.length
                                    }
                                }
                            }
                        } else {
                            if (D.resources.match.state == "ACTIVE") {
                                if (D.resources.match.board.currentturnuserid == G) {
                                    A++
                                } else {
                                    r++
                                }
                            } else {
                                if (D.resources.match.state == "AWAITING_USERS") {
                                    f++
                                } else {
                                    if (D.resources.match.state == "COMPLETE") {
                                        t++
                                    }
                                }
                            }
                        }
                    } catch (E) {
                        console.warn("Problem sending telemetry for get match")
                    }
                    if (D.resources.match.length) {
                        if (D.resources.match[0].state != "COMPLETE") {
                            Scrabble.GameServerManager.mergeMatchList(D.resources.match)
                        } else {
                            Scrabble.StatsManager.mergeArchived(D.resources.match);
                            var I;
                            for (var C = 0; C < Scrabble.StatsManager.archives.length; C++) {
                                I = Scrabble.StatsManager.archives[C].matchuri;
                                delete Scrabble.GameServerManager.matchList[I];
                                $('[data-match_id="' + I.substring(9) + '"]').remove();
                                if (I == Scrabble.GameServerManager.currentMatch) {
                                    Scrabble.StatsManager.loadArchive(Scrabble.GameServerManager.currentMatch)
                                }
                            }
                        }
                        if (D.resources.match.length == B) {
                            if (D.resources.match[0].state == "ACTIVE") {
                                z++;
                                q++
                            }
                        }
                    } else {
                        if (D.resources.match.state != "COMPLETE") {
                            Scrabble.GameServerManager.mergeMatchList([D.resources.match])
                        } else {
                            Scrabble.StatsManager.mergeArchived([D.resources.match]);
                            Scrabble.LeftMenu.archiveMatch(D.resources.match.matchuri.substring(9));
                            if (D.resources.match.matchuri == Scrabble.GameServerManager.currentMatch) {
                                Scrabble.StatsManager.loadArchive(Scrabble.GameServerManager.currentMatch)
                            }
                        }
                    }
                }
            }
            h++;
            if (h >= j) {
                u = false;
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.MatchTypeRefreshed);
                if (!v) {
                    var H = Scrabble.kontagent.genUniqueTrackingTag();
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "total_games", {subtype1: "number_games",value: r + A + t + f,level: r + A + t + f,data: "{trackingTag:" + H + "}"});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "players_turn", {subtype1: "number_games",value: A,level: A,data: "{trackingTag:" + H + "}"});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "opponents_turn", {subtype1: "number_games",value: r,level: r,data: "{trackingTag:" + H + "}"});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "completed_game", {subtype1: "number_games",value: t,level: t,data: "{trackingTag:" + H + "}"});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "waiting_user", {subtype1: "number_games",value: f,level: f,data: "{trackingTag:" + H + "}"});
                    v = true
                }
            }
        },handleSingleMatchRefresh: function(D) {
            if (D.match) {
                if (D.match.mmatchusers.matchuser != null) {
                    Scrabble.GameServerManager.mergeMatchList([D.match], true);
                    matchId = D.match.matchuri.substring(9);
                    var C = "true";
                    if (D.match.plays.hasOwnProperty("play")) {
                        C = "false"
                    }
                    Scrabble.GameServerManager.gameCreatedEvent(matchId, C);
                    Scrabble.GameServerManager.gameCreatedEvent = function() {
                    }
                } else {
                    delete Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                    Scrabble.LeftMenu.addGames();
                    Scrabble.LeftMenu.loadFirstInList();
                    Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation);
                    return
                }
                Scrabble.EventManager.dispatchEvent(Scrabble.MayhemEvents.RefreshSingleMatch, D.match.matchuri)
            } else {
                Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation)
            }
        },handleWordRetreived: function(C) {
            if (C.error) {
                Scrabble.WordList.displaylookupResult(false)
            } else {
                Scrabble.WordList.displaylookupResult(true)
            }
        },handleStatsListRetrieved: function(C, D) {
            console.log("HANDLE STATS LIST RETRIEVED!");
            if (C && C.resources) {
                k++;
                if (k == l) {
                    m = false;
                    if (C.resources.stat) {
                        Scrabble.StatsManager.updateStats(C.resources.stat, true)
                    } else {
                        Scrabble.StatsManager.updateStats(false, true)
                    }
                    if (D) {
                        Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.LeaderBoard.fillScrollable);
                        Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.StatsLoaded);
                        Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.LeaderBoard.fillScrollable)
                    } else {
                        Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.StatsLoaded)
                    }
                } else {
                    if (C.resources.stat) {
                        Scrabble.StatsManager.updateStats(C.resources.stat, false)
                    }
                }
            } else {
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.StatsLoaded);
                Scrabble.TelemetryManager.sendUserInformation("fresh_stats_empty")
            }
        },handlePostPlaySuccess: function(D) {
            var F = "";
            var H = Scrabble.Dictionary.translate("GSCNPP_TXT_INVLDPLY_TTL");
            if (D.resources || D.nudgeresponse) {
                Scrabble.GameServerManager.refreshSingleMatch(Scrabble.GameServerManager.currentMatch.substring(9), false)
            } else {
                if (D.error && D.error.words) {
                    F = parseErrorMessage(D.error);
                    Scrabble.TileManager.reactivateTilesOnBoard();
                    Scrabble.GameScene.displayTilesError(D.error.words.split(";"));
                    var C = {type: "noticePopup",title: H,message: F,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C));
                    Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation)
                } else {
                    if (D.error && D.error.reason == "WORD_ATLEAST_TWO_LETTER_LONG") {
                        F = Scrabble.Dictionary.translate("GSCNPP_TXT_INVLDPLY_1LTTR_MSG");
                        Scrabble.TileManager.reactivateTilesOnBoard();
                        Scrabble.GameScene.displayTilesError();
                        var C = {type: "noticePopup",title: H,message: F,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                        Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C));
                        Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation)
                    } else {
                        if (D.error && D.error.type == "MATCH_IS_OVER") {
                            Scrabble.LeftMenu.archiveMatch(Scrabble.GameServerManager.currentMatch);
                            H = Scrabble.Dictionary.translate("FCBK_TXT_GMRSGND_TTL");
                            F = Scrabble.Dictionary.translate("FCBK_TXT_GMRSGND_MSG");
                            var C = {type: "noticePopup",title: H,message: F,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "FCBK_TXT_GMRSGND_OK"}}};
                            var E = Scrabble.PopupFactory.genericPopup(C);
                            Scrabble.PopupManager.add(E);
                            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation);
                            Scrabble.GameScene.isWaitingForPlayValidation = false;
                            Scrabble.GameScene.waitingConfirmation = false;
                            Scrabble.LeftMenu.loadFirstInList()
                        } else {
                            Scrabble.TileManager.reactivateTilesOnBoard();
                            Scrabble.GameScene.waitingConfirmation = false;
                            Scrabble.GameScene.isWaitingForPlayValidation = false;
                            var G = Scrabble.Dictionary.translate("FCBK_TXT_CNNTCHCKWRD_MSG");
                            var C = {type: "noticePopup",title: H,message: G,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                            var E = Scrabble.PopupFactory.genericPopup(C);
                            Scrabble.PopupManager.add(E);
                            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.RefreshSingleMatch, Scrabble.GameScene.handlePlayValidation)
                        }
                    }
                }
                Scrabble.GameScene.updateBotMenu()
            }
            $("#gameScene .loadingWheel").hide()
        },handlePostNudgeSuccess: function(C, D) {
            $("#gameScene .loadingWheel").hide();
            if (D.reload == true) {
                Scrabble.SocialPlatformManager.call("publishNudge", D.match, D.type);
                if (D.action == "single") {
                    Scrabble.GameServerManager.refreshSingleMatch(D.match.matchuri.substring(9), false)
                } else {
                    Scrabble.GameServerManager.refreshMatches()
                }
            }
        },handleChatEntryPosted: function(C) {
            if (C.resources) {
                Scrabble.EventManager.dispatchEvent(Scrabble.MayhemEvents.ChatEntryPosted, C.resources.uri)
            } else {
            }
        },handlePostDeleteSuccess: function(F, C) {
            Scrabble.GameServerManager.pendingDelete = null;
            var E = Scrabble.PlayerManager.currentUser.mayhemId;
            var I = $("#gameCard_" + E);
            if (I.has(".hasForfeited").length == 0) {
                $(I).prepend('<span class="hasForfeited"></span>')
            }
            if (F.resources) {
                if (Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch]) {
                    Scrabble.SocialPlatformManager.call("publishTurn", Scrabble.Interstitials.incrementTurnsPlayed, "delete")
                }
                if (C === true) {
                    delete Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
                    Scrabble.LeftMenu.addGames();
                    Scrabble.LeftMenu.loadFirstInList()
                }
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.MatchDeleted, C)
            } else {
                if (F.error && F.error.type == "MATCH_IS_OVER") {
                    Scrabble.GameScene.updateBotMenu();
                    var H = Scrabble.Dictionary.translate("FCBK_TXT_GMRSGND_TTL");
                    var G = Scrabble.Dictionary.translate("FCBK_TXT_GMRSGND_MSG");
                    var D = {type: "noticePopup",title: H,message: G,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(D))
                } else {
                    Scrabble.GameScene.updateBotMenu();
                    var H = Scrabble.Dictionary.translate("FCBK_TXT_DLTMTCHERRR_TTL");
                    var G = Scrabble.Dictionary.translate("FCBK_TXT_DLTMTCHERRR_MSG");
                    var D = {type: "noticePopup",title: H,message: G,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(D))
                }
            }
        },handlePostMatchWithInvite: function(D, E) {
            if (D.resources) {
                var F;
                F = D.resources.uri.split("/")[2];
                var C = {};
                C.matchId = F;
                C.userId = e.uid;
                C.applicationUserId = E;
                C.mh_session_key = "";
                C.mh_uid = "";
                n.post(Scrabble.MayhemEvents.PostMatchInvite, C, Scrabble.GameServerManager.handlePostMatch, E)
            }
        },handlePostMatch: function(D, E) {
            if (D.resources) {
                var F;
                if (D.resources.uri.indexOf("inviteKey") != -1) {
                    F = D.resources.uri.split("/")[4].split("?")[0]
                } else {
                    F = D.resources.uri.substring(9)
                }
                Scrabble.GameServerManager.refreshSingleMatch(F)
            } else {
                if (D.error) {
                    var C;
                    if (D.error.code == "401") {
                        C = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_TXT_CRTMTCHERRR_TTL"),message: Scrabble.Dictionary.translate("FCBK_TXT_CRTMTCHERRR_MSG"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}}
                    } else {
                        C = {type: "noticePopup",title: Scrabble.Dictionary.translate("NGMPP_TXT_TOOMNYGMS_TTL"),message: Scrabble.Dictionary.translate("NGMPP_TXT_TOOMNYGMS_MSG"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}}
                    }
                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(C));
                    Scrabble.GameServerManager.refreshSingleMatch(Scrabble.GameServerManager.currentMatch.substring(9))
                }
            }
        }}
}();
Scrabble.KeyboardManager = function() {
    return {keyCode: {backspace: 8,tab: 9,enter: 13,shift: 16,ctrl: 17,alt: 18,escape: 27,space: 32,left: 37,up: 38,right: 39,down: 40,"delete": 46,a: 65,b: 66,c: 67,d: 68,e: 69,f: 70,g: 71,h: 72,i: 73,j: 74,k: 75,l: 76,m: 77,n: 78,o: 79,p: 80,q: 81,r: 82,s: 83,t: 84,u: 85,v: 86,w: 87,x: 88,y: 89,z: 90,f1: 112},triggerEnterKeyOnReleaseOnly: false,enterKeyCallback: null,init: function() {
            $(document).keydown(function(a) {
                if (a.which == 13) {
                    Scrabble.KeyboardManager.triggerEnterKeyCallback(false)
                }
            });
            $(document).keyup(function(a) {
                if (a.which == 13) {
                    Scrabble.KeyboardManager.triggerEnterKeyCallback(true)
                }
            });
            Scrabble.KeyboardManager.disableBackspace()
        },disableBackspace: function() {
            $(document).on("keydown", Scrabble.KeyboardManager._preventBackspace)
        },_preventBackspace: function(a) {
            if (a.which == 8) {
                a.stopPropagation();
                a.preventDefault()
            }
        },enableBackspace: function() {
            $(document).off("keydown", Scrabble.KeyboardManager._preventBackspace)
        },setEnterKeyCallback: function(a) {
            Scrabble.KeyboardManager.enterKeyCallback = a
        },triggerEnterKeyCallback: function(a) {
            if (Scrabble.KeyboardManager.enterKeyCallback != null) {
                if (this.triggerEnterKeyOnReleaseOnly) {
                    if (a) {
                        Scrabble.KeyboardManager.enterKeyCallback()
                    }
                } else {
                    Scrabble.KeyboardManager.enterKeyCallback()
                }
            } else {
                if (a) {
                    if (Scrabble.Board._arrowPosition.x != -1) {
                        Scrabble.GameScene._playClicked()
                    }
                }
            }
        }}
}();
Scrabble.LocalStorageManager = function() {
    return {localStorageEnabled: null,detectLocalStorage: function() {
            if (Modernizr.localstorage) {
                try {
                    localStorage.test = "a";
                    Scrabble.LocalStorageManager.localStorageEnabled = true;
                    var c = localStorage.cacheVersion;
                    var b = localStorage.cacheUser;
                    if (c == undefined || c != Scrabble.vNum || b == undefined || b != Scrabble.config.fbId) {
                        Scrabble.LocalStorageManager.reset();
                        localStorage.cacheVersion = Scrabble.vNum;
                        localStorage.cacheUser = Scrabble.config.fbId
                    }
                } catch (a) {
                    Scrabble.LocalStorageManager.localStorageEnabled = false
                }
            } else {
                Scrabble.LocalStorageManager.localStorageEnabled = false
            }
        },get: function(a) {
            console.log("Reading from Local Storage:" + a);
            if (localStorage[Scrabble.vNum + "." + a] == undefined) {
                if (a == "sfxVolumeOption" || a == "musicVolumeOption") {
                    if (localStorage[a] == undefined) {
                        return null
                    } else {
                        return localStorage[a]
                    }
                }
                return null
            } else {
                return localStorage[Scrabble.vNum + "." + a]
            }
        },set: function(a, b) {
            console.log("Writting to Local Storage:" + a);
            try {
                if (a == "sfxVolumeOption" || a == "musicVolumeOption") {
                    localStorage[a] = b
                } else {
                    localStorage[Scrabble.vNum + "." + a] = b
                }
            } catch (c) {
                return false
            }
            return true
        },reset: function() {
            console.warn("Clearing Local Storage");
            for (var a in localStorage) {
                if (a != "sfxVolumeOption" && a != "musicVolumeOption") {
                    console.log("Removing " + a + " from Local Storage");
                    localStorage.removeItem(a)
                }
            }
        }}
}();
Scrabble.MatchOptions = function() {
    return {dictionary: "ENGLISH_COLLINS",gameSpeed: "SLOW",opponentRatingRange: "0-9999",startUserCount: "2",setDefaultDictionary: function() {
            var a = Scrabble.config.lang;
            switch (a) {
                case "fr":
                    Scrabble.MatchOptions.dictionary = "FRENCH_FWL";
                    break;
                case "it":
                    Scrabble.MatchOptions.dictionary = "ITALIAN";
                    break;
                case "de":
                    Scrabble.MatchOptions.dictionary = "GERMAN";
                    break;
                case "es":
                    Scrabble.MatchOptions.dictionary = "SPANISH";
                    break;
                case "pt":
                    Scrabble.MatchOptions.dictionary = "PORTUGUESE"
            }
        }}
}();
Scrabble.OnboardManager = function() {
    return {showHowToPlayTip: false,showNewGameTip: false,showDictionaryTip: false,onboardStepQueue: [],onboardEnabled: false,focusedElements: null,clonedFocusedElement: null,isSetup: false,setupOnboarding: function() {
            if (Scrabble.OnboardManager.isSetup == true) {
                return 0
            }
            var a;
            if (Scrabble.config.firstTime) {
                Scrabble.OnboardManager.setupFirstTimeOnboarding()
            } else {
                if (Scrabble.LocalStorageManager.localStorageEnabled == true && (a = Scrabble.LocalStorageManager.get("OnboardState")) != null) {
                    Scrabble.OnboardManager.setupLocalStorageOnboarding(a)
                } else {
                }
            }
            if (Scrabble.OnboardManager.onboardStepQueue.length == 0) {
                if (Scrabble.config.tntId != undefined) {
                    Scrabble.OnboardManager.checkShowOncePopups()
                } else {
                    Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.TNTUserReceived, Scrabble.OnboardManager.checkShowOncePopups)
                }
            } else {
                Scrabble.OnboardManager.onboardEnabled = true
            }
            Scrabble.OnboardManager.isSetup = true;
            Scrabble.OnboardManager.nextOnboardingStep()
        },checkShowOncePopups: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.TNTUserReceived);
            var a = new Date();
            for (var c = 0; c < Scrabble.ShowOncePopups.popupList.length; c++) {
                if (Scrabble.ShowOncePopups.popupList[c].expireDate > a) {
                    if (Scrabble.ShowOncePopups.popupList[c].startDate <= a) {
                        if ((Scrabble.ShowOncePopups.popupList[c].zone == "NA" && Scrabble.config._branding == "hasbro") || (Scrabble.ShowOncePopups.popupList[c].zone == "WW" && Scrabble.config._branding == "mattel")) {
                            var b = Scrabble.LocalStorageManager.get(Scrabble.ShowOncePopups.popupList[c].name);
                            if (b == null) {
                                Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.ShowOncePopups.popupList[c].show);
                                Scrabble.OnboardManager.onboardEnabled = true;
                                Scrabble.OnboardManager.nextOnboardingStep();
                                if (Scrabble.ShowOncePopups.popupList[c].save == undefined || Scrabble.ShowOncePopups.popupList[c].save == true) {
                                    Scrabble.LocalStorageManager.set(Scrabble.ShowOncePopups.popupList[c].name, "seen")
                                }
                                break
                            }
                        }
                    }
                }
            }
        },setupFirstTimeOnboarding: function() {
            Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerMattelIntroPopup);
            if (Scrabble.PlayerManager.countPlayers() - 1 != 0) {
                Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerSpreadTheWordPopup);
                if (Scrabble.LocalStorageManager.localStorageEnabled == true) {
                    Scrabble.LocalStorageManager.set("OnboardState", "OB1Spread")
                }
            } else {
                Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerInviteFriendsPopup);
                if (Scrabble.LocalStorageManager.localStorageEnabled == true) {
                    Scrabble.LocalStorageManager.set("OnboardState", "OB1Invite")
                }
            }
            Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerNewGameTooltip);
            Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerHowToPlayTooltip);
            Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerSuggestedGamesPopup);
            Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerChatTooltip)
        },setupLocalStorageOnboarding: function(a) {
            switch (a) {
                case "OB1Spread":
                    Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerInviteFriendsPopup);
                    Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerDictionaryTooltip);
                    Scrabble.LocalStorageManager.set("OnboardState", "OB2");
                    break;
                case "OB1Invite":
                    Scrabble.OnboardManager.onboardStepQueue.push(Scrabble.OnboardManager.triggerDictionaryTooltip);
                    Scrabble.LocalStorageManager.set("OnboardState", "OB2");
                    break;
                case "OB2":
                    break;
                default:
                    break
            }
        },checkNoWordsPlayedOB: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.OnboardManager.checkNoWordsPlayedOB);
            var a = Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.HIGH_WORD.id];
            if (Scrabble.OnboardManager.onboardEnabled == false && a.score <= 0) {
                Scrabble.config.firstTime = true;
                Scrabble.OnboardManager.setupOnboarding();
                Scrabble.NudgePopup.hide()
            }
        },nextOnboardingStep: function() {
            var a = Scrabble.OnboardManager.onboardStepQueue.shift();
            if (a != null) {
                a()
            }
        },triggerMattelIntroPopup: function() {
            Scrabble.OnBoardPopup.showNext("mattelIntroPopup")
        },triggerSpreadTheWordPopup: function() {
            Scrabble.OnBoardPopup.showNext("playWithFriendsPopup")
        },triggerInviteFriendsPopup: function() {
            Scrabble.OnBoardPopup.showNext("moreFriendsPopup")
        },triggerNewGameTooltip: function() {
            Scrabble.TopMenu.closeMessageBoard();
            Scrabble.TipManager.showTip("#newGameBtn", Scrabble.TipFactory.genericTip("ONBRDNG_TXT_STRTNWGMTP"), "left");
            Scrabble.OnboardManager.nextOnboardingStep()
        },triggerHowToPlayTooltip: function() {
            Scrabble.OnboardManager.showHowToPlayTip = true
        },triggerChatTooltip: function() {
            Scrabble.TipManager.removeTips(false);
            Scrabble.TipManager.showTip("#toggleChatBtn", Scrabble.TipFactory.genericTip("FCBK_TXT_ONBRDNG_CHT"), "under", 273);
            Scrabble.OnboardManager.nextOnboardingStep()
        },triggerDictionaryTooltip: function() {
            Scrabble.TopMenu.closeMessageBoard();
            Scrabble.TipManager.showTip("#toggleWordListBtn", Scrabble.TipFactory.genericTip("ONBRDNG_TXT_DCTNRYTP"), "under", 285);
            Scrabble.OnboardManager.nextOnboardingStep()
        },triggerSuggestedGamesPopup: function() {
            Scrabble.OnboardManager.setupEventTrigger(Scrabble.SystemEvents.ValidPlayAnimationDone, function() {
                Scrabble.OnboardManager.nextOnboardingStep()
            })
        },triggerBoardSkinSelectorIntroPopup: function(a) {
            Scrabble.OnboardManager.setupEventTrigger(Scrabble.UserEvents.SuggestionPopupClosed, function() {
                Scrabble.OnBoardPopup.showNext("boardSkinSelectorIntroPopup")
            })
        },triggerStoreIntroPopup: function(a) {
            Scrabble.OnboardManager.setupEventTrigger(Scrabble.UserEvents.SuggestionPopupClosed, function() {
                Scrabble.OnBoardPopup.showNext("storeIntroPopup")
            })
        },setupEventTrigger: function(a, b) {
            Scrabble.EventManager.bindEvent(a, function() {
                Scrabble.OnboardManager._eventTriggerHelper(a)
            });
            Scrabble.OnboardManager._eventCallbackFunction = b
        },_eventTriggerHelper: function(a) {
            Scrabble.EventManager.unbindEvent(a, function() {
                Scrabble.OnboardManager._eventTriggerHelper(a)
            });
            Scrabble.OnboardManager._eventCallbackFunction()
        },focusOnElements: function(a) {
            if (Object.prototype.toString.call(a) !== "[object Array]") {
                a = [a]
            }
            focusedElements = a;
            $("#fullGameOverlaySemiTransparent").show("fast");
            var d;
            for (var b = 0; b < focusedElements.length; b++) {
                d = $(focusedElements[b]);
                clonedFocusedElement = d.clone(true, true);
                $(clonedFocusedElement).appendTo("#onboardingFocus");
                var c = d.offset();
                $(clonedFocusedElement).offset(c)
            }
        },removeFocus: function() {
            $("#fullGameOverlaySemiTransparent").hide("fast");
            $("#onboardingFocus").empty()
        }}
}();
Scrabble.PlayerManager = function() {
    return {playerList: {},mayhemIdToFacebookIdList: {},friends: undefined,players: undefined,JSONBacklog: new Array(),batchSize: 5,batchDelay: 10,requestedUsers: 0,ommitList: [],friendsLoaded: false,currentUser: {},usedRandomList: [],anonymousUsersToGet: [],anonymousUserToGetIndex: 0,currentAnonymousUserMayhemId: null,currentAnonymousUserFbId: null,currentAnonymousUserSignup: null,tempIdLog: {},countPlayers: function() {
            return Scrabble.PlayerManager.players.length + 1
        },buildFriends: function() {
            if (Scrabble.PlayerManager.friendsLoaded == true) {
                Scrabble.PlayerManager.players = [];
                Scrabble.PlayerManager.friends = [];
                var c;
                for (var b in Scrabble.PlayerManager.playerList) {
                    c = Scrabble.PlayerManager.playerList[b];
                    if (c != null) {
                        if (!c.isAppUser) {
                            if (c.isFriend == true) {
                                Scrabble.PlayerManager.friends.push({facebookId: c.fbId,picUrl: c.picUrl,userName: c.first_name + " " + c.last_name,isAppUser: false})
                            }
                        } else {
                            if (Scrabble.PlayerManager.currentUser.fbId != c.fbId) {
                                if (c.mayhemId == "") {
                                    c.mayhemId = "0"
                                }
                                c.userName = c.first_name + " " + c.last_name;
                                Scrabble.PlayerManager.players.push(c)
                            }
                        }
                    }
                }
                var a = 0;
                if (Scrabble.PlayerManager.players.length) {
                    a = Scrabble.PlayerManager.players.length
                }
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "scrabble_friends", {data: "{nbScrabbleFriends:" + a + "}"});
                Scrabble.PlayerManager.friends.sort(Scrabble.NewGameMenu._sortUsersByName);
                Scrabble.PlayerManager.players.sort(Scrabble.NewGameMenu._sortUsersByName);
                Scrabble.PlayerManager.players.sort(Scrabble.NewGameMenu._sortNewAppUsers);
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.FacebookFriendsBuilt)
            }
        },finishUpdateCurrentPlayer: function(a) {
            if (a[0]) {
                Scrabble.PlayerManager.currentUser.first_name = a[0].first_name;
                Scrabble.PlayerManager.currentUser.last_name = a[0].last_name;
                Scrabble.PlayerManager.currentUser.picUrl = a[0].pic_square;
                Scrabble.PlayerManager.currentUser.fbId = Scrabble.config.fbId;
                Scrabble.PlayerManager.currentUser.isAppUser = true;
                Scrabble.PlayerManager.currentUser.isFriend = true;
                updateIdMap(Scrabble.config.fbId, Scrabble.PlayerManager.currentUser);
                console.warn("From updatecurrentuser:")
            } else {
            }
        },getRandomPlayer: function() {
            Scrabble.PopupManager.close();
            var e = Math.round(Math.random() * Scrabble.PlayerManager.countPlayers());
            var b = 0;
            var d = 0;
            while (Scrabble.PlayerManager.isUsed(e)) {
                d++;
                e = Math.round(Math.random() * Scrabble.PlayerManager.countPlayers());
                if (d == 5) {
                    break
                }
            }
            var a;
            for (var c in Scrabble.PlayerManager.playerList) {
                if (b == 0) {
                    a = Scrabble.PlayerManager.playerList[c]
                }
                if (b == e) {
                    Scrabble.PlayerManager.usedRandomList.push(b);
                    if (Scrabble.PlayerManager.playerList[c].mayhemId && Scrabble.PlayerManager.playerList[c].mayhemId != "") {
                        return Scrabble.PlayerManager.playerList[c]
                    } else {
                        e++
                    }
                }
                b++
            }
            return false
        },isUsed: function(a) {
            for (var b = 0; b < Scrabble.PlayerManager.usedRandomList.length; b++) {
                if (Scrabble.PlayerManager.usedRandomList[b] == a) {
                    return true
                }
            }
            return false
        },getAnonymousPlayersInfo: function(a) {
            if (Scrabble.PlayerManager.anonymousUsersToGet.indexOf(a) == -1) {
                Scrabble.PlayerManager.anonymousUsersToGet = Scrabble.PlayerManager.anonymousUsersToGet.concat(a)
            }
            if (Scrabble.PlayerManager.currentAnonymousUserMayhemId === null) {
                Scrabble.PlayerManager.loadNextAnonymous()
            }
        },loadNextAnonymous: function() {
            Scrabble.EventManager.bindEvent(Scrabble.MayhemEvents.GetUserDirect, Scrabble.PlayerManager.handleGetUserDirect);
            var a;
            if (Scrabble.PlayerManager.anonymousUsersToGet.length < Scrabble.PlayerManager.anonymousUserToGetIndex) {
                return false
            }
            a = Scrabble.PlayerManager.anonymousUsersToGet[Scrabble.PlayerManager.anonymousUserToGetIndex];
            Scrabble.PlayerManager.anonymousUserToGetIndex++;
            Scrabble.PlayerManager.currentAnonymousUserMayhemId = a;
            Scrabble.GameServerManager.getUserDirect(a)
        },handleGetUserDirect: function(a) {
            Scrabble.EventManager.unbindEvent(Scrabble.MayhemEvents.GetUserDirect, Scrabble.PlayerManager.handleGetUserDirect);
            if (a.user) {
                Scrabble.PlayerManager.currentAnonymousUserFbId = a.user.lastapplicationuseduserid;
                Scrabble.PlayerManager.currentAnonymousUserSignup = a.user.signuptime;
                Scrabble.SocialPlatformManager.call("getUserInfo", Scrabble.PlayerManager.handleFbGetUserInfo, {fields: "first_name,last_name,pic_square",ids: a.user.lastapplicationuseduserid})
            }
        },handleFbGetUserInfo: function(a) {
            Scrabble.PlayerManager.mayhemIdToFacebookIdList[Scrabble.PlayerManager.currentAnonymousUserMayhemId] = Scrabble.PlayerManager.currentAnonymousUserFbId;
            if (a.length > 0) {
                Scrabble.PlayerManager.playerList[Scrabble.PlayerManager.currentAnonymousUserFbId] = {fbId: Scrabble.PlayerManager.currentAnonymousUserFbId,first_name: a[0].first_name,last_name: a[0].last_name,signupTime: Scrabble.PlayerManager.currentAnonymousUserSignup,mayhemId: Scrabble.PlayerManager.currentAnonymousUserMayhemId,picUrl: a[0].pic_square}
            } else {
                Scrabble.PlayerManager.playerList[Scrabble.PlayerManager.currentAnonymousUserFbId] = {fbId: Scrabble.PlayerManager.currentAnonymousUserFbId,first_name: "Anonymous",last_name: "",signupTime: Scrabble.PlayerManager.currentAnonymousUserSignup,mayhemId: Scrabble.PlayerManager.currentAnonymousUserMayhemId,picUrl: Scrabble.config._cdnVersion + "/images/skins/skin_default/randomOpponent_" + Scrabble.config._branding + ".png"}
            }
            updateIdMap(Scrabble.PlayerManager.currentAnonymousUserFbId, Scrabble.PlayerManager.playerList[Scrabble.PlayerManager.currentAnonymousUserFbId]);
            Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.AnonymousUserLoaded, Scrabble.PlayerManager.currentAnonymousUserMayhemId);
            if (Scrabble.PlayerManager.anonymousUsersToGet.length > Scrabble.PlayerManager.anonymousUserToGetIndex) {
                Scrabble.PlayerManager.loadNextAnonymous()
            } else {
                Scrabble.PlayerManager.currentAnonymousUserMayhemId = null
            }
        },getCurrentGameOpponents: function() {
            return Scrabble.PlayerManager.getGameOpponents(Scrabble.GameServerManager.currentGame())
        },getGameOpponents: function(c) {
            var a;
            var d;
            var b = [];
            if (c == null) {
                console.log("Called getGameOpponents with a null game as parameter");
                return b
            }
            for (i = 0; i < c.mmatchusers.matchuser.length; i++) {
                a = c.mmatchusers.matchuser[i].userid;
                d = Scrabble.PlayerManager.getPlayerInfo(a, "fbId");
                console.log(Scrabble.PlayerManager.currentUser.fbId + " VS " + d);
                if (Scrabble.PlayerManager.currentUser.fbId != d) {
                    b.push(d)
                }
            }
            return b.join(",")
        },trimTransitionnedUsers: function(a) {
            if (Scrabble.config.isABon == 1) {
                if (isInPcent(a) == false) {
                    Scrabble.PlayerManager.ommitList.push(a);
                    return false
                }
            }
            return true
        },getPlayerInfo: function(a, c) {
            thisRef = Scrabble.PlayerManager;
            if (thisRef.playerList[a] != undefined) {
                return (thisRef.playerList[a].hasOwnProperty(c)) ? thisRef.playerList[a][c] : undefined
            } else {
                if (a == thisRef.currentUser.mayhemId) {
                    return (thisRef.currentUser.hasOwnProperty(c)) ? thisRef.currentUser[c] : undefined
                } else {
                    if (a == thisRef.currentUser.fbId) {
                        return (thisRef.currentUser.hasOwnProperty(c)) ? thisRef.currentUser[c] : undefined
                    } else {
                        var b = thisRef.mayhemIdToFacebookIdList[a];
                        if (b != null) {
                            if (thisRef.playerList[b] != null) {
                                return (thisRef.playerList[b].hasOwnProperty(c)) ? thisRef.playerList[b][c] : undefined
                            }
                        }
                    }
                }
            }
            return false
        },importJSON: function(b) {
            var a = Scrabble.PlayerManager;
            a.JSONBacklog = b.concat();
            a.performBatch()
        },loadFacebookFriends: function() {
            console.warn("From Load Facebook Friends:");
            var b = lookupIdMap("*");
            if (b != null) {
                for (var a in b) {
                    if (a != Scrabble.config.fbId) {
                        Scrabble.PlayerManager.playerList[a] = b[a];
                        Scrabble.PlayerManager.mayhemIdToFacebookIdList[b[a].mayhemId] = a
                    }
                }
                Scrabble.PlayerManager.friendsLoaded = true;
                Scrabble.PlayerManager.buildFriends();
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.FacebookFriendsLoaded);
                Scrabble.TelemetryManager.sendUserInformation("fb")
            } else {
                Scrabble.PlayerManager.refreshFacebookFriends()
            }
        },refreshFacebookFriends: function() {
            Scrabble.SocialPlatformManager.call("getFriends", Scrabble.PlayerManager.populateFriendList)
        },performBatch: function() {
            var c = Scrabble.PlayerManager;
            var b;
            for (var a = c.batchSize; a >= 0; a--) {
                if (c.JSONBacklog[a]) {
                    b = {first_name: c.JSONBacklog[a].first_name,last_name: c.JSONBacklog[a].last_name,picUrl: c.JSONBacklog[a].pic_square,fbId: c.JSONBacklog[a].uid,mayhemId: "",isFriend: true,isAppUser: c.JSONBacklog[a].is_app_user};
                    if (c.playerList[b.fbId] != undefined) {
                        c.playerList[b.fbId].first_name = b.first_name;
                        c.playerList[b.fbId].last_name = b.last_name;
                        c.playerList[b.fbId].picUrl = b.picUrl;
                        c.playerList[b.fbId].isAppUser = b.isAppUser;
                        c.playerList[b.fbId].fbId = b.fbId;
                        c.playerList[b.fbId].isFriend = true
                    } else {
                        c.playerList[b.fbId] = b
                    }
                    if (b.isAppUser == true) {
                        c.tempIdLog[b.fbId] = c.playerList[b.fbId]
                    }
                }
                c.JSONBacklog.splice(a, 1)
            }
            if (c.JSONBacklog.length >= 1) {
                setTimeout(c.performBatch, c.batchDelay)
            } else {
                console.warn("From performbatch:");
                advUpdateIdMap(c.tempIdLog);
                c.tempIdLog = {};
                c.friendsLoaded = true;
                Scrabble.PlayerManager.buildFriends();
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.FacebookFriendsLoaded);
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.FacebookFriendsRefreshed)
            }
        },populateFriendList: function(a) {
            if (a.data) {
                var c = [];
                Scrabble.PlayerManager.numFriends = a.data.length;
                for (var b = 0; b < Scrabble.PlayerManager.numFriends; b++) {
                    c[c.length] = a.data[b].id
                }
                Scrabble.PlayerManager.requestedUsers = a.data.length;
                Scrabble.SocialPlatformManager.call("getUserInfo", Scrabble.PlayerManager.importJSON, {fields: "uid,first_name,last_name,pic_square,is_app_user",ids: c.join()})
            }
        },updateCurrentPlayer: function() {
            Scrabble.SocialPlatformManager.call("getUserInfo", Scrabble.PlayerManager.finishUpdateCurrentPlayer, {fields: "uid,first_name,last_name,pic_square,is_app_user",ids: Scrabble.config.fbId})
        },updatePlayer: function(a, c, b) {
            Scrabble.PlayerManager.playerList[a][c] = b
        },getPlayers: function() {
            var a = [];
            for (var b in Scrabble.PlayerManager.playerList) {
                a.push(Scrabble.PlayerManager.playerList[b].fbId)
            }
            return a
        },getRegisteredPlayers: function(c) {
            var a = [];
            if (c == undefined) {
                c = "fbId"
            }
            for (var b in Scrabble.PlayerManager.playerList) {
                if (Scrabble.PlayerManager.playerList[b].mayhemId) {
                    a.push(Scrabble.PlayerManager.playerList[b][c])
                }
            }
            return a
        }}
}();
Scrabble.PopupManager = function() {
    var a = $("#scrabbleBody .blocker");
    return {$popupContainer: null,hasPopupOpened: false,queue: [],isPaused: false,add: function(b, c) {
            var d = Scrabble.PopupManager;
            if (!d.hasPopupOpened) {
                d.open(b, (b.show != undefined))
            } else {
                if (c == true) {
                    d.queue.splice(0, 0, b)
                } else {
                    d.queue.push(b)
                }
            }
        },init: function() {
            var b = Scrabble.PopupManager;
            b.$popupContainer = $("#popupContainer");
            b.$popupContainer.html("");
            if (Scrabble.AnimationManager.animationsEnabled) {
                b.$popupContainer.fadeTo(0, 0, function() {
                    $(this).hide()
                })
            } else {
                b.$popupContainer.hide()
            }
            b.bindCloseEvents()
        },bindCloseEvents: function() {
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupOKClicked, Scrabble.PopupManager.close);
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.PopupCancelClicked, function() {
                Scrabble.PopupManager.close();
                Scrabble.SoundManager.play_sfx("Popup_close")
            })
        },open: function(b, e) {
            if (Scrabble.PopupManager.isPaused) {
                return
            }
            if (b == null || b == "") {
                Scrabble.PopupManager.close();
                return
            }
            var d = Scrabble.PopupManager;
            if (e == true) {
                b.show();
                d.hasPopupOpened = true;
                return true
            }
            if (b.indexOf("ForfeitConfirmed") == -1) {
                Scrabble.SoundManager.play_sfx("Popup_open")
            }
            d.$popupContainer.html(b);
            if (Scrabble.AnimationManager.animationsEnabled) {
                var c = 215;
                $(".genericPopup").css("top", c + 80 + "px");
                $(".genericPopup").fadeTo(0, 0);
                $(".genericPopup").animate({top: c + "px",opacity: 1}, 100)
            }
            if ($("#messageBoard").css("display") == "block") {
                d.$popupContainer.css("top", "86px")
            } else {
                d.$popupContainer.css("top", "50px")
            }
            $(".popupButton").click(function(f) {
                Scrabble.EventManager.dispatchEvent($(this).attr("data-action"))
            });
            if (Scrabble.AnimationManager.animationsEnabled) {
                d.$popupContainer.fadeTo(150, 1, function() {
                    $(this).css("display", "block")
                })
            } else {
                d.$popupContainer.show()
            }
            d.showBlocker();
            if (b.indexOf("popupButton") == b.lastIndexOf("popupButton")) {
                Scrabble.KeyboardManager.triggerEnterKeyOnReleaseOnly = true;
                Scrabble.KeyboardManager.setEnterKeyCallback(function() {
                    Scrabble.EventManager.dispatchEvent($(".popupButton").attr("data-action"))
                })
            }
            d.hasPopupOpened = true
        },showBlocker: function() {
            console.log("SHOW BLOCKER!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
            a.stop();
            a.show();
            if (Scrabble.AnimationManager.animationsEnabled) {
                a.fadeTo(10, 1, function() {
                    a.css("display", "block", "important")
                })
            }
        },hideBlocker: function() {
            if (Scrabble.AnimationManager.animationsEnabled) {
                a.fadeTo(200, 0, function() {
                    $(this).hide()
                })
            } else {
                a.hide()
            }
        },close: function() {
            Scrabble.KeyboardManager.setEnterKeyCallback(null);
            Scrabble.KeyboardManager.triggerEnterKeyOnReleaseOnly = false;
            if (Scrabble.PopupManager.isPaused) {
                if (Scrabble.AnimationManager.animationsEnabled) {
                    Scrabble.PopupManager.$popupContainer.fadeTo(300, 0, function() {
                        $(this).hide()
                    })
                } else {
                    Scrabble.PopupManager.$popupContainer.hide()
                }
                if (Scrabble.OptionsMenu.isOpen == false && Scrabble.NewGameMenu.isOpen == false && Scrabble.Store.isOpen == false) {
                    Scrabble.PopupManager.hideBlocker()
                }
                Scrabble.PopupManager.hasPopupOpened = false
            } else {
                Scrabble.PopupManager.openNext()
            }
        },openNext: function() {
            if (Scrabble.PopupManager.isPaused) {
                return
            }
            var c = Scrabble.PopupManager;
            if (c.queue.length) {
                var b = c.queue.shift();
                c.open(b, (b.show != undefined))
            } else {
                if (Scrabble.AnimationManager.animationsEnabled) {
                    c.$popupContainer.fadeTo(300, 0, function() {
                        $(this).hide()
                    })
                } else {
                    c.$popupContainer.hide()
                }
                if (Scrabble.OptionsMenu.isOpen == false && Scrabble.NewGameMenu.isOpen == false && Scrabble.Store.isOpen == false) {
                    c.hideBlocker()
                }
                c.hasPopupOpened = false
            }
        },pause: function() {
            Scrabble.PopupManager.isPaused = true
        },resume: function() {
            Scrabble.PopupManager.isPaused = false;
            if (Scrabble.PopupManager.queue.length) {
                Scrabble.PopupManager.openNext()
            }
        }}
}();
Scrabble.ResolutionManager = function() {
    var d = 1025;
    var c = 990;
    var b = 760;
    var a = false;
    return {stageWidth: null,stageHeight: null,widthBracket: null,init: function() {
            $(window).resize(Scrabble.ResolutionManager.updateResolution);
            $("#rightMenu").on("click", ".rightMenuCloseBtn", function() {
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.RightMenu.pannelDisplayed = null;
                Scrabble.ResolutionManager.reduceResolution()
            })
        },reduceResolution: function() {
            if (Scrabble.ResolutionManager.widthBracket == 2) {
                Scrabble.ResolutionManager.setResolution(b);
                Scrabble.LocalStorageManager.set("resolutionSetting", Scrabble.ResolutionManager.widthBracket)
            }
        },setResolution: function(j, e, f) {
            var h = 300;
            if (f) {
                h = 0
            }
            var g = Scrabble.ResolutionManager.widthBracket;
            Scrabble.ResolutionManager.stageWidth = j;
            if (j >= c && Scrabble.ResolutionManager.widthBracket != 2) {
                $("#wrapper").animate({width: "990px"}, h);
                Scrabble.ResolutionManager.widthBracket = 2;
                if (!Scrabble.LeftMenu.isExpanded) {
                    Scrabble.LeftMenu.show()
                }
                Scrabble.RightMenu.show(true);
                $("#toggleLeftMenuBtn").hide();
                $("#cardZoneDivision").css({position: "relative","float": "none"});
                $("#headerButtonsContainer").css("width", "989px");
                $("#headerButtonsContainerMiddle").css("width", "969px");
                Scrabble.TipManager.removeTips()
            } else {
                if (j < c && j >= b && Scrabble.ResolutionManager.widthBracket != 1) {
                    $("#wrapper").css("width", "760px");
                    $("#headerButtonsContainer").css("width", "760px");
                    $("#headerButtonsContainerMiddle").css("width", "740px");
                    $("#cardZoneDivision").css({position: "absolute","float": "left"});
                    Scrabble.ResolutionManager.widthBracket = 1;
                    if (Scrabble.RightMenu.isExpanded && Scrabble.LeftMenu.isExpanded) {
                        Scrabble.RightMenu.hide(true)
                    } else {
                        if (!Scrabble.RightMenu.isExpanded && !Scrabble.LeftMenu.isExpanded) {
                            Scrabble.LeftMenu.show()
                        }
                    }
                    Scrabble.TipManager.removeTips()
                }
            }
            Scrabble.ResolutionManager.checkForSkyscraperUpdate();
            if (g != Scrabble.ResolutionManager.widthBracket) {
                Scrabble.LeaderBoard.setSize(Scrabble.ResolutionManager.widthBracket);
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.GameResized, Scrabble.ResolutionManager.widthBracket);
                if (g == 1 && Scrabble.ResolutionManager.widthBracket == 2) {
                    Scrabble.LocalStorageManager.set("resolutionSetting", Scrabble.ResolutionManager.widthBracket)
                }
            }
        },updateResolution: function(h) {
            var g = $(window).width();
            var f = $(window).height();
            Scrabble.ResolutionManager.setResolution(g, f, true)
        },checkForSkyscraperUpdate: function() {
            var f = $(window).width();
            var e = $("#wrapper").width();
            var g = e + (190 * 2);
            console.log(g + " --- - --- " + f);
            if (g > f) {
                $("#dartSkyscraper").hide()
            } else {
                $("#dartSkyscraper").show()
            }
        }}
}();
Scrabble.SocialPlatformManager = function() {
    return {bridge: "",init: function() {
            if (Scrabble.config._socialPlatformName == "facebook") {
                Scrabble.SocialPlatformManager.bridge = "FacebookBridge";
                FB.init({appId: Scrabble.config._appId,status: true,cookie: true,frictionlessRequests: true,oauth: true,authResponse: true});
                FB.getLoginStatus(function(a) {
                    if (a.status == "connected" && !(Scrabble.config.fbId == "0" || Scrabble.config.accessToken == "")) {
                        Scrabble.SocialPlatformManager._authCompleted();
                        FB.Canvas.setAutoGrow()
                    } else {
                        top.location.href = "https://www.facebook.com/dialog/oauth/?client_id=" + Scrabble.config._appId + "&redirect_uri=" + encodeURIComponent(Scrabble.config._applicationUrl) + "&scope=email,user_birthday,publish_actions"
                    }
                })
            } else {
                if (Scrabble.config._socialPlatformName == "google") {
                    Scrabble.SocialPlatformManager.bridge = "GoogleBridge"
                }
            }
        },_authCompleted: function() {
            Scrabble.PlayerManager.updateCurrentPlayer();
            Scrabble.PlayerManager.refreshFacebookFriends()
        },call: function(b) {
            if (Scrabble[Scrabble.SocialPlatformManager.bridge][b]) {
                var a = [];
                var d = arguments.length;
                for (var c = 0; c < d; c++) {
                    a.push(arguments[c])
                }
                a.shift();
                return Scrabble[Scrabble.SocialPlatformManager.bridge][b].apply(this, a)
            }
        }}
}();
Scrabble.SoundManager = function() {
    var a = {Barrel_1: {file: "Barrel_Swipe_01.mp3",preload: true},Barrel_2: {file: "Barrel_Swipe_01.mp3",preload: true},Barrel_3: {file: "Barrel_Swipe_01.mp3",preload: true},Barrel_4: {file: "Barrel_Swipe_01.mp3",preload: true},Rank_1: {file: "GameEnd_Ranking_01.mp3",preload: false},Rank_2: {file: "GameEnd_Ranking_02.mp3",preload: false},Rank_3: {file: "GameEnd_Ranking_03.mp3",preload: false},Rank_4: {file: "GameEnd_Ranking_04.mp3",preload: false},Letter_0: {file: "sfx_sheppard_Xylo_letter_01.mp3",preload: true},Letter_1: {file: "sfx_sheppard_Xylo_letter_02.mp3",preload: true},Letter_2: {file: "sfx_sheppard_Xylo_letter_03.mp3",preload: true},Letter_3: {file: "sfx_sheppard_Xylo_letter_04.mp3",preload: true},Letter_4: {file: "sfx_sheppard_Xylo_letter_05.mp3",preload: true},Letter_5: {file: "sfx_sheppard_Xylo_letter_06.mp3",preload: true},Letter_6: {file: "sfx_sheppard_Xylo_letter_07.mp3",preload: true},Word_0: {file: "sfx_sheppard_Xylo_word_01.mp3",preload: true},Word_1: {file: "sfx_sheppard_Xylo_word_02.mp3",preload: true},Word_2: {file: "sfx_sheppard_Xylo_word_03.mp3",preload: true},Word_3: {file: "sfx_sheppard_Xylo_word_04.mp3",preload: true},Word_4: {file: "sfx_sheppard_Xylo_word_05.mp3",preload: true},Word_5: {file: "sfx_sheppard_Xylo_word_06.mp3",preload: true},Word_6: {file: "sfx_sheppard_Xylo_word_07.mp3",preload: true},Bingo: {file: "ScoreReward_4_AllLetters.mp3",preload: true},Cancel: {file: "sfx_BackCancel.mp3",preload: true},Chat: {file: "sfx_Chat.mp3",preload: true},Generic_btn: {file: "sfx_GenericButton.mp3",preload: true},Delete: {file: "sfx_InGame_Delete.mp3",preload: true},Play: {file: "sfx_InGame_Pass_PlayButton.mp3",preload: true},Popup_close: {file: "sfx_PopUpScreen_0_Close.mp3",preload: true},Popup_open: {file: "sfx_PopUpScreen_1_Open.mp3",preload: true},Popup_confirm: {file: "sfx_PopUpScreen_2_Confirm.mp3",preload: true},Radio_btn: {file: "sfx_RadioButton.mp3",preload: true},Select: {file: "sfx_Select.mp3",preload: true},SlideTransition: {file: "sfx_SlideTransition.mp3",preload: true},Recall_1: {file: "sfx_tile_recall_1.mp3",preload: true},Recall_2: {file: "sfx_tile_recall_2.mp3",preload: true},Recall_3: {file: "sfx_tile_recall_3.mp3",preload: true},Shuffle_1: {file: "sfx_tile_shuffle_1.mp3",preload: true},Shuffle_2: {file: "sfx_tile_shuffle_2.mp3",preload: true},Swap_1: {file: "sfx_tile_swap_1.mp3",preload: true},Swap_2: {file: "sfx_tile_swap_2.mp3",preload: true},Swap_3: {file: "sfx_tile_swap_3.mp3",preload: true},Drop_b_1: {file: "sfx_tileDropOnBoard_01.mp3",preload: true},Drop_b_2: {file: "sfx_tileDropOnBoard_02.mp3",preload: true},Drop_b_3: {file: "sfx_tileDropOnBoard_03.mp3",preload: true},Drop_b_4: {file: "sfx_tileDropOnBoard_04.mp3",preload: true},Drop_b_5: {file: "sfx_tileDropOnBoard_05.mp3",preload: true},Drop_r_1: {file: "sfx_tileDropRack_01.mp3",preload: true},Drop_r_2: {file: "sfx_tileDropRack_02.mp3",preload: true},Drop_r_3: {file: "sfx_tileDropRack_03.mp3",preload: true},Drop_r_4: {file: "sfx_tileDropRack_04.mp3",preload: true},Drop_r_5: {file: "sfx_tileDropRack_05.mp3",preload: true},Grab_b_1: {file: "sfx_tileGrabFromBoard_01.mp3",preload: true},Grab_b_2: {file: "sfx_tileGrabFromBoard_02.mp3",preload: true},Grab_b_3: {file: "sfx_tileGrabFromBoard_03.mp3",preload: true},Grab_b_4: {file: "sfx_tileGrabFromBoard_04.mp3",preload: true},Grab_b_5: {file: "sfx_tileGrabFromBoard_05.mp3",preload: true},Grab_r_1: {file: "sfx_tileGrabRack_01.mp3",preload: true},Grab_r_2: {file: "sfx_tileGrabRack_02.mp3",preload: true},Grab_r_3: {file: "sfx_tileGrabRack_03.mp3",preload: true},Grab_r_4: {file: "sfx_tileGrabRack_04.mp3",preload: true},Grab_r_5: {file: "sfx_tileGrabRack_05.mp3",preload: true},Gamescene: {file: "sfx_ToGameScene.mp3",preload: true},ScoreTravel: {file: "ScoreTravel.mp3",preload: false},Word_score: {file: "wordScoredAnim.mp3",preload: true},Chat_Chimes: {file: "sfx_ChatChimes.mp3",preload: true}};
    var b = {backgroundSound_hasbro: {file: "BackGroundMusic_Loop_Hasbro.mp3",preload: false},backgroundSound_mattel: {file: "BackGroundMusic_Loop_Mattel.mp3",preload: false}};
    return {soundManagerObject: null,soundManagerState: null,sfx_vol: 50,music_vol: 0,soundEnabled: true,READY: "ready",ERROR: "error",init: function() {
            if ($.browser.msie && parseInt($.browser.version, 10) <= 8 || soundManager == undefined) {
                Scrabble.SoundManager.soundEnabled = false;
                return false
            }
            soundManager.url = Scrabble.config._cdnVersion + "/js/libs/soundmanager/swf/";
            this.soundManagerObject = soundManager;
            this.soundManagerObject.onready(function() {
                Scrabble.SoundManager._handleReady()
            });
            this.soundManagerObject.ontimeout(function() {
                Scrabble.SoundManager._handleFailure()
            });
            this.soundManagerObject.useHighPerformance = true
        },_handleFailure: function() {
            console.log("SoundManager FAILURE");
            Scrabble.SoundManager.soundManagerState = Scrabble.SoundManager.ERROR
        },_handleReady: function() {
            console.log("SoundManager READY");
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                var c = Scrabble.LocalStorageManager.get("sfxVolumeOption");
                if (c != undefined) {
                    Scrabble.SoundManager.sfx_vol = c
                }
                c = Scrabble.LocalStorageManager.get("musicVolumeOption");
                if (c != undefined) {
                    Scrabble.SoundManager.music_vol = c
                }
            }
            Scrabble.SoundManager.soundManagerState = Scrabble.SoundManager.READY;
            Scrabble.SoundManager._preloadSounds()
        },mute: function() {
            if (Scrabble.SoundManager.soundManagerState == Scrabble.SoundManager.READY) {
                Scrabble.SoundManager.soundManagerObject.mute()
            }
        },play_sfx: function(c) {
            try {
                if (Scrabble.SoundManager.soundManagerState == Scrabble.SoundManager.READY && Scrabble.SoundManager.soundEnabled) {
                    if (a[c].soundObject) {
                        a[c].soundObject.play({volume: Scrabble.SoundManager.sfx_vol})
                    } else {
                        var d = Scrabble.SoundManager.soundManagerObject.createSound({id: c,url: Scrabble.config._cdnStatic + "/sounds/" + a[c].file,autoPlay: true,volume: 100});
                        a[c].soundObject = d;
                        d.play({volume: Scrabble.SoundManager.sfx_vol})
                    }
                }
            } catch (f) {
                console.error("PLAY_SFX Failure")
            }
        },fadeInSong: function() {
            var d = b["backgroundSound_" + Scrabble.config._branding].soundObject;
            var c = d.volume;
            if (c >= Scrabble.SoundManager.music_vol) {
                return false
            }
            d.setVolume(c + 1);
            setTimeout(Scrabble.SoundManager.fadeInSong, 30)
        },play_song: function() {
            if (Scrabble.SoundManager.soundManagerState == Scrabble.SoundManager.READY && Scrabble.SoundManager.soundEnabled && Scrabble.SoundManager.music_vol != 0) {
                var c = Scrabble.SoundManager.soundManagerObject.createSound({id: "backgroundSound_" + Scrabble.config._branding,url: Scrabble.config._cdnStatic + "/sounds/" + b["backgroundSound_" + Scrabble.config._branding].file,volume: 0});
                if (c != false && c.play) {
                    c.play({onfinish: function() {
                            Scrabble.SoundManager._loopSong()
                        },volume: 0})
                }
                b["backgroundSound_" + Scrabble.config._branding].soundObject = c;
                Scrabble.SoundManager.fadeInSong()
            }
        },playRoll: function(d, c) {
            Scrabble.SoundManager.play_sfx(d + "_" + (Math.ceil(Math.random() * c)))
        },playSequence: function(e, d, c) {
            Scrabble.SoundManager.play_sfx(e + "_" + (d % c))
        },_preloadSounds: function() {
            var c;
            for (var d in a) {
                if (a[d].preload == true && Scrabble.SoundManager.sfx_vol != 0) {
                    c = Scrabble.SoundManager.soundManagerObject.createSound({id: d,url: Scrabble.config._cdnStatic + "/sounds/" + a[d].file,volume: 100});
                    a[d].soundObject = c
                }
            }
        },_loopSong: function() {
            Scrabble.SoundManager.soundManagerObject.play("backgroundSound_" + Scrabble.config._branding, {onfinish: function() {
                    Scrabble.SoundManager._loopSong()
                },volume: Scrabble.SoundManager.music_vol})
        },setVolume: function(c, d) {
            if (Scrabble.SoundManager.soundManagerState == Scrabble.SoundManager.READY) {
                if (c == "sfx") {
                    Scrabble.SoundManager.sfx_vol = d;
                    for (var e in a) {
                        if (e.soundObject) {
                            e.setVolume(Scrabble.SoundManager.sfx_vol)
                        }
                    }
                } else {
                    if (b["backgroundSound_" + Scrabble.config._branding].soundObject == undefined && Scrabble.SoundManager.music_vol == 0 && d != 0) {
                        Scrabble.SoundManager.music_vol = d;
                        Scrabble.SoundManager.play_song()
                    }
                    Scrabble.SoundManager.music_vol = d;
                    b["backgroundSound_" + Scrabble.config._branding]["soundObject"].setVolume(Scrabble.SoundManager.music_vol)
                }
            }
        }}
}();
Scrabble.StatsManager = function() {
    var a = new Date();
    return {stats: {},archives: [],loadStats: function(b) {
            if (Scrabble.StatsManager.hasSavedStats() == false) {
                Scrabble.GameServerManager.getStatList(Scrabble.PlayerManager.players, b, false, false);
                Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.StatsManager.loadCurrentUserStats)
            } else {
                Scrabble.StatsManager.loadSingleUserStats(Scrabble.PlayerManager.currentUser.mayhemId);
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.StatsLoaded);
                Scrabble.TelemetryManager.sendUserInformation("saved_stats")
            }
        },loadCurrentUserStats: function() {
            Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.StatsManager.loadCurrentUserStats);
            Scrabble.StatsManager.loadSingleUserStats(Scrabble.PlayerManager.currentUser.mayhemId);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.OnboardManager.checkNoWordsPlayedOB);
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.TelemetryManager.sendUserInformation)
        },loadSingleUserStats: function(b) {
            Scrabble.GameServerManager.getStatList([{mayhemId: b}], "all", false, true)
        },mergeArchived: function(b) {
            Scrabble.StatsManager.archives = b
        },getArchive: function(c) {
            for (var b = 0; b < Scrabble.StatsManager.archives.length; b++) {
                if (Scrabble.StatsManager.archives[b].matchuri == c) {
                    return Scrabble.StatsManager.archives[b]
                }
            }
            return
        },loadArchive: function(h, e) {
            Scrabble.Chat.reset();
            Scrabble.EndGamePopup.hide();
            Scrabble.TipManager.removeTips();
            Scrabble.TradeTilesPopup.deleteTiles();
            Scrabble.TradeTilesPopup.hide();
            Scrabble.WildTilePopup.hide();
            Scrabble.SuggestionPopup.hide();
            $("#scorePreviewIndicator").hide();
            $(".tempPreviewIndicator").remove();
            $("#dictionary").hide();
            var b = Scrabble.StatsManager.getArchive(h);
            if (b != undefined) {
                var c = [];
                if (e != true) {
                    Scrabble.GameScene.resetBoard()
                }
                var g = {};
                if (b.plays.play != undefined) {
                    if (b.plays.play instanceof Array) {
                        for (var d = 0; d < b.plays.play.length; ++d) {
                            var f = b.plays.play[d];
                            if (f.playtype == "PLAY_WORD") {
                                c = c.concat(f.playdata.split(";"));
                                g = {word: f.allwords.word,score: f.score,user: f.useruri.split("/")[2]}
                            }
                        }
                    } else {
                        if (b.plays.play.playtype == "PLAY_WORD") {
                            c = c.concat(b.plays.play.playdata.split(";"));
                            var f = b.plays.play;
                            g = {word: f.allwords.word,score: f.score,user: f.useruri.split("/")[2]}
                        }
                    }
                }
                Scrabble.GameServerManager.currentMatch = h;
                clearInterval(Scrabble.GameServerManager.refreshTimer);
                Scrabble.Board.hideFocusArrow();
                Scrabble.EndGamePopup.show(false, true);
                Scrabble.GameServerManager.currentMatchState = b.state;
                Scrabble.GameServerManager.currentMatchUserTurn = b.board.currentturnuserid;
                Scrabble.WordList.updatetlwl(Scrabble.GameServerManager.getTwoLetterWordList(b.board.dictionary).split(" "), b.board.dictionary);
                Scrabble.WordList.updateIcon(b.board.dictionary);
                Scrabble.PlayValidation.currentDictionary = b.board.dictionary;
                Scrabble.WordList.buildMovesList(b.plays.play, b);
                Scrabble.Chat.currentChatRoom = (b.chatroomuri.split("/")[2]);
                Scrabble.GameServerManager.getchatRoom(b.chatroomuri.split("/")[2]);
                Scrabble.GameScene.updateBotMenu(e, true);
                Scrabble.PlayerCards.buildPlayerCards(b, e);
                if (e) {
                    Scrabble.GameScene.cloneGameScene(b)
                }
                if (b.rack.tileids != undefined && (b.rack.tileids + "").length > 0) {
                    Scrabble.TileRack.loadTiles(b.rack.tileids + "", e)
                }
                Scrabble.GameScene.setMatch(c, g);
                if (Scrabble.QuestPopup.isToyotaQuestActive) {
                    Scrabble.WordList.updateQuestTabContent()
                }
            }
        },hasSavedStats: function() {
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                var c = Scrabble.LocalStorageManager.get("statLastUpdate");
                console.warn("storage date : " + c);
                var b = "";
                if (c == (a.getDate() + "/" + a.getMonth()) + b) {
                    var e = JSON.parse(Scrabble.LocalStorageManager.get("stats"));
                    var d = 0;
                    for (var f in e) {
                        d++
                    }
                    if (Scrabble.PlayerManager.countPlayers() <= d) {
                        Scrabble.StatsManager.stats = e;
                        return true
                    }
                } else {
                    if (Scrabble.LocalStorageManager.get("stats") != undefined) {
                        var e = JSON.parse(Scrabble.LocalStorageManager.get("stats"));
                        Scrabble.StatsManager.stats = e;
                        return false
                    }
                }
            }
            return false
        },hasSavedSingleUserStats: function(e) {
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                var c = Scrabble.LocalStorageManager.get("statLastUpdate");
                console.warn("storage date : " + c);
                var b = "";
                if (c == (a.getDate() + "/" + a.getMonth()) + b) {
                    var d = JSON.parse(Scrabble.LocalStorageManager.get("stats"));
                    if (d.hasOwnProperty(e)) {
                        console.log("LOADING SINGLE USER");
                        return true
                    }
                } else {
                    if (Scrabble.LocalStorageManager.get("stats") != undefined) {
                        var d = JSON.parse(Scrabble.LocalStorageManager.get("stats"));
                        Scrabble.StatsManager.stats = d;
                        return false
                    }
                }
            }
            return false
        },updateStatField: function(b, d, c) {
            if (Scrabble.StatsManager.stats[b] == undefined) {
                Scrabble.StatsManager.stats[b] = {}
            }
            Scrabble.StatsManager.stats[b][d] = c;
            if (Scrabble.LocalStorageManager.localStorageEnabled) {
                Scrabble.LocalStorageManager.set("stats", JSON.stringify(Scrabble.StatsManager.stats))
            }
            Scrabble.LeaderBoard.fillScrollable()
        },updateStats: function(g, d) {
            if (g) {
                var f = g.length;
                var j;
                if (typeof f == "undefined") {
                    j = true;
                    f = 1
                } else {
                    j = false
                }
                var e, b, h, k;
                for (var c = 0; c < f; c++) {
                    if (j) {
                        e = g.userid;
                        b = g.stattypeid;
                        h = g.value;
                        k = g.stringvalue
                    } else {
                        e = g[c].userid;
                        b = g[c].stattypeid;
                        h = g[c].value;
                        k = g[c].stringvalue
                    }
                    if (Scrabble.StatsManager.stats[e] == undefined) {
                        Scrabble.StatsManager.stats[e] = {average_word_score: "-",average_game_score: "-"};
                        Scrabble.StatsManager.stats[e][Scrabble.StatType.HIGH_WORD.id] = {word: "-",score: -1}
                    }
                    if (b != Scrabble.StatType.HIGH_WORD.id) {
                        if (Scrabble.StatsManager.stats[e][b] == undefined) {
                            Scrabble.StatsManager.stats[e][b] = -1
                        }
                        switch (b) {
                            case Scrabble.StatType.TOTAL_GAMES.id:
                            case Scrabble.StatType.TOTAL_WINS.id:
                            case Scrabble.StatType.TOTAL_LOSSES.id:
                            case Scrabble.StatType.TOTAL_DRAWS.id:
                            case Scrabble.StatType.TOTAL_BINGOS.id:
                            case Scrabble.StatType.HIGH_GAME.id:
                                if (h > Scrabble.StatsManager.stats[e][b]) {
                                    Scrabble.StatsManager.stats[e][b] = h
                                }
                                break;
                            case Scrabble.StatType.RATING.id:
                            case Scrabble.StatType.AVG_WORD.id:
                            case Scrabble.StatType.AVG_GAME.id:
                                Scrabble.StatsManager.stats[e][b] = h;
                                break;
                            default:
                                break
                        }
                    } else {
                        if (k && k.split) {
                            if (h > Scrabble.StatsManager.stats[e][b].score) {
                                Scrabble.StatsManager.stats[e][b] = {word: (k).split(":")[0],score: h}
                            }
                        } else {
                            Scrabble.StatsManager.stats[e][b] = {word: "",score: 0}
                        }
                    }
                }
            }
            if (Scrabble.LocalStorageManager.localStorageEnabled && d) {
                Scrabble.LocalStorageManager.set("statLastUpdate", a.getDate() + "/" + a.getMonth());
                Scrabble.LocalStorageManager.set("stats", JSON.stringify(Scrabble.StatsManager.stats))
            }
        },checkUserStatsLoaded: function(b, c) {
            if (!Scrabble.StatsManager.stats.hasOwnProperty(b)) {
                return false
            }
            var e = c.length;
            for (var d = 0; d < e; d++) {
                if (!Scrabble.StatsManager.stats[b].hasOwnProperty(c[d])) {
                    return false
                }
            }
            return true
        }}
}();
Scrabble.TelemetryManager = function() {
    return {cpuEventsReceived: 0,gameDataLoadingStartTime: null,init: function() {
            var b = {};
            if (Scrabble.config._isSecure == "true") {
                b.useHttps = true
            }
            b.useTestServer = Scrabble.config.useKtTestServer;
            Scrabble.kontagent = new KontagentApi(Scrabble.config._kontagentApiKey, b);
            Scrabble.kontagentMaster = new KontagentApi(Scrabble.config._kontagentMasterApiKey, b);
            Scrabble.kontagent._sendHttpRequestViaImgTag = Scrabble.kontagentMaster._sendHttpRequestViaImgTag = function(f, d) {
                var e = new Image();
                if (d) {
                    e.onerror = function() {
                        d();
                        e.onerror = null;
                        e.onload = null;
                        e = null
                    };
                    e.onload = function() {
                        d();
                        e.onerror = null;
                        e.onload = null;
                        e = null
                    };
                    e.src = f
                } else {
                    e.src = f;
                    e = null
                }
            };
            setInterval(function() {
                Scrabble.kontagent.trackPageRequest(Scrabble.config.fbId);
                Scrabble.kontagentMaster.trackPageRequest(Scrabble.config.fbId)
            }, 30000);
            try {
                var b = {};
                if (Scrabble.config.ktTrackingTag.length == 8) {
                    b.shortUniqueTrackingTag = Scrabble.config.ktTrackingTag
                } else {
                    if (Scrabble.config.ktTrackingTag.length == 16) {
                        b.uniqueTrackingTag = Scrabble.config.ktTrackingTag
                    }
                }
                Scrabble.TelemetryManager.trackApplicationAdded(Scrabble.config.fbId, b)
            } catch (a) {
                console.log(a)
            }
            var c = new Date();
            Scrabble.TelemetryManager.gameDataLoadingStartTime = c.getTime()
        },trackApplicationAdded: function(c, d, a, b) {
            try {
                Scrabble.kontagent.trackApplicationAdded(c, d, a, b);
                Scrabble.kontagentMaster.trackApplicationAdded(c, d, a, b)
            } catch (f) {
                console.error("Telemetry error:" + f)
            }
        },trackEvent: function(d, b, f, a, c) {
            try {
                Scrabble.kontagent.trackEvent(d, b, f, a, c);
                Scrabble.kontagentMaster.trackEvent(d, b, f, a, c)
            } catch (g) {
                console.error("Telemetry error:" + g)
            }
        },trackInviteSent: function(d, h, b, f, a, c) {
            try {
                Scrabble.kontagent.trackInviteSent(d, h, b, f, a, c);
                Scrabble.kontagentMaster.trackInviteSent(d, h, b, f, a, c)
            } catch (g) {
                console.error("Telemetry error:" + g)
            }
        },trackUserInformation: function(c, d, a, b) {
            try {
                Scrabble.kontagent.trackUserInformation(c, d, a, b);
                Scrabble.kontagentMaster.trackUserInformation(c, d, a, b)
            } catch (f) {
                console.error("Telemetry error:" + f)
            }
        },trackStreamPost: function(d, b, g, f, a, c) {
            try {
                Scrabble.kontagent.trackStreamPost(d, b, g, f, a, c);
                Scrabble.kontagentMaster.trackStreamPost(d, b, g, f, a, c)
            } catch (h) {
                console.error("Telemetry error:" + h)
            }
        },_getMatchType: function(h) {
            var a;
            if (h) {
                if (!h.mmatchusers.matchuser.length) {
                    a = "2p_rand"
                } else {
                    var b = h.mmatchusers.matchuser.length;
                    switch (b) {
                        case 1:
                            a = "2p_rand";
                            break;
                        case 2:
                            var d;
                            if (h.mmatchusers.matchuser[0].userid != Scrabble.PlayerManager.currentUser.mayhemId) {
                                d = h.mmatchusers.matchuser[0].userid
                            } else {
                                d = h.mmatchusers.matchuser[1].userid
                            }
                            var g = Scrabble.PlayerManager.players;
                            var e = g.length;
                            var f = false;
                            for (var c = 0; c < e; c++) {
                                if (g[c].mayhemId == d) {
                                    f = true;
                                    break
                                }
                            }
                            if (f) {
                                a = "2p_friends"
                            } else {
                                a = "2p_rand"
                            }
                            break;
                        case 3:
                            a = "mp_3";
                            break;
                        case 4:
                            a = "mp_4";
                            break
                    }
                }
                return a
            } else {
                return "broken"
            }
        },sendUserInformation: function(a) {
            Scrabble.TelemetryManager.cpuEventsReceived++;
            if (a != "tnt" && a != "fb" && a != "userSettings") {
                Scrabble.EventManager.unbindEvent(Scrabble.SystemEvents.StatsLoaded, Scrabble.TelemetryManager.sendUserInformation)
            }
            if (Scrabble.TelemetryManager.cpuEventsReceived == 4) {
                console.warn("Sending user info!!!");
                FB.api({method: "fql.query",query: "SELECT sex, birthday_date FROM user WHERE uid = me()",access_token: Scrabble.config.accessToken}, function(e) {
                    var c = {};
                    var b = {};
                    b.friendCount = Scrabble.PlayerManager.numFriends;
                    b.language = Scrabble.config.lang;
                    if (e[0].sex) {
                        b.gender = e[0].sex
                    }
                    if (e[0].birthday_date) {
                        b.birthday_date = e[0].birthday_date
                    }
                    try {
                        b.ELORating = Scrabble.StatsManager.stats[Scrabble.PlayerManager.currentUser.mayhemId][Scrabble.StatType.RATING.id]
                    } catch (d) {
                        console.error("Problem getting current user's ELO rating for telemetry event CPU")
                    }
                    b.coinsBalance = Scrabble.Store.getBalance();
                    b.device = Scrabble.currentPlatform;
                    b.browser = Scrabble.currentBrowser;
                    b.browserVersion = Scrabble.currentBrowserVersion;
                    b.CurrentDictionnary = Scrabble.MatchOptions.dictionary;
                    c.data = JSON.stringify(b);
                    Scrabble.TelemetryManager.trackUserInformation(Scrabble.config.fbId, c)
                })
            }
        },gameLoad: function(f, e, b, a) {
            var c = {subtype1: "game_load",subtype2: "game_" + e};
            var d = {};
            if (f == "fail") {
                d.target = b;
                d.loadTime = a
            } else {
                d.loadTime = b
            }
            d = JSON.stringify(d);
            c.data = d;
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, f, c)
        },sendPlay: function(j, a, b, c, e) {
            var g;
            if (e.board.speed != "TURBO") {
                if (e.mmatchusers.matchuser.length) {
                    var f = e.mmatchusers.matchuser.length;
                    switch (f) {
                        case 2:
                            g = "2p_friends";
                            break;
                        case 3:
                            g = "mp_3";
                            break;
                        case 4:
                            g = "mp_4";
                            break
                    }
                }
            } else {
                g = "2p_rand"
            }
            var h = {subtype1: "features",subtype2: "play"};
            var d = {isBingo: b,isNewBestWord: c,wordsPlayed: j.join(","),score: a,matchID: e.matchuri.substring(9)};
            h.data = JSON.stringify(d);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, g, h)
        },sendPass: function(d) {
            var a = Scrabble.TelemetryManager._getMatchType(d);
            var b = {subtype1: "features",subtype2: "pass"};
            var c = {matchID: d.matchuri.substring(9)};
            b.data = JSON.stringify(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendExchange: function(f, d) {
            if (f == null) {
                return
            }
            var a = Scrabble.TelemetryManager._getMatchType(f);
            var b = {subtype1: "features",subtype2: "exchange",subtype3: d};
            var e = (Scrabble.TradeTilesPopup.tileTracking) ? "on" : "off";
            var c = {matchID: f.matchuri.substring(9),tile_tracking: e};
            b.data = JSON.stringify(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendShuffle: function(d) {
            var a = Scrabble.TelemetryManager._getMatchType(d);
            var b = {subtype1: "features",subtype2: "shuffle"};
            var c = {matchID: d.matchuri.substring(9)};
            b.data = JSON.stringify(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendRecall: function(d) {
            var a = Scrabble.TelemetryManager._getMatchType(d);
            var b = {subtype1: "features",subtype2: "recall"};
            var c = {matchID: d.matchuri.substring(9)};
            b.data = JSON.stringify(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendTutorial: function(e, a, d) {
            var b = {subtype1: "tutorial",subtype2: e};
            if (a == "send") {
                var c = {nbFriendsSelected: d};
                b.data = JSON.stringify(c)
            }
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendGameEnd: function(h, o) {
            if (o == "check") {
                var k = h;
                var b = k.mmatchusers.matchuser;
                var l = b.length;
                var n;
                for (var e = 0; e < l; e++) {
                    n = b[e];
                    if (n.userid == Scrabble.PlayerManager.currentUser.mayhemId) {
                        if (n.status == "WIN") {
                            o = "win"
                        } else {
                            o = "loss"
                        }
                        break
                    }
                }
            }
            var j = Scrabble.TelemetryManager._getMatchType(h);
            var g = h.date.split(":");
            var f = parseInt(g[0]) * 86400000 + parseInt(g[1]) * 3600000 + parseInt(g[2]) * 60000 + parseInt(g[3]) * 1000;
            var a;
            var b = h.mmatchusers.matchuser;
            if (!b.length) {
                b = [b]
            }
            l = b.length;
            var n;
            for (e = 0; e < l; e++) {
                n = b[e];
                if (n.userid == Scrabble.PlayerManager.currentUser.mayhemId) {
                    a = n.totalPoints;
                    break
                }
            }
            var c;
            if (!h.plays.play) {
                c = 0
            } else {
                if (!h.plays.play.length) {
                    c = 1
                } else {
                    c = h.plays.play.length
                }
            }
            var d = {matchID: h.matchuri.substring(9),gameTime: f,score: a,turns: c};
            var m = {subtype1: "game_end",subtype2: o,data: JSON.stringify(d)};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, j, m)
        },sendNudgeFeature: function(h, e, j) {
            var l = {subtype1: "features"};
            if (e == "forfeit") {
                l.subtype2 = "force_forfeit"
            } else {
                if (e == "nudge") {
                    l.subtype2 = "nudge"
                }
            }
            var b = h.lastupdatedtime;
            var k = new Date();
            var c = k.getTime();
            var m = c - b;
            var a = h.plays.play;
            var f;
            if (a == null || !a.length) {
                f = 1
            } else {
                f = a.length
            }
            var g = {turnsPlayed: f,timeSinceLastPlay: m};
            l.data = JSON.stringify(g);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, j, l)
        },sendChatSent: function(d) {
            var a = Scrabble.TelemetryManager._getMatchType(d);
            var b = {subtype1: "features",subtype2: "chat"};
            var c = {matchID: d.matchuri.substring(9)};
            b.data = JSON.stringify(c);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, b)
        },sendStats: function(b, c) {
            var a = "self";
            if (c != Scrabble.PlayerManager.currentUser.mayhemId) {
                a = "friend"
            }
            var d = {subtype1: "features",subtype2: "stats",subtype3: b};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, d)
        },sendFeedback: function(b, f, a, d, c) {
            var e = {subtype1: b,subtype2: "feedback"};
            if (f != null) {
                e.subtype3 = f
            }
            var g = {};
            if (d != null) {
                g.subject = d
            }
            if (c != null) {
                g.browser = c
            }
            e.data = JSON.stringify(g);
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, a, e)
        }}
}();
Scrabble.TileManager = function() {
    var b;
    var c;
    var a;
    var e;
    var d;
    return {currentlyDraggedTile: null,gameSceneOffset: null,gameSceneWidth: null,gameSceneHeight: null,smallTileSize: 42,dragStart: 0,blankTileClickStartTime: 0,tilePastCell: null,tilePastSpace: null,tileLastContainer: null,mouseDown: 0,enableTiles: function() {
            if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                $("#absoluteTileContainer").off("mousedown", ".tile", Scrabble.TileManager.startMouseDown);
                $("#absoluteTileContainer").on("mousedown", ".tile", Scrabble.TileManager.startMouseDown)
            }
            document.body.onmousedown = function() {
                ++Scrabble.TileManager.mouseDown
            };
            document.body.onmouseup = function() {
                --Scrabble.TileManager.mouseDown
            };
            Scrabble.TileManager.chargeTiles();
            $('[data-tile_active="active"]').draggable({distance: 0,zIndex: 1000,scroll: false,drag: function(h, g) {
                    h.stopPropagation();
                    var f = h.originalEvent.pageX;
                    var j = h.originalEvent.pageY;
                    d++;
                    if (d > 100) {
                        d = 0;
                        if (f < b || f > c || j < a || j > e) {
                            h.preventDefault();
                            if (g.helper[0].getAttribute("data-temp_letter") != undefined) {
                                Scrabble.TileManager.removeWildTileValue(g.helper[0])
                            }
                        }
                    }
                },start: function(o, u) {
                    if (Scrabble.TileRack.isAnimating == true) {
                        return false
                    }
                    var f = $(this);
                    Scrabble.TileManager.tileLastContainer = f.parent();
                    if ($(u.helper[0]).attr("data-letter") == "BLANK" || $(u.helper[0]).attr("data-temp_letter") != undefined) {
                        var k = Scrabble.TileManager.blankTileClickStartTime;
                        Scrabble.TileManager.blankTileClickStartTime = new Date().getTime();
                        if (Scrabble.TileManager.blankTileClickStartTime - k < 500) {
                            Scrabble.TileManager.resetBlankTile(o);
                            $(o.currentTarget).css("z-index", "");
                            return false
                        }
                    }
                    d = 0;
                    $("#lookupTxt").blur();
                    $("#chatInputTxt").blur();
                    Scrabble.ProfilePopup.hide();
                    var m = f.parent().parent().attr("id");
                    if (m == "board") {
                        Scrabble.Board.removeTileFromOrder(u.helper[0])
                    }
                    Scrabble.TileManager.currentlyDraggedTile = o.target;
                    if (m == "tileRackContainer" || m == "tradeRack") {
                        Scrabble.SoundManager.playRoll("Grab_r", 5)
                    } else {
                        Scrabble.SoundManager.playRoll("Grab_b", 5)
                    }
                    Scrabble.GameScene.updateSkip();
                    var h = $("#gameScene");
                    var s = h.offset();
                    var r = h.width();
                    var j = h.height();
                    b = s.left;
                    c = s.left + r;
                    a = s.top;
                    e = s.top + j;
                    if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                        Scrabble.TileManager.dragStart = new Date().getTime();
                        if (m == "tileRackContainer" || m == "tradeRack") {
                            $("#absoluteTileContainer .tile").removeClass("fromRack")
                        } else {
                            $("#absoluteTileContainer .tile").removeClass("fromBoard")
                        }
                    } else {
                        var g = f.offset();
                        document.getElementById("absoluteTileContainer").appendChild(this);
                        var n = f.offset();
                        var t = o.originalEvent.pageX - g.left - Scrabble.TileManager.smallTileSize / 2;
                        var q = o.originalEvent.pageY - g.top - Scrabble.TileManager.smallTileSize / 2;
                        var l = f.data("draggable");
                        l.offset.click.left += n.left - g.left - t;
                        l.offset.click.top += n.top - g.top - q
                    }
                    f.removeClass("dropped").addClass("grabbed");
                    Scrabble.Board.updateScorePreview();
                    Scrabble.EventManager.dispatchEvent(Scrabble.UserEvents.TileGrabbed)
                },stop: function(l, k) {
                    l.stopPropagation();
                    var g = $(this);
                    if (this.parentNode.getAttribute("id") == "absoluteTileContainer") {
                        var h = k.helper[0];
                        $("#absoluteTileContainer .tile").addClass("fromRack");
                        var f = Scrabble.TileRack.getEmptyRackSpaceId();
                        document.getElementById(f).appendChild(this);
                        g.fadeTo(0, 1);
                        g.offset({left: "0px",top: "0px"});
                        g.css({left: "-2px",top: "-2px"});
                        g.removeClass("grabbed");
                        if (h.getAttribute("data-temp_letter") != undefined && !Scrabble.TileManager.tileLastContainer.hasClass("tileRackSpace")) {
                            Scrabble.TileManager.removeWildTileValue(h)
                        }
                    }
                    if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                        var j = new Date().getTime();
                        if ((j - Scrabble.TileManager.dragStart) < 500) {
                            if ($("#tradeTilesPopup").css("display") == "block") {
                                Scrabble.TradeTilesPopup.onTileClick(null, g)
                            }
                        }
                    }
                    Scrabble.GameScene.updateSkip()
                }})
        },startMouseDown: function() {
            $("#absoluteTileContainer").on("mouseup", ".tile", Scrabble.TileManager.stopMouseDown);
            Scrabble.TileManager.dragStart = new Date().getTime()
        },stopMouseDown: function() {
            $("#absoluteTileContainer").off("mouseup", ".tile", Scrabble.TileManager.stopMouseDown);
            var f = new Date().getTime();
            if ((f - Scrabble.TileManager.dragStart) < 500) {
                if ($("#tradeTilesPopup").css("display") == "block") {
                    Scrabble.TradeTilesPopup.onTileClick(null, $("#absoluteTileContainer .tile"))
                }
            }
        },chargeTiles: function() {
            if ($.browser.msie && parseInt($.browser.version, 10) <= 8) {
                $(".active").mouseenter(function() {
                    if (!Scrabble.TileRack.isAnimating && $("#absoluteTileContainer .grabbed").length == 0) {
                        if ($("#absoluteTileContainer .fromRack").length != 0) {
                            $("#absoluteTileContainer .tile").offset({left: "0px",top: "0px"});
                            if (Scrabble.TileManager.tilePastSpace != null && Scrabble.TileManager.tilePastSpace.parent().attr("id") == "tradeRack") {
                                $("#absoluteTileContainer .tile").css({left: "0px",top: "0px"})
                            } else {
                                $("#absoluteTileContainer .tile").css({left: "-2px",top: "-2px"})
                            }
                            if (Scrabble.TileManager.tilePastSpace.find(".tile").length == 0) {
                                Scrabble.TileManager.tilePastSpace.append($("#absoluteTileContainer .tile"))
                            } else {
                                var f = Scrabble.TileRack.getEmptyRackSpaceId();
                                $("#" + f).append($("#absoluteTileContainer .tile"))
                            }
                        }
                        if ($("#absoluteTileContainer .fromBoard").length != 0) {
                            $("#absoluteTileContainer .tile").offset({left: "0px",top: "0px"});
                            $("#absoluteTileContainer .tile").css({left: "-2px",top: "-2px"});
                            Scrabble.TileManager.tilePastCell.append($("#absoluteTileContainer .tile"))
                        }
                        if ($(this).parent().parent().attr("id") != "gameScene") {
                            var g = $(this).offset();
                            if ($(this).parent().parent().attr("id") == "tileRackContainer" || $(this).parent().parent().attr("id") == "tradeRack") {
                                $(this).removeClass("fromBoard").addClass("fromRack");
                                Scrabble.TileManager.tilePastSpace = $(this).parent()
                            } else {
                                $(this).removeClass("fromRack").addClass("fromBoard");
                                Scrabble.TileManager.tilePastCell = $(this).parent()
                            }
                            document.getElementById("absoluteTileContainer").appendChild(this);
                            $("#absoluteTileContainer .tile").offset(g)
                        }
                    }
                });
                $(".active").mouseleave(function() {
                    Scrabble.TileManager.emptyAbsoluteContainer($(this))
                });
                $(".active").mouseout(function() {
                    Scrabble.TileManager.emptyAbsoluteContainer($(this))
                });
                $(".botButton").mouseenter(function() {
                    Scrabble.TileManager.emptyAbsoluteContainer()
                })
            }
        },emptyAbsoluteContainer: function(h) {
            var f = $("#absoluteTileContainer .tile");
            if (h != undefined) {
                f = h
            }
            if (!Scrabble.TileRack.isAnimating && $("#absoluteTileContainer .grabbed").length == 0) {
                if ($("#absoluteTileContainer .fromRack").length != 0) {
                    if (Scrabble.TileManager.tilePastSpace.find(".tile").length == 0) {
                        Scrabble.TileManager.tilePastSpace.append($("#absoluteTileContainer .tile"))
                    } else {
                        var g = Scrabble.TileRack.getEmptyRackSpaceId();
                        $("#" + g).append($("#absoluteTileContainer .tile"))
                    }
                }
                if ($("#absoluteTileContainer .fromBoard").length != 0) {
                    Scrabble.TileManager.tilePastCell.append($("#absoluteTileContainer .tile"))
                }
                f.offset({left: "0px",top: "0px"});
                if (Scrabble.TileManager.tilePastSpace != null && Scrabble.TileManager.tilePastSpace.parent().attr("id") == "tradeRack") {
                    f.css({left: "0px",top: "0px"})
                } else {
                    f.css({left: "-2px",top: "-2px"})
                }
            }
        },resetBlankTile: function(g) {
            var f = g.currentTarget;
            if ($(f).attr("data-temp_letter") != undefined || Scrabble.TileManager.tileLastContainer.hasClass("tileRackSpace")) {
                Scrabble.WildTilePopup.show(f)
            }
        },setWildTileValue: function(g, f) {
            g.setAttribute("data-temp_letter", f);
            g.setAttribute("data-letter", f);
            $(g).find(".tileLetterRed").attr("class", "tileLetterRed letter_" + f)
        },resetBlankTileValue: function(f) {
            console.log("DOUBLE CLICK")
        },removeWildTileValue: function(f) {
            f.removeAttribute("data-temp_letter");
            f.setAttribute("data-letter", "BLANK");
            $(f).find(".tileLetterRed").attr("class", "tileLetterRed letter_BLANK")
        },disableTiles: function() {
            $('[data-tile_active="active"]').draggable("disable");
            $('[data-tile_active="active"]').css("cursor", "default")
        },reEnableTiles: function() {
            $('[data-tile_active="active"]').draggable("enable");
            $('[data-tile_active="active"]').css("cursor", "pointer")
        },destroyTiles: function(f) {
            var g = '[data-tile_active="active"]';
            if (f) {
                g = ".tile"
            }
            $(g).draggable("destroy");
            $(g).css("cursor", "default")
        },deactivateTilesOnBoard: function() {
            var f = $('[data-tile_active="active"]');
            var h = f.length;
            for (var g = 0; g < f.length; g++) {
                if ($.contains(document.getElementById("board"), f[g])) {
                    $(f[g]).css("cursor", "default");
                    $(f[g]).draggable("destroy");
                    f[g].setAttribute("data-tile_active", "disable")
                }
            }
        },reactivateTilesOnBoard: function() {
            var f = $('[data-tile_active="disable"]');
            var h = f.length;
            for (var g = 0; g < f.length; g++) {
                if ($.contains(document.getElementById("board"), f[g])) {
                    $(f[g]).css("cursor", "pointer");
                    f[g].setAttribute("data-tile_active", "active")
                }
            }
            Scrabble.TileManager.enableTiles()
        },findLetterfromId: function(g) {
            var f = Scrabble.MatchOptions.dictionary;
            if (Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch] != undefined) {
                f = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
            }
            return Scrabble.TileSets[f][g].letter
        },removeTilesGlow: function() {
            var f = $('[data-tile_active="active"]').find(".tileGlow");
            f.toggleClass("redGlow");
            f.css("display", "none");
            Scrabble.TileManager.tilesGlowDisplayed = false
        },getSquareType: function(h) {
            var f = h.parent().attr("class");
            var g = f.split(" ");
            return g[0]
        },getSquarePosition: function(f) {
            var h = f.parent().attr("id");
            var g = h.split("_");
            return {x: g[1],y: g[2]}
        }}
}();
Scrabble.TipManager = function() {
    var a = false;
    return {tipVisible: false,init: function() {
            Scrabble.EventManager.bindEvent(Scrabble.UserEvents.TileGrabbed, Scrabble.TipManager.removeTips)
        },showTip: function(j, d, f, e, b, h) {
            Scrabble.TipManager.tipVisible = true;
            var l = [$(j).innerWidth(), $(j).innerHeight()];
            var c = Scrabble.TipManager.addToDOM(j, d);
            var k = $("#" + c);
            if (a == false) {
                Scrabble.TipManager.init()
            }
            k.find(".toolTip_mid").css("height", k.find(".tipContent").innerHeight() + "px");
            var g = $(j).offset();
            if (f && f == "under") {
                k.find(".tipArrow").addClass("underArrow");
                k.find(".toolTip_mid").css("width", "300px");
                k.find(".toolTip_mid").css("height", "56px");
                k.find(".tipContent").css("width", "300px");
                if (b != undefined) {
                    console.log("POS X : ");
                    console.log(b);
                    g.left = b - 122
                } else {
                    console.log("FAILED");
                    g.left = (g.left - 300) + 27
                }
                g.top = g.top + l[1] - 25
            } else {
                if (f == "over") {
                    k.find(".tipArrow").addClass("overArrow");
                    k.find(".toolTip_mid").css("width", "300px");
                    k.find(".tipContent").css("width", "300px");
                    if (h) {
                        k.find(".toolTip_mid").css("height", h + "px")
                    } else {
                        k.find(".toolTip_mid").css("height", "66px")
                    }
                    g.left = g.left + (l[0] * 0.5) - 156;
                    g.top = g.top - k.find(".toolTip_mid").innerHeight() - 81;
                    if (k.find(".toolTip_mid").height() < k.find(".tipContent").innerHeight()) {
                        k.find(".tipContent").css("top", "0px")
                    }
                } else {
                    if (f == "left") {
                        k.find(".tipArrow").addClass("leftArrow");
                        g.left = g.left + l[0] + 18
                    }
                }
            }
            k.offset(g);
            if (e) {
                k.find(".tipArrow").css("left", e + "px")
            } else {
                if (f != "left") {
                    k.find(".tipArrow").css("left", ((k.innerWidth() * 0.5) - (k.find(".tipArrow").innerWidth() * 0.5)) + "px")
                } else {
                    k.find(".tipArrow").css("top", -17 - ((k.find(".toolTip_mid").innerHeight()) - (k.find(".tipArrow").innerHeight())) + "px")
                }
            }
            $(document).on("mousedown", Scrabble.TipManager.removeTips)
        },addToDOM: function(d, e) {
            var c = d.substring(1) + "_tip";
            var b = $(e);
            b.attr("id", c);
            $("#specialPopups").append(b);
            return c
        },removeTips: function(b) {
            $(document).off("mousedown", Scrabble.TipManager.removeTips);
            Scrabble.TipManager.tipVisible = false;
            if (b == undefined) {
                $(".tooltip").fadeTo(250, 0, function() {
                    $(".tooltip").remove()
                })
            } else {
                $(".tooltip").remove()
            }
        }}
}();
Scrabble.BoardModels = function() {
    return {boards: {Default: {name: "Default",cellTypes: ["normalSquare", "startingPoint", "doubleLetter", "tripleLetter", "doubleWord", "tripleWord"],specialTiles: [[1, 7, 7], [2, 3, 0], [2, 11, 0], [2, 6, 2], [2, 8, 2], [2, 0, 3], [2, 7, 3], [2, 14, 3], [2, 2, 6], [2, 6, 6], [2, 8, 6], [2, 12, 6], [2, 3, 7], [2, 11, 7], [2, 2, 8], [2, 6, 8], [2, 8, 8], [2, 12, 8], [2, 0, 11], [2, 7, 11], [2, 14, 11], [2, 6, 12], [2, 8, 12], [2, 3, 14], [2, 11, 14], [3, 5, 1], [3, 9, 1], [3, 1, 5], [3, 5, 5], [3, 9, 5], [3, 13, 5], [3, 1, 9], [3, 5, 9], [3, 9, 9], [3, 13, 9], [3, 5, 13], [3, 9, 13], [4, 1, 1], [4, 2, 2], [4, 3, 3], [4, 4, 4], [4, 13, 1], [4, 12, 2], [4, 11, 3], [4, 10, 4], [4, 4, 10], [4, 3, 11], [4, 2, 12], [4, 1, 13], [4, 10, 10], [4, 11, 11], [4, 12, 12], [4, 13, 13], [5, 0, 0], [5, 14, 0], [5, 0, 7], [5, 14, 7], [5, 0, 14], [5, 14, 14], [5, 7, 0], [5, 7, 14]]}}}
}();
Scrabble.BoardSkins = function() {
    return {currentSkin: "def",skins: {def_hasbro: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_REFRSH")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_hasbro/boardPortuguese.png")'},backgroundColor: "#FFFFFF",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/default_hasbro/background.png')"},def_mattel: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_REFRSH")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/default_mattel/boardPortuguese.png")'},backgroundColor: "#FFFFFF",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/default_mattel/background.png')"},classic_hasbro: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_FLSHCLSSC")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_hasbro/boardPortuguese.png")'},backgroundColor: "#000000",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/classic_hasbro/background.png')"},classic_mattel: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_FLSHCLSSC")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/classic_mattel/boardPortuguese.png")'},backgroundColor: "#000000",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/classic_mattel/background.png')"},charcoal: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_CHRCL")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/charcoal/boardPortuguese.png")'},backgroundColor: "#182020",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/charcoal/background.png')"},vintage_hasbro: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_VINTAGE")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_hasbro/boardPortuguese.png")'},backgroundColor: "#FFFFFF",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/vintage_hasbro/background.png')"},vintage_mattel: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_VINTAGE")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/vintage_mattel/boardPortuguese.png")'},backgroundColor: "#FFFFFF",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/vintage_mattel/background.png')"},christmas2012: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("FCBK_TXT_BRDNM_WINTER")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/christmas2012/boardPortuguese.png")'},backgroundColor: "#9cb8ba",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/christmas2012/background.png')"},toyota2013: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("TOYOTA")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/board.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/board.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/board.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/toyota2013/board.png")'},backgroundColor: "#aeaba9",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/toyota2013/background.png')"},luxury: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("TYT_TXT_STR_LXRYBRD")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/board.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/board.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/board.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/luxury/board.png")'},backgroundColor: "#aeaba9",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/luxury/background.png')"},gamehouse: {getDisplayName: function() {
                    return Scrabble.Dictionary.translate("STR_TXT_ITM_NM_LEGACYBRD")
                },url: {en: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/board.png")',fr: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/boardFrench.png")',de: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/boardGerman.png")',es: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/boardSpanish.png")',it: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/boardItalian.png")',pt: 'url("' + Scrabble.config._cdnVersion + '/images/boardSkins/gamehouse/boardPortuguese.png")'},backgroundColor: "#FFFFFF",backgroundImage: "url('" + Scrabble.config._cdnVersion + "/images/boardSkins/gamehouse/background.png')"}}}
}();
Scrabble.MatchStates = {ACTIVE: "ACTIVE",INACTIVE: "INACTIVE",COMPLETE: "COMPLETE",COMPLETE_ARCHIVE: "COMPLETE_ARCHIVE",INACTIVE_ARCHIVE: "INACTIVE_ARCHIVE",WAITING_USERS: "AWAITING_USERS"};
Scrabble.ShowOncePopups = function() {
    return {popupList: [{name: "toyotaQuestOverPopup",zone: "NA",startDate: new Date(2013, 6, 1, 1),expireDate: new Date(2013, 8, 1, 12),show: function() {
                    Scrabble.OnBoardPopup.showNext("toyotaQuestOverPopup")
                }}, {name: "ToyotaQuestDaysLeft",zone: "NA",startDate: new Date(2013, 5, 24, 1),expireDate: new Date(2013, 6, 1, 0),show: function() {
                    Scrabble.OnBoardPopup.showNext("toyotaQuestDaysLeftPopup")
                }}]}
}();
var Stat = function() {
    return {total_wins: 0,total_losses: 0,total_draws: 0,average_word: 0,average_game: 0,high_word_score: {word: "",score: 0},high_game_score: 0,total_bingos: 0}
}();
Scrabble.StatType = function() {
    return {TOTAL_GAMES: {id: 1,code: "total_games"},TOTAL_WINS: {id: 2,code: "total_wins"},TOTAL_LOSSES: {id: 3,code: "total_losses"},TOTAL_DRAWS: {id: 4,code: "total_draws"},TOTAL_BINGOS: {id: 5,code: "total_bingos"},HIGH_GAME: {id: 6,code: "high_game_score"},HIGH_WORD: {id: 7,code: "high_word_score"},RATING: {id: 8,code: "rating"},AVG_WORD: {id: 6224,code: "avg_word_score"},AVG_GAME: {id: 6223,code: "avg_game_score"},strings: []}
}();
(function(b) {
    var a = function(e, d) {
        this.endTrigger = null
    };
    function c(d) {
    }
    b.Step = a
})(Scrabble);
Scrabble.TileSets = function() {
    return {ENGLISH_TWL: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "B",score: 3}, {id: 10,letter: "B",score: 3}, {id: 11,letter: "C",score: 3}, {id: 12,letter: "C",score: 3}, {id: 13,letter: "D",score: 2}, {id: 14,letter: "D",score: 2}, {id: 15,letter: "D",score: 2}, {id: 16,letter: "D",score: 2}, {id: 17,letter: "E",score: 1}, {id: 18,letter: "E",score: 1}, {id: 19,letter: "E",score: 1}, {id: 20,letter: "E",score: 1}, {id: 21,letter: "E",score: 1}, {id: 22,letter: "E",score: 1}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "F",score: 4}, {id: 30,letter: "F",score: 4}, {id: 31,letter: "G",score: 2}, {id: 32,letter: "G",score: 2}, {id: 33,letter: "G",score: 2}, {id: 34,letter: "H",score: 4}, {id: 35,letter: "H",score: 4}, {id: 36,letter: "I",score: 1}, {id: 37,letter: "I",score: 1}, {id: 38,letter: "I",score: 1}, {id: 39,letter: "I",score: 1}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "J",score: 8}, {id: 46,letter: "K",score: 5}, {id: 47,letter: "L",score: 1}, {id: 48,letter: "L",score: 1}, {id: 49,letter: "L",score: 1}, {id: 50,letter: "L",score: 1}, {id: 51,letter: "M",score: 3}, {id: 52,letter: "M",score: 3}, {id: 53,letter: "N",score: 1}, {id: 54,letter: "N",score: 1}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "N",score: 1}, {id: 59,letter: "O",score: 1}, {id: 60,letter: "O",score: 1}, {id: 61,letter: "O",score: 1}, {id: 62,letter: "O",score: 1}, {id: 63,letter: "O",score: 1}, {id: 64,letter: "O",score: 1}, {id: 65,letter: "O",score: 1}, {id: 66,letter: "O",score: 1}, {id: 67,letter: "P",score: 3}, {id: 68,letter: "P",score: 3}, {id: 69,letter: "Q",score: 10}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "R",score: 1}, {id: 74,letter: "R",score: 1}, {id: 75,letter: "R",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "T",score: 1}, {id: 81,letter: "T",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "T",score: 1}, {id: 86,letter: "U",score: 1}, {id: 87,letter: "U",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "V",score: 4}, {id: 91,letter: "V",score: 4}, {id: 92,letter: "W",score: 4}, {id: 93,letter: "W",score: 4}, {id: 94,letter: "X",score: 8}, {id: 95,letter: "Y",score: 4}, {id: 96,letter: "Y",score: 4}, {id: 97,letter: "Z",score: 10}, {id: 98,letter: " ",score: 0}, {id: 99,letter: " ",score: 0}],ENGLISH_MW: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "B",score: 3}, {id: 10,letter: "B",score: 3}, {id: 11,letter: "C",score: 3}, {id: 12,letter: "C",score: 3}, {id: 13,letter: "D",score: 2}, {id: 14,letter: "D",score: 2}, {id: 15,letter: "D",score: 2}, {id: 16,letter: "D",score: 2}, {id: 17,letter: "E",score: 1}, {id: 18,letter: "E",score: 1}, {id: 19,letter: "E",score: 1}, {id: 20,letter: "E",score: 1}, {id: 21,letter: "E",score: 1}, {id: 22,letter: "E",score: 1}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "F",score: 4}, {id: 30,letter: "F",score: 4}, {id: 31,letter: "G",score: 2}, {id: 32,letter: "G",score: 2}, {id: 33,letter: "G",score: 2}, {id: 34,letter: "H",score: 4}, {id: 35,letter: "H",score: 4}, {id: 36,letter: "I",score: 1}, {id: 37,letter: "I",score: 1}, {id: 38,letter: "I",score: 1}, {id: 39,letter: "I",score: 1}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "J",score: 8}, {id: 46,letter: "K",score: 5}, {id: 47,letter: "L",score: 1}, {id: 48,letter: "L",score: 1}, {id: 49,letter: "L",score: 1}, {id: 50,letter: "L",score: 1}, {id: 51,letter: "M",score: 3}, {id: 52,letter: "M",score: 3}, {id: 53,letter: "N",score: 1}, {id: 54,letter: "N",score: 1}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "N",score: 1}, {id: 59,letter: "O",score: 1}, {id: 60,letter: "O",score: 1}, {id: 61,letter: "O",score: 1}, {id: 62,letter: "O",score: 1}, {id: 63,letter: "O",score: 1}, {id: 64,letter: "O",score: 1}, {id: 65,letter: "O",score: 1}, {id: 66,letter: "O",score: 1}, {id: 67,letter: "P",score: 3}, {id: 68,letter: "P",score: 3}, {id: 69,letter: "Q",score: 10}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "R",score: 1}, {id: 74,letter: "R",score: 1}, {id: 75,letter: "R",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "T",score: 1}, {id: 81,letter: "T",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "T",score: 1}, {id: 86,letter: "U",score: 1}, {id: 87,letter: "U",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "V",score: 4}, {id: 91,letter: "V",score: 4}, {id: 92,letter: "W",score: 4}, {id: 93,letter: "W",score: 4}, {id: 94,letter: "X",score: 8}, {id: 95,letter: "Y",score: 4}, {id: 96,letter: "Y",score: 4}, {id: 97,letter: "Z",score: 10}, {id: 98,letter: " ",score: 0}, {id: 99,letter: " ",score: 0}],ENGLISH_COLLINS: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "B",score: 3}, {id: 10,letter: "B",score: 3}, {id: 11,letter: "C",score: 3}, {id: 12,letter: "C",score: 3}, {id: 13,letter: "D",score: 2}, {id: 14,letter: "D",score: 2}, {id: 15,letter: "D",score: 2}, {id: 16,letter: "D",score: 2}, {id: 17,letter: "E",score: 1}, {id: 18,letter: "E",score: 1}, {id: 19,letter: "E",score: 1}, {id: 20,letter: "E",score: 1}, {id: 21,letter: "E",score: 1}, {id: 22,letter: "E",score: 1}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "F",score: 4}, {id: 30,letter: "F",score: 4}, {id: 31,letter: "G",score: 2}, {id: 32,letter: "G",score: 2}, {id: 33,letter: "G",score: 2}, {id: 34,letter: "H",score: 4}, {id: 35,letter: "H",score: 4}, {id: 36,letter: "I",score: 1}, {id: 37,letter: "I",score: 1}, {id: 38,letter: "I",score: 1}, {id: 39,letter: "I",score: 1}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "J",score: 8}, {id: 46,letter: "K",score: 5}, {id: 47,letter: "L",score: 1}, {id: 48,letter: "L",score: 1}, {id: 49,letter: "L",score: 1}, {id: 50,letter: "L",score: 1}, {id: 51,letter: "M",score: 3}, {id: 52,letter: "M",score: 3}, {id: 53,letter: "N",score: 1}, {id: 54,letter: "N",score: 1}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "N",score: 1}, {id: 59,letter: "O",score: 1}, {id: 60,letter: "O",score: 1}, {id: 61,letter: "O",score: 1}, {id: 62,letter: "O",score: 1}, {id: 63,letter: "O",score: 1}, {id: 64,letter: "O",score: 1}, {id: 65,letter: "O",score: 1}, {id: 66,letter: "O",score: 1}, {id: 67,letter: "P",score: 3}, {id: 68,letter: "P",score: 3}, {id: 69,letter: "Q",score: 10}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "R",score: 1}, {id: 74,letter: "R",score: 1}, {id: 75,letter: "R",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "T",score: 1}, {id: 81,letter: "T",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "T",score: 1}, {id: 86,letter: "U",score: 1}, {id: 87,letter: "U",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "V",score: 4}, {id: 91,letter: "V",score: 4}, {id: 92,letter: "W",score: 4}, {id: 93,letter: "W",score: 4}, {id: 94,letter: "X",score: 8}, {id: 95,letter: "Y",score: 4}, {id: 96,letter: "Y",score: 4}, {id: 97,letter: "Z",score: 10}, {id: 98,letter: " ",score: 0}, {id: 99,letter: " ",score: 0}],FRENCH_FWL: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "B",score: 3}, {id: 10,letter: "B",score: 3}, {id: 11,letter: "C",score: 3}, {id: 12,letter: "C",score: 3}, {id: 13,letter: "D",score: 2}, {id: 14,letter: "D",score: 2}, {id: 15,letter: "D",score: 2}, {id: 16,letter: "E",score: 1}, {id: 17,letter: "E",score: 1}, {id: 18,letter: "E",score: 1}, {id: 19,letter: "E",score: 1}, {id: 20,letter: "E",score: 1}, {id: 21,letter: "E",score: 1}, {id: 22,letter: "E",score: 1}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "E",score: 1}, {id: 30,letter: "E",score: 1}, {id: 31,letter: "F",score: 4}, {id: 32,letter: "F",score: 4}, {id: 33,letter: "G",score: 2}, {id: 34,letter: "G",score: 2}, {id: 35,letter: "H",score: 4}, {id: 36,letter: "H",score: 4}, {id: 37,letter: "I",score: 1}, {id: 38,letter: "I",score: 1}, {id: 39,letter: "I",score: 1}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "J",score: 8}, {id: 46,letter: "K",score: 10}, {id: 47,letter: "L",score: 1}, {id: 48,letter: "L",score: 1}, {id: 49,letter: "L",score: 1}, {id: 50,letter: "L",score: 1}, {id: 51,letter: "L",score: 1}, {id: 52,letter: "M",score: 2}, {id: 53,letter: "M",score: 2}, {id: 54,letter: "M",score: 2}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "N",score: 1}, {id: 59,letter: "N",score: 1}, {id: 60,letter: "N",score: 1}, {id: 61,letter: "O",score: 1}, {id: 62,letter: "O",score: 1}, {id: 63,letter: "O",score: 1}, {id: 64,letter: "O",score: 1}, {id: 65,letter: "O",score: 1}, {id: 66,letter: "O",score: 1}, {id: 67,letter: "P",score: 3}, {id: 68,letter: "P",score: 3}, {id: 69,letter: "Q",score: 8}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "R",score: 1}, {id: 74,letter: "R",score: 1}, {id: 75,letter: "R",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "S",score: 1}, {id: 81,letter: "S",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "T",score: 1}, {id: 86,letter: "T",score: 1}, {id: 87,letter: "T",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "U",score: 1}, {id: 91,letter: "U",score: 1}, {id: 92,letter: "U",score: 1}, {id: 93,letter: "U",score: 1}, {id: 94,letter: "V",score: 4}, {id: 95,letter: "V",score: 4}, {id: 96,letter: "W",score: 10}, {id: 97,letter: "X",score: 10}, {id: 98,letter: "Y",score: 10}, {id: 99,letter: "Z",score: 10}, {id: 100,letter: " ",score: 0}, {id: 101,letter: " ",score: 0}],ITALIAN: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "A",score: 1}, {id: 10,letter: "A",score: 1}, {id: 11,letter: "A",score: 1}, {id: 12,letter: "A",score: 1}, {id: 13,letter: "A",score: 1}, {id: 14,letter: "B",score: 5}, {id: 15,letter: "B",score: 5}, {id: 16,letter: "B",score: 5}, {id: 17,letter: "C",score: 2}, {id: 18,letter: "C",score: 2}, {id: 19,letter: "C",score: 2}, {id: 20,letter: "C",score: 2}, {id: 21,letter: "C",score: 2}, {id: 22,letter: "C",score: 2}, {id: 23,letter: "D",score: 5}, {id: 24,letter: "D",score: 5}, {id: 25,letter: "D",score: 5}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "E",score: 1}, {id: 30,letter: "E",score: 1}, {id: 31,letter: "E",score: 1}, {id: 32,letter: "E",score: 1}, {id: 33,letter: "E",score: 1}, {id: 34,letter: "E",score: 1}, {id: 35,letter: "E",score: 1}, {id: 36,letter: "E",score: 1}, {id: 37,letter: "F",score: 5}, {id: 38,letter: "F",score: 5}, {id: 39,letter: "F",score: 5}, {id: 40,letter: "G",score: 8}, {id: 41,letter: "G",score: 8}, {id: 42,letter: "H",score: 8}, {id: 43,letter: "H",score: 8}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "I",score: 1}, {id: 46,letter: "I",score: 1}, {id: 47,letter: "I",score: 1}, {id: 48,letter: "I",score: 1}, {id: 49,letter: "I",score: 1}, {id: 50,letter: "I",score: 1}, {id: 51,letter: "I",score: 1}, {id: 52,letter: "I",score: 1}, {id: 53,letter: "I",score: 1}, {id: 54,letter: "I",score: 1}, {id: 55,letter: "I",score: 1}, {id: 56,letter: "L",score: 3}, {id: 57,letter: "L",score: 3}, {id: 58,letter: "L",score: 3}, {id: 59,letter: "L",score: 3}, {id: 60,letter: "L",score: 3}, {id: 61,letter: "M",score: 3}, {id: 62,letter: "M",score: 3}, {id: 63,letter: "M",score: 3}, {id: 64,letter: "M",score: 3}, {id: 65,letter: "M",score: 3}, {id: 66,letter: "N",score: 3}, {id: 67,letter: "N",score: 3}, {id: 68,letter: "N",score: 3}, {id: 69,letter: "N",score: 3}, {id: 70,letter: "N",score: 3}, {id: 71,letter: "O",score: 1}, {id: 72,letter: "O",score: 1}, {id: 73,letter: "O",score: 1}, {id: 74,letter: "O",score: 1}, {id: 75,letter: "O",score: 1}, {id: 76,letter: "O",score: 1}, {id: 77,letter: "O",score: 1}, {id: 78,letter: "O",score: 1}, {id: 79,letter: "O",score: 1}, {id: 80,letter: "O",score: 1}, {id: 81,letter: "O",score: 1}, {id: 82,letter: "O",score: 1}, {id: 83,letter: "O",score: 1}, {id: 84,letter: "O",score: 1}, {id: 85,letter: "O",score: 1}, {id: 86,letter: "P",score: 5}, {id: 87,letter: "P",score: 5}, {id: 88,letter: "P",score: 5}, {id: 89,letter: "Q",score: 10}, {id: 90,letter: "R",score: 2}, {id: 91,letter: "R",score: 2}, {id: 92,letter: "R",score: 2}, {id: 93,letter: "R",score: 2}, {id: 94,letter: "R",score: 2}, {id: 95,letter: "R",score: 2}, {id: 96,letter: "S",score: 2}, {id: 97,letter: "S",score: 2}, {id: 98,letter: "S",score: 2}, {id: 99,letter: "S",score: 2}, {id: 100,letter: "S",score: 2}, {id: 101,letter: "S",score: 2}, {id: 102,letter: "T",score: 2}, {id: 103,letter: "T",score: 2}, {id: 104,letter: "T",score: 2}, {id: 105,letter: "T",score: 2}, {id: 106,letter: "T",score: 2}, {id: 107,letter: "T",score: 2}, {id: 108,letter: "U",score: 3}, {id: 109,letter: "U",score: 3}, {id: 110,letter: "U",score: 3}, {id: 111,letter: "U",score: 3}, {id: 112,letter: "U",score: 3}, {id: 113,letter: "V",score: 5}, {id: 114,letter: "V",score: 5}, {id: 115,letter: "V",score: 5}, {id: 116,letter: "Z",score: 8}, {id: 117,letter: "Z",score: 8}, {id: 118,letter: " ",score: 0}, {id: 119,letter: " ",score: 0}],GERMAN: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "B",score: 3}, {id: 6,letter: "B",score: 3}, {id: 7,letter: "C",score: 4}, {id: 8,letter: "C",score: 4}, {id: 9,letter: "D",score: 1}, {id: 10,letter: "D",score: 1}, {id: 11,letter: "D",score: 1}, {id: 12,letter: "D",score: 1}, {id: 13,letter: "E",score: 1}, {id: 14,letter: "E",score: 1}, {id: 15,letter: "E",score: 1}, {id: 16,letter: "E",score: 1}, {id: 17,letter: "E",score: 1}, {id: 18,letter: "E",score: 1}, {id: 19,letter: "E",score: 1}, {id: 20,letter: "E",score: 1}, {id: 21,letter: "E",score: 1}, {id: 22,letter: "E",score: 1}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "F",score: 4}, {id: 29,letter: "F",score: 4}, {id: 30,letter: "G",score: 2}, {id: 31,letter: "G",score: 2}, {id: 32,letter: "G",score: 2}, {id: 33,letter: "H",score: 2}, {id: 34,letter: "H",score: 2}, {id: 35,letter: "H",score: 2}, {id: 36,letter: "H",score: 2}, {id: 37,letter: "I",score: 1}, {id: 38,letter: "I",score: 1}, {id: 39,letter: "I",score: 1}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "J",score: 6}, {id: 44,letter: "K",score: 4}, {id: 45,letter: "K",score: 4}, {id: 46,letter: "L",score: 2}, {id: 47,letter: "L",score: 2}, {id: 48,letter: "L",score: 2}, {id: 49,letter: "M",score: 3}, {id: 50,letter: "M",score: 3}, {id: 51,letter: "M",score: 3}, {id: 52,letter: "M",score: 3}, {id: 53,letter: "N",score: 1}, {id: 54,letter: "N",score: 1}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "N",score: 1}, {id: 59,letter: "N",score: 1}, {id: 60,letter: "N",score: 1}, {id: 61,letter: "N",score: 1}, {id: 62,letter: "O",score: 2}, {id: 63,letter: "O",score: 2}, {id: 64,letter: "O",score: 2}, {id: 65,letter: "P",score: 4}, {id: 66,letter: "Q",score: 10}, {id: 67,letter: "R",score: 1}, {id: 68,letter: "R",score: 1}, {id: 69,letter: "R",score: 1}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "S",score: 1}, {id: 74,letter: "S",score: 1}, {id: 75,letter: "S",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "T",score: 1}, {id: 81,letter: "T",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "T",score: 1}, {id: 86,letter: "U",score: 1}, {id: 87,letter: "U",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "U",score: 1}, {id: 91,letter: "U",score: 1}, {id: 92,letter: "V",score: 6}, {id: 93,letter: "W",score: 3}, {id: 94,letter: "X",score: 8}, {id: 95,letter: "Y",score: 10}, {id: 96,letter: "Z",score: 3}, {id: 97,letter: "",score: 6}, {id: 98,letter: "",score: 8}, {id: 99,letter: "",score: 6}, {id: 100,letter: " ",score: 0}, {id: 101,letter: " ",score: 0}],SPANISH: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "A",score: 1}, {id: 10,letter: "A",score: 1}, {id: 11,letter: "A",score: 1}, {id: 12,letter: "B",score: 3}, {id: 13,letter: "B",score: 3}, {id: 14,letter: "C",score: 3}, {id: 15,letter: "C",score: 3}, {id: 16,letter: "C",score: 3}, {id: 17,letter: "C",score: 3}, {id: 18,letter: "D",score: 2}, {id: 19,letter: "D",score: 2}, {id: 20,letter: "D",score: 2}, {id: 21,letter: "D",score: 2}, {id: 22,letter: "D",score: 2}, {id: 23,letter: "E",score: 1}, {id: 24,letter: "E",score: 1}, {id: 25,letter: "E",score: 1}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "E",score: 1}, {id: 30,letter: "E",score: 1}, {id: 31,letter: "E",score: 1}, {id: 32,letter: "E",score: 1}, {id: 33,letter: "E",score: 1}, {id: 34,letter: "E",score: 1}, {id: 35,letter: "F",score: 4}, {id: 36,letter: "G",score: 2}, {id: 37,letter: "G",score: 2}, {id: 38,letter: "H",score: 4}, {id: 39,letter: "H",score: 4}, {id: 40,letter: "I",score: 1}, {id: 41,letter: "I",score: 1}, {id: 42,letter: "I",score: 1}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "I",score: 1}, {id: 46,letter: "J",score: 8}, {id: 47,letter: "L",score: 1}, {id: 48,letter: "L",score: 1}, {id: 49,letter: "L",score: 1}, {id: 50,letter: "L",score: 1}, {id: 51,letter: "M",score: 3}, {id: 52,letter: "M",score: 3}, {id: 53,letter: "N",score: 1}, {id: 54,letter: "N",score: 1}, {id: 55,letter: "N",score: 1}, {id: 56,letter: "N",score: 1}, {id: 57,letter: "N",score: 1}, {id: 58,letter: "O",score: 1}, {id: 59,letter: "O",score: 1}, {id: 60,letter: "O",score: 1}, {id: 61,letter: "O",score: 1}, {id: 62,letter: "O",score: 1}, {id: 63,letter: "O",score: 1}, {id: 64,letter: "O",score: 1}, {id: 65,letter: "O",score: 1}, {id: 66,letter: "O",score: 1}, {id: 67,letter: "P",score: 3}, {id: 68,letter: "P",score: 3}, {id: 69,letter: "Q",score: 5}, {id: 70,letter: "R",score: 1}, {id: 71,letter: "R",score: 1}, {id: 72,letter: "R",score: 1}, {id: 73,letter: "R",score: 1}, {id: 74,letter: "R",score: 1}, {id: 75,letter: "S",score: 1}, {id: 76,letter: "S",score: 1}, {id: 77,letter: "S",score: 1}, {id: 78,letter: "S",score: 1}, {id: 79,letter: "S",score: 1}, {id: 80,letter: "S",score: 1}, {id: 81,letter: "T",score: 1}, {id: 82,letter: "T",score: 1}, {id: 83,letter: "T",score: 1}, {id: 84,letter: "T",score: 1}, {id: 85,letter: "U",score: 1}, {id: 86,letter: "U",score: 1}, {id: 87,letter: "U",score: 1}, {id: 88,letter: "U",score: 1}, {id: 89,letter: "U",score: 1}, {id: 90,letter: "V",score: 4}, {id: 91,letter: "X",score: 8}, {id: 92,letter: "Y",score: 4}, {id: 93,letter: "Z",score: 10}, {id: 94,letter: "spanish_CH",score: 5}, {id: 95,letter: "spanish_LL",score: 8}, {id: 96,letter: "",score: 8}, {id: 97,letter: "spanish_RR",score: 8}, {id: 98,letter: " ",score: 0}, {id: 99,letter: " ",score: 0}],PORTUGUESE: [{id: 0,letter: "A",score: 1}, {id: 1,letter: "A",score: 1}, {id: 2,letter: "A",score: 1}, {id: 3,letter: "A",score: 1}, {id: 4,letter: "A",score: 1}, {id: 5,letter: "A",score: 1}, {id: 6,letter: "A",score: 1}, {id: 7,letter: "A",score: 1}, {id: 8,letter: "A",score: 1}, {id: 9,letter: "A",score: 1}, {id: 10,letter: "A",score: 1}, {id: 11,letter: "A",score: 1}, {id: 12,letter: "A",score: 1}, {id: 13,letter: "A",score: 1}, {id: 14,letter: "B",score: 3}, {id: 15,letter: "B",score: 3}, {id: 16,letter: "B",score: 3}, {id: 17,letter: "C",score: 2}, {id: 18,letter: "C",score: 2}, {id: 19,letter: "C",score: 2}, {id: 20,letter: "C",score: 2}, {id: 21,letter: "D",score: 2}, {id: 22,letter: "D",score: 2}, {id: 23,letter: "D",score: 5}, {id: 24,letter: "D",score: 5}, {id: 25,letter: "D",score: 5}, {id: 26,letter: "E",score: 1}, {id: 27,letter: "E",score: 1}, {id: 28,letter: "E",score: 1}, {id: 29,letter: "E",score: 1}, {id: 30,letter: "E",score: 1}, {id: 31,letter: "E",score: 1}, {id: 32,letter: "E",score: 1}, {id: 33,letter: "E",score: 1}, {id: 34,letter: "E",score: 1}, {id: 35,letter: "E",score: 1}, {id: 36,letter: "E",score: 1}, {id: 37,letter: "F",score: 4}, {id: 38,letter: "F",score: 4}, {id: 39,letter: "G",score: 4}, {id: 40,letter: "G",score: 4}, {id: 41,letter: "H",score: 4}, {id: 42,letter: "H",score: 4}, {id: 43,letter: "I",score: 1}, {id: 44,letter: "I",score: 1}, {id: 45,letter: "I",score: 1}, {id: 46,letter: "I",score: 1}, {id: 47,letter: "I",score: 1}, {id: 48,letter: "I",score: 1}, {id: 49,letter: "I",score: 1}, {id: 50,letter: "I",score: 1}, {id: 51,letter: "I",score: 1}, {id: 52,letter: "I",score: 1}, {id: 53,letter: "J",score: 5}, {id: 54,letter: "J",score: 5}, {id: 55,letter: "L",score: 2}, {id: 56,letter: "L",score: 2}, {id: 57,letter: "L",score: 2}, {id: 58,letter: "L",score: 2}, {id: 59,letter: "L",score: 2}, {id: 60,letter: "M",score: 1}, {id: 61,letter: "M",score: 1}, {id: 62,letter: "M",score: 1}, {id: 63,letter: "M",score: 1}, {id: 64,letter: "M",score: 1}, {id: 65,letter: "M",score: 1}, {id: 66,letter: "N",score: 3}, {id: 67,letter: "N",score: 3}, {id: 68,letter: "N",score: 3}, {id: 69,letter: "N",score: 3}, {id: 70,letter: "O",score: 1}, {id: 71,letter: "O",score: 1}, {id: 72,letter: "O",score: 1}, {id: 73,letter: "O",score: 1}, {id: 74,letter: "O",score: 1}, {id: 75,letter: "O",score: 1}, {id: 76,letter: "O",score: 1}, {id: 77,letter: "O",score: 1}, {id: 78,letter: "O",score: 1}, {id: 79,letter: "O",score: 1}, {id: 80,letter: "P",score: 4}, {id: 81,letter: "P",score: 4}, {id: 82,letter: "P",score: 4}, {id: 83,letter: "P",score: 4}, {id: 84,letter: "Q",score: 6}, {id: 85,letter: "R",score: 1}, {id: 86,letter: "R",score: 1}, {id: 87,letter: "R",score: 1}, {id: 88,letter: "R",score: 1}, {id: 89,letter: "R",score: 1}, {id: 90,letter: "R",score: 1}, {id: 91,letter: "S",score: 1}, {id: 92,letter: "S",score: 1}, {id: 93,letter: "S",score: 1}, {id: 94,letter: "S",score: 1}, {id: 95,letter: "S",score: 1}, {id: 96,letter: "S",score: 1}, {id: 97,letter: "S",score: 1}, {id: 98,letter: "S",score: 1}, {id: 99,letter: "T",score: 1}, {id: 100,letter: "T",score: 1}, {id: 101,letter: "T",score: 1}, {id: 102,letter: "T",score: 1}, {id: 103,letter: "T",score: 1}, {id: 104,letter: "U",score: 1}, {id: 105,letter: "U",score: 1}, {id: 106,letter: "U",score: 1}, {id: 107,letter: "U",score: 1}, {id: 108,letter: "U",score: 1}, {id: 109,letter: "U",score: 1}, {id: 110,letter: "U",score: 1}, {id: 111,letter: "V",score: 4}, {id: 112,letter: "V",score: 4}, {id: 113,letter: "X",score: 8}, {id: 114,letter: "Z",score: 8}, {id: 115,letter: "",score: 3}, {id: 116,letter: "",score: 3}, {id: 117,letter: " ",score: 0}, {id: 118,letter: " ",score: 0}, {id: 119,letter: " ",score: 0}],getAlphabet: function(d) {
            var a = Scrabble.TileSets[d];
            var c = [];
            c[0] = a[0].letter;
            for (var b = 0; b < a.length; b++) {
                if (c[c.length - 1] != a[b].letter && a[b].score != 0) {
                    c.push(a[b].letter)
                }
            }
            return c
        },getDistribution: function(d) {
            var c = {};
            var a = Scrabble.TileSets[d];
            for (var b = 0; b < a.length; b++) {
                if (c[a[b].letter] == undefined) {
                    c[a[b].letter] = 1
                } else {
                    c[a[b].letter]++
                }
            }
            return c
        },getLetter: function(d, c) {
            var a = Scrabble.TileSets[c];
            for (var b = 0; b < a.length; b++) {
                if (a[b].id == d) {
                    return a[b].letter
                }
            }
            return null
        }}
}();
Scrabble.TileSkins = function() {
    return {currentSkin: "def",skins: {def: {name: "Default",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Default")
                }},black: {name: "Black",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Black")
                }},classic: {name: "Classic",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Classic")
                }},burgundy: {name: "Burgundy",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Burgundy")
                }},christmas2012: {name: "Christmas2012",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Christmas2012")
                }},toyota2013: {name: "Toyota2013",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Toyota2013")
                }},luxury: {name: "Luxury",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("PH_Luxury")
                }},gamehouse: {name: "Gamehouse",getDisplayName: function() {
                    return Scrabble.Dictionary.translate("STR_TXT_ITM_NM_LEGACYTLS")
                }}}}
}();
Scrabble.Interstitials = function() {
    TIMER_DELAY = 5;
    TURNS_BETWEEN_ADS = 5;
    TIME_BETWEEN_ADS = 60000;
    return {isDisplayed: false,currentTimerValue: 0,timerStarted: false,timerInterval: null,turnsPlayedSinceLastAd: 0,uidsToOmit: null,adIsVideo: false,adsSequences: [],currentAdsSequence: null,firstTime: false,initialized: false,initialize: function() {
            Scrabble.Interstitials.initialized = true;
            var a = Scrabble.config._interstitialsDelay;
            var d = a.split("/");
            var c = d.length;
            for (var b = 0; b < c; b++) {
                d[b] = d[b].split("-")
            }
            Scrabble.Interstitials.adsSequences = d;
            Scrabble.Interstitials.currentAdsSequence = Scrabble.Interstitials.adsSequences.shift()
        },incrementTurnsPlayed: function() {
            if (!Scrabble.Interstitials.initialized) {
                Scrabble.Interstitials.initialize()
            }
            Scrabble.EventManager.unbindEvent(Scrabble.UserEvents.QuestPopupDissmissed, Scrabble.Interstitials.incrementTurnsPlayed);
            if (Scrabble.config.adsEnabled != "false" && Scrabble.config.adsEnabled != false) {
                if (Scrabble.Interstitials.firstTime == true) {
                    return false
                }
                Scrabble.Interstitials.turnsPlayedSinceLastAd++;
                if (Scrabble.Interstitials.turnsPlayedSinceLastAd > Scrabble.Interstitials.currentAdsSequence.length) {
                    if (Scrabble.Interstitials.adsSequences.length) {
                        Scrabble.Interstitials.currentAdsSequence = Scrabble.Interstitials.adsSequences.shift();
                        Scrabble.Interstitials.turnsPlayedSinceLastAd = 1
                    } else {
                        Scrabble.Interstitials.turnsPlayedSinceLastAd = 1
                    }
                }
                var a = Scrabble.Interstitials.currentAdsSequence[Scrabble.Interstitials.turnsPlayedSinceLastAd - 1];
                switch (a) {
                    case "0":
                        break;
                    case "1":
                        Scrabble.Interstitials.adIsVideo = !Scrabble.Interstitials.adIsVideo;
                        Scrabble.Interstitials.show();
                        break;
                    case "2":
                        Scrabble.Interstitials.adIsVideo = false;
                        Scrabble.Interstitials.show();
                        break;
                    case "3":
                        Scrabble.Interstitials.adIsVideo = true;
                        Scrabble.Interstitials.show();
                        break
                }
            }
        },isShowingAdNextTurn: function() {
            if (!Scrabble.Interstitials.initialized) {
                Scrabble.Interstitials.initialize()
            }
            var a = Scrabble.Interstitials.turnsPlayedSinceLastAd + 1;
            var b = Scrabble.Interstitials.currentAdsSequence;
            if (a > Scrabble.Interstitials.currentAdsSequence.length) {
                if (Scrabble.Interstitials.adsSequences.length) {
                    b = Scrabble.Interstitials.adsSequences[0];
                    a = 1
                } else {
                    a = 1
                }
            }
            var c = b[a - 1];
            switch (c) {
                case "0":
                    return false;
                    break;
                case "1":
                    return true;
                    break;
                case "2":
                    return true;
                    break;
                case "3":
                    return true;
                    break;
                default:
                    return false
            }
        },show: function() {
            if (Scrabble.config.adsEnabled != "false" && Scrabble.config.adsEnabled != false) {
                var j = $("#interstitialContainer");
                j.remove();
                var g = Scrabble.Interstitials.adIsVideo;
                Scrabble.Interstitials.timerStarted = false;
                setTimeout(Scrabble.Interstitials.startTimer, 10000);
                var b = Scrabble.DomBuilder.buildInterstitial(g);
                $("#specialPopups").append(b);
                $("#interstitialsRemoveAds").fadeTo(0.5, 0.5);
                if (g) {
                    var h = new Date();
                    var a = h.getTime();
                    var f = (Scrabble.config._branding == "hasbro") ? "" : "_row";
                    jwplayer("interstitialsVideoPlayer").setup({autostart: true,flashplayer: Scrabble.config._cdnVersion + "/js/libs/jwplayer/player.swf",width: "300",height: "250",file: Scrabble.config._cdnVersion + "/js/libs/jwplayer/blank.mp4",plugins: {googima: {ad: {my_ad: {tag: "https://ad.doubleclick.net/pfadx/Facebookea/scrabble_video" + f + ";sz=300x250;ord=" + a,type: "video",position: "pre"}},advideowidth: 300,advideoheight: 250,allowplayercontrols: false,events: {onAdsComplete: function() {
                                        jwplayer("interstitialsVideoPlayer").remove()
                                    },onAdNotAvailable: function() {
                                        jwplayer("interstitialsVideoPlayer").remove();
                                        $("#interstitialAd").html(Scrabble.DomBuilder.buildStaticInterstitial());
                                        Scrabble.Interstitials.waitForIframeLoaded()
                                    },onAdStart: Scrabble.Interstitials.startTimer}}}});
                    jwplayer("interstitialsVideoPlayer").onReady(function() {
                        var d = jwplayer("interstitialsVideoPlayer");
                        var m = d.getWidth();
                        var q = d.getHeight();
                        var l = 400;
                        var k = 300;
                        var o = (l - m) / 2;
                        var n = (k - q) / 2;
                        $("#interstitialsVideoPlayer").css({marginLeft: o + "px",marginTop: n + "px"})
                    })
                } else {
                    Scrabble.Interstitials.waitForIframeLoaded()
                }
                var j = $("#interstitialContainer");
                var e = $("#gameScene").offset().top;
                j.offset({top: e + 12});
                j.css("opacity", 0);
                j.show();
                j.animate({opacity: 1}, 500, function() {
                    $("#interstitialAd").show()
                });
                $("#fullGameOverlayTransparent").show();
                Scrabble.Interstitials.isDisplayed = true;
                var c = {subtype1: "ads",subtype2: "in-game"};
                Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "served", c)
            }
        },hide: function() {
            Scrabble.Interstitials.stopWaitForIframeLoaded();
            try {
                jwplayer("interstitialsVideoPlayer").remove()
            } catch (b) {
            }
            $("#interstitialAd").hide();
            $("#interstitialTimer").hide();
            $("#interstitialOptOut").hide();
            $("#fullGameOverlayTransparent").hide();
            var c = $("#interstitialContainer");
            c.animate({opacity: 0}, 500, function() {
                c.remove()
            });
            $("#interstitialCloseBtn").off("click", Scrabble.Interstitials.hide);
            $("#interstitialsRemoveAds").off("click", Scrabble.Interstitials.showAdRemovalItem);
            Scrabble.Interstitials.isDisplayed = false;
            var a = {subtype1: "ads",subtype2: "in-game"};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "closed", a)
        },showAdRemovalItem: function() {
            Scrabble.Interstitials.hide();
            Scrabble.Store.show();
            var a = Scrabble.Store.getItemByType("adBlock3");
            if (a != null) {
                Scrabble.Store.showPreview(a)
            }
        },startTimer: function() {
            if (!Scrabble.Interstitials.timerStarted) {
                Scrabble.Interstitials.timerStarted = true;
                $("#interstitialTimer p").html(Scrabble.Dictionary.translate("FCBK_TXT_INTRSTTL_CLSCNTDWN", {"[#_SECONDS]": TIMER_DELAY}));
                Scrabble.Interstitials.currentTimerValue = TIMER_DELAY;
                Scrabble.Interstitials.timerInterval = setInterval(function() {
                    Scrabble.Interstitials.decreaseTimer()
                }, 1000)
            }
        },decreaseTimer: function() {
            $("#interstitialTimer p").html(Scrabble.Dictionary.translate("FCBK_TXT_INTRSTTL_CLSCNTDWN", {"[#_SECONDS]": --Scrabble.Interstitials.currentTimerValue}));
            if (Scrabble.Interstitials.currentTimerValue == 0) {
                clearInterval(Scrabble.Interstitials.timerInterval);
                var a = $("#interstitialCloseBtn");
                a.on("click", function() {
                    Scrabble.Interstitials.hide()
                });
                a.css("cursor", "pointer");
                a.css("background-position", "-28px");
                $("#interstitialsTimerTxt").css("color", "#FFFFFF");
                $("#interstitialsRemoveAds").fadeTo(1, 1);
                $("#interstitialsRemoveAds").on("click", Scrabble.Interstitials.showAdRemovalItem)
            }
        },waitForIframeLoaded: function() {
            $("#staticInterstitial").on("load", Scrabble.Interstitials.startTimer)
        },stopWaitForIframeLoaded: function() {
            $("#staticInterstitial").off("load", Scrabble.Interstitials.startTimer)
        }}
}();
Scrabble.Store = function() {
    var k = "coins";
    var d = "items";
    var e = {coins: ["moneyPack"],items: ["board", "tileSet", "adRemoval", "kit", "feature"]};
    var g = null;
    var n = {};
    var b = [];
    var f = [];
    var m = null;
    var c = false;
    var j = false;
    var a = 0;
    var h = 0;
    var l = false;
    return {adsRemovedLeft: null,storeItems: [],equiped: {board: null,tileset: null},tosChecked: false,userCurrency: "",isRefreshing: false,$legalTip: null,$purchaseSuccessTip: null,$purchaseErrorTip: null,$storePopup: null,$storeLoading: null,isOpen: false,equipedReceived: false,tempItem: null,sessionId: "",scrollList: null,scrollApi: null,ListDOM: null,init: function() {
            Scrabble.Store.$storePopup = $("#storePopup");
            Scrabble.Store.$storePopup.html(Scrabble.DomBuilder.buildStoreFrame);
            $("#legalTOSPopup").remove();
            Scrabble.Store.$storePopup.parent().parent().append(Scrabble.PopupFactory.tosLegalPopup());
            Scrabble.Store.$storePopup.append(Scrabble.PopupFactory.purchaseSuccessfulPopup());
            Scrabble.Store.$storePopup.append(Scrabble.PopupFactory.purchaseUnsuccessfulPopup());
            Scrabble.Store.$legalTip = $("#legalTOSPopup");
            Scrabble.Store.$purchaseSuccessTip = $("#purchaseSuccessfulPopup");
            Scrabble.Store.$purchaseErrorTip = $("#purchaseUnsuccessfulPopup");
            Scrabble.Store.$storeLoading = $("#storeLoadingIcon");
            Scrabble.Store._hideLegalTip();
            Scrabble.Store.scrollList = $("#storeList").jScrollPane({showArrows: true,verticalDragMinHeight: 50});
            Scrabble.Store.scrollApi = Scrabble.Store.scrollList.data("jsp");
            Scrabble.Store.ListDOM = Scrabble.Store.scrollApi.getContentPane();
            Scrabble.Store.$storePopup.on("click", "#storeCloseButton", Scrabble.Store.hide);
            Scrabble.Store.$storePopup.on("click", ".storePreviewBtn", Scrabble.Store.showPreview);
            Scrabble.Store.$storePopup.on("click", ".storeItemContainer", Scrabble.Store.showPreview);
            $("#legalTOSPopup").on("click", "#storeTosCheck", Scrabble.Store.toggleTOS);
            $("#legalTOSPopup").on("click", "#storeTosLink", Scrabble.Store.showTOS);
            $("#legalTOSPopup").on("click", ".legalTipCloseBtn", Scrabble.Store._hideLegalTip);
            Scrabble.Store.$storePopup.on("click", ".legalTipCloseBtn", Scrabble.Store._hideLegalTip);
            Scrabble.Store.displayPage(d);
            Scrabble.Store.synchronize()
        },checkAdsRemoved: function() {
            var r = new Date(), q, o = Scrabble.config.adsEnabled;
            for (var s = 0; s < Scrabble.Store.storeItems.length; s++) {
                if (Scrabble.Store.storeItems[s].expiration != null) {
                    if (Scrabble.Store.storeItems[s].category == "adRemoval") {
                        Scrabble.Store.storeItems[s].purchased = false;
                        q = Date.fromISO(Scrabble.Store.storeItems[s].expiration);
                        if (getDayDifference(r) < getDayDifference(q)) {
                            r = q;
                            if (r > 0) {
                                o = false
                            }
                        }
                    }
                }
            }
            if (o == false) {
                Scrabble.config.adsEnabled = o;
                Scrabble.Store.setAdsExpirationDate(r)
            }
        },setAdsExpirationDate: function(o) {
            Scrabble.config.adsEnabled = false;
            j = true;
            Scrabble.Store.adsRemovedLeft = getDayDifference(o)
        },show: function(o) {
            if (Scrabble.Store.isOpen == true) {
                Scrabble.Store.hide();
                return
            }
            var q = {subtype1: "store",subtype2: "navigation"};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "open_store", q);
            if (Scrabble.Store.$storePopup == null) {
                Scrabble.Store.init()
            }
            if (Scrabble.OptionsMenu.isOpen) {
                Scrabble.OptionsMenu.hide()
            }
            if (Scrabble.NewGameMenu.isOpen) {
                Scrabble.NewGameMenu.hide()
            }
            Scrabble.PopupManager.showBlocker();
            Scrabble.Store.$storePopup.show();
            Scrabble.Store.isOpen = true;
            Scrabble.Store.displayPage(d);
            setTimeout(Scrabble.Store.scrollList.data("jsp").reinitialise, 100)
        },hide: function() {
            if (Scrabble.Store.$storePopup != null) {
                Scrabble.Store.$storePopup.hide()
            } else {
                $("#storePopup").hide()
            }
            Scrabble.SoundManager.play_sfx("Popup_close");
            Scrabble.PopupManager.hideBlocker();
            Scrabble.Store._hideLegalTip();
            Scrabble.Store.isOpen = false;
            h = 0;
            Scrabble.PopupManager.resume();
            var o = {subtype1: "store",subtype2: "navigation"};
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "close_store", o)
        },displayPage: function(s, o, r) {
            Scrabble.Store._hideLegalTip();
            g = s;
            Scrabble.Store["show" + (g.capitalize())](o || null, r || null);
            Scrabble.Store.refreshView();
            Scrabble.SoundManager.play_sfx("Generic_btn");
            $(".storePopupTitle").html(Scrabble.Dictionary.translate("STR_BTN_STRMNMNU"));
            if (o === true) {
                setTimeout(function() {
                    Scrabble.Store.scrollApi.scrollToPercentY(h)
                }, 100);
                if (c == true) {
                    var q = {subtype1: "store",subtype2: "shopping",subtype3: "more_coins"};
                    q.data = JSON.stringify({itemName: r.name,itemPrice: r.price});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "redirect_cancel", q);
                    c = false
                } else {
                    var q = {subtype1: "store",subtype2: "navigation"};
                    q.data = JSON.stringify({itemName: r.name,itemPrice: r.price});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "back_button", q)
                }
            } else {
                setTimeout(function() {
                    Scrabble.Store.scrollApi.scrollToPercentY(0)
                }, 100)
            }
        },synchronize: function(o) {
            if (Scrabble.Store.isRefreshing == false) {
                Scrabble.Store.showLoading();
                Scrabble.StoreSynchronizer.sync("category");
                Scrabble.StoreSynchronizer.sync("item", true);
                Scrabble.StoreSynchronizer.sync("purchase", true);
                Scrabble.Store.update()
            }
            return false
        },getBalance: function() {
            return a
        },showLoading: function() {
            Scrabble.Store.$storeLoading.show()
        },hideLoading: function() {
            Scrabble.Store.$storeLoading.hide()
        },syncEquiped: function() {
            Scrabble.Store.equipedReceived = true;
            Scrabble.Store.update()
        },updateCategories: function(o) {
            n = o;
            Scrabble.Store.update()
        },updateItems: function(o) {
            Scrabble.Store.storeItems = o;
            Scrabble.StoreSynchronizer.getPrices(Scrabble.Store.storeItems);
            Scrabble.Store.update()
        },updatePrices: function(o) {
            f = o;
            Scrabble.Store.update()
        },updatePurchases: function(q) {
            b = b.concat(q);
            var o = {};
            for (var r = b.length - 1; r >= 0; r--) {
                if (o[b[r].id] == undefined) {
                    o[b[r].id] = [r, b[r].expiration]
                } else {
                    if (o[b[r].id][1] < b[r].expiration) {
                        b.splice(o[b[r].id][0], 1);
                        o[b[r].id][1] = b[r].expiration
                    } else {
                        b.splice(r, 1)
                    }
                }
            }
            o = null;
            Scrabble.Store.update()
        },update: function() {
            if (((Scrabble.StoreSynchronizer.refreshed >= Scrabble.StoreSynchronizer.sentReq) || Scrabble.StoreSynchronizer.refreshed == 0) && (Scrabble.Store.storeItems.length >= 1 && f.length >= 1 && n != {}) && Scrabble.Store.equipedReceived == true) {
                Scrabble.Store.hideLoading();
                Scrabble.Store.storeItems.sort(function(t, s) {
                    return parseInt(t.order) - parseInt(s.order)
                });
                for (var o = 0; o < Scrabble.Store.storeItems.length; o++) {
                    for (var q = 0; q < f.length; q++) {
                        if (f[q].itemId == Scrabble.Store.storeItems[o].id) {
                            Scrabble.Store.storeItems[o].price = f[q].value;
                            Scrabble.Store.storeItems[o].priceId = f[q].id;
                            Scrabble.Store.storeItems[o].currency = f[q].currency;
                            break
                        }
                    }
                    if (Scrabble.Store.storeItems[o].parsed == false) {
                        Scrabble.Store.storeItems[o].parsed = true;
                        Scrabble.Store.storeItems[o].category = n[Scrabble.Store.storeItems[o].category].type
                    }
                    for (var r = 0; r < b.length; r++) {
                        if (b[r].id == Scrabble.Store.storeItems[o].id) {
                            if (Scrabble.Store.storeItems[o].category != "moneyPack" && Scrabble.Store.storeItems[o].category != "adRemoval") {
                                Scrabble.Store.storeItems[o].purchased = true
                            }
                            Scrabble.Store.storeItems[o].expiration = b[r].expiration;
                            break
                        }
                    }
                    if (Scrabble.Store.storeItems[o].category == "board" && Scrabble.BoardSkins.currentSkin == Scrabble.Store.storeItems[o].type) {
                        if (!(Scrabble.Store.storeItems[o].type == "toyota2013" && Scrabble.QuestPopup.isToyotaQuestActive == true)) {
                            Scrabble.Store.storeItems[o].equiped = true;
                            Scrabble.Store.equiped.board = Scrabble.Store.storeItems[o]
                        } else {
                            Scrabble.Store.storeItems[o].equiped = false
                        }
                    } else {
                        if (Scrabble.Store.storeItems[o].category == "tileSet" && Scrabble.TileSkins.currentSkin == Scrabble.Store.storeItems[o].type) {
                            if (!(Scrabble.Store.storeItems[o].type == "toyota2013" && Scrabble.QuestPopup.isToyotaQuestActive == true)) {
                                Scrabble.Store.storeItems[o].equiped = true;
                                Scrabble.Store.equiped.tileset = Scrabble.Store.storeItems[o]
                            } else {
                                Scrabble.Store.storeItems[o].equiped = false
                            }
                        } else {
                            if (Scrabble.Store.storeItems[o].category == "kit") {
                                Scrabble.QuestPopup.toyotaKitIndex = o;
                                if (Scrabble.QuestPopup.isToyotaQuestActive == true) {
                                    Scrabble.Store.storeItems[o].equiped = true;
                                    Scrabble.Store.equiped.tileset = Scrabble.Store.storeItems[o];
                                    Scrabble.Store.equiped.board = Scrabble.Store.storeItems[o]
                                }
                            } else {
                                if (Scrabble.Store.storeItems[o].category == "feature") {
                                    if ((Scrabble.Store.storeItems[o].type == "tileTracking" && Scrabble.Store.storeItems[o].purchased == true) || (Scrabble.Store.storeItems[o].type == "tileTracking2" && Scrabble.Store.storeItems[o].purchased == true)) {
                                        Scrabble.Store.storeItems[o].equiped = true;
                                        Scrabble.TradeTilesPopup.tileTracking = true;
                                        if (Scrabble.Store.storeItems[o].type == "tileTracking2") {
                                            Scrabble.TradeTilesPopup.branding = false
                                        }
                                    }
                                } else {
                                    Scrabble.Store.storeItems[o].equiped = false
                                }
                            }
                        }
                    }
                }
                Scrabble.Store.checkAdsRemoved();
                Scrabble.StoreSynchronizer.saveLastUpdate();
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.StoreSyncComplete)
            }
        },updateWalletInfo: function(q) {
            q = parseInt(q) || a || 0;
            a = q;
            var o = $("#storeBalanceAmmount");
            if (Scrabble.AnimationManager.animationsEnabled) {
                Scrabble.AnimationManager.animateTextIncrementation(o, a, 2000, true)
            } else {
                o.html(convertToReadableNumber(a, false))
            }
        },purchaseItem: function(t) {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            var o, r = Scrabble.Store.findItem(t);
            if (r != null) {
                if (r.purchased == true && r.equiped == true) {
                } else {
                    if (r.purchased == true && r.equiped == false) {
                        r.equiped = true;
                        if (r.category == "board") {
                            if (Scrabble.QuestPopup.isToyotaQuestActive && !l && !Scrabble.QuestPopup.isToyotaQuestCompleted) {
                                r.equiped = false;
                                Scrabble.QuestPopup.set("Toyota", -1, r);
                                Scrabble.QuestPopup.show();
                                Scrabble.QuestPopup.tempItem = r;
                                l = true;
                                if (t.stopPropagation) {
                                    t.stopPropagation();
                                    window.event.cancelBubble = true
                                }
                                return
                            }
                            if (Scrabble.QuestPopup.isToyotaQuestActive) {
                                Scrabble.QuestPopup.removeToyotaKit("board")
                            }
                            Scrabble.Board.setBoardSkin(r.type);
                            o = Scrabble.Store.equiped.board;
                            if (o != null) {
                                o.equiped = false;
                                Scrabble.Store.refreshSingleItem(o)
                            }
                            Scrabble.Store.equiped.board = r
                        } else {
                            if (r.category == "tileSet") {
                                if (Scrabble.QuestPopup.isToyotaQuestActive && !l && !Scrabble.QuestPopup.isToyotaQuestCompleted) {
                                    r.equiped = false;
                                    Scrabble.QuestPopup.set("Toyota", -1, r);
                                    Scrabble.QuestPopup.show();
                                    Scrabble.QuestPopup.tempItem = r;
                                    l = true;
                                    if (t.stopPropagation) {
                                        t.stopPropagation();
                                        window.event.cancelBubble = true
                                    }
                                    return
                                }
                                if (Scrabble.QuestPopup.isToyotaQuestActive) {
                                    Scrabble.QuestPopup.removeToyotaKit("tileset")
                                }
                                Scrabble.Board.setTileSkin(r.type);
                                o = Scrabble.Store.equiped.tileset;
                                if (o != null) {
                                    o.equiped = false;
                                    Scrabble.Store.refreshSingleItem(o)
                                }
                                Scrabble.Store.equiped.tileset = r
                            } else {
                                if (r.category == "adRemoval") {
                                    j = true;
                                    adsRemovedPeriod = r.meta.defaultValue;
                                    Scrabble.config.adsEnabled = false;
                                    r.equiped = false;
                                    Scrabble.Store.checkAdsRemoved()
                                } else {
                                    if (r.category == "kit") {
                                        if (r.type == "toyota2013") {
                                            Scrabble.QuestPopup.setToyotaKit(true);
                                            o = Scrabble.Store.equiped.tileset;
                                            if (o != null) {
                                                o.equiped = false;
                                                Scrabble.Store.refreshSingleItem(o)
                                            }
                                            Scrabble.Store.equiped.tileset = r;
                                            o = Scrabble.Store.equiped.board;
                                            if (o != null) {
                                                o.equiped = false;
                                                Scrabble.Store.refreshSingleItem(o)
                                            }
                                            Scrabble.Store.equiped.board = r
                                        }
                                    } else {
                                        if (r.category == "feature") {
                                            if (r.type == "tileTracking") {
                                                Scrabble.TradeTilesPopup.tileTracking = true
                                            }
                                            if (r.type == "tileTracking2") {
                                                Scrabble.TradeTilesPopup.tileTracking = true;
                                                Scrabble.TradeTilesPopup.branding = false
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        var s = {subtype1: "store",subtype2: "shopping",subtype3: "action"};
                        s.data = JSON.stringify({itemName: r.name});
                        Scrabble.kontagent.trackEvent(Scrabble.config.fbId, "item_activation", s)
                    } else {
                        Scrabble.Store._hideLegalTip();
                        if (a < r.price) {
                            $("#storeBalance p").animate({color: "#F00"}, 100).animate({color: "#F11"}, 200).animate({color: "#177787"}, 1000);
                            Scrabble.Store.displayPage(k, "redirect_preview", r);
                            c = true;
                            var q = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_TXT_CNNTCHCKWRD_TTL"),message: Scrabble.Dictionary.translate("STR_TXT_NTENGHCNS", {"[X]": convertToReadableNumber((r.price - a), false),"[IMG]": ('<img src="' + Scrabble.config._cdnVersion + "/images/skins/skin_default/storeCoinIcon_" + Scrabble.config._branding + '.png" id="notEnoughCoinsImg" alt="*" />')}),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                            Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(q))
                        } else {
                            Scrabble.Store.showLoading();
                            Scrabble.Store.tempItem = Scrabble.Store.storeItems.indexOf(r);
                            Scrabble.StoreSynchronizer.postItemPurchase(r);
                            var u = "store";
                            if (r.price == -1 || r.type == "toyota2013") {
                                u = "toyota"
                            }
                            var s = {subtype1: u,subtype2: "shopping",subtype3: "action"};
                            s.data = JSON.stringify({itemName: r.name,coinsSpent: r.price});
                            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "item_purchase", s)
                        }
                    }
                }
                Scrabble.Store.refreshSingleItem(r)
            }
            if (t.stopPropagation) {
                t.stopPropagation();
                window.event.cancelBubble = true
            }
        },finishItemPurchase: function(q) {
            Scrabble.Store.hideLoading();
            if (Scrabble.Store.tempItem != null) {
                var o = Scrabble.Store.storeItems[Scrabble.Store.tempItem];
                if (o.category != "adRemoval") {
                    o.purchased = true;
                    Scrabble.Store.purchaseItem(o);
                    Scrabble.Store.refreshSingleItem(o)
                } else {
                    Scrabble.Store.checkAdsRemoved()
                }
                Scrabble.Store.displayPage(d);
                a -= o.price;
                Scrabble.Store.updateWalletInfo();
                Scrabble.Store.successTipBlink();
                Scrabble.Store.tempItem = null
            }
        },itemPurchaseError: function() {
            Scrabble.Store.displayPage(d);
            Scrabble.Store.hideLoading();
            if (Scrabble.Store.tempItem != null) {
                var o = Scrabble.Store.storeItems[Scrabble.Store.tempItem];
                Scrabble.SoundManager.play_sfx("Cancel");
                Scrabble.Store.$purchaseErrorTip.show();
                Scrabble.Store.$purchaseErrorTip.off("click", ".smallBlueBtn");
                Scrabble.Store.$purchaseErrorTip.on("click", ".smallBlueBtn", function() {
                    Scrabble.SoundManager.play_sfx("Generic_btn");
                    Scrabble.Store.purchaseItem(o);
                    Scrabble.Store._hideLegalTip()
                });
                Scrabble.Store.tempItem = null
            }
        },getItemByType: function(q) {
            var o = 0;
            for (o; o < Scrabble.Store.storeItems.length; o++) {
                if (Scrabble.Store.storeItems[o].type == q) {
                    return Scrabble.Store.storeItems[o]
                }
            }
            return null
        },successTipBlink: function() {
            Scrabble.SoundManager.play_sfx("Chat_Chimes");
            Scrabble.Store.$purchaseSuccessTip.show();
            Scrabble.Store.$purchaseSuccessTip.fadeTo(1, 1);
            setTimeout(Scrabble.Store.hideSuccessTip, 1500)
        },hideSuccessTip: function() {
            Scrabble.Store.$purchaseSuccessTip.fadeTo(300, 0, function() {
                $(this).hide()
            })
        },toggleTOS: function() {
            Scrabble.Store.tosChecked = !Scrabble.Store.tosChecked;
            Scrabble.SoundManager.play_sfx("Generic_btn");
            setTimeout(function() {
                Scrabble.Store.$legalTip.fadeTo(100, 0, function() {
                    $(this).hide();
                    Scrabble.Store._fbPurchase(m)
                })
            }, 150)
        },showTOS: function() {
            var q = window.open();
            var o = (Scrabble.config._branding == "hasbro") ? "US" : "WW";
            q.location = "http://tos.ea.com/legalapp/DSA/" + o + "/" + Scrabble.config.lang + "/PC/Scrabble"
        },purchaseCoins: function(r) {
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.Store._hideLegalTip();
            var o = Scrabble.Store.findItem(r);
            if (o != null) {
                if (Scrabble.Store.tosChecked == true) {
                    Scrabble.Store._fbPurchase(o)
                } else {
                    Scrabble.Store.$legalTip.show();
                    m = o;
                    var q = $(r.currentTarget).offset().top - 120;
                    var s = Math.min(q, 504);
                    $("#legalTOSPopup").css("top", s)
                }
            }
            if (r.stopPropagation) {
                r.stopPropagation()
            }
            window.event.cancelBubble = true
        },_hideLegalTip: function() {
            if (Scrabble.Store.$legalTip) {
                Scrabble.Store.$legalTip.hide();
                Scrabble.Store.$purchaseSuccessTip.hide();
                Scrabble.Store.$purchaseErrorTip.hide()
            }
        },_fbPurchase: function(o) {
            if (Scrabble.Store.sessionId == "") {
            }
            m = null;
            FB.ui({method: "pay",action: "buy_item",order_info: '{"itemId":' + o.id + ',"sessionId":"' + Scrabble.Store.sessionId + '","price":' + o.price + ',"currency":"' + Scrabble.Store.userCurrency + '"}',dev_purchase_params: {oscif: true}}, function(q) {
                Scrabble.Store.coinPurchaseHandler(o, q)
            })
        },showPreview: function(r) {
            h = Scrabble.Store.scrollApi.getPercentScrolledY();
            Scrabble.SoundManager.play_sfx("Generic_btn");
            Scrabble.Store._hideLegalTip();
            var o = Scrabble.Store.findItem(r);
            if (o != null) {
                if (o.meta.facebook.preview != undefined) {
                    Scrabble.Store.scrollApi.scrollToPercentY(0);
                    $(".storePopupTitle").html(Scrabble.Dictionary.translate("ITEMPR_BTN_STRMNMNU"));
                    Scrabble.Store.$storePopup.off("click", "#storeBackButton");
                    Scrabble.Store.$storePopup.on("click", "#storeBackButton", function() {
                        Scrabble.Store.displayPage(d, true, o)
                    });
                    $("#storeGetCoinsButton").show();
                    $("#storeBackButton").show();
                    Scrabble.Store.ListDOM.html(Scrabble.DomBuilder.buildStorePreview(o));
                    var s = "store";
                    if (o.price == -1 || o.type == "toyota2013") {
                        s = "toyota"
                    }
                    var q = {subtype1: s,subtype2: "navigation"};
                    q.data = JSON.stringify({itemName: o.name,itemPrice: o.price});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "preview_item", q);
                    $(".storeItemPreview").load(Scrabble.Store.centerPreviewImage)
                }
            }
            if (r.stopPropagation != undefined) {
                r.stopPropagation();
                window.event.cancelBubble = true
            }
        },findItem: function(s) {
            if (s.meta == undefined) {
                var o = $(s.currentTarget);
                if (!o.hasClass("storeItemContainer")) {
                    o = o.parent()
                }
                var q = null;
                for (var r = 0; r < Scrabble.Store.storeItems.length; r++) {
                    if (Scrabble.Store.storeItems[r].id == o.data("storeitemid")) {
                        q = Scrabble.Store.storeItems[r];
                        break
                    }
                }
                return q
            }
            return s
        },defaultTileset: function() {
            for (var o = 0; o < Scrabble.Store.storeItems.length; o++) {
                if (Scrabble.Store.storeItems[o].type == "def" && Scrabble.Store.storeItems[o].category == "tileSet") {
                    return Scrabble.Store.storeItems[o]
                }
            }
            console.error("Could not find default tilset")
        },defaultBoard: function() {
            for (var o = 0; o < Scrabble.Store.storeItems.length; o++) {
                if (Scrabble.Store.storeItems[o].type == "def" && Scrabble.Store.storeItems[o].category == "board") {
                    return Scrabble.Store.storeItems[o]
                }
            }
            console.error("Could not find default board")
        },coinPurchaseHandler: function(r, q) {
            if (q.order_id && q.status === "settled") {
                if (r.meta && r.meta.defaultValue) {
                    a += parseInt(r.meta.defaultValue);
                    Scrabble.Store.updateWalletInfo();
                    var o = {subtype1: "store",subtype2: "shopping",subtype3: "action"};
                    o.data = JSON.stringify({packageName: r.name,coinsAdded: r.meta.defaultValue,realValue: r.price});
                    Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "package_purchase", o);
                    return true
                }
            } else {
                if (q.error_code || q.status === "canceled") {
                    Scrabble.Store.showErrorTip(r)
                } else {
                    Scrabble.Store.showErrorTip(r)
                }
            }
            var o = {subtype1: "store",subtype2: "shopping",subtype3: "action"};
            o.data = JSON.stringify({packageName: r.name,facebookMessage: q.error_message || "fatal error"});
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, "cancel_purchase", o)
        },showErrorTip: function(o) {
            Scrabble.SoundManager.play_sfx("Cancel");
            Scrabble.Store.$purchaseErrorTip.show();
            Scrabble.Store.$purchaseErrorTip.off("click", ".smallBlueBtn");
            Scrabble.Store.$purchaseErrorTip.on("click", ".smallBlueBtn", function() {
                Scrabble.Store.purchaseCoins(o);
                Scrabble.Store._hideLegalTip()
            })
        },showItems: function() {
            $("#storeGetCoinsButton").show();
            $("#storeBackButton").hide();
            $("#storeBalance").css("left", "0px");
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StoreSyncComplete, Scrabble.Store.refreshView);
            Scrabble.Store.$storePopup.off("click", "#storeGetCoinsButton");
            Scrabble.Store.$storePopup.on("click", "#storeGetCoinsButton", function() {
                Scrabble.Store.displayPage(k, "button")
            });
            Scrabble.Store.$storePopup.off("click", "#storeBackButton");
            Scrabble.Store.$storePopup.off("click", ".storeItemActionBtn");
            Scrabble.Store.$storePopup.off("click", ".storeLockedItem");
            Scrabble.Store.$storePopup.on("click", ".storeLockedItem", Scrabble.Store.showLocked);
            Scrabble.Store.$storePopup.on("click", ".storeItemActionBtn", Scrabble.Store.purchaseItem);
            Scrabble.Store.$storePopup.off("click", ".storeChkBoxItem", Scrabble.QuestPopup.toggleToyota);
            Scrabble.Store.$storePopup.on("click", ".storeChkBoxItem", Scrabble.QuestPopup.toggleToyota)
        },showLocked: function(q) {
            if (Date.fromISO(Scrabble.QuestPopup.toyotaEndDate) > (new Date())) {
                var o = Scrabble.Store.findItem(q);
                if (o != null) {
                    Scrabble.QuestPopup.set("Toyota", 3, o);
                    Scrabble.QuestPopup.show()
                }
            }
            q.stopPropagation();
            window.event.cancelBubble = true
        },showCoins: function(o, r) {
            $("#storeGetCoinsButton").hide();
            $("#storeBackButton").show();
            $("#storeBalance").css("left", "50px");
            Scrabble.EventManager.bindEvent(Scrabble.SystemEvents.StoreSyncComplete, Scrabble.Store.refreshView);
            Scrabble.Store.$storePopup.off("click", "#storeGetCoinsButton");
            Scrabble.Store.$storePopup.off("click", "#storeBackButton");
            Scrabble.Store.$storePopup.on("click", "#storeBackButton", function() {
                Scrabble.Store.displayPage(d)
            });
            Scrabble.Store.$storePopup.off("click", ".storeItemActionBtn");
            Scrabble.Store.$storePopup.on("click", ".storeItemActionBtn", Scrabble.Store.purchaseCoins);
            var q = {subtype1: "store",subtype2: "shopping",subtype3: "more_coins"};
            if (r != null) {
                q.data = JSON.stringify({itemName: r.name,itemPrice: r.price})
            }
            Scrabble.TelemetryManager.trackEvent(Scrabble.config.fbId, o, q)
        },refreshSingleItem: function(q) {
            var o = Scrabble.Store.$storePopup.find('[data-storeItemId="' + q.id + '"]');
            if (o.hasClass("storeItemPreviewContainer")) {
                o.replaceWith(Scrabble.DomBuilder.buildStorePreview(q));
                $(".storeItemPreview").load(Scrabble.Store.centerPreviewImage)
            } else {
                o.replaceWith(Scrabble.DomBuilder.buildStoreItem(q))
            }
        },refreshView: function() {
            Scrabble.Store.ListDOM.html("");
            for (var o = 0; o < Scrabble.Store.storeItems.length; o++) {
                if (e[g].indexOf(Scrabble.Store.storeItems[o].category) != -1 && Scrabble.Store.storeItems[o].hidden !== true) {
                    Scrabble.Store.ListDOM.append(Scrabble.DomBuilder.buildStoreItem(Scrabble.Store.storeItems[o]))
                }
            }
            setTimeout(Scrabble.Store.scrollList.data("jsp").reinitialise, 100)
        },centerPreviewImage: function() {
            var q = $(".storeItemPreview");
            var o = q.width();
            var s = q.parent().width();
            var r = (s - o) / 2;
            q.css("marginLeft", r + "px");
            q.parent().css("height", (parseInt(q.height()) + 30) + "px");
            setTimeout(Scrabble.Store.scrollList.data("jsp").reinitialise, 100);
            setTimeout(function() {
                Scrabble.Store.scrollApi.scrollToPercentY(0)
            }, 101)
        }}
}();
Scrabble.StoreSynchronizer = function() {
    var a = "proxy/store/rest/store/", c = "proxy/local/rest/", b = "proxy/store/rest/store/", f = "rest/store/price/", g = true, d = -1, j = null, e = null, h = -1;
    return {refreshed: 0,sentReq: 0,sync: function(l) {
            console.log("Sync begins for " + l);
            Scrabble.StoreSynchronizer.sentReq++;
            var k = ";jsessionid=" + Scrabble.Store.sessionId;
            if (l == "purchase") {
                k += "?type=board&type=tileSet&type=adRemoval&tntId=" + Scrabble.config.tntId
            } else {
                if (l == "item") {
                    k += "?state=active&state=" + Scrabble.config._branding
                }
            }
            Scrabble.StoreSynchronizer._get(l, a, k)
        },getTNTUser: function() {
            Scrabble.StoreSynchronizer._get("user", c, ("?facebookId=" + Scrabble.config.fbId + "&accessCode=" + Scrabble.config.accessToken))
        },logoutTNTUser: function() {
            Scrabble.StoreSynchronizer._get("user", c, ("/1/!logout"))
        },getPrices: function(m) {
            Scrabble.StoreSynchronizer.sentReq++;
            var l = "";
            for (var k = 0; k < m.length; k++) {
                l += "&itemKey=" + m[k].id
            }
            Scrabble.StoreSynchronizer._get("price", b, (";jsessionid=" + Scrabble.Store.sessionId + "?localCurrency=USD" + l))
        },postItemPurchase: function(k) {
            Scrabble.StoreSynchronizer._post("purchase", a, ";jsessionid=" + Scrabble.Store.sessionId, k)
        },_post: function(o, n, k, l) {
            l = l || {};
            k = k || "";
            Scrabble.StoreSynchronizer[o + "PostCallStatus"] = "sent";
            var m = $.ajax({url: Scrabble.config._storeProxyUrl + n + o + k,dataType: "jsonp",cache: false,crossDomain: true,contentType: "application/javascript; charset=utf-8",type: "POST",jsonp: "callback",timeout: 31000,data: {tntId: Scrabble.config.tntId,itemKey: l.id,priceKey: l.priceId,_method: "POST","X-facebookId": Scrabble.config.fbId},jsonpCallback: "Scrabble.StoreSynchronizer.p" + o.capitalize()});
            m.error(function(q) {
                if (Scrabble.StoreSynchronizer[o + "PostCallStatus"] != null) {
                    if (o == "purchase") {
                        Scrabble.Store.itemPurchaseError()
                    }
                }
            })
        },_get: function(s, q, k) {
            var m, n, r = [];
            k = k || "";
            Scrabble.StoreSynchronizer[s + "CallStatus"] = "sent";
            if (g && s != "user" && s != "purchase") {
                if (j == null) {
                    n = Scrabble.LocalStorageManager.get("clientLastUpdate");
                    if (n == null) {
                        n = 0
                    }
                    j = n
                }
                if (j == d) {
                    n = Scrabble.LocalStorageManager.get("store_" + s);
                    if (JSON.parse(n) != null) {
                        console.log(s + " found in localStorage");
                        r = JSON.parse(n);
                        Scrabble.StoreSynchronizer["g" + s.capitalize()](r);
                        return true
                    }
                }
            }
            if (g && s == "purchase") {
                if (e == null) {
                    n = Scrabble.LocalStorageManager.get("clientLastPurchase");
                    if (n == null) {
                        n = 0
                    }
                    e = n
                }
                if (e == h) {
                    n = Scrabble.LocalStorageManager.get("store_" + s);
                    if (JSON.parse(n) != null) {
                        console.log(s + " found in localStorage");
                        r = JSON.parse(n);
                        Scrabble.StoreSynchronizer["g" + s.capitalize()](r);
                        return true
                    }
                }
            }
            var l = "&";
            if (k.indexOf("?") == -1) {
                l = "?"
            }
            var o = $.ajax({url: Scrabble.config._storeProxyUrl + q + s + k + l + "X-facebookId=" + Scrabble.config.fbId,dataType: "jsonp",crossDomain: true,contentType: "application/javascript; charset=utf-8",cache: false,jsonp: "callback",timeout: 31000,jsonpCallback: "Scrabble.StoreSynchronizer.g" + s.capitalize()});
            o.error(function(t) {
                if (Scrabble.StoreSynchronizer[s + "CallStatus"] != null) {
                    if (s == "user") {
                        $("#boardSkinSelectorBtn").hide();
                        m = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_TTL"),message: Scrabble.Dictionary.translate("STR_TXT_STRUNVILBL"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "FCBK_BTN_GMLMTRCHD_OK"}}};
                        Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(m));
                        Scrabble.Store.hide()
                    } else {
                        if (s == "purchase") {
                            Scrabble.StoreSynchronizer.gPurchase([])
                        } else {
                            if (s == "price") {
                                if (t.status == 0 && t.statusText == "timeout") {
                                    m = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_TTL"),message: Scrabble.Dictionary.translate("STR_TXT_CRC_NTSPPRTD"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "FCBK_BTN_GMLMTRCHD_OK"}}};
                                    Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(m));
                                    $("#boardSkinSelectorBtn").hide();
                                    Scrabble.Store.hide()
                                }
                            }
                        }
                    }
                }
            })
        },gCategory: function(m) {
            Scrabble.StoreSynchronizer.categoryCallStatus = null;
            var k = {};
            Scrabble.StoreSynchronizer.refreshed++;
            if (m.length) {
                for (var l = 0; l < m.length; l++) {
                    k[m[l].key] = {type: m[l].type,value: m[l].value}
                }
            }
            Scrabble.Store.updateCategories(k);
            if (g) {
                Scrabble.LocalStorageManager.set("store_category", JSON.stringify(m))
            }
        },gItem: function(m) {
            Scrabble.StoreSynchronizer.itemCallStatus = null;
            var k = [];
            Scrabble.StoreSynchronizer.refreshed++;
            if (m.length) {
                for (var l = 0; l < m.length; l++) {
                    if (jsonpParse(m[l].metadata) != false) {
                        k.push({category: m[l].categoryKey,description: m[l].description,meta: jsonpParse(m[l].metadata),purchased: false,equiped: false,parsed: false,name: m[l].name,order: m[l].itemOrder,type: m[l].type,state: m[l].state,id: m[l].key,price: 0,priceId: 0})
                    }
                }
            }
            Scrabble.Store.updateItems(k);
            if (g) {
                Scrabble.LocalStorageManager.set("store_item", JSON.stringify(m))
            }
        },gPrice: function(m) {
            Scrabble.StoreSynchronizer.priceCallStatus = null;
            var k = [];
            Scrabble.StoreSynchronizer.refreshed++;
            if (m.length) {
                for (var l = 0; l < m.length; l++) {
                    if (m[l].userCurrency != null) {
                        Scrabble.Store.userCurrency = m[l].userCurrency
                    }
                    k.push({itemId: m[l].itemKey,value: m[l].localValue || m[l].value,id: m[l].key,currency: m[l].currency})
                }
            }
            Scrabble.Store.updatePrices(k);
            if (g) {
                Scrabble.LocalStorageManager.set("store_price", JSON.stringify(m))
            }
        },gPurchase: function(m) {
            Scrabble.StoreSynchronizer.purchaseCallStatus = null;
            var k = [];
            Scrabble.StoreSynchronizer.refreshed++;
            if (m != undefined) {
                if (m.length == undefined) {
                    m = [m]
                }
            }
            for (var l = 0; l < m.length; l++) {
                k.push({id: m[l].itemKey,expiration: m[l].expirationDate})
            }
            Scrabble.Store.updatePurchases(k);
            if (g) {
                Scrabble.LocalStorageManager.set("store_purchase", JSON.stringify(m));
                Scrabble.LocalStorageManager.set("clientLastPurchase", h)
            }
        },pPurchase: function(k) {
            Scrabble.StoreSynchronizer.purchasePostCallStatus = null;
            Scrabble.Store.finishItemPurchase(k);
            if (g) {
                e = "-1"
            }
            Scrabble.StoreSynchronizer.sentReq++;
            Scrabble.StoreSynchronizer._get("purchase", a, ("/" + k + ";jsessionid=" + Scrabble.Store.sessionId + "?tntId=" + Scrabble.config.tntId + "&facebookId=" + Scrabble.config.fbId))
        },gUser: function(k) {
            Scrabble.StoreSynchronizer.userCallStatus = null;
            Scrabble.config.tntId = k.tntId;
            Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.TNTUserReceived);
            if (k.sessionId != null) {
                Scrabble.Store.sessionId = k.sessionId
            }
            if (g) {
                d = k.lastStoreUpdateDate;
                if (k.lastPurchaseDate != undefined) {
                    h = k.lastPurchaseDate
                } else {
                    h = 0
                }
            }
            Scrabble.TelemetryManager.sendUserInformation("tnt");
            Scrabble.Store.init();
            if (Scrabble.config._branding == "hasbro") {
                Scrabble.QuestPopup.checkCurrentChallenges()
            } else {
                Scrabble.QuestPopup.removeToyotaKit()
            }
            Scrabble.Store.updateWalletInfo(k.scrabbleCash);
            $("#boardSkinSelectorBtn").show()
        },saveLastUpdate: function() {
            if (g) {
                Scrabble.LocalStorageManager.set("clientLastUpdate", d)
            }
        },forceUpdate: function(l) {
            var m = h, k = d;
            h = -2;
            d = -2;
            Scrabble.StoreSynchronizer.sync(l);
            h = m;
            d = k
        }}
}();
Scrabble.PopupTester = function() {
    return {popupList: {Update: function() {
                var c = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLUPDT_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLUPDT_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },NotLoading: function() {
                var c = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLNTLDNG_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_SCRBBLNTLDNG_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },ProfileNotLoading: function() {
                var c = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTLDNG_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTLDNG_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },ProfileNotCompleted: function() {
                title = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTCMPLTD_TTL");
                message = Scrabble.Dictionary.translate("FCBK_TXT_PRFLNTCMPLTD_MSG");
                var a = {type: "noticePopup",title: title,message: message,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },MayhemError: function() {
                title = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_TTL");
                message = Scrabble.Dictionary.translate("FCBK_TXT_MYHMERRR_MSG");
                var a = {type: "noticePopup",title: title,message: message,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },FriendsNotLoading: function() {
                var c = Scrabble.Dictionary.translate("FCBK_TXT_FRNDSLSTNTLDNG_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_FRNDSLSTNTLDNG_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },DeleteError: function() {
                var c = Scrabble.Dictionary.translate("FCBK_TXT_DLTMTCHERRR_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_DLTMTCHERRR_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },CreateError: function() {
                var a = {type: "noticePopup",title: Scrabble.Dictionary.translate("FCBK_TXT_CRTMTCHERRR_TTL"),message: Scrabble.Dictionary.translate("FCBK_TXT_CRTMTCHERRR_MSG"),diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            },ServerCommunicationError: function() {
                var c = Scrabble.Dictionary.translate("GSCNPP_TXT_INVLDPLY_TTL");
                var b = Scrabble.Dictionary.translate("FCBK_TXT_CNNTCHCKWRD_MSG");
                var a = {type: "noticePopup",title: c,message: b,diag: {ok: {action: Scrabble.UserEvents.PopupOKClicked,label: "GSCNPP_BTN_EXCHNGNTAVAL_CLS"}}};
                return a
            }},showAllPopups: function() {
            for (var a in Scrabble.PopupTester.popupList) {
                Scrabble.PopupManager.add(Scrabble.PopupFactory.genericPopup(Scrabble.PopupTester.popupList[a]()))
            }
        }}
}();
Scrabble.Dictionary = function() {
    var b = 0;
    var a = 1;
    var e = 2;
    var d = 3;
    var c = 4;
    return {lang: b,translate: function(h, j) {
            var g = "";
            if (dictionary[h] != undefined) {
                g = dictionary[h]
            } else {
                g = h
            }
            if (j != undefined) {
                for (var f in j) {
                    g = g.split(f).join(j[f])
                }
            }
            return g.split("\\n").join(" ")
        },batch: function(f) {
            var g = [];
            for (var h = 0; h < f.length; h++) {
                g.push(Scrabble.Dictionary.translate(f[h]))
            }
            return g.join(" ")
        }}
}();
Scrabble.ImageLoader = function() {
    return {nbImagesLoaded: 0,nbImagesToLoad: 0,loadStartTime: null,loadImages: function() {
            var e = new Date();
            var a = e.getTime();
            Scrabble.ImageLoader.loadStartTime = a;
            var f = Scrabble.config._cdnVersion + "/images/";
            var c = Scrabble.imgList;
            Scrabble.ImageLoader.nbImagesToLoad = c.length;
            for (var b = 0; b < Scrabble.ImageLoader.nbImagesToLoad; b++) {
                Scrabble.ImageLoader._loadImage(c[b].replace("./", f))
            }
        },_loadImage: function(e) {
            var a = new Image();
            var c = new Date();
            var b = c.getTime();
            $(a).load(function() {
                Scrabble.ImageLoader._incrementImagesLoaded()
            }).attr("src", e);
            $(a).error(function() {
                Scrabble.ImageLoader._incrementImagesLoaded();
                var d = new Date();
                var f = d.getTime();
                var g = f - b;
                Scrabble.TelemetryManager.gameLoad("fail", "assets", e, g)
            }).attr("src", e)
        },_incrementImagesLoaded: function() {
            Scrabble.ImageLoader.nbImagesLoaded++;
            if (Scrabble.ImageLoader.nbImagesLoaded == Scrabble.ImageLoader.nbImagesToLoad) {
                Scrabble.EventManager.dispatchEvent(Scrabble.SystemEvents.AssetsLoaded)
            }
        }}
}();
var Incrementor = function(d) {
    var c = parseInt(d.html());
    var b = d.innerHeight();
    d.html('<div class="incrementor"><span class="inc_currentVal">' + c + '</span><span class="inc_bufferVal">0</span></div>');
    var a = d.find(".incrementor");
    a.css("height", (b - 5) + "px");
    a.css("width", d.innerWidth() + "px");
    return {currentTarget: 0,currentSpeed: 0,isInverted: false,setValue: function(e, g, j) {
            var f = parseInt(a.find(".inc_currentVal").html());
            var h;
            if (f != e && !isNaN(f)) {
                this.currentTarget = e;
                if (this.currentTarget > f) {
                    h = "up";
                    this.currentSpeed = g / (this.currentTarget - f)
                } else {
                    h = "down";
                    this.currentSpeed = g / (f - this.currentTarget)
                }
                if (j) {
                    this.cb = j
                }
                this._doMove(f, h)
            }
            if (j) {
                setTimeout(j, g)
            }
        },_doMove: function(g, j) {
            var f = 0;
            var e = b;
            var h = this;
            if (j == "down") {
                f = g - 1;
                e = e * -1
            } else {
                f = g + 1
            }
            if (this.inverted == false) {
                this.inverted = true;
                a.find(".inc_bufferVal").css("top", e + "px");
                a.find(".inc_bufferVal").html(f);
                a.find(".inc_currentVal").animate({top: (e * -1) + "px"}, h.currentSpeed);
                a.find(".inc_bufferVal").animate({top: "0px"}, h.currentSpeed, "linear", function() {
                    if (h.currentTarget != f) {
                        h._doMove(f, j)
                    }
                });
                return
            } else {
                this.inverted = false;
                a.find(".inc_currentVal").css("top", e + "px");
                a.find(".inc_currentVal").html(f);
                a.find(".inc_bufferVal").animate({top: (e * -1) + "px"}, h.currentSpeed);
                a.find(".inc_currentVal").animate({top: "0px"}, h.currentSpeed, "linear", function() {
                    if (h.currentTarget != f) {
                        h._doMove(f, j)
                    }
                });
                return
            }
        }}
};
Scrabble.Ordinals = function() {
    return {getOrdinalIndicator: function(a) {
            lang = Scrabble.config.lang;
            if (lang == "en") {
                return Scrabble.Ordinals._calculateEnglish(a)
            } else {
                if (lang == "fr") {
                    return Scrabble.Ordinals._calculateFrench(a)
                } else {
                    if (lang == "de") {
                        return "."
                    } else {
                        if (lang == "it" || lang == "es" || lang == "pt") {
                            return ""
                        }
                    }
                }
            }
            return Scrabble.Ordinals._calculateEnglish(a)
        },_calculateEnglish: function(a) {
            a = a + "";
            last2Numbers = parseInt(a.slice(a.length - 2));
            if (last2Numbers >= 11 && last2Numbers <= 19) {
                return "th"
            }
            lastNumber = a.slice(a.length - 1);
            switch (lastNumber) {
                case "1":
                    return "st";
                    break;
                case "2":
                    return "nd";
                    break;
                case "3":
                    return "rd";
                    break;
                default:
                    return "th"
            }
        },_calculateFrench: function(a) {
            a = a + "";
            if (a == "1") {
                return "er"
            }
            return "e"
        }}
}();
var temp_idMap = null;
Array.prototype.compare = function(b) {
    if (this.length != b.length) {
        return false
    }
    for (var a = 0; a < b.length; a++) {
        if (this[a].compare) {
            if (!this[a].compare(b[a])) {
                return false
            }
        }
        if (this[a] !== b[a]) {
            return false
        }
    }
    return true
};
String.prototype.splice = function(a, c, b) {
    return (this.slice(0, a) + b + this.slice(a + Math.abs(c)))
};
if (Array.prototype.indexOf == undefined) {
    Array.prototype.indexOf = function(c) {
        var a = this.length;
        for (var b = 0; b < a; b++) {
            if (this[b] == c) {
                return b
            }
        }
        return -1
    }
}
Array.prototype.remove = function(c, b) {
    var a = this.slice((b || c) + 1 || this.length);
    this.length = c < 0 ? this.length + c : c;
    return this.push.apply(this, a)
};
String.prototype.capitalize = function() {
    if (typeof this == "string" || this instanceof String) {
        return this.charAt(0).toUpperCase() + this.slice(1)
    }
    return this
};
String.prototype.replaceAll = function(b, a, c) {
    if (typeof this == "string" || this instanceof String) {
        return this.replace(new RegExp(b.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g, "\\$&"), (c ? "gi" : "g")), (typeof (a) == "string") ? a.replace(/\$/g, "$$$$") : a)
    }
    return this
};
function clone(c) {
    if (c == null || typeof (c) != "object") {
        return c
    }
    var a = new c.constructor();
    for (var b in c) {
        a[b] = clone(c[b])
    }
    return a
}
function updateIdMap(a, d, c) {
    if (Scrabble.LocalStorageManager.localStorageEnabled) {
        if (temp_idMap == null) {
            temp_idMap = Scrabble.LocalStorageManager.get("idMap")
        }
        if (temp_idMap == undefined) {
            temp_idMap = {}
        } else {
            if (typeof temp_idMap === "string") {
                temp_idMap = JSON.parse(temp_idMap)
            }
        }
        if (temp_idMap[a] == undefined) {
            temp_idMap[a] = {}
        }
        if (typeof (d) == "string") {
            temp_idMap[a][d] = c
        } else {
            for (var b in d) {
                temp_idMap[a][b] = d[b]
            }
        }
        try {
            Scrabble.LocalStorageManager.set("idMap", JSON.stringify(temp_idMap))
        } catch (f) {
        }
    }
}
function advUpdateIdMap(c) {
    if (Scrabble.LocalStorageManager.localStorageEnabled) {
        if (temp_idMap == null) {
            temp_idMap = Scrabble.LocalStorageManager.get("idMap")
        }
        if (temp_idMap == undefined) {
            temp_idMap = {}
        } else {
            if (typeof temp_idMap === "string") {
                temp_idMap = JSON.parse(temp_idMap)
            }
        }
        for (var a in c) {
            temp_idMap[a] = c[a]
        }
        try {
            Scrabble.LocalStorageManager.set("idMap", JSON.stringify(temp_idMap))
        } catch (b) {
        }
    }
}
function lookupIdMap(a, c) {
    if (Scrabble.LocalStorageManager.localStorageEnabled) {
        if (temp_idMap == null) {
            temp_idMap = Scrabble.LocalStorageManager.get("idMap")
        }
        if (temp_idMap == undefined) {
            return null
        } else {
            if (typeof temp_idMap === "string") {
                temp_idMap = JSON.parse(temp_idMap)
            }
        }
        if (a == "*") {
            return temp_idMap
        }
        if (temp_idMap[a] != undefined) {
            var b = null;
            if (c == "*") {
                b = temp_idMap[a]
            } else {
                b = temp_idMap[a][c]
            }
            return b
        }
    }
    return null
}
function getDayDifference(a) {
    return Math.round((a - (new Date())) / (1000 * 60 * 60 * 24))
}
function trimName(d, c, a) {
    if (c == undefined || c == "") {
        c = String(d).split(" ", 2)[1];
        d = String(d).split(" ", 2)[0];
        if (c == undefined) {
            c = ""
        }
    }
    var b = d + " " + c;
    if (a == undefined) {
        a = 100
    }
    if (b.length > a) {
        if (d.length > a - 5) {
            d = String(d).split("-")[0];
            if (d.length > a) {
                if (d.length > a + 2) {
                    b = String(d).substring(0, a) + "..."
                } else {
                    b = String(d).substring(0, a + 2)
                }
            } else {
                if (c != "") {
                    b = d + " " + (String(c).substring(0, 1).toUpperCase() + "...");
                    if (b.length > a) {
                        b = d
                    }
                } else {
                    b = d
                }
            }
        } else {
            if (c != "") {
                b = d + " " + (String(c).substring(0, 1).toUpperCase() + "...");
                if (b.length > a) {
                    b = d
                }
            } else {
                b = d
            }
        }
    }
    return b
}
function jsonpParse(b) {
    var a = {};
    if (b != "") {
        try {
            a = JSON.parse(String(b))
        } catch (c) {
            console.error("could not parse " + b);
            return false
        }
    }
    return a
}
function urlEncode(c) {
    var a = [];
    for (var b in c) {
        a[a.length] = b + "=" + c[b]
    }
    return a.join("&")
}
function unParse(a) {
    return a.substring(0, a.length - 2)
}
function getTimeAgo(f, b) {
    var c;
    var h;
    if (f == "now") {
        h = {day: 0,hour: 0,min: 0,sec: 0}
    } else {
        c = f.split(":");
        h = {day: c[0],hour: c[1],min: c[2],sec: c[3]}
    }
    var g = 0;
    var d;
    var a;
    for (var e in h) {
        d = h[e];
        if (d > 0) {
            a = (d > 1) ? true : false;
            switch (e) {
                case "day":
                    if (b) {
                        if (d > 14) {
                            return Scrabble.Dictionary.translate("MYGM_TXT_SGGSTDFRNDSCRD_TMAGOMX  ")
                        } else {
                            return Scrabble.Dictionary.translate("FCBK_LBL_FRCFRFTPP_LSTPLYD_DYS", {"[TIME]": d})
                        }
                    } else {
                        if (a) {
                            return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_DYS", {"[TIME]": d})
                        } else {
                            return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_ONEDY", {"[TIME]": d})
                        }
                    }
                    break;
                case "hour":
                    if (b) {
                        return Scrabble.Dictionary.translate("FCBK_TXT_NDGPP_LSTPLYD_HRS", {"[TIME]": d})
                    } else {
                        if (a) {
                            return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_HRS", {"[TIME]": d})
                        } else {
                            return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_ONEHR", {"[TIME]": d})
                        }
                    }
                    break;
                case "min":
                    if (a) {
                        return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_MINS", {"[TIME]": d})
                    } else {
                        return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_ONEMIN", {"[TIME]": d})
                    }
                    break;
                case "sec":
                    if (a) {
                        return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_SCNDS", {"[TIME]": d})
                    } else {
                        return Scrabble.Dictionary.translate("FCBK_TXT_GMCRD_TMAGO_ONESCND", {"[TIME]": d})
                    }
                    break
            }
        }
        if (g == 3) {
            return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_TMAGOJSTNW")
        }
        g++
    }
}
function getTimeLeft(b) {
    var a = b.split(":");
    var c = {day: a[0],hour: a[1],min: a[2],sec: a[3]};
    if ((parseInt(c.day) / 30) >= 1) {
        return Math.floor(parseInt(c.day) / 30) + " " + convert("month") + "left"
    }
    if ((parseInt(c.day) / 7) >= 1) {
        return Math.floor(parseInt(c.day) / 7) + " " + convert("week") + "left"
    }
    if (parseInt(c.day) > 1) {
        return parseInt(c.day) + " " + convert("day") + "left"
    } else {
        return "1 " + convert("day") + "left"
    }
}
function getTimeFromTimeAgo(j) {
    if (j == "now") {
        if (Scrabble.config.lang == "en") {
            return j
        } else {
            return "maintenant"
        }
    } else {
        var l = j.split(":");
        var h = {day: l[0],hour: l[1],minute: l[2],second: l[3]};
        var k = 0;
        k += parseInt(h.second) * 1000;
        k += parseInt(h.minute) * 60000;
        k += parseInt(h.hour) * 3600000;
        k += parseInt(h.day) * 86400000;
        var b = new Date();
        b = b.getTime();
        var a = new Date(b - k);
        var d = a.getHours();
        var g;
        if (d > 11) {
            d = d - 12;
            if (d < 10) {
                d = "0" + d
            }
            g = "PM"
        } else {
            if (d < 10) {
                d = "0" + d
            }
            g = "AM"
        }
        var f = a.getDate();
        if (f < 10) {
            f = "0" + f
        }
        var e = a.getMonth();
        if (e < 10) {
            e = "0" + e
        }
        var c = a.getMinutes();
        if (c < 10) {
            c = "0" + c
        }
        return a.getFullYear() + "-" + e + "-" + f + " " + d + ":" + c + g
    }
}
function isInPcent(b) {
    var a = b.substring(b.length - 2);
    if (parseInt(a) > Scrabble.config.bPcent) {
        return false
    }
    return true
}
function getLastActivityDate(d) {
    if (d == null) {
        return new Date()
    }
    var c = d.split(":");
    var e = {day: c[0],hour: c[1],minute: c[2],second: c[3]};
    var a = 0;
    a += parseInt(e.second) * 1000;
    a += parseInt(e.minute) * 60000;
    a += parseInt(e.hour) * 3600000;
    a += parseInt(e.day) * 86400000;
    var b = new Date();
    b = b.getTime();
    return new Date(b - a)
}
function getIfPreHtmlUser(b) {
    var a = getLastActivityDate(b);
    console.warn(a.getFullYear() + " " + (a.getMonth() + 1) + " " + a.getDate() + " " + a.getHours());
    if (a.getFullYear() > 2012) {
        return false
    } else {
        if (a.getFullYear() == 2012) {
            if (a.getMonth() + 1 > 6) {
                return false
            } else {
                if (a.getMonth() + 1 == 6) {
                    if (a.getDate() > 26) {
                        return false
                    } else {
                        if (a.getDate() == 26) {
                            if (a.getHours() >= 12) {
                                return false
                            }
                        }
                    }
                }
            }
        }
    }
    return true
}
function getTextualTimeFromTimeAgo(j) {
    if (j == "now") {
        return Scrabble.Dictionary.translate("MENU_TXT_GMCRD_TMAGOJSTNW")
    } else {
        var l = j.split(":");
        var h = {day: l[0],hour: l[1],minute: l[2],second: l[3]};
        var k = 0;
        k += parseInt(h.second) * 1000;
        k += parseInt(h.minute) * 60000;
        k += parseInt(h.hour) * 3600000;
        k += parseInt(h.day) * 86400000;
        var b = new Date();
        b = b.getTime();
        var a = new Date(b - k);
        var d = a.getHours();
        var g;
        if (d > 11) {
            if (d > 12) {
                d = d - 12
            }
            g = "PM"
        } else {
            g = "AM"
        }
        var f = a.getDate();
        if (f < 10) {
            f = "0" + f
        }
        var e = a.getMonth();
        switch (e) {
            case 0:
                e = ["Jan.", "Jan.", "Gen", "Jan.", "Ene", "Jan."];
                break;
            case 1:
                e = ["Feb.", "F&eacute;v.", "Feb", "Feb.", "Feb", "Fev."];
                break;
            case 2:
                e = ["Mar.", "Mars", "Mar", "M&auml;r.", "Mar", "Mar."];
                break;
            case 3:
                e = ["Apr.", "Avr.", "Apr", "Apr.", "Abr", "Abr."];
                break;
            case 4:
                e = ["May", "Mai", "Mag", "Mai", "May", "Mai."];
                break;
            case 5:
                e = ["Jun.", "Juin.", "Giu", "Jun.", "Jun", "Jun."];
                break;
            case 6:
                e = ["Jul.", "Jui.", "Lug", "Jul.", "Jul", "Jul."];
                break;
            case 7:
                e = ["Aug.", "Ao&ucirc;t", "Ago", "Aug.", "Ago", "Ago."];
                break;
            case 8:
                e = ["Sep.", "Sep.", "Set", "Sep.", "Sep", "Set."];
                break;
            case 9:
                e = ["Oct.", "Oct.", "Ott", "Okt.", "Oct", "Out."];
                break;
            case 10:
                e = ["Nov.", "Nov.", "Nov", "Nov.", "Nov", "Nov."];
                break;
            case 11:
                e = ["Dec.", "D&eacute;c.", "Dic", "Dez.", "Dic", "Dez."];
                break
        }
        var c = a.getMinutes();
        if (c < 10) {
            c = "0" + c
        }
        if (Scrabble.config.lang == "fr") {
            return f + " " + e[1] + ", " + d + ":" + c + " " + g
        } else {
            if (Scrabble.config.lang == "it") {
                return f + " " + e[2] + ", " + d + ":" + c + " " + g
            } else {
                if (Scrabble.config.lang == "de") {
                    return f + ". " + e[3] + ", " + d + ":" + c + " " + g
                } else {
                    if (Scrabble.config.lang == "es") {
                        return f + " de " + e[4] + ", " + d + ":" + c + " " + g
                    } else {
                        if (Scrabble.config.lang == "pt") {
                            return f + " " + e[5] + ", " + d + ":" + c + " " + g
                        } else {
                            (Scrabble.config.lang == "en")
                        }
                    }
                }
            }
        }
        return e[0] + " " + f + ", " + d + ":" + c + " " + g
    }
}
function parseWordData(b) {
    var d = b.split(":");
    d = d[1].split(";");
    var e, a = "";
    for (var c = 0; c < d.length - 1; c++) {
        e = d[c].split(",");
        a += e[3]
    }
    return a
}
function parseSignupDate(c) {
    var a = new Date(c);
    var b = a.getMonth();
    if (isNaN(b)) {
        a = new Date();
        b = a.getMonth()
    }
    switch (b) {
        case 0:
            b = ["Jan.", "Jan.", "Gen", "Jan.", "Ene", "Jan."];
            break;
        case 1:
            b = ["Feb.", "F&eacute;v.", "Feb", "Feb.", "Feb", "Fev."];
            break;
        case 2:
            b = ["Mar.", "Mars", "Mar", "M&auml;r.", "Mar", "Mar."];
            break;
        case 3:
            b = ["Apr.", "Avr.", "Apr", "Apr.", "Abr", "Abr."];
            break;
        case 4:
            b = ["May", "Mai", "Mag", "Mai", "May", "Mai."];
            break;
        case 5:
            b = ["Jun.", "Juin.", "Giu", "Jun.", "Jun", "Jun."];
            break;
        case 6:
            b = ["Jul.", "Jui.", "Lug", "Jul.", "Jul", "Jul."];
            break;
        case 7:
            b = ["Aug.", "Ao&ucirc;t", "Ago", "Aug.", "Ago", "Ago."];
            break;
        case 8:
            b = ["Sep.", "Sep.", "Set", "Sep.", "Sep", "Set."];
            break;
        case 9:
            b = ["Oct.", "Oct.", "Ott", "Okt.", "Oct", "Out."];
            break;
        case 10:
            b = ["Nov.", "Nov.", "Nov", "Nov.", "Nov", "Nov."];
            break;
        case 11:
            b = ["Dec.", "D&eacute;c.", "Dic", "Dez.", "Dic", "Dez."];
            break
    }
    if (Scrabble.config.lang == "fr") {
        return parseInt(a.getDate()) + " " + b[1] + " " + a.getFullYear()
    } else {
        if (Scrabble.config.lang == "it") {
            return parseInt(a.getDate()) + " " + b[2] + ", " + a.getFullYear()
        } else {
            if (Scrabble.config.lang == "de") {
                return parseInt(a.getDate()) + ". " + b[3] + " " + a.getFullYear()
            } else {
                if (Scrabble.config.lang == "es") {
                    return parseInt(a.getDate()) + " de " + b[4] + " de " + a.getFullYear()
                } else {
                    if (Scrabble.config.lang == "pt") {
                        return parseInt(a.getDate()) + " " + b[5] + " " + a.getFullYear()
                    } else {
                        return b[0] + " " + parseInt(a.getDate()) + ", " + a.getFullYear()
                    }
                }
            }
        }
    }
}
function dateToMilliseconds(b) {
    var d = b.split(":");
    var e = d[3];
    var c = d[2];
    var a = d[1];
    var f = d[0];
    return e * 1000 + c * 60000 + a * 3600000 + f * 86400000
}
function getMatchLeader(d) {
    var h = d.mmatchusers.matchuser;
    if (!h instanceof Array) {
        return false
    }
    var c = false, g, b;
    var f = h.length;
    for (var e = 0; e < f; e++) {
        var a = h[e];
        if (e == 0) {
            g = a.userscore;
            b = a.userid;
            continue
        }
        if (a.userscore > g) {
            c = true;
            g = a.userscore;
            b = a.userid
        }
        if (a.userscore < g) {
            c = true
        }
    }
    if (c) {
        return b
    } else {
        return false
    }
}
function parseErrorMessage(b) {
    var a;
    if (b) {
        if (b.reason == "WORD_NOT_IN_DICTIONARY") {
            if (b.words) {
                b.words = Scrabble.Dictionary.translate(b.words, {"}": "CH","[": "RR","]": "LL"});
                var c = b.words.split(";");
                if (c.length == 1) {
                    a = Scrabble.Dictionary.translate("GSCNPP_BTN_INVLDWRD_MSG1", {"[WORD]": c[0],"[WORDS_LIST]": getLocalizedDictionary()})
                } else {
                    if (c.length == 2) {
                        a = Scrabble.Dictionary.translate("GSCNPP_BTN_INVLDWRD_MSG2", {"[WORD]": c[0],"[WORD_2]": c[1],"[WORDS_LIST]": getLocalizedDictionary()})
                    } else {
                        a = Scrabble.Dictionary.translate("GSCNPP_BTN_INVLDWRD_MSG3", {"[WORD]": c[0],"[WORD_2]": c[1],"[WORD_3]": c[2],"[WORDS_LIST]": getLocalizedDictionary()})
                    }
                }
            } else {
                if (b.errormessage) {
                    a = b.errormessage + " " + Scrabble.Dictionary.translate("GSCNPP_TXT_WRDLST_INVLDMSG", {"[LANGUAGE]": getLocalizedDictionary()})
                } else {
                    a = Scrabble.Dictionary.translate(String(b.reason))
                }
            }
        } else {
            a = Scrabble.Dictionary.translate(String(b.reason))
        }
    } else {
        a = ScrabbleDictionary.translate("Server Error")
    }
    return a
}
function trimSecure(a) {
    return a.split("https").join("http")
}
function getLocalizedDictionary(d, b) {
    var c;
    if (d != undefined) {
        c = d
    } else {
        c = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
    }
    var a = {ENGLISH_TWL: "GSET_DDM_PSSNPLY_SET_WRDLSTTWL",ENGLISH_MW: "GSET_DDM_PSSNPLY_SET_WRDLSTMW",ENGLISH_COLLINS: "OPTNSPP_BTN_SLCTDCTNRY_CLLNS",FRENCH_FWL: "GSET_DDM_PSSNPLY_SET_WRDLSTFWL",ITALIAN: "GSET_DDM_PSSNPLY_SET_WRDLSTIWL",GERMAN: "GSET_DDM_PSSNPLY_SET_WRDLSTGWL",SPANISH: "GSET_DDM_PSSNPLY_SET_WRDLSTSWL",PORTUGUESE: "GSET_DDM_PSSNPLY_SET_WRDLSTPWL"};
    if (b === true) {
        a = {ENGLISH_TWL: "GSCNPP_TXT_WRDLST_TTL_TWL",ENGLISH_MW: "GSCNPP_TXT_WRDLST_TTL_MW",ENGLISH_COLLINS: "NGM_BTN_DCTNRY_COLLINS",FRENCH_FWL: "GSCNPP_TXT_WRDLST_TTL_FWL",ITALIAN: "GSCNPP_TXT_WRDLST_TTL_IWL",GERMAN: "GSCNPP_TXT_WRDLST_TTL_GWL",SPANISH: "GSCNPP_TXT_WRDLST_TTL_SWL",PORTUGUESE: "GSCNPP_TXT_WRDLST_TTL_PWL"}
    }
    return Scrabble.Dictionary.translate(a[c])
}
function getWordListDictionary(e) {
    var d;
    if (e != undefined) {
        d = e
    } else {
        d = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
    }
    var a = {ENGLISH_TWL: "NGM_BTN_DCTNRY_TWL",ENGLISH_MW: "NGM_BTN_DCTNRY_MW",ENGLISH_COLLINS: "NGM_BTN_DCTNRY_COLLINS",FRENCH_FWL: "NGM_BTN_DCTNRY_FWL",ITALIAN: "NGM_BTN_DCTNRY_ITLN",GERMAN: "NGM_BTN_DCTNRY_GRMN",SPANISH: "NGM_BTN_DCTNRY_SPNSH",PORTUGUESE: "NGM_BTN_DCTNRY_PWL"};
    var c;
    if (d == "ENGLISH_COLLINS") {
        var b = Scrabble.Dictionary.translate(a[d]);
        c = b.replace("(Collins)", '<img class="collinsImg" src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/collinsLogoDictionary.png"/>')
    } else {
        if (d == "FRENCH_FWL") {
            var b = Scrabble.Dictionary.translate(a[d]);
            c = b.replace("ODS", '<img src="' + Scrabble.config._cdnVersion + '/images/skins/skin_default/larousseLogoDictionary.png"/>')
        } else {
            c = Scrabble.Dictionary.translate(a[d])
        }
    }
    return c
}
function randomSort(e, c) {
    var d = Math.random() - 0.5;
    if (d < 0) {
        return -1
    }
    return 1
}
function simplifyText(a) {
    var b = a.toLowerCase();
    b = b.replace(new RegExp(/\s/g), "");
    b = b.replace(new RegExp(/[]/g), "a");
    b = b.replace(new RegExp(//g), "ae");
    b = b.replace(new RegExp(//g), "c");
    b = b.replace(new RegExp(/[]/g), "e");
    b = b.replace(new RegExp(/[]/g), "i");
    b = b.replace(new RegExp(//g), "n");
    b = b.replace(new RegExp(/[]/g), "o");
    b = b.replace(new RegExp(//g), "oe");
    b = b.replace(new RegExp(/[]/g), "u");
    b = b.replace(new RegExp(/[]/g), "y");
    b = b.replace(new RegExp(/\W/g), "");
    return b
}
function getLetterFromKey(a) {
    switch (a) {
        case 97:
            return "a";
            break;
        case 65:
            return "A";
            break;
        case 98:
            return "b";
            break;
        case 66:
            return "B";
            break;
        case 99:
            return "c";
            break;
        case 67:
            return "C";
            break;
        case 100:
            return "d";
            break;
        case 68:
            return "D";
            break;
        case 101:
            return "e";
            break;
        case 69:
            return "E";
            break;
        case 102:
            return "f";
            break;
        case 70:
            return "F";
            break;
        case 103:
            return "g";
            break;
        case 71:
            return "G";
            break;
        case 104:
            return "h";
            break;
        case 72:
            return "H";
            break;
        case 105:
            return "i";
            break;
        case 73:
            return "I";
            break;
        case 106:
            return "j";
            break;
        case 74:
            return "J";
            break;
        case 107:
            return "k";
            break;
        case 75:
            return "K";
            break;
        case 108:
            return "l";
            break;
        case 76:
            return "L";
            break;
        case 109:
            return "m";
            break;
        case 77:
            return "M";
            break;
        case 110:
            return "n";
            break;
        case 78:
            return "N";
            break;
        case 111:
            return "o";
            break;
        case 79:
            return "O";
            break;
        case 112:
            return "p";
            break;
        case 80:
            return "P";
            break;
        case 113:
            return "q";
            break;
        case 81:
            return "Q";
            break;
        case 114:
            return "r";
            break;
        case 82:
            return "R";
            break;
        case 115:
            return "s";
            break;
        case 83:
            return "S";
            break;
        case 116:
            return "t";
            break;
        case 84:
            return "T";
            break;
        case 117:
            return "u";
            break;
        case 85:
            return "U";
            break;
        case 118:
            return "v";
            break;
        case 86:
            return "V";
            break;
        case 119:
            return "w";
            break;
        case 87:
            return "W";
            break;
        case 120:
            return "x";
            break;
        case 88:
            return "X";
            break;
        case 121:
            return "y";
            break;
        case 89:
            return "Y";
            break;
        case 122:
            return "z";
            break;
        case 90:
            return "Z";
            break;
        default:
            return false
    }
}
function checkIfNewUser(b) {
    var a = new Date();
    var c = a.getTime();
    return (c - parseInt(b) > 1209600000) ? false : true
}
function convertToReadableNumber(d, a, e) {
    if (typeof a == "undefined") {
        a = true
    }
    if (typeof e == "undefined") {
        e = false
    }
    if (d == 0) {
        return 0
    }
    var b = (a == true) ? 2 : 0;
    var c;
    if (Scrabble.config.lang == "fr") {
        c = accounting.formatNumber(d, b, ".", ",")
    } else {
        c = accounting.formatNumber(d, b, ",", ".")
    }
    return c
}
function runDebugTask(a, b) {
    if (Scrabble.config._debug === true) {
        if (typeof b == "undefined") {
            b = ""
        }
        if (b == "") {
            a()
        } else {
            fbIdArray = b.split(",");
            if (fbIdArray.indexOf(Scrabble.config.fbId) != -1) {
                a()
            }
        }
    }
}
(function() {
    var a = new Date("2011-06-02T09:34:29+02:00");
    if (!a || +a !== 1307000069000) {
        Date.fromISO = function(e) {
            var c, h, g = /^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/, f = g.exec(e) || [];
            if (f[1]) {
                c = f[1].split(/\D/);
                for (var d = 0, b = c.length; d < b; d++) {
                    c[d] = parseInt(c[d], 10) || 0
                }
                c[1] -= 1;
                c = new Date(Date.UTC.apply(Date, c));
                if (!c.getDate()) {
                    return NaN
                }
                if (f[5]) {
                    h = (parseInt(f[5], 10) * 60);
                    if (f[6]) {
                        h += parseInt(f[6], 10)
                    }
                    if (f[4] == "+") {
                        h *= -1
                    }
                    if (h) {
                        c.setUTCMinutes(c.getUTCMinutes() + h)
                    }
                }
                return c
            }
            return NaN
        }
    } else {
        Date.fromISO = function(b) {
            return new Date(b)
        }
    }
})();
function isOlderThanDays(b, a) {
    if (b != null) {
        if (getDayDifference(Date.fromISO(b)) >= 7) {
            return true
        }
    }
    return false
}
var session_cache = {};
$("body").mousedown(function(a) {
    if (a.button == 1) {
        return false
    }
});
$(".botButton").mousedown(function(a) {
    return false
});
Scrabble.WordGameUtils = function() {
    return {wordGameIds: [301085943688, 246294385446337, 5520804123, 293881037311354, 221304301274258, 258658667501782, 119993908122830, 156606747788844, 346553312025184, 242847189126599, 176245792414572, 253870811339225, 100294126688207, 126065704103748],didReceiveWGFInformation: false,parseLikesWordGames: function(c) {
            var a = Scrabble.PlayerManager;
            Scrabble.WordGameUtils.didReceiveWGFInformation = true;
            for (var b = 0; b < c.length; b++) {
                a.playerList[c[b].uid].likesWordGames = true
            }
        }}
}();
Scrabble.imgList = ["./ad_bar_90.gif", "./cover.png", "./loadingCover_small.png", "./loadingWheel00.gif", "./loadingWheel01.gif", "./emoticons/emoticons.png", "./emoticons/emoticons_toyota.png", "./scrollBars/skin_default/sidebar00.png", "./scrollBars/skin_default/sidebar01.png", "./scrollBars/skin_default/sidebar02.png", "./scrollBars/skin_default/sidebar03.png", "./scrollBars/skin_default/sidebar04.png", "./scrollBars/skin_default/sidebar05.png", "./scrollBars/skin_default/sidebar06.png", "./scrollBars/skin_lightBlue/sidebar00.png", "./scrollBars/skin_lightBlue/sidebar01.png", "./scrollBars/skin_lightBlue/sidebar02.png", "./scrollBars/skin_lightBlue/sidebar03.png", "./scrollBars/skin_lightBlue/sidebar04.png", "./scrollBars/skin_lightBlue/sidebar05.png", "./scrollBars/skin_lightBlue/sidebar06.png", "./skins/skin_default/arrowHorizontal_combined.png", "./skins/skin_default/boardSelector04.png", "./skins/skin_default/boardSelectorPopup05.png", "./skins/skin_default/boardStrip.png", "./skins/skin_default/btnChatLoad00.png", "./skins/skin_default/btnMenu00.png", "./skins/skin_default/btnMenu01.png", "./skins/skin_default/btnMenu03.png", "./skins/skin_default/btnMenu05.png", "./skins/skin_default/btnMenu09.png", "./skins/skin_default/btnMenu17.png", "./skins/skin_default/btnMenuOnboarding.png", "./skins/skin_default/btnSlider04.png", "./skins/skin_default/btnSliderBG_combined.png", "./skins/skin_default/btnStoreInactive.png", "./skins/skin_default/btnStoreItems01.png", "./skins/skin_default/btnStoreItems02.png", "./skins/skin_default/chat00.png", "./skins/skin_default/chat01.png", "./skins/skin_default/chat02.png", "./skins/skin_default/chat03.png", "./skins/skin_default/chat04.png", "./skins/skin_default/chat05.png", "./skins/skin_default/chatBubble00.png", "./skins/skin_default/chatBubble01.png", "./skins/skin_default/chatBubble02.png", "./skins/skin_default/chatBubble03.png", "./skins/skin_default/chatBubble04.png", "./skins/skin_default/chatBubble05.png", "./skins/skin_default/chatPageIndicator00.png", "./skins/skin_default/chatPageIndicator01.png", "./skins/skin_default/collinsLogoDictionary.png", "./skins/skin_default/collinsLogoNewGame.png", "./skins/skin_default/createBtn.png", "./skins/skin_default/createDropDown02.png", "./skins/skin_default/createDropDown03.png", "./skins/skin_default/createFlags.png", "./skins/skin_default/createPopup.png", "./skins/skin_default/createX.png", "./skins/skin_default/dictionaryPopup00.png", "./skins/skin_default/dictionaryPopup01.png", "./skins/skin_default/dictionaryPopupTabs_combined.png", "./skins/skin_default/eogFrame00.png", "./skins/skin_default/gsBottomSeparator.png", "./skins/skin_default/gsHeader02.png", "./skins/skin_default/gsIconChat02.png", "./skins/skin_default/gsIconChat03.png", "./skins/skin_default/gsIconForceForfeit01.png", "./skins/skin_default/gsIconShopBadge.png", "./skins/skin_default/gsOnboading_s0.png", "./skins/skin_default/gsOnboading_s1.png", "./skins/skin_default/gsOnboading_s2.png", "./skins/skin_default/gsOnboarding17.png", "./skins/skin_default/gsStarGlow.png", "./skins/skin_default/larousseLogoDictionary.png", "./skins/skin_default/larousseLogoNewGame.png", "./skins/skin_default/leaderboardArrows_combined_fix.png", "./skins/skin_default/leaderboardBG00.png", "./skins/skin_default/leaderboardBG02.png", "./skins/skin_default/leaderboardBG03_fix.png", "./skins/skin_default/leaderboardBG04.png", "./skins/skin_default/leaderboardBG05.png", "./skins/skin_default/leaderboardBG08.png", "./skins/skin_default/leaderboardBG09.png", "./skins/skin_default/leaderboardBG10_fix.png", "./skins/skin_default/leaderboardBG11_fix.png", "./skins/skin_default/leaderboardBG12.png", "./skins/skin_default/leaderboardBG13.png", "./skins/skin_default/leaderboardBG14.png", "./skins/skin_default/leaderboardBG15_fix.png", "./skins/skin_default/leaderboardBG16.png", "./skins/skin_default/leaderboardBG17.png", "./skins/skin_default/leaderboardBG18.png", "./skins/skin_default/leaderboardCards_combined.png", "./skins/skin_default/listHeaderBg.png", "./skins/skin_default/listOverlayOpaque06.png", "./skins/skin_default/listOverlayOpaque07.png", "./skins/skin_default/listSeparator00.png", "./skins/skin_default/listSeparator01.png", "./skins/skin_default/listSeparator02.png", "./skins/skin_default/listSeparator04.png", "./skins/skin_default/listSeparator06.png", "./skins/skin_default/listSeparator07.png", "./skins/skin_default/listSeparator08.png", "./skins/skin_default/mainMenuListDropdownClosed00_fix.png", "./skins/skin_default/mainMenuListDropdownClosed01.png", "./skins/skin_default/mainMenuListGames17.png", "./skins/skin_default/mainMenuListGames18.png", "./skins/skin_default/mainMenuListGames19.png", "./skins/skin_default/mainMenuListGamesFrames.png", "./skins/skin_default/mainMenuListTile.png", "./skins/skin_default/panXBtn.png", "./skins/skin_default/pfConsoleBack00_fix.png", "./skins/skin_default/pfConsoleBack01.png", "./skins/skin_default/pfConsoleBack02.png", "./skins/skin_default/pfConsoleBtn00_fix.png", "./skins/skin_default/pfConsoleBtn01.png", "./skins/skin_default/pfConsoleBtn02.png", "./skins/skin_default/pfConsoleBtn03_fix.png", "./skins/skin_default/pfConsoleBtn04.png", "./skins/skin_default/pfConsoleBtn05.png", "./skins/skin_default/popup00.png", "./skins/skin_default/popup01.png", "./skins/skin_default/popup02.png", "./skins/skin_default/popup03.png", "./skins/skin_default/popup04.png", "./skins/skin_default/popup05.png", "./skins/skin_default/popup06.png", "./skins/skin_default/popup07.png", "./skins/skin_default/popupCheckbox00.png", "./skins/skin_default/popupCheckboxLegal.png", "./skins/skin_default/popupLegal.png", "./skins/skin_default/popupNewFeature.png", "./skins/skin_default/popupNotification00.png", "./skins/skin_default/popupNotification01.png", "./skins/skin_default/popupNotification02.png", "./skins/skin_default/popupNotification03.png", "./skins/skin_default/popupSuggestedGames00.png", "./skins/skin_default/popupSuggestedGames01.png", "./skins/skin_default/popupTransparent00.png", "./skins/skin_default/popupTransparent02.png", "./skins/skin_default/popupTransparent03.png", "./skins/skin_default/popupTransparent04.png", "./skins/skin_default/popupWelcome.png", "./skins/skin_default/popupWelcomeCollinsLogo.png", "./skins/skin_default/popupWelcomeStarPoint.png", "./skins/skin_default/popupZoomTutorial00.png", "./skins/skin_default/popupZoomTutorial01.png", "./skins/skin_default/popupZoomTutorial02.png", "./skins/skin_default/popupZoomTutorial03.png", "./skins/skin_default/popupZoomTutorial04.png", "./skins/skin_default/profileOverlayBgX01.png", "./skins/skin_default/profileOverlayEntry00.png", "./skins/skin_default/profileOverlayEntry02.png", "./skins/skin_default/profileOverlayEntry03.png", "./skins/skin_default/profileOverlayEntry05.png", "./skins/skin_default/profileOverlayEntry06.png", "./skins/skin_default/profileOverlayEntry08.png", "./skins/skin_default/profileOverlayEntry09.png", "./skins/skin_default/profileOverlayEntry10.png", "./skins/skin_default/profileOverlayEntry11.png", "./skins/skin_default/profileOverlayEntry_bot.png", "./skins/skin_default/profileOverlayEntry_mid.png", "./skins/skin_default/profileOverlayEntry_top.png", "./skins/skin_default/randomOpponentBg.png", "./skins/skin_default/starCell.png", "./skins/skin_default/storePopup00.png", "./skins/skin_default/storePopup01.png", "./skins/skin_default/storePopup02.png", "./skins/skin_default/storePopupLegal01.png", "./skins/skin_default/storePopupLegal02.png", "./skins/skin_default/storePopupPuchaseSuccess.png", "./skins/skin_default/storePopupPurchaseFail.png", "./skins/skin_default/storePreviewIcon.png", "./skins/skin_default/storePreviewPopup01.png", "./skins/skin_default/storePreviewPopup02.png", "./skins/skin_default/storeSeparator.png", "./skins/skin_default/textFieldBg.png", "./skins/skin_default/tileArrows.png", "./skins/skin_default/TileLeftIndicator_3players.png", "./skins/skin_default/TileLeftIndicator_3players_mattel.png", "./skins/skin_default/TileLeftIndicator_4players.png", "./skins/skin_default/TileLeftIndicator_4players_mattel.png", "./skins/skin_default/tileTracking.png", "./skins/skin_default/tileTrackingBranded.png", "./skins/skin_default/tileTrackingInfo.png", "./skins/skin_default/tileTrackingTiles01.png", "./skins/skin_default/tileTrackingTxtZone.png", "./skins/skin_default/tokenConnect00.png", "./skins/skin_default/toyotaFancyButton.png", "./skins/skin_default/txtField00.png", "./skins/skin_default/txtField01.png", "./skins/skin_default/txtField02.png", "./skins/skin_default/txtField03_fix.png", "./skins/skin_default/txtField04.png", "./skins/skin_default/txtField05.png", "./skins/skin_default/txtField06_fix.png", "./skins/skin_default/txtField07.png", "./skins/skin_default/txtField08.png", "./skins/skin_default/webOnboardingX.png", "./skins/skin_default/wordListSeparator00.png"];
Scrabble.PlayValidation = function() {
    return {errorMessage: "",getActiveTiles: function() {
            var f = $("#board .active");
            var d = [];
            var e;
            var b;
            var c = f.length;
            for (var a = 0; a < c; a++) {
                e = f[a].parentNode.id;
                if (e.indexOf("cell") == 0) {
                    b = e.split("_");
                    d.push({letter: f[a].getAttribute("data-letter"),id: f[a].getAttribute("data-id"),active: f[a].getAttribute("data-tile_active"),x: parseInt(b[1]),y: parseInt(b[2])})
                }
            }
            return d
        },getColumn: function(g) {
            var f = $("#board .tile");
            var d = ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"];
            var e;
            var b;
            var c = f.length;
            var a = 0;
            for (a = 0; a < c; a++) {
                e = f[a].parentNode.id;
                if (e.indexOf("cell") == 0) {
                    b = e.split("_");
                    if (parseInt(b[1]) == g) {
                        d[parseInt(b[2])] = ({letter: f[a].getAttribute("data-letter"),id: f[a].getAttribute("data-id"),active: f[a].getAttribute("data-tile_active"),x: parseInt(b[1]),y: parseInt(b[2])})
                    }
                }
            }
            return d
        },getRow: function(g) {
            var f = $("#board .tile");
            var d = ["0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"];
            var e;
            var b;
            var c = f.length;
            var a = 0;
            for (a = 0; a < c; a++) {
                e = f[a].parentNode.id;
                if (e.indexOf("cell") == 0) {
                    b = e.split("_");
                    if (parseInt(b[2]) == g) {
                        d[parseInt(b[1])] = ({letter: f[a].getAttribute("data-letter"),id: f[a].getAttribute("data-id"),active: f[a].getAttribute("data-tile_active"),x: parseInt(b[1]),y: parseInt(b[2])})
                    }
                }
            }
            return d
        },validatePlay: function() {
            Scrabble.PlayValidation.errorMessage = "";
            var n = Scrabble.PlayValidation.getActiveTiles();
            var b = [];
            var o = [];
            var v;
            var E;
            var F;
            var j = true;
            if ($("#board .inactive").length > 0) {
                j = false
            }
            if (n.length > 1) {
                var D = 15;
                var a = 15;
                var k = 0;
                var s = 0;
                var d = null;
                var x = false;
                for (var B = 0; B < n.length; B++) {
                    if (d == null) {
                        d = n[B]
                    }
                    if (n[B].x < D) {
                        D = n[B].x
                    }
                    if (n[B].x != d.x) {
                        k++
                    }
                    if (n[B].x < d.x) {
                        d = n[B]
                    }
                    if (n[B].y < a) {
                        a = n[B].y
                    }
                    if (n[B].y != d.y) {
                        s++
                    }
                    if (n[B].y < d.y) {
                        d = n[B]
                    }
                    if (n[B].y == 7 && n[B].x == 7) {
                        x = true
                    }
                }
                if (j == true && x == false) {
                    Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_CNTR_MSG";
                    return false
                }
                if (k > 0 && s > 0) {
                    Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_AXIS_MSG";
                    return false
                } else {
                    if (k == 0) {
                        var c = Scrabble.PlayValidation.getColumn(d.x);
                        b = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(d.y, c)], c, "y");
                        if (Scrabble.PlayValidation.getNumberOfActiveTilesFromWord(b) < n.length) {
                            Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_TCHNG_MSG";
                            return false
                        } else {
                            for (var z = 0; z < b.length; z++) {
                                if (b[z].active == "active") {
                                    F = Scrabble.PlayValidation.getRow(b[z].y);
                                    v = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(b[z].x, F)], F, "x");
                                    if (v.length > 1) {
                                        o.push(v)
                                    }
                                }
                            }
                        }
                    } else {
                        if (s == 0) {
                            var m = Scrabble.PlayValidation.getRow(d.y);
                            b = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(d.x, m)], m, "x");
                            if (Scrabble.PlayValidation.getNumberOfActiveTilesFromWord(b) < n.length) {
                                Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_TCHNG_MSG";
                                return false
                            } else {
                                for (var z = 0; z < b.length; z++) {
                                    if (b[z].active == "active") {
                                        E = Scrabble.PlayValidation.getColumn(b[z].x);
                                        v = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(b[z].y, E)], E, "y");
                                        if (v.length > 1) {
                                            o.push(v)
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            } else {
                if (n.length == 1) {
                    var x = false;
                    if (n[0].y == 7 && n[0].x == 7) {
                        x = true
                    }
                    if (j == true && x == false) {
                        Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_CNTR_MSG";
                        return false
                    }
                    var e = n[0];
                    b = [e];
                    E = Scrabble.PlayValidation.getColumn(e.x);
                    F = Scrabble.PlayValidation.getRow(e.y);
                    var h = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(e.y, E)], E, "y");
                    var C = Scrabble.PlayValidation.discoverWord([Scrabble.PlayValidation.getFirstTileInWord(e.x, F)], F, "x");
                    if (h.length > 1) {
                        b = h
                    }
                    if (C.length > 1) {
                        if (h.length > 1) {
                            o.push(C)
                        } else {
                            b = C
                        }
                    }
                } else {
                    Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_CNTR_MSG";
                    return "skip"
                }
            }
            if (o.length == 0) {
                if (!j) {
                    var g = false;
                    for (var t = 0; t < b.length; t++) {
                        if (b[t].active == "inactive") {
                            g = true;
                            break
                        }
                    }
                    if (!g) {
                        Scrabble.PlayValidation.errorMessage = "GSCNPP_TXT_INVLDPLY_TCHNG_MSG";
                        return false
                    }
                }
            }
            var l = "";
            if (Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch] != undefined) {
                l = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch].board.dictionary
            } else {
                if (Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch) != null) {
                    l = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch).board.dictionary
                } else {
                    return false
                }
            }
            if (l == undefined) {
                l = Scrabble.MatchOptions.dictionary
            }
            var f = 0;
            var A = 0;
            if (b.length > 0) {
                A = Scrabble.PlayValidation.getPlayScore(b);
                f += A
            }
            for (var q = 0; q < o.length; q++) {
                A = Scrabble.PlayValidation.getPlayScore(o[q]);
                f += A
            }
            if (n.length >= 7) {
                f += 50
            }
            return [b, f, l, o]
        },discoverWord: function(f, b, d) {
            var e = f[f.length - 1];
            var c = 0;
            if (e != undefined) {
                c = b[e[d]][d]
            }
            if (c < b.length - 1) {
                if (b[c + 1] != "0") {
                    var a = b[c + 1];
                    f.push(a);
                    return Scrabble.PlayValidation.discoverWord(f, b, d)
                } else {
                    return f
                }
            } else {
                return f
            }
        },getNumberOfActiveTilesFromWord: function(c) {
            var b = 0;
            for (var a = 0; a < c.length; a++) {
                if (c[a] != undefined) {
                    if (c[a].active == "active") {
                        b++
                    }
                }
            }
            return b
        },getFirstTileInWord: function(b, c) {
            var a = c[b];
            if (b == 0) {
                return a
            }
            for (var d = b; d >= -1; d--) {
                if (c[d] != "0" && c[d] != undefined) {
                    a = c[d]
                } else {
                    return a
                }
            }
        },getPlayScore: function(a) {
            var g = 1;
            var b = 0;
            var d = 0;
            var k = Scrabble.GameServerManager.matchList[Scrabble.GameServerManager.currentMatch];
            if (k == null) {
                k = Scrabble.StatsManager.getArchive(Scrabble.GameServerManager.currentMatch)
            }
            var c = k.board.dictionary;
            if (c == undefined) {
                c = Scrabble.MatchOptions.dictionary
            }
            for (var e = 0; e < a.length; e++) {
                var j = Scrabble.TileSets[c][a[e].id].score;
                b += j;
                if (a[e].active == "active") {
                    var h = 0;
                    var f = Scrabble.Board.getCellBonus(a[e].x, a[e].y);
                    switch (f) {
                        case 0:
                            break;
                        case 1:
                            g *= 2;
                            break;
                        case 2:
                            h = 1;
                            break;
                        case 3:
                            h = 2;
                            break;
                        case 4:
                            g *= 2;
                            break;
                        case 5:
                            g *= 3;
                            break;
                        default:
                            break
                    }
                    d += (j * h)
                }
            }
            return (b + d) * g
        },wordToString: function(b) {
            var c = "";
            for (var a = 0; a < b.length; a++) {
                c += b[a].letter
            }
            return c
        }}
}();
